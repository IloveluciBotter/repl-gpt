;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="11286554-f7ca-add8-10b6-9dd4f1e9bdac")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,872237,(e,t,i)=>{let r;var n,o,a=e.i(439725),s=e.r(772929),c=e.r(883735),l=e.r(619314),h=e.r(940193),u=e.r(879617),d=e.r(559542),_=e.r(316330),v=e.r(561584),f=e.r(365738);n=self,o=function(){return function(){"use strict";var e,t,i,r,n,o={965:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.GlyphRenderer=void 0;var r,n=i(374),o=i(509),a=i(855),h=i(859),u=i(381),_=11*Float32Array.BYTES_PER_ELEMENT,v=0,f=0,g=0;t.GlyphRenderer=function(e){function t(e,i,r){c._(this,t),(a=s._(this,t))._terminal=e,a._gl=i,a._dimensions=r,a._activeBuffer=0,a._vertices={count:0,attributes:new Float32Array(0),attributesBuffers:[new Float32Array(0),new Float32Array(0)]};var a,l=a._gl;void 0===o.TextureAtlas.maxAtlasPages&&(o.TextureAtlas.maxAtlasPages=Math.min(32,(0,n.throwIfFalsy)(l.getParameter(l.MAX_TEXTURE_IMAGE_UNITS))),o.TextureAtlas.maxTextureSize=(0,n.throwIfFalsy)(l.getParameter(l.MAX_TEXTURE_SIZE))),a._program=(0,n.throwIfFalsy)((0,u.createProgram)(l,"#version 300 es\nlayout (location = 0) in vec2 a_unitquad;\nlayout (location = 1) in vec2 a_cellpos;\nlayout (location = 2) in vec2 a_offset;\nlayout (location = 3) in vec2 a_size;\nlayout (location = 4) in float a_texpage;\nlayout (location = 5) in vec2 a_texcoord;\nlayout (location = 6) in vec2 a_texsize;\n\nuniform mat4 u_projection;\nuniform vec2 u_resolution;\n\nout vec2 v_texcoord;\nflat out int v_texpage;\n\nvoid main() {\n  vec2 zeroToOne = (a_offset / u_resolution) + a_cellpos + (a_unitquad * a_size);\n  gl_Position = u_projection * vec4(zeroToOne, 0.0, 1.0);\n  v_texpage = int(a_texpage);\n  v_texcoord = a_texcoord + a_unitquad * a_texsize;\n}",function(e){for(var t="",i=1;i<e;i++)t+=" else if (v_texpage == ".concat(i,") { outColor = texture(u_texture[").concat(i,"], v_texcoord); }");return"#version 300 es\nprecision lowp float;\n\nin vec2 v_texcoord;\nflat in int v_texpage;\n\nuniform sampler2D u_texture[".concat(e,"];\n\nout vec4 outColor;\n\nvoid main() {\n  if (v_texpage == 0) {\n    outColor = texture(u_texture[0], v_texcoord);\n  } ").concat(t,"\n}")}(o.TextureAtlas.maxAtlasPages))),a.register((0,h.toDisposable)(function(){return l.deleteProgram(a._program)})),a._projectionLocation=(0,n.throwIfFalsy)(l.getUniformLocation(a._program,"u_projection")),a._resolutionLocation=(0,n.throwIfFalsy)(l.getUniformLocation(a._program,"u_resolution")),a._textureLocation=(0,n.throwIfFalsy)(l.getUniformLocation(a._program,"u_texture")),a._vertexArrayObject=l.createVertexArray(),l.bindVertexArray(a._vertexArrayObject);var d=new Float32Array([0,0,1,0,0,1,1,1]),v=l.createBuffer();a.register((0,h.toDisposable)(function(){return l.deleteBuffer(v)})),l.bindBuffer(l.ARRAY_BUFFER,v),l.bufferData(l.ARRAY_BUFFER,d,l.STATIC_DRAW),l.enableVertexAttribArray(0),l.vertexAttribPointer(0,2,a._gl.FLOAT,!1,0,0);var f=new Uint8Array([0,1,2,3]),g=l.createBuffer();a.register((0,h.toDisposable)(function(){return l.deleteBuffer(g)})),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,g),l.bufferData(l.ELEMENT_ARRAY_BUFFER,f,l.STATIC_DRAW),a._attributesBuffer=(0,n.throwIfFalsy)(l.createBuffer()),a.register((0,h.toDisposable)(function(){return l.deleteBuffer(a._attributesBuffer)})),l.bindBuffer(l.ARRAY_BUFFER,a._attributesBuffer),l.enableVertexAttribArray(2),l.vertexAttribPointer(2,2,l.FLOAT,!1,_,0),l.vertexAttribDivisor(2,1),l.enableVertexAttribArray(3),l.vertexAttribPointer(3,2,l.FLOAT,!1,_,2*Float32Array.BYTES_PER_ELEMENT),l.vertexAttribDivisor(3,1),l.enableVertexAttribArray(4),l.vertexAttribPointer(4,1,l.FLOAT,!1,_,4*Float32Array.BYTES_PER_ELEMENT),l.vertexAttribDivisor(4,1),l.enableVertexAttribArray(5),l.vertexAttribPointer(5,2,l.FLOAT,!1,_,5*Float32Array.BYTES_PER_ELEMENT),l.vertexAttribDivisor(5,1),l.enableVertexAttribArray(6),l.vertexAttribPointer(6,2,l.FLOAT,!1,_,7*Float32Array.BYTES_PER_ELEMENT),l.vertexAttribDivisor(6,1),l.enableVertexAttribArray(1),l.vertexAttribPointer(1,2,l.FLOAT,!1,_,9*Float32Array.BYTES_PER_ELEMENT),l.vertexAttribDivisor(1,1),l.useProgram(a._program);for(var x=new Int32Array(o.TextureAtlas.maxAtlasPages),y=0;y<o.TextureAtlas.maxAtlasPages;y++)x[y]=y;l.uniform1iv(a._textureLocation,x),l.uniformMatrix4fv(a._projectionLocation,!1,u.PROJECTION_MATRIX),a._atlasTextures=[];for(var p=0;p<o.TextureAtlas.maxAtlasPages;p++)!function(e){var t=new u.GLTexture((0,n.throwIfFalsy)(l.createTexture()));a.register((0,h.toDisposable)(function(){return l.deleteTexture(t.texture)})),l.activeTexture(l.TEXTURE0+e),l.bindTexture(l.TEXTURE_2D,t.texture),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE),l.texImage2D(l.TEXTURE_2D,0,l.RGBA,1,1,0,l.RGBA,l.UNSIGNED_BYTE,new Uint8Array([255,0,0,255])),a._atlasTextures[e]=t}(p);return l.enable(l.BLEND),l.blendFunc(l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA),a.handleResize(),a}return d._(t,e),l._(t,[{key:"beginFrame",value:function(){return!this._atlas||this._atlas.beginFrame()}},{key:"updateCell",value:function(e,t,i,r,n,o,a,s){this._updateCell(this._vertices.attributes,e,t,i,r,n,o,a,s)}},{key:"_updateCell",value:function(e,t,i,n,o,s,c,l,h){v=(i*this._terminal.cols+t)*11,n!==a.NULL_CELL_CODE&&void 0!==n?this._atlas&&(r=l&&l.length>1?this._atlas.getRasterizedGlyphCombinedChar(l,o,s,c,!1):this._atlas.getRasterizedGlyph(n,o,s,c,!1),f=Math.floor((this._dimensions.device.cell.width-this._dimensions.device.char.width)/2),o!==h&&r.offset.x>f?(g=r.offset.x-f,e[v]=-(r.offset.x-g)+this._dimensions.device.char.left,e[v+1]=-r.offset.y+this._dimensions.device.char.top,e[v+2]=(r.size.x-g)/this._dimensions.device.canvas.width,e[v+3]=r.size.y/this._dimensions.device.canvas.height,e[v+4]=r.texturePage,e[v+5]=r.texturePositionClipSpace.x+g/this._atlas.pages[r.texturePage].canvas.width,e[v+6]=r.texturePositionClipSpace.y,e[v+7]=r.sizeClipSpace.x-g/this._atlas.pages[r.texturePage].canvas.width):(e[v]=-r.offset.x+this._dimensions.device.char.left,e[v+1]=-r.offset.y+this._dimensions.device.char.top,e[v+2]=r.size.x/this._dimensions.device.canvas.width,e[v+3]=r.size.y/this._dimensions.device.canvas.height,e[v+4]=r.texturePage,e[v+5]=r.texturePositionClipSpace.x,e[v+6]=r.texturePositionClipSpace.y,e[v+7]=r.sizeClipSpace.x),e[v+8]=r.sizeClipSpace.y):e.fill(0,v,v+11-1-2)}},{key:"clear",value:function(){var e=this._terminal,t=e.cols*e.rows*11;this._vertices.count!==t?this._vertices.attributes=new Float32Array(t):this._vertices.attributes.fill(0);for(var i=0;i<this._vertices.attributesBuffers.length;i++)this._vertices.count!==t?this._vertices.attributesBuffers[i]=new Float32Array(t):this._vertices.attributesBuffers[i].fill(0);this._vertices.count=t,i=0;for(var r=0;r<e.rows;r++)for(var n=0;n<e.cols;n++)this._vertices.attributes[i+9]=n/e.cols,this._vertices.attributes[i+10]=r/e.rows,i+=11}},{key:"handleResize",value:function(){var e=this._gl;e.useProgram(this._program),e.viewport(0,0,e.canvas.width,e.canvas.height),e.uniform2f(this._resolutionLocation,e.canvas.width,e.canvas.height),this.clear()}},{key:"render",value:function(e){if(this._atlas){var t=this._gl;t.useProgram(this._program),t.bindVertexArray(this._vertexArrayObject),this._activeBuffer=(this._activeBuffer+1)%2;for(var i=this._vertices.attributesBuffers[this._activeBuffer],r=0,n=0;n<e.lineLengths.length;n++){var o=n*this._terminal.cols*11,a=this._vertices.attributes.subarray(o,o+11*e.lineLengths[n]);i.set(a,r),r+=a.length}t.bindBuffer(t.ARRAY_BUFFER,this._attributesBuffer),t.bufferData(t.ARRAY_BUFFER,i.subarray(0,r),t.STREAM_DRAW);for(var s=0;s<this._atlas.pages.length;s++)this._atlas.pages[s].version!==this._atlasTextures[s].version&&this._bindAtlasPageTexture(t,this._atlas,s);t.drawElementsInstanced(t.TRIANGLE_STRIP,4,t.UNSIGNED_BYTE,0,r/11)}}},{key:"setAtlas",value:function(e){this._atlas=e;var t=!0,i=!1,r=void 0;try{for(var n,o=this._atlasTextures[Symbol.iterator]();!(t=(n=o.next()).done);t=!0)n.value.version=-1}catch(e){i=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(i)throw r}}}},{key:"_bindAtlasPageTexture",value:function(e,t,i){e.activeTexture(e.TEXTURE0+i),e.bindTexture(e.TEXTURE_2D,this._atlasTextures[i].texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t.pages[i].canvas),e.generateMipmap(e.TEXTURE_2D),this._atlasTextures[i].version=t.pages[i].version}},{key:"setDimensions",value:function(e){this._dimensions=e}}]),t}(h.Disposable)},742:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.RectangleRenderer=void 0;var r=i(374),n=i(859),o=i(310),a=i(381),h=8*Float32Array.BYTES_PER_ELEMENT,u=function e(){c._(this,e),this.attributes=new Float32Array(160),this.count=0},_=0,v=0,f=0,g=0,x=0,y=0,p=0;t.RectangleRenderer=function(e){function t(e,i,o,l){c._(this,t),(d=s._(this,t))._terminal=e,d._gl=i,d._dimensions=o,d._themeService=l,d._vertices=new u,d._verticesCursor=new u;var d,_=d._gl;d._program=(0,r.throwIfFalsy)((0,a.createProgram)(_,"#version 300 es\nlayout (location = 0) in vec2 a_position;\nlayout (location = 1) in vec2 a_size;\nlayout (location = 2) in vec4 a_color;\nlayout (location = 3) in vec2 a_unitquad;\n\nuniform mat4 u_projection;\n\nout vec4 v_color;\n\nvoid main() {\n  vec2 zeroToOne = a_position + (a_unitquad * a_size);\n  gl_Position = u_projection * vec4(zeroToOne, 0.0, 1.0);\n  v_color = a_color;\n}","#version 300 es\nprecision lowp float;\n\nin vec4 v_color;\n\nout vec4 outColor;\n\nvoid main() {\n  outColor = v_color;\n}")),d.register((0,n.toDisposable)(function(){return _.deleteProgram(d._program)})),d._projectionLocation=(0,r.throwIfFalsy)(_.getUniformLocation(d._program,"u_projection")),d._vertexArrayObject=_.createVertexArray(),_.bindVertexArray(d._vertexArrayObject);var v=new Float32Array([0,0,1,0,0,1,1,1]),f=_.createBuffer();d.register((0,n.toDisposable)(function(){return _.deleteBuffer(f)})),_.bindBuffer(_.ARRAY_BUFFER,f),_.bufferData(_.ARRAY_BUFFER,v,_.STATIC_DRAW),_.enableVertexAttribArray(3),_.vertexAttribPointer(3,2,d._gl.FLOAT,!1,0,0);var g=new Uint8Array([0,1,2,3]),x=_.createBuffer();return d.register((0,n.toDisposable)(function(){return _.deleteBuffer(x)})),_.bindBuffer(_.ELEMENT_ARRAY_BUFFER,x),_.bufferData(_.ELEMENT_ARRAY_BUFFER,g,_.STATIC_DRAW),d._attributesBuffer=(0,r.throwIfFalsy)(_.createBuffer()),d.register((0,n.toDisposable)(function(){return _.deleteBuffer(d._attributesBuffer)})),_.bindBuffer(_.ARRAY_BUFFER,d._attributesBuffer),_.enableVertexAttribArray(0),_.vertexAttribPointer(0,2,_.FLOAT,!1,h,0),_.vertexAttribDivisor(0,1),_.enableVertexAttribArray(1),_.vertexAttribPointer(1,2,_.FLOAT,!1,h,2*Float32Array.BYTES_PER_ELEMENT),_.vertexAttribDivisor(1,1),_.enableVertexAttribArray(2),_.vertexAttribPointer(2,4,_.FLOAT,!1,h,4*Float32Array.BYTES_PER_ELEMENT),_.vertexAttribDivisor(2,1),d._updateCachedColors(l.colors),d.register(d._themeService.onChangeColors(function(e){d._updateCachedColors(e),d._updateViewportRectangle()})),d}return d._(t,e),l._(t,[{key:"renderBackgrounds",value:function(){this._renderVertices(this._vertices)}},{key:"renderCursor",value:function(){this._renderVertices(this._verticesCursor)}},{key:"_renderVertices",value:function(e){var t=this._gl;t.useProgram(this._program),t.bindVertexArray(this._vertexArrayObject),t.uniformMatrix4fv(this._projectionLocation,!1,a.PROJECTION_MATRIX),t.bindBuffer(t.ARRAY_BUFFER,this._attributesBuffer),t.bufferData(t.ARRAY_BUFFER,e.attributes,t.DYNAMIC_DRAW),t.drawElementsInstanced(this._gl.TRIANGLE_STRIP,4,t.UNSIGNED_BYTE,0,e.count)}},{key:"handleResize",value:function(){this._updateViewportRectangle()}},{key:"setDimensions",value:function(e){this._dimensions=e}},{key:"_updateCachedColors",value:function(e){this._bgFloat=this._colorToFloat32Array(e.background),this._cursorFloat=this._colorToFloat32Array(e.cursor)}},{key:"_updateViewportRectangle",value:function(){this._addRectangleFloat(this._vertices.attributes,0,0,0,this._terminal.cols*this._dimensions.device.cell.width,this._terminal.rows*this._dimensions.device.cell.height,this._bgFloat)}},{key:"updateBackgrounds",value:function(e){var t,i,r,n,a,s,c,l,h,u,d,_=this._terminal,v=this._vertices,f=1;for(t=0;t<_.rows;t++){for(r=-1,n=0,a=0,s=!1,i=0;i<_.cols;i++)c=(t*_.cols+i)*o.RENDER_MODEL_INDICIES_PER_CELL,l=e.cells[c+o.RENDER_MODEL_BG_OFFSET],u=!!(0x4000000&(h=e.cells[c+o.RENDER_MODEL_FG_OFFSET])),(l!==n||h!==a&&(s||u))&&((0!==n||s&&0!==a)&&(d=8*f++,this._updateRectangle(v,d,a,n,r,i,t)),r=i,n=l,a=h,s=u);(0!==n||s&&0!==a)&&(d=8*f++,this._updateRectangle(v,d,a,n,r,_.cols,t))}v.count=f}},{key:"updateCursor",value:function(e){var t=this._verticesCursor,i=e.cursor;if(!i||"block"===i.style)return void(t.count=0);var r,n=0;"bar"!==i.style&&"outline"!==i.style||(r=8*n++,this._addRectangleFloat(t.attributes,r,i.x*this._dimensions.device.cell.width,i.y*this._dimensions.device.cell.height,"bar"===i.style?i.dpr*i.cursorWidth:i.dpr,this._dimensions.device.cell.height,this._cursorFloat)),"underline"!==i.style&&"outline"!==i.style||(r=8*n++,this._addRectangleFloat(t.attributes,r,i.x*this._dimensions.device.cell.width,(i.y+1)*this._dimensions.device.cell.height-i.dpr,i.width*this._dimensions.device.cell.width,i.dpr,this._cursorFloat)),"outline"===i.style&&(r=8*n++,this._addRectangleFloat(t.attributes,r,i.x*this._dimensions.device.cell.width,i.y*this._dimensions.device.cell.height,i.width*this._dimensions.device.cell.width,i.dpr,this._cursorFloat),r=8*n++,this._addRectangleFloat(t.attributes,r,(i.x+i.width)*this._dimensions.device.cell.width-i.dpr,i.y*this._dimensions.device.cell.height,i.dpr,this._dimensions.device.cell.height,this._cursorFloat)),t.count=n}},{key:"_updateRectangle",value:function(e,t,i,r,n,o,s){if(0x4000000&i)switch(0x3000000&i){case 0x1000000:case 0x2000000:_=this._themeService.colors.ansi[255&i].rgba;break;case 0x3000000:_=(0xffffff&i)<<8;break;default:_=this._themeService.colors.foreground.rgba}else switch(0x3000000&r){case 0x1000000:case 0x2000000:_=this._themeService.colors.ansi[255&r].rgba;break;case 0x3000000:_=(0xffffff&r)<<8;break;default:_=this._themeService.colors.background.rgba}e.attributes.length<t+4&&(e.attributes=(0,a.expandFloat32Array)(e.attributes,this._terminal.rows*this._terminal.cols*8)),v=n*this._dimensions.device.cell.width,f=s*this._dimensions.device.cell.height,g=(_>>24&255)/255,x=(_>>16&255)/255,y=(_>>8&255)/255,p=1,this._addRectangle(e.attributes,t,v,f,(o-n)*this._dimensions.device.cell.width,this._dimensions.device.cell.height,g,x,y,p)}},{key:"_addRectangle",value:function(e,t,i,r,n,o,a,s,c,l){e[t]=i/this._dimensions.device.canvas.width,e[t+1]=r/this._dimensions.device.canvas.height,e[t+2]=n/this._dimensions.device.canvas.width,e[t+3]=o/this._dimensions.device.canvas.height,e[t+4]=a,e[t+5]=s,e[t+6]=c,e[t+7]=l}},{key:"_addRectangleFloat",value:function(e,t,i,r,n,o,a){e[t]=i/this._dimensions.device.canvas.width,e[t+1]=r/this._dimensions.device.canvas.height,e[t+2]=n/this._dimensions.device.canvas.width,e[t+3]=o/this._dimensions.device.canvas.height,e[t+4]=a[0],e[t+5]=a[1],e[t+6]=a[2],e[t+7]=a[3]}},{key:"_colorToFloat32Array",value:function(e){return new Float32Array([(e.rgba>>24&255)/255,(e.rgba>>16&255)/255,(e.rgba>>8&255)/255,(255&e.rgba)/255])}}]),t}(n.Disposable)},310:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.RenderModel=t.COMBINED_CHAR_BIT_MASK=t.RENDER_MODEL_EXT_OFFSET=t.RENDER_MODEL_FG_OFFSET=t.RENDER_MODEL_BG_OFFSET=t.RENDER_MODEL_INDICIES_PER_CELL=void 0;var r=i(296);t.RENDER_MODEL_INDICIES_PER_CELL=4,t.RENDER_MODEL_BG_OFFSET=1,t.RENDER_MODEL_FG_OFFSET=2,t.RENDER_MODEL_EXT_OFFSET=3,t.COMBINED_CHAR_BIT_MASK=0x80000000,t.RenderModel=function(){function e(){c._(this,e),this.cells=new Uint32Array(0),this.lineLengths=new Uint32Array(0),this.selection=(0,r.createSelectionRenderModel)()}return l._(e,[{key:"resize",value:function(e,i){var r=e*i*t.RENDER_MODEL_INDICIES_PER_CELL;r!==this.cells.length&&(this.cells=new Uint32Array(r),this.lineLengths=new Uint32Array(i))}},{key:"clear",value:function(){this.cells.fill(0,0),this.lineLengths.fill(0,0)}}]),e}()},666:function(e,t,i){var r=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Math.max(Math.min(e,t),i)};Object.defineProperty(t,"__esModule",{value:!0}),t.JoinedCellData=t.WebglRenderer=void 0;var n=i(820),o=i(274),a=i(627),h=i(457),u=i(56),v=i(374),f=i(345),g=i(859),x=i(147),y=i(782),p=i(855),C=i(965),m=i(742),L=i(310),w=i(733);t.WebglRenderer=function(e){function t(e,i,r,l,h,d,x,p,C){var m,b;if(c._(this,t),(m=s._(this,t))._terminal=e,m._characterJoinerService=i,m._charSizeService=r,m._coreBrowserService=l,m._coreService=h,m._decorationService=d,m._optionsService=x,m._themeService=p,m._cursorBlinkStateManager=new g.MutableDisposable,m._charAtlasDisposable=m.register(new g.MutableDisposable),m._observerDisposable=m.register(new g.MutableDisposable),m._model=new L.RenderModel,m._workCell=new y.CellData,m._rectangleRenderer=m.register(new g.MutableDisposable),m._glyphRenderer=m.register(new g.MutableDisposable),m._onChangeTextureAtlas=m.register(new f.EventEmitter),m.onChangeTextureAtlas=m._onChangeTextureAtlas.event,m._onAddTextureAtlasCanvas=m.register(new f.EventEmitter),m.onAddTextureAtlasCanvas=m._onAddTextureAtlasCanvas.event,m._onRemoveTextureAtlasCanvas=m.register(new f.EventEmitter),m.onRemoveTextureAtlasCanvas=m._onRemoveTextureAtlasCanvas.event,m._onRequestRedraw=m.register(new f.EventEmitter),m.onRequestRedraw=m._onRequestRedraw.event,m._onContextLoss=m.register(new f.EventEmitter),m.onContextLoss=m._onContextLoss.event,m.register(m._themeService.onChangeColors(function(){return m._handleColorChange()})),m._cellColorResolver=new o.CellColorResolver(m._terminal,m._optionsService,m._model.selection,m._decorationService,m._coreBrowserService,m._themeService),m._core=m._terminal._core,m._renderLayers=[new w.LinkRenderLayer(m._core.screenElement,2,m._terminal,m._core.linkifier,m._coreBrowserService,x,m._themeService)],m.dimensions=(0,v.createRenderDimensions)(),m._devicePixelRatio=m._coreBrowserService.dpr,m._updateDimensions(),m._updateCursorBlink(),m.register(x.onOptionChange(function(){return m._handleOptionsChanged()})),m._canvas=m._coreBrowserService.mainDocument.createElement("canvas"),m._gl=m._canvas.getContext("webgl2",{antialias:!1,depth:!1,preserveDrawingBuffer:C}),!m._gl)throw Error("WebGL2 not supported "+m._gl);return m.register((0,n.addDisposableDomListener)(m._canvas,"webglcontextlost",function(e){console.log("webglcontextlost event received"),e.preventDefault(),m._contextRestorationTimeout=setTimeout(function(){m._contextRestorationTimeout=void 0,console.warn("webgl context not restored; firing onContextLoss"),m._onContextLoss.fire(e)},3e3)})),m.register((0,n.addDisposableDomListener)(m._canvas,"webglcontextrestored",function(e){console.warn("webglcontextrestored event received"),clearTimeout(m._contextRestorationTimeout),m._contextRestorationTimeout=void 0,(0,a.removeTerminalFromCache)(m._terminal),m._initializeWebGLState(),m._requestRedrawViewport()})),m._observerDisposable.value=(0,u.observeDevicePixelDimensions)(m._canvas,m._coreBrowserService.window,function(e,t){return m._setCanvasDevicePixelDimensions(e,t)}),m.register(m._coreBrowserService.onWindowChange(function(e){m._observerDisposable.value=(0,u.observeDevicePixelDimensions)(m._canvas,e,function(e,t){return m._setCanvasDevicePixelDimensions(e,t)})})),m._core.screenElement.appendChild(m._canvas),b=_._(m._initializeWebGLState(),2),m._rectangleRenderer.value=b[0],m._glyphRenderer.value=b[1],m._isAttached=m._coreBrowserService.window.document.body.contains(m._core.screenElement),m.register((0,g.toDisposable)(function(){var e=!0,t=!1,i=void 0;try{for(var r,n,o=m._renderLayers[Symbol.iterator]();!(e=(n=o.next()).done);e=!0)n.value.dispose()}catch(e){t=!0,i=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw i}}null==(r=m._canvas.parentElement)||r.removeChild(m._canvas),(0,a.removeTerminalFromCache)(m._terminal)})),m}return d._(t,e),l._(t,[{key:"textureAtlas",get:function(){var e;return null==(e=this._charAtlas)?void 0:e.pages[0].canvas}},{key:"_handleColorChange",value:function(){this._refreshCharAtlas(),this._clearModel(!0)}},{key:"handleDevicePixelRatioChange",value:function(){this._devicePixelRatio!==this._coreBrowserService.dpr&&(this._devicePixelRatio=this._coreBrowserService.dpr,this.handleResize(this._terminal.cols,this._terminal.rows))}},{key:"handleResize",value:function(e,t){this._updateDimensions(),this._model.resize(this._terminal.cols,this._terminal.rows);var i=!0,r=!1,n=void 0;try{for(var o,a,s,c,l,h=this._renderLayers[Symbol.iterator]();!(i=(l=h.next()).done);i=!0)l.value.resize(this._terminal,this.dimensions)}catch(e){r=!0,n=e}finally{try{i||null==h.return||h.return()}finally{if(r)throw n}}this._canvas.width=this.dimensions.device.canvas.width,this._canvas.height=this.dimensions.device.canvas.height,this._canvas.style.width="".concat(this.dimensions.css.canvas.width,"px"),this._canvas.style.height="".concat(this.dimensions.css.canvas.height,"px"),this._core.screenElement.style.width="".concat(this.dimensions.css.canvas.width,"px"),this._core.screenElement.style.height="".concat(this.dimensions.css.canvas.height,"px"),null==(o=this._rectangleRenderer.value)||o.setDimensions(this.dimensions),null==(a=this._rectangleRenderer.value)||a.handleResize(),null==(s=this._glyphRenderer.value)||s.setDimensions(this.dimensions),null==(c=this._glyphRenderer.value)||c.handleResize(),this._refreshCharAtlas(),this._clearModel(!1)}},{key:"handleCharSizeChanged",value:function(){this.handleResize(this._terminal.cols,this._terminal.rows)}},{key:"handleBlur",value:function(){var e=!0,t=!1,i=void 0;try{for(var r,n,o=this._renderLayers[Symbol.iterator]();!(e=(n=o.next()).done);e=!0)n.value.handleBlur(this._terminal)}catch(e){t=!0,i=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw i}}null==(r=this._cursorBlinkStateManager.value)||r.pause(),this._requestRedrawViewport()}},{key:"handleFocus",value:function(){var e=!0,t=!1,i=void 0;try{for(var r,n,o=this._renderLayers[Symbol.iterator]();!(e=(n=o.next()).done);e=!0)n.value.handleFocus(this._terminal)}catch(e){t=!0,i=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw i}}null==(r=this._cursorBlinkStateManager.value)||r.resume(),this._requestRedrawViewport()}},{key:"handleSelectionChanged",value:function(e,t,i){var r=!0,n=!1,o=void 0;try{for(var a,s=this._renderLayers[Symbol.iterator]();!(r=(a=s.next()).done);r=!0)a.value.handleSelectionChanged(this._terminal,e,t,i)}catch(e){n=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(n)throw o}}this._model.selection.update(this._core,e,t,i),this._requestRedrawViewport()}},{key:"handleCursorMove",value:function(){var e=!0,t=!1,i=void 0;try{for(var r,n,o=this._renderLayers[Symbol.iterator]();!(e=(n=o.next()).done);e=!0)n.value.handleCursorMove(this._terminal)}catch(e){t=!0,i=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw i}}null==(r=this._cursorBlinkStateManager.value)||r.restartBlinkAnimation()}},{key:"_handleOptionsChanged",value:function(){this._updateDimensions(),this._refreshCharAtlas(),this._updateCursorBlink()}},{key:"_initializeWebGLState",value:function(){return this._rectangleRenderer.value=new m.RectangleRenderer(this._terminal,this._gl,this.dimensions,this._themeService),this._glyphRenderer.value=new C.GlyphRenderer(this._terminal,this._gl,this.dimensions),this.handleCharSizeChanged(),[this._rectangleRenderer.value,this._glyphRenderer.value]}},{key:"_refreshCharAtlas",value:function(){if(this.dimensions.device.char.width<=0&&this.dimensions.device.char.height<=0)return void(this._isAttached=!1);var e,t=(0,a.acquireTextureAtlas)(this._terminal,this._optionsService.rawOptions,this._themeService.colors,this.dimensions.device.cell.width,this.dimensions.device.cell.height,this.dimensions.device.char.width,this.dimensions.device.char.height,this._coreBrowserService.dpr);this._charAtlas!==t&&(this._onChangeTextureAtlas.fire(t.pages[0].canvas),this._charAtlasDisposable.value=(0,g.getDisposeArrayDisposable)([(0,f.forwardEvent)(t.onAddTextureAtlasCanvas,this._onAddTextureAtlasCanvas),(0,f.forwardEvent)(t.onRemoveTextureAtlasCanvas,this._onRemoveTextureAtlasCanvas)])),this._charAtlas=t,this._charAtlas.warmUp(),null==(e=this._glyphRenderer.value)||e.setAtlas(this._charAtlas)}},{key:"_clearModel",value:function(e){var t;this._model.clear(),e&&(null==(t=this._glyphRenderer.value)||t.clear())}},{key:"clearTextureAtlas",value:function(){var e;null==(e=this._charAtlas)||e.clearTexture(),this._clearModel(!0),this._requestRedrawViewport()}},{key:"clear",value:function(){this._clearModel(!0);var e=!0,t=!1,i=void 0;try{for(var r,n,o=this._renderLayers[Symbol.iterator]();!(e=(n=o.next()).done);e=!0)n.value.reset(this._terminal)}catch(e){t=!0,i=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw i}}null==(r=this._cursorBlinkStateManager.value)||r.restartBlinkAnimation(),this._updateCursorBlink()}},{key:"registerCharacterJoiner",value:function(e){return -1}},{key:"deregisterCharacterJoiner",value:function(e){return!1}},{key:"renderRows",value:function(e,t){if(!this._isAttached){if(!(this._coreBrowserService.window.document.body.contains(this._core.screenElement)&&this._charSizeService.width&&this._charSizeService.height))return;this._updateDimensions(),this._refreshCharAtlas(),this._isAttached=!0}var i=!0,r=!1,n=void 0;try{for(var o,a=this._renderLayers[Symbol.iterator]();!(i=(o=a.next()).done);i=!0)o.value.handleGridChanged(this._terminal,e,t)}catch(e){r=!0,n=e}finally{try{i||null==a.return||a.return()}finally{if(r)throw n}}this._glyphRenderer.value&&this._rectangleRenderer.value&&(this._glyphRenderer.value.beginFrame()?(this._clearModel(!0),this._updateModel(0,this._terminal.rows-1)):this._updateModel(e,t),this._rectangleRenderer.value.renderBackgrounds(),this._glyphRenderer.value.render(this._model),this._cursorBlinkStateManager.value&&!this._cursorBlinkStateManager.value.isCursorVisible||this._rectangleRenderer.value.renderCursor())}},{key:"_updateCursorBlink",value:function(){var e=this;this._terminal.options.cursorBlink?this._cursorBlinkStateManager.value=new h.CursorBlinkStateManager(function(){e._requestRedrawCursor()},this._coreBrowserService):this._cursorBlinkStateManager.clear(),this._requestRedrawCursor()}},{key:"_updateModel",value:function(e,t){var i,n,o,a,s,c,l,h,u,d,_,v,f,g=this._core,x=this._workCell;e=r(e,g.rows-1,0),t=r(t,g.rows-1,0);var y=this._terminal.buffer.active.baseY+this._terminal.buffer.active.cursorY,C=y-g.buffer.ydisp,m=Math.min(this._terminal.buffer.active.cursorX,g.cols-1),w=-1,M=this._coreService.isCursorInitialized&&!this._coreService.isCursorHidden&&(!this._cursorBlinkStateManager.value||this._cursorBlinkStateManager.value.isCursorVisible);this._model.cursor=void 0;var R=!1;for(n=e;n<=t;n++)for(o=n+g.buffer.ydisp,a=g.buffer.lines.get(o),this._model.lineLengths[n]=0,s=this._characterJoinerService.getJoinedCharacters(o),v=0;v<g.cols;v++)if(i=this._cellColorResolver.result.bg,a.loadCell(v,x),0===v&&(i=this._cellColorResolver.result.bg),c=!1,l=v,s.length>0&&v===s[0][0]&&(c=!0,h=s.shift(),x=new b(x,a.translateToString(!0,h[0],h[1]),h[1]-h[0]),l=h[1]-1),u=x.getChars(),d=x.getCode(),_=(n*g.cols+v)*L.RENDER_MODEL_INDICIES_PER_CELL,this._cellColorResolver.resolve(x,v,o,this.dimensions.device.cell.width),M&&o===y&&(v===m&&(this._model.cursor={x:m,y:C,width:x.getWidth(),style:this._coreBrowserService.isFocused?g.options.cursorStyle||"block":g.options.cursorInactiveStyle,cursorWidth:g.options.cursorWidth,dpr:this._devicePixelRatio},w=m+x.getWidth()-1),v>=m&&v<=w&&(this._coreBrowserService.isFocused&&"block"===(g.options.cursorStyle||"block")||!1===this._coreBrowserService.isFocused&&"block"===g.options.cursorInactiveStyle)&&(this._cellColorResolver.result.fg=0x3000000|this._themeService.colors.cursorAccent.rgba>>8&0xffffff,this._cellColorResolver.result.bg=0x3000000|this._themeService.colors.cursor.rgba>>8&0xffffff)),d!==p.NULL_CELL_CODE&&(this._model.lineLengths[n]=v+1),(this._model.cells[_]!==d||this._model.cells[_+L.RENDER_MODEL_BG_OFFSET]!==this._cellColorResolver.result.bg||this._model.cells[_+L.RENDER_MODEL_FG_OFFSET]!==this._cellColorResolver.result.fg||this._model.cells[_+L.RENDER_MODEL_EXT_OFFSET]!==this._cellColorResolver.result.ext)&&(R=!0,u.length>1&&(d|=L.COMBINED_CHAR_BIT_MASK),this._model.cells[_]=d,this._model.cells[_+L.RENDER_MODEL_BG_OFFSET]=this._cellColorResolver.result.bg,this._model.cells[_+L.RENDER_MODEL_FG_OFFSET]=this._cellColorResolver.result.fg,this._model.cells[_+L.RENDER_MODEL_EXT_OFFSET]=this._cellColorResolver.result.ext,this._glyphRenderer.value.updateCell(v,n,d,this._cellColorResolver.result.bg,this._cellColorResolver.result.fg,this._cellColorResolver.result.ext,u,i),c))for(x=this._workCell,v++;v<l;v++)f=(n*g.cols+v)*L.RENDER_MODEL_INDICIES_PER_CELL,this._glyphRenderer.value.updateCell(v,n,p.NULL_CELL_CODE,0,0,0,p.NULL_CELL_CHAR,0),this._model.cells[f]=p.NULL_CELL_CODE,this._model.cells[f+L.RENDER_MODEL_BG_OFFSET]=this._cellColorResolver.result.bg,this._model.cells[f+L.RENDER_MODEL_FG_OFFSET]=this._cellColorResolver.result.fg,this._model.cells[f+L.RENDER_MODEL_EXT_OFFSET]=this._cellColorResolver.result.ext;R&&this._rectangleRenderer.value.updateBackgrounds(this._model),this._rectangleRenderer.value.updateCursor(this._model)}},{key:"_updateDimensions",value:function(){this._charSizeService.width&&this._charSizeService.height&&(this.dimensions.device.char.width=Math.floor(this._charSizeService.width*this._devicePixelRatio),this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*this._devicePixelRatio),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.top=1===this._optionsService.rawOptions.lineHeight?0:Math.round((this.dimensions.device.cell.height-this.dimensions.device.char.height)/2),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.char.left=Math.floor(this._optionsService.rawOptions.letterSpacing/2),this.dimensions.device.canvas.height=this._terminal.rows*this.dimensions.device.cell.height,this.dimensions.device.canvas.width=this._terminal.cols*this.dimensions.device.cell.width,this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/this._devicePixelRatio),this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/this._devicePixelRatio),this.dimensions.css.cell.height=this.dimensions.device.cell.height/this._devicePixelRatio,this.dimensions.css.cell.width=this.dimensions.device.cell.width/this._devicePixelRatio)}},{key:"_setCanvasDevicePixelDimensions",value:function(e,t){this._canvas.width===e&&this._canvas.height===t||(this._canvas.width=e,this._canvas.height=t,this._requestRedrawViewport())}},{key:"_requestRedrawViewport",value:function(){this._onRequestRedraw.fire({start:0,end:this._terminal.rows-1})}},{key:"_requestRedrawCursor",value:function(){var e=this._terminal.buffer.active.cursorY;this._onRequestRedraw.fire({start:e,end:e})}}]),t}(g.Disposable);var b=function(e){function t(e,i,r){var n;return c._(this,t),(n=s._(this,t)).content=0,n.combinedData="",n.fg=e.fg,n.bg=e.bg,n.combinedData=i,n._width=r,n}return d._(t,e),l._(t,[{key:"isCombined",value:function(){return 2097152}},{key:"getWidth",value:function(){return this._width}},{key:"getChars",value:function(){return this.combinedData}},{key:"getCode",value:function(){return 2097151}},{key:"setFromCharData",value:function(e){throw Error("not implemented")}},{key:"getAsCharData",value:function(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}]),t}(x.AttributeData);t.JoinedCellData=b},381:function(e,t,i){var r=function(e,t,i){var r=(0,n.throwIfFalsy)(e.createShader(t));if(e.shaderSource(r,i),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS))return r;console.error(e.getShaderInfoLog(r)),e.deleteShader(r)};Object.defineProperty(t,"__esModule",{value:!0}),t.GLTexture=t.expandFloat32Array=t.createShader=t.createProgram=t.PROJECTION_MATRIX=void 0;var n=i(374);t.PROJECTION_MATRIX=new Float32Array([2,0,0,0,0,-2,0,0,0,0,1,0,-1,1,0,1]),t.createProgram=function(e,t,i){var o=(0,n.throwIfFalsy)(e.createProgram());if(e.attachShader(o,(0,n.throwIfFalsy)(r(e,e.VERTEX_SHADER,t))),e.attachShader(o,(0,n.throwIfFalsy)(r(e,e.FRAGMENT_SHADER,i))),e.linkProgram(o),e.getProgramParameter(o,e.LINK_STATUS))return o;console.error(e.getProgramInfoLog(o)),e.deleteProgram(o)},t.createShader=r,t.expandFloat32Array=function(e,t){for(var i=new Float32Array(Math.min(2*e.length,t)),r=0;r<e.length;r++)i[r]=e[r];return i},t.GLTexture=function e(t){c._(this,e),this.texture=t,this.version=-1}},592:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.BaseRenderLayer=void 0;var r=i(627),n=i(237),o=i(374),a=i(859);t.BaseRenderLayer=function(e){function t(e,i,r,n,o,l,h,u){var d;return c._(this,t),(d=s._(this,t))._container=i,d._alpha=o,d._coreBrowserService=l,d._optionsService=h,d._themeService=u,d._deviceCharWidth=0,d._deviceCharHeight=0,d._deviceCellWidth=0,d._deviceCellHeight=0,d._deviceCharLeft=0,d._deviceCharTop=0,d._canvas=d._coreBrowserService.mainDocument.createElement("canvas"),d._canvas.classList.add("xterm-".concat(r,"-layer")),d._canvas.style.zIndex=n.toString(),d._initCanvas(),d._container.appendChild(d._canvas),d.register(d._themeService.onChangeColors(function(t){d._refreshCharAtlas(e,t),d.reset(e)})),d.register((0,a.toDisposable)(function(){d._canvas.remove()})),d}return d._(t,e),l._(t,[{key:"_initCanvas",value:function(){this._ctx=(0,o.throwIfFalsy)(this._canvas.getContext("2d",{alpha:this._alpha})),this._alpha||this._clearAll()}},{key:"handleBlur",value:function(e){}},{key:"handleFocus",value:function(e){}},{key:"handleCursorMove",value:function(e){}},{key:"handleGridChanged",value:function(e,t,i){}},{key:"handleSelectionChanged",value:function(e,t,i){arguments.length>3&&void 0!==arguments[3]&&arguments[3]}},{key:"_setTransparency",value:function(e,t){if(t!==this._alpha){var i=this._canvas;this._alpha=t,this._canvas=this._canvas.cloneNode(),this._initCanvas(),this._container.replaceChild(this._canvas,i),this._refreshCharAtlas(e,this._themeService.colors),this.handleGridChanged(e,0,e.rows-1)}}},{key:"_refreshCharAtlas",value:function(e,t){this._deviceCharWidth<=0&&this._deviceCharHeight<=0||(this._charAtlas=(0,r.acquireTextureAtlas)(e,this._optionsService.rawOptions,t,this._deviceCellWidth,this._deviceCellHeight,this._deviceCharWidth,this._deviceCharHeight,this._coreBrowserService.dpr),this._charAtlas.warmUp())}},{key:"resize",value:function(e,t){this._deviceCellWidth=t.device.cell.width,this._deviceCellHeight=t.device.cell.height,this._deviceCharWidth=t.device.char.width,this._deviceCharHeight=t.device.char.height,this._deviceCharLeft=t.device.char.left,this._deviceCharTop=t.device.char.top,this._canvas.width=t.device.canvas.width,this._canvas.height=t.device.canvas.height,this._canvas.style.width="".concat(t.css.canvas.width,"px"),this._canvas.style.height="".concat(t.css.canvas.height,"px"),this._alpha||this._clearAll(),this._refreshCharAtlas(e,this._themeService.colors)}},{key:"_fillBottomLineAtCells",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this._ctx.fillRect(e*this._deviceCellWidth,(t+1)*this._deviceCellHeight-this._coreBrowserService.dpr-1,i*this._deviceCellWidth,this._coreBrowserService.dpr)}},{key:"_clearAll",value:function(){this._alpha?this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height):(this._ctx.fillStyle=this._themeService.colors.background.css,this._ctx.fillRect(0,0,this._canvas.width,this._canvas.height))}},{key:"_clearCells",value:function(e,t,i,r){this._alpha?this._ctx.clearRect(e*this._deviceCellWidth,t*this._deviceCellHeight,i*this._deviceCellWidth,r*this._deviceCellHeight):(this._ctx.fillStyle=this._themeService.colors.background.css,this._ctx.fillRect(e*this._deviceCellWidth,t*this._deviceCellHeight,i*this._deviceCellWidth,r*this._deviceCellHeight))}},{key:"_fillCharTrueColor",value:function(e,t,i,r){this._ctx.font=this._getFont(e,!1,!1),this._ctx.textBaseline=n.TEXT_BASELINE,this._clipCell(i,r,t.getWidth()),this._ctx.fillText(t.getChars(),i*this._deviceCellWidth+this._deviceCharLeft,r*this._deviceCellHeight+this._deviceCharTop+this._deviceCharHeight)}},{key:"_clipCell",value:function(e,t,i){this._ctx.beginPath(),this._ctx.rect(e*this._deviceCellWidth,t*this._deviceCellHeight,i*this._deviceCellWidth,this._deviceCellHeight),this._ctx.clip()}},{key:"_getFont",value:function(e,t,i){return"".concat(i?"italic":""," ").concat(t?e.options.fontWeightBold:e.options.fontWeight," ").concat(e.options.fontSize*this._coreBrowserService.dpr,"px ").concat(e.options.fontFamily)}}]),t}(a.Disposable)},733:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.LinkRenderLayer=void 0;var r=i(197),n=i(237);t.LinkRenderLayer=function(e){function t(e,i,r,n,o,a,l){var h;return c._(this,t),(h=s._(this,t,[r,e,"link",i,!0,o,a,l])).register(n.onShowLinkUnderline(function(e){return h._handleShowLinkUnderline(e)})),h.register(n.onHideLinkUnderline(function(e){return h._handleHideLinkUnderline(e)})),h}return d._(t,e),l._(t,[{key:"resize",value:function(e,i){h._(u._(t.prototype),"resize",this).call(this,e,i),this._state=void 0}},{key:"reset",value:function(e){this._clearCurrentLink()}},{key:"_clearCurrentLink",value:function(){if(this._state){this._clearCells(this._state.x1,this._state.y1,this._state.cols-this._state.x1,1);var e=this._state.y2-this._state.y1-1;e>0&&this._clearCells(0,this._state.y1+1,this._state.cols,e),this._clearCells(0,this._state.y2,this._state.x2,1),this._state=void 0}}},{key:"_handleShowLinkUnderline",value:function(e){if(e.fg===n.INVERTED_DEFAULT_COLOR?this._ctx.fillStyle=this._themeService.colors.background.css:void 0!==e.fg&&(0,r.is256Color)(e.fg)?this._ctx.fillStyle=this._themeService.colors.ansi[e.fg].css:this._ctx.fillStyle=this._themeService.colors.foreground.css,e.y1===e.y2)this._fillBottomLineAtCells(e.x1,e.y1,e.x2-e.x1);else{this._fillBottomLineAtCells(e.x1,e.y1,e.cols-e.x1);for(var t=e.y1+1;t<e.y2;t++)this._fillBottomLineAtCells(0,t,e.cols);this._fillBottomLineAtCells(0,e.y2,e.x2)}this._state=e}},{key:"_handleHideLinkUnderline",value:function(e){this._clearCurrentLink()}}]),t}(i(592).BaseRenderLayer)},820:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.addDisposableDomListener=void 0,t.addDisposableDomListener=function(e,t,i,r){e.addEventListener(t,i,r);var n=!1;return{dispose:function(){n||(n=!0,e.removeEventListener(t,i,r))}}}},274:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.CellColorResolver=void 0;var r,n=i(855),o=i(160),a=i(374),s=0,h=0,u=!1,d=!1,_=!1,v=0;t.CellColorResolver=function(){function e(t,i,r,n,o,a){c._(this,e),this._terminal=t,this._optionService=i,this._selectionRenderModel=r,this._decorationService=n,this._coreBrowserService=o,this._themeService=a,this.result={fg:0,bg:0,ext:0}}return l._(e,[{key:"resolve",value:function(e,t,i,c){if(this.result.bg=e.bg,this.result.fg=e.fg,this.result.ext=0x10000000&e.bg?e.extended.ext:0,h=0,s=0,d=!1,u=!1,_=!1,r=this._themeService.colors,v=0,e.getCode()!==n.NULL_CELL_CODE&&4===e.extended.underlineStyle&&(v=t*c%(2*Math.round(Math.max(1,Math.floor(this._optionService.rawOptions.fontSize*this._coreBrowserService.dpr/15))))),this._decorationService.forEachDecorationAtCell(t,i,"bottom",function(e){e.backgroundColorRGB&&(h=e.backgroundColorRGB.rgba>>8&0xffffff,d=!0),e.foregroundColorRGB&&(s=e.foregroundColorRGB.rgba>>8&0xffffff,u=!0)}),_=this._selectionRenderModel.isCellSelected(this._terminal,t,i)){if(0x4000000&this.result.fg||0!=(0x3000000&this.result.bg)){if(0x4000000&this.result.fg)switch(0x3000000&this.result.fg){case 0x1000000:case 0x2000000:h=this._themeService.colors.ansi[255&this.result.fg].rgba;break;case 0x3000000:h=(0xffffff&this.result.fg)<<8|255;break;default:h=this._themeService.colors.foreground.rgba}else switch(0x3000000&this.result.bg){case 0x1000000:case 0x2000000:h=this._themeService.colors.ansi[255&this.result.bg].rgba;break;case 0x3000000:h=(0xffffff&this.result.bg)<<8|255}h=o.rgba.blend(h,0xffffff00&(this._coreBrowserService.isFocused?r.selectionBackgroundOpaque:r.selectionInactiveBackgroundOpaque).rgba|128)>>8&0xffffff}else h=(this._coreBrowserService.isFocused?r.selectionBackgroundOpaque:r.selectionInactiveBackgroundOpaque).rgba>>8&0xffffff;if(d=!0,r.selectionForeground&&(s=r.selectionForeground.rgba>>8&0xffffff,u=!0),(0,a.treatGlyphAsBackgroundColor)(e.getCode())){if(0x4000000&this.result.fg&&0==(0x3000000&this.result.bg))s=(this._coreBrowserService.isFocused?r.selectionBackgroundOpaque:r.selectionInactiveBackgroundOpaque).rgba>>8&0xffffff;else{if(0x4000000&this.result.fg)switch(0x3000000&this.result.bg){case 0x1000000:case 0x2000000:s=this._themeService.colors.ansi[255&this.result.bg].rgba;break;case 0x3000000:s=(0xffffff&this.result.bg)<<8|255}else switch(0x3000000&this.result.fg){case 0x1000000:case 0x2000000:s=this._themeService.colors.ansi[255&this.result.fg].rgba;break;case 0x3000000:s=(0xffffff&this.result.fg)<<8|255;break;default:s=this._themeService.colors.foreground.rgba}s=o.rgba.blend(s,0xffffff00&(this._coreBrowserService.isFocused?r.selectionBackgroundOpaque:r.selectionInactiveBackgroundOpaque).rgba|128)>>8&0xffffff}u=!0}}this._decorationService.forEachDecorationAtCell(t,i,"top",function(e){e.backgroundColorRGB&&(h=e.backgroundColorRGB.rgba>>8&0xffffff,d=!0),e.foregroundColorRGB&&(s=e.foregroundColorRGB.rgba>>8&0xffffff,u=!0)}),d&&(h=_?-0x1000000&e.bg&-0x8000001|h|0x3000000:-0x1000000&e.bg|h|0x3000000),u&&(s=-0x1000000&e.fg&-0x4000001|s|0x3000000),0x4000000&this.result.fg&&(d&&!u&&(s=0==(0x3000000&this.result.bg)?-0x8000000&this.result.fg|0xffffff&r.background.rgba>>8|0x3000000:-0x8000000&this.result.fg|0x3ffffff&this.result.bg,u=!0),!d&&u&&(h=0==(0x3000000&this.result.fg)?-0x4000000&this.result.bg|0xffffff&r.foreground.rgba>>8|0x3000000:-0x4000000&this.result.bg|0x3ffffff&this.result.fg,d=!0)),r=void 0,this.result.bg=d?h:this.result.bg,this.result.fg=u?s:this.result.fg,this.result.ext&=0x1fffffff,this.result.ext|=v<<29&0xe0000000}}]),e}()},627:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.removeTerminalFromCache=t.acquireTextureAtlas=void 0;var r=i(509),n=i(197),o=[];t.acquireTextureAtlas=function(e,t,i,a,s,c,l,h){for(var u=(0,n.generateConfig)(a,s,c,l,t,i,h),d=0;d<o.length;d++){var _=o[d],v=_.ownedBy.indexOf(e);if(v>=0){if((0,n.configEquals)(_.config,u))return _.atlas;1===_.ownedBy.length?(_.atlas.dispose(),o.splice(d,1)):_.ownedBy.splice(v,1);break}}for(var f=0;f<o.length;f++){var g=o[f];if((0,n.configEquals)(g.config,u))return g.ownedBy.push(e),g.atlas}var x=e._core,y={atlas:new r.TextureAtlas(document,u,x.unicodeService),config:u,ownedBy:[e]};return o.push(y),y.atlas},t.removeTerminalFromCache=function(e){for(var t=0;t<o.length;t++){var i=o[t].ownedBy.indexOf(e);if(-1!==i){1===o[t].ownedBy.length?(o[t].atlas.dispose(),o.splice(t,1)):o[t].ownedBy.splice(i,1);break}}}},197:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.is256Color=t.configEquals=t.generateConfig=void 0;var r=i(160);t.generateConfig=function(e,t,i,n,o,a,s){var c={foreground:a.foreground,background:a.background,cursor:r.NULL_COLOR,cursorAccent:r.NULL_COLOR,selectionForeground:r.NULL_COLOR,selectionBackgroundTransparent:r.NULL_COLOR,selectionBackgroundOpaque:r.NULL_COLOR,selectionInactiveBackgroundTransparent:r.NULL_COLOR,selectionInactiveBackgroundOpaque:r.NULL_COLOR,ansi:a.ansi.slice(),contrastCache:a.contrastCache,halfContrastCache:a.halfContrastCache};return{customGlyphs:o.customGlyphs,devicePixelRatio:s,letterSpacing:o.letterSpacing,lineHeight:o.lineHeight,deviceCellWidth:e,deviceCellHeight:t,deviceCharWidth:i,deviceCharHeight:n,fontFamily:o.fontFamily,fontSize:o.fontSize,fontWeight:o.fontWeight,fontWeightBold:o.fontWeightBold,allowTransparency:o.allowTransparency,drawBoldTextInBrightColors:o.drawBoldTextInBrightColors,minimumContrastRatio:o.minimumContrastRatio,colors:c}},t.configEquals=function(e,t){for(var i=0;i<e.colors.ansi.length;i++)if(e.colors.ansi[i].rgba!==t.colors.ansi[i].rgba)return!1;return e.devicePixelRatio===t.devicePixelRatio&&e.customGlyphs===t.customGlyphs&&e.lineHeight===t.lineHeight&&e.letterSpacing===t.letterSpacing&&e.fontFamily===t.fontFamily&&e.fontSize===t.fontSize&&e.fontWeight===t.fontWeight&&e.fontWeightBold===t.fontWeightBold&&e.allowTransparency===t.allowTransparency&&e.deviceCharWidth===t.deviceCharWidth&&e.deviceCharHeight===t.deviceCharHeight&&e.drawBoldTextInBrightColors===t.drawBoldTextInBrightColors&&e.minimumContrastRatio===t.minimumContrastRatio&&e.colors.foreground.rgba===t.colors.foreground.rgba&&e.colors.background.rgba===t.colors.background.rgba},t.is256Color=function(e){return 0x1000000==(0x3000000&e)||0x2000000==(0x3000000&e)}},237:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.TEXT_BASELINE=t.DIM_OPACITY=t.INVERTED_DEFAULT_COLOR=void 0;var r=i(399);t.INVERTED_DEFAULT_COLOR=257,t.DIM_OPACITY=.5,t.TEXT_BASELINE=r.isFirefox||r.isLegacyEdge?"bottom":"ideographic"},457:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.CursorBlinkStateManager=void 0,t.CursorBlinkStateManager=function(){function e(t,i){c._(this,e),this._renderCallback=t,this._coreBrowserService=i,this.isCursorVisible=!0,this._coreBrowserService.isFocused&&this._restartInterval()}return l._(e,[{key:"isPaused",get:function(){return!(this._blinkStartTimeout||this._blinkInterval)}},{key:"dispose",value:function(){this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(this._coreBrowserService.window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}},{key:"restartBlinkAnimation",value:function(){var e=this;this.isPaused||(this._animationTimeRestarted=Date.now(),this.isCursorVisible=!0,this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(function(){e._renderCallback(),e._animationFrame=void 0})))}},{key:"_restartInterval",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:600;this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout=this._coreBrowserService.window.setTimeout(function(){if(e._animationTimeRestarted){var t=600-(Date.now()-e._animationTimeRestarted);if(e._animationTimeRestarted=void 0,t>0)return void e._restartInterval(t)}e.isCursorVisible=!1,e._animationFrame=e._coreBrowserService.window.requestAnimationFrame(function(){e._renderCallback(),e._animationFrame=void 0}),e._blinkInterval=e._coreBrowserService.window.setInterval(function(){if(e._animationTimeRestarted){var t=600-(Date.now()-e._animationTimeRestarted);return e._animationTimeRestarted=void 0,void e._restartInterval(t)}e.isCursorVisible=!e.isCursorVisible,e._animationFrame=e._coreBrowserService.window.requestAnimationFrame(function(){e._renderCallback(),e._animationFrame=void 0})},600)},t)}},{key:"pause",value:function(){this.isCursorVisible=!0,this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(this._coreBrowserService.window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}},{key:"resume",value:function(){this.pause(),this._animationTimeRestarted=void 0,this._restartInterval(),this.restartBlinkAnimation()}}]),e}()},860:function(e,t,i){var r=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Math.max(Math.min(e,t),i)},n=function(e,t,i,n,o,a,s){var c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,h=e.map(function(e){return parseFloat(e)||parseInt(e)});if(h.length<2)throw Error("Too few arguments for instruction");for(var u=0;u<h.length;u+=2)h[u]*=t-c*s-l*s,a&&0!==h[u]&&(h[u]=r(Math.round(h[u]+.5)-.5,t,0)),h[u]+=n+c*s;for(var d=1;d<h.length;d+=2)h[d]*=i,a&&0!==h[d]&&(h[d]=r(Math.round(h[d]+.5)-.5,i,0)),h[d]+=o;return h};Object.defineProperty(t,"__esModule",{value:!0}),t.tryDrawCustomChar=t.powerlineDefinitions=t.boxDrawingDefinitions=t.blockElementDefinitions=void 0;var o=i(374);t.blockElementDefinitions={"â–€":[{x:0,y:0,w:8,h:4}],"â–":[{x:0,y:7,w:8,h:1}],"â–‚":[{x:0,y:6,w:8,h:2}],"â–ƒ":[{x:0,y:5,w:8,h:3}],"â–„":[{x:0,y:4,w:8,h:4}],"â–…":[{x:0,y:3,w:8,h:5}],"â–†":[{x:0,y:2,w:8,h:6}],"â–‡":[{x:0,y:1,w:8,h:7}],"â–ˆ":[{x:0,y:0,w:8,h:8}],"â–‰":[{x:0,y:0,w:7,h:8}],"â–Š":[{x:0,y:0,w:6,h:8}],"â–‹":[{x:0,y:0,w:5,h:8}],"â–Œ":[{x:0,y:0,w:4,h:8}],"â–":[{x:0,y:0,w:3,h:8}],"â–Ž":[{x:0,y:0,w:2,h:8}],"â–":[{x:0,y:0,w:1,h:8}],"â–":[{x:4,y:0,w:4,h:8}],"â–”":[{x:0,y:0,w:8,h:1}],"â–•":[{x:7,y:0,w:1,h:8}],"â––":[{x:0,y:4,w:4,h:4}],"â–—":[{x:4,y:4,w:4,h:4}],"â–˜":[{x:0,y:0,w:4,h:4}],"â–™":[{x:0,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"â–š":[{x:0,y:0,w:4,h:4},{x:4,y:4,w:4,h:4}],"â–›":[{x:0,y:0,w:4,h:8},{x:4,y:0,w:4,h:4}],"â–œ":[{x:0,y:0,w:8,h:4},{x:4,y:0,w:4,h:8}],"â–":[{x:4,y:0,w:4,h:4}],"â–ž":[{x:4,y:0,w:4,h:4},{x:0,y:4,w:4,h:4}],"â–Ÿ":[{x:4,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"ðŸ­°":[{x:1,y:0,w:1,h:8}],"ðŸ­±":[{x:2,y:0,w:1,h:8}],"ðŸ­²":[{x:3,y:0,w:1,h:8}],"ðŸ­³":[{x:4,y:0,w:1,h:8}],"ðŸ­´":[{x:5,y:0,w:1,h:8}],"ðŸ­µ":[{x:6,y:0,w:1,h:8}],"ðŸ­¶":[{x:0,y:1,w:8,h:1}],"ðŸ­·":[{x:0,y:2,w:8,h:1}],"ðŸ­¸":[{x:0,y:3,w:8,h:1}],"ðŸ­¹":[{x:0,y:4,w:8,h:1}],"ðŸ­º":[{x:0,y:5,w:8,h:1}],"ðŸ­»":[{x:0,y:6,w:8,h:1}],"ðŸ­¼":[{x:0,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"ðŸ­½":[{x:0,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"ðŸ­¾":[{x:7,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"ðŸ­¿":[{x:7,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"ðŸ®€":[{x:0,y:0,w:8,h:1},{x:0,y:7,w:8,h:1}],"ðŸ®":[{x:0,y:0,w:8,h:1},{x:0,y:2,w:8,h:1},{x:0,y:4,w:8,h:1},{x:0,y:7,w:8,h:1}],"ðŸ®‚":[{x:0,y:0,w:8,h:2}],"ðŸ®ƒ":[{x:0,y:0,w:8,h:3}],"ðŸ®„":[{x:0,y:0,w:8,h:5}],"ðŸ®…":[{x:0,y:0,w:8,h:6}],"ðŸ®†":[{x:0,y:0,w:8,h:7}],"ðŸ®‡":[{x:6,y:0,w:2,h:8}],"ðŸ®ˆ":[{x:5,y:0,w:3,h:8}],"ðŸ®‰":[{x:3,y:0,w:5,h:8}],"ðŸ®Š":[{x:2,y:0,w:6,h:8}],"ðŸ®‹":[{x:1,y:0,w:7,h:8}],"ðŸ®•":[{x:0,y:0,w:2,h:2},{x:4,y:0,w:2,h:2},{x:2,y:2,w:2,h:2},{x:6,y:2,w:2,h:2},{x:0,y:4,w:2,h:2},{x:4,y:4,w:2,h:2},{x:2,y:6,w:2,h:2},{x:6,y:6,w:2,h:2}],"ðŸ®–":[{x:2,y:0,w:2,h:2},{x:6,y:0,w:2,h:2},{x:0,y:2,w:2,h:2},{x:4,y:2,w:2,h:2},{x:2,y:4,w:2,h:2},{x:6,y:4,w:2,h:2},{x:0,y:6,w:2,h:2},{x:4,y:6,w:2,h:2}],"ðŸ®—":[{x:0,y:2,w:8,h:2},{x:0,y:6,w:8,h:2}]};var a={"â–‘":[[1,0,0,0],[0,0,0,0],[0,0,1,0],[0,0,0,0]],"â–’":[[1,0],[0,0],[0,1],[0,0]],"â–“":[[0,1],[1,1],[1,0],[1,1]]};t.boxDrawingDefinitions={"â”€":{1:"M0,.5 L1,.5"},"â”":{3:"M0,.5 L1,.5"},"â”‚":{1:"M.5,0 L.5,1"},"â”ƒ":{3:"M.5,0 L.5,1"},"â”Œ":{1:"M0.5,1 L.5,.5 L1,.5"},"â”":{3:"M0.5,1 L.5,.5 L1,.5"},"â”":{1:"M0,.5 L.5,.5 L.5,1"},"â”“":{3:"M0,.5 L.5,.5 L.5,1"},"â””":{1:"M.5,0 L.5,.5 L1,.5"},"â”—":{3:"M.5,0 L.5,.5 L1,.5"},"â”˜":{1:"M.5,0 L.5,.5 L0,.5"},"â”›":{3:"M.5,0 L.5,.5 L0,.5"},"â”œ":{1:"M.5,0 L.5,1 M.5,.5 L1,.5"},"â”£":{3:"M.5,0 L.5,1 M.5,.5 L1,.5"},"â”¤":{1:"M.5,0 L.5,1 M.5,.5 L0,.5"},"â”«":{3:"M.5,0 L.5,1 M.5,.5 L0,.5"},"â”¬":{1:"M0,.5 L1,.5 M.5,.5 L.5,1"},"â”³":{3:"M0,.5 L1,.5 M.5,.5 L.5,1"},"â”´":{1:"M0,.5 L1,.5 M.5,.5 L.5,0"},"â”»":{3:"M0,.5 L1,.5 M.5,.5 L.5,0"},"â”¼":{1:"M0,.5 L1,.5 M.5,0 L.5,1"},"â•‹":{3:"M0,.5 L1,.5 M.5,0 L.5,1"},"â•´":{1:"M.5,.5 L0,.5"},"â•¸":{3:"M.5,.5 L0,.5"},"â•µ":{1:"M.5,.5 L.5,0"},"â•¹":{3:"M.5,.5 L.5,0"},"â•¶":{1:"M.5,.5 L1,.5"},"â•º":{3:"M.5,.5 L1,.5"},"â•·":{1:"M.5,.5 L.5,1"},"â•»":{3:"M.5,.5 L.5,1"},"â•":{1:function(e,t){return"M0,".concat(.5-t," L1,").concat(.5-t," M0,").concat(.5+t," L1,").concat(.5+t)}},"â•‘":{1:function(e,t){return"M".concat(.5-e,",0 L").concat(.5-e,",1 M").concat(.5+e,",0 L").concat(.5+e,",1")}},"â•’":{1:function(e,t){return"M.5,1 L.5,".concat(.5-t," L1,").concat(.5-t," M.5,").concat(.5+t," L1,").concat(.5+t)}},"â•“":{1:function(e,t){return"M".concat(.5-e,",1 L").concat(.5-e,",.5 L1,.5 M").concat(.5+e,",.5 L").concat(.5+e,",1")}},"â•”":{1:function(e,t){return"M1,".concat(.5-t," L").concat(.5-e,",").concat(.5-t," L").concat(.5-e,",1 M1,").concat(.5+t," L").concat(.5+e,",").concat(.5+t," L").concat(.5+e,",1")}},"â••":{1:function(e,t){return"M0,".concat(.5-t," L.5,").concat(.5-t," L.5,1 M0,").concat(.5+t," L.5,").concat(.5+t)}},"â•–":{1:function(e,t){return"M".concat(.5+e,",1 L").concat(.5+e,",.5 L0,.5 M").concat(.5-e,",.5 L").concat(.5-e,",1")}},"â•—":{1:function(e,t){return"M0,".concat(.5+t," L").concat(.5-e,",").concat(.5+t," L").concat(.5-e,",1 M0,").concat(.5-t," L").concat(.5+e,",").concat(.5-t," L").concat(.5+e,",1")}},"â•˜":{1:function(e,t){return"M.5,0 L.5,".concat(.5+t," L1,").concat(.5+t," M.5,").concat(.5-t," L1,").concat(.5-t)}},"â•™":{1:function(e,t){return"M1,.5 L".concat(.5-e,",.5 L").concat(.5-e,",0 M").concat(.5+e,",.5 L").concat(.5+e,",0")}},"â•š":{1:function(e,t){return"M1,".concat(.5-t," L").concat(.5+e,",").concat(.5-t," L").concat(.5+e,",0 M1,").concat(.5+t," L").concat(.5-e,",").concat(.5+t," L").concat(.5-e,",0")}},"â•›":{1:function(e,t){return"M0,".concat(.5+t," L.5,").concat(.5+t," L.5,0 M0,").concat(.5-t," L.5,").concat(.5-t)}},"â•œ":{1:function(e,t){return"M0,.5 L".concat(.5+e,",.5 L").concat(.5+e,",0 M").concat(.5-e,",.5 L").concat(.5-e,",0")}},"â•":{1:function(e,t){return"M0,".concat(.5-t," L").concat(.5-e,",").concat(.5-t," L").concat(.5-e,",0 M0,").concat(.5+t," L").concat(.5+e,",").concat(.5+t," L").concat(.5+e,",0")}},"â•ž":{1:function(e,t){return"M.5,0 L.5,1 M.5,".concat(.5-t," L1,").concat(.5-t," M.5,").concat(.5+t," L1,").concat(.5+t)}},"â•Ÿ":{1:function(e,t){return"M".concat(.5-e,",0 L").concat(.5-e,",1 M").concat(.5+e,",0 L").concat(.5+e,",1 M").concat(.5+e,",.5 L1,.5")}},"â• ":{1:function(e,t){return"M".concat(.5-e,",0 L").concat(.5-e,",1 M1,").concat(.5+t," L").concat(.5+e,",").concat(.5+t," L").concat(.5+e,",1 M1,").concat(.5-t," L").concat(.5+e,",").concat(.5-t," L").concat(.5+e,",0")}},"â•¡":{1:function(e,t){return"M.5,0 L.5,1 M0,".concat(.5-t," L.5,").concat(.5-t," M0,").concat(.5+t," L.5,").concat(.5+t)}},"â•¢":{1:function(e,t){return"M0,.5 L".concat(.5-e,",.5 M").concat(.5-e,",0 L").concat(.5-e,",1 M").concat(.5+e,",0 L").concat(.5+e,",1")}},"â•£":{1:function(e,t){return"M".concat(.5+e,",0 L").concat(.5+e,",1 M0,").concat(.5+t," L").concat(.5-e,",").concat(.5+t," L").concat(.5-e,",1 M0,").concat(.5-t," L").concat(.5-e,",").concat(.5-t," L").concat(.5-e,",0")}},"â•¤":{1:function(e,t){return"M0,".concat(.5-t," L1,").concat(.5-t," M0,").concat(.5+t," L1,").concat(.5+t," M.5,").concat(.5+t," L.5,1")}},"â•¥":{1:function(e,t){return"M0,.5 L1,.5 M".concat(.5-e,",.5 L").concat(.5-e,",1 M").concat(.5+e,",.5 L").concat(.5+e,",1")}},"â•¦":{1:function(e,t){return"M0,".concat(.5-t," L1,").concat(.5-t," M0,").concat(.5+t," L").concat(.5-e,",").concat(.5+t," L").concat(.5-e,",1 M1,").concat(.5+t," L").concat(.5+e,",").concat(.5+t," L").concat(.5+e,",1")}},"â•§":{1:function(e,t){return"M.5,0 L.5,".concat(.5-t," M0,").concat(.5-t," L1,").concat(.5-t," M0,").concat(.5+t," L1,").concat(.5+t)}},"â•¨":{1:function(e,t){return"M0,.5 L1,.5 M".concat(.5-e,",.5 L").concat(.5-e,",0 M").concat(.5+e,",.5 L").concat(.5+e,",0")}},"â•©":{1:function(e,t){return"M0,".concat(.5+t," L1,").concat(.5+t," M0,").concat(.5-t," L").concat(.5-e,",").concat(.5-t," L").concat(.5-e,",0 M1,").concat(.5-t," L").concat(.5+e,",").concat(.5-t," L").concat(.5+e,",0")}},"â•ª":{1:function(e,t){return"M.5,0 L.5,1 M0,".concat(.5-t," L1,").concat(.5-t," M0,").concat(.5+t," L1,").concat(.5+t)}},"â•«":{1:function(e,t){return"M0,.5 L1,.5 M".concat(.5-e,",0 L").concat(.5-e,",1 M").concat(.5+e,",0 L").concat(.5+e,",1")}},"â•¬":{1:function(e,t){return"M0,".concat(.5+t," L").concat(.5-e,",").concat(.5+t," L").concat(.5-e,",1 M1,").concat(.5+t," L").concat(.5+e,",").concat(.5+t," L").concat(.5+e,",1 M0,").concat(.5-t," L").concat(.5-e,",").concat(.5-t," L").concat(.5-e,",0 M1,").concat(.5-t," L").concat(.5+e,",").concat(.5-t," L").concat(.5+e,",0")}},"â•±":{1:"M1,0 L0,1"},"â•²":{1:"M0,0 L1,1"},"â•³":{1:"M1,0 L0,1 M0,0 L1,1"},"â•¼":{1:"M.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"â•½":{1:"M.5,.5 L.5,0",3:"M.5,.5 L.5,1"},"â•¾":{1:"M.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"â•¿":{1:"M.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"â”":{1:"M.5,.5 L.5,1",3:"M.5,.5 L1,.5"},"â”Ž":{1:"M.5,.5 L1,.5",3:"M.5,.5 L.5,1"},"â”‘":{1:"M.5,.5 L.5,1",3:"M.5,.5 L0,.5"},"â”’":{1:"M.5,.5 L0,.5",3:"M.5,.5 L.5,1"},"â”•":{1:"M.5,.5 L.5,0",3:"M.5,.5 L1,.5"},"â”–":{1:"M.5,.5 L1,.5",3:"M.5,.5 L.5,0"},"â”™":{1:"M.5,.5 L.5,0",3:"M.5,.5 L0,.5"},"â”š":{1:"M.5,.5 L0,.5",3:"M.5,.5 L.5,0"},"â”":{1:"M.5,0 L.5,1",3:"M.5,.5 L1,.5"},"â”ž":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,.5 L.5,0"},"â”Ÿ":{1:"M.5,0 L.5,.5 L1,.5",3:"M.5,.5 L.5,1"},"â” ":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,1"},"â”¡":{1:"M.5,.5 L.5,1",3:"M.5,0 L.5,.5 L1,.5"},"â”¢":{1:"M.5,.5 L.5,0",3:"M0.5,1 L.5,.5 L1,.5"},"â”¥":{1:"M.5,0 L.5,1",3:"M.5,.5 L0,.5"},"â”¦":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"â”§":{1:"M.5,0 L.5,.5 L0,.5",3:"M.5,.5 L.5,1"},"â”¨":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,1"},"â”©":{1:"M.5,.5 L.5,1",3:"M.5,0 L.5,.5 L0,.5"},"â”ª":{1:"M.5,.5 L.5,0",3:"M0,.5 L.5,.5 L.5,1"},"â”­":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"â”®":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,.5 L1,.5"},"â”¯":{1:"M.5,.5 L.5,1",3:"M0,.5 L1,.5"},"â”°":{1:"M0,.5 L1,.5",3:"M.5,.5 L.5,1"},"â”±":{1:"M.5,.5 L1,.5",3:"M0,.5 L.5,.5 L.5,1"},"â”²":{1:"M.5,.5 L0,.5",3:"M0.5,1 L.5,.5 L1,.5"},"â”µ":{1:"M.5,0 L.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"â”¶":{1:"M.5,0 L.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"â”·":{1:"M.5,.5 L.5,0",3:"M0,.5 L1,.5"},"â”¸":{1:"M0,.5 L1,.5",3:"M.5,.5 L.5,0"},"â”¹":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,.5 L0,.5"},"â”º":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,.5 L1,.5"},"â”½":{1:"M.5,0 L.5,1 M.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"â”¾":{1:"M.5,0 L.5,1 M.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"â”¿":{1:"M.5,0 L.5,1",3:"M0,.5 L1,.5"},"â•€":{1:"M0,.5 L1,.5 M.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"â•":{1:"M.5,.5 L.5,0 M0,.5 L1,.5",3:"M.5,.5 L.5,1"},"â•‚":{1:"M0,.5 L1,.5",3:"M.5,0 L.5,1"},"â•ƒ":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,0 L.5,.5 L0,.5"},"â•„":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,0 L.5,.5 L1,.5"},"â•…":{1:"M.5,0 L.5,.5 L1,.5",3:"M0,.5 L.5,.5 L.5,1"},"â•†":{1:"M.5,0 L.5,.5 L0,.5",3:"M0.5,1 L.5,.5 L1,.5"},"â•‡":{1:"M.5,.5 L.5,1",3:"M.5,.5 L.5,0 M0,.5 L1,.5"},"â•ˆ":{1:"M.5,.5 L.5,0",3:"M0,.5 L1,.5 M.5,.5 L.5,1"},"â•‰":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,1 M.5,.5 L0,.5"},"â•Š":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,1 M.5,.5 L1,.5"},"â•Œ":{1:"M.1,.5 L.4,.5 M.6,.5 L.9,.5"},"â•":{3:"M.1,.5 L.4,.5 M.6,.5 L.9,.5"},"â”„":{1:"M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5"},"â”…":{3:"M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5"},"â”ˆ":{1:"M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5"},"â”‰":{3:"M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5"},"â•Ž":{1:"M.5,.1 L.5,.4 M.5,.6 L.5,.9"},"â•":{3:"M.5,.1 L.5,.4 M.5,.6 L.5,.9"},"â”†":{1:"M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333"},"â”‡":{3:"M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333"},"â”Š":{1:"M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95"},"â”‹":{3:"M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95"},"â•­":{1:function(e,t){return"M.5,1 L.5,".concat(.5+t/.15*.5," C.5,").concat(.5+t/.15*.5,",.5,.5,1,.5")}},"â•®":{1:function(e,t){return"M.5,1 L.5,".concat(.5+t/.15*.5," C.5,").concat(.5+t/.15*.5,",.5,.5,0,.5")}},"â•¯":{1:function(e,t){return"M.5,0 L.5,".concat(.5-t/.15*.5," C.5,").concat(.5-t/.15*.5,",.5,.5,0,.5")}},"â•°":{1:function(e,t){return"M.5,0 L.5,".concat(.5-t/.15*.5," C.5,").concat(.5-t/.15*.5,",.5,.5,1,.5")}}},t.powerlineDefinitions={"î‚°":{d:"M0,0 L1,.5 L0,1",type:0,rightPadding:2},"î‚±":{d:"M-1,-.5 L1,.5 L-1,1.5",type:1,leftPadding:1,rightPadding:1},"î‚²":{d:"M1,0 L0,.5 L1,1",type:0,leftPadding:2},"î‚³":{d:"M2,-.5 L0,.5 L2,1.5",type:1,leftPadding:1,rightPadding:1},"î‚´":{d:"M0,0 L0,1 C0.552,1,1,0.776,1,.5 C1,0.224,0.552,0,0,0",type:0,rightPadding:1},"î‚µ":{d:"M.2,1 C.422,1,.8,.826,.78,.5 C.8,.174,0.422,0,.2,0",type:1,rightPadding:1},"î‚¶":{d:"M1,0 L1,1 C0.448,1,0,0.776,0,.5 C0,0.224,0.448,0,1,0",type:0,leftPadding:1},"î‚·":{d:"M.8,1 C0.578,1,0.2,.826,.22,.5 C0.2,0.174,0.578,0,0.8,0",type:1,leftPadding:1},"î‚¸":{d:"M-.5,-.5 L1.5,1.5 L-.5,1.5",type:0},"î‚¹":{d:"M-.5,-.5 L1.5,1.5",type:1,leftPadding:1,rightPadding:1},"î‚º":{d:"M1.5,-.5 L-.5,1.5 L1.5,1.5",type:0},"î‚¼":{d:"M1.5,-.5 L-.5,1.5 L-.5,-.5",type:0},"î‚½":{d:"M1.5,-.5 L-.5,1.5",type:1,leftPadding:1,rightPadding:1},"î‚¾":{d:"M-.5,-.5 L1.5,1.5 L1.5,-.5",type:0}},t.powerlineDefinitions["î‚»"]=t.powerlineDefinitions["î‚½"],t.powerlineDefinitions["î‚¿"]=t.powerlineDefinitions["î‚¹"],t.tryDrawCustomChar=function(e,i,r,l,h,u,d,v){var f=t.blockElementDefinitions[i];if(f)return function(e,t,i,r,n,o){for(var a=0;a<t.length;a++){var s=t[a],c=n/8,l=o/8;e.fillRect(i+s.x*c,r+s.y*l,s.w*c,s.h*l)}}(e,f,r,l,h,u),!0;var g=a[i];if(g)return function(e,t,i,r,n,a){var c=s.get(t);c||(c=new Map,s.set(t,c));var l=e.fillStyle;if("string"!=typeof l)throw Error('Unexpected fillStyle type "'.concat(l,'"'));var h=c.get(l);if(!h){var u,d,v,f,g,x=t[0].length,y=t.length,p=e.canvas.ownerDocument.createElement("canvas");p.width=x,p.height=y;var C=(0,o.throwIfFalsy)(p.getContext("2d")),m=new ImageData(x,y);if(l.startsWith("#"))u=parseInt(l.slice(1,3),16),d=parseInt(l.slice(3,5),16),v=parseInt(l.slice(5,7),16),f=l.length>7&&parseInt(l.slice(7,9),16)||1;else{if(!l.startsWith("rgba"))throw Error('Unexpected fillStyle color format "'.concat(l,'" when drawing pattern glyph'));u=(g=_._(l.substring(5,l.length-1).split(",").map(function(e){return parseFloat(e)}),4))[0],d=g[1],v=g[2],f=g[3]}for(var L=0;L<y;L++)for(var w=0;w<x;w++)m.data[4*(L*x+w)]=u,m.data[4*(L*x+w)+1]=d,m.data[4*(L*x+w)+2]=v,m.data[4*(L*x+w)+3]=t[L][w]*(255*f);C.putImageData(m,0,0),h=(0,o.throwIfFalsy)(e.createPattern(p,null)),c.set(l,h)}e.fillStyle=h,e.fillRect(i,r,n,a)}(e,g,r,l,h,u),!0;var x=t.boxDrawingDefinitions[i];if(x)return function(e,t,i,r,o,a,s){e.strokeStyle=e.fillStyle;var l=!0,h=!1,u=void 0;try{for(var d,v=Object.entries(t)[Symbol.iterator]();!(l=(d=v.next()).done);l=!0){var f=_._(d.value,2),g=f[0],x=f[1],y=void 0;e.beginPath(),e.lineWidth=s*Number.parseInt(g),y="function"==typeof x?x(.15,.15/a*o):x;var p=!0,C=!1,m=void 0;try{for(var L,w=y.split(" ")[Symbol.iterator]();!(p=(L=w.next()).done);p=!0){var b=L.value,M=b[0],R=c[M];if(!R){console.error('Could not find drawing instructions for "'.concat(M,'"'));continue}var A=b.substring(1).split(",");A[0]&&A[1]&&R(e,n(A,o,a,i,r,!0,s))}}catch(e){C=!0,m=e}finally{try{p||null==w.return||w.return()}finally{if(C)throw m}}e.stroke(),e.closePath()}}catch(e){h=!0,u=e}finally{try{l||null==v.return||v.return()}finally{if(h)throw u}}}(e,x,r,l,h,u,v),!0;var y=t.powerlineDefinitions[i];return!!y&&(function(e,t,i,r,o,a,s,l){var h=new Path2D;h.rect(i,r,o,a),e.clip(h),e.beginPath();var u=s/12;e.lineWidth=l*u;var d=!0,_=!1,v=void 0;try{for(var f,g=t.d.split(" ")[Symbol.iterator]();!(d=(f=g.next()).done);d=!0){var x,y,p=f.value,C=p[0],m=c[C];if(!m){console.error('Could not find drawing instructions for "'.concat(C,'"'));continue}var L=p.substring(1).split(",");L[0]&&L[1]&&m(e,n(L,o,a,i,r,!1,l,(null!=(x=t.leftPadding)?x:0)*(u/2),(null!=(y=t.rightPadding)?y:0)*(u/2)))}}catch(e){_=!0,v=e}finally{try{d||null==g.return||g.return()}finally{if(_)throw v}}1===t.type?(e.strokeStyle=e.fillStyle,e.stroke()):e.fill(),e.closePath()}(e,y,r,l,h,u,d,v),!0)};var s=new Map,c={C:function(e,t){return e.bezierCurveTo(t[0],t[1],t[2],t[3],t[4],t[5])},L:function(e,t){return e.lineTo(t[0],t[1])},M:function(e,t){return e.moveTo(t[0],t[1])}}},56:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.observeDevicePixelDimensions=void 0;var r=i(859);t.observeDevicePixelDimensions=function(e,t,i){var n=new t.ResizeObserver(function(t){var r=t.find(function(t){return t.target===e});if(r){if(!("devicePixelContentBoxSize"in r))return null==n||n.disconnect(),void(n=void 0);var o=r.devicePixelContentBoxSize[0].inlineSize,a=r.devicePixelContentBoxSize[0].blockSize;o>0&&a>0&&i(o,a)}});try{n.observe(e,{box:["device-pixel-content-box"]})}catch(e){n.disconnect(),n=void 0}return(0,r.toDisposable)(function(){return null==n?void 0:n.disconnect()})}},374:function(e,t){var i=function(e){return 57508<=e&&e<=57558};Object.defineProperty(t,"__esModule",{value:!0}),t.computeNextVariantOffset=t.createRenderDimensions=t.treatGlyphAsBackgroundColor=t.isRestrictedPowerlineGlyph=t.isPowerlineGlyph=t.throwIfFalsy=void 0,t.throwIfFalsy=function(e){if(!e)throw Error("value must not be falsy");return e},t.isPowerlineGlyph=i,t.isRestrictedPowerlineGlyph=function(e){return 57520<=e&&e<=57527},t.treatGlyphAsBackgroundColor=function(e){return i(e)||9472<=e&&e<=9631},t.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}},t.computeNextVariantOffset=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return(e-(2*Math.round(t)-i))%(2*Math.round(t))}},296:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createSelectionRenderModel=void 0;var i=function(){function e(){c._(this,e),this.clear()}return l._(e,[{key:"clear",value:function(){this.hasSelection=!1,this.columnSelectMode=!1,this.viewportStartRow=0,this.viewportEndRow=0,this.viewportCappedStartRow=0,this.viewportCappedEndRow=0,this.startCol=0,this.endCol=0,this.selectionStart=void 0,this.selectionEnd=void 0}},{key:"update",value:function(e,t,i){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.selectionStart=t,this.selectionEnd=i,!t||!i||t[0]===i[0]&&t[1]===i[1])return void this.clear();var n=e.buffers.active.ydisp,o=t[1]-n,a=i[1]-n,s=Math.max(o,0),c=Math.min(a,e.rows-1);s>=e.rows||c<0?this.clear():(this.hasSelection=!0,this.columnSelectMode=r,this.viewportStartRow=o,this.viewportEndRow=a,this.viewportCappedStartRow=s,this.viewportCappedEndRow=c,this.startCol=t[0],this.endCol=i[0])}},{key:"isCellSelected",value:function(e,t,i){return!!this.hasSelection&&(i-=e.buffer.active.viewportY,this.columnSelectMode?this.startCol<=this.endCol?t>=this.startCol&&i>=this.viewportCappedStartRow&&t<this.endCol&&i<=this.viewportCappedEndRow:t<this.startCol&&i>=this.viewportCappedStartRow&&t>=this.endCol&&i<=this.viewportCappedEndRow:i>this.viewportStartRow&&i<this.viewportEndRow||this.viewportStartRow===this.viewportEndRow&&i===this.viewportStartRow&&t>=this.startCol&&t<this.endCol||this.viewportStartRow<this.viewportEndRow&&i===this.viewportEndRow&&t<this.endCol||this.viewportStartRow<this.viewportEndRow&&i===this.viewportStartRow&&t>=this.startCol)}}]),e}();t.createSelectionRenderModel=function(){return new i}},509:function(e,t,i){var r,n=function(e,t,i,r){for(var n=t.rgba>>>24,o=t.rgba>>>16&255,a=t.rgba>>>8&255,s=Math.floor((Math.abs(n-(i.rgba>>>24))+Math.abs(o-(i.rgba>>>16&255))+Math.abs(a-(i.rgba>>>8&255)))/12),c=!0,l=0;l<e.data.length;l+=4)e.data[l]===n&&e.data[l+1]===o&&e.data[l+2]===a||r&&Math.abs(e.data[l]-n)+Math.abs(e.data[l+1]-o)+Math.abs(e.data[l+2]-a)<s?e.data[l+3]=0:c=!1;return c},o=function(e,t,i){var r=e.createElement("canvas");return r.width=t,r.height=i,r};Object.defineProperty(t,"__esModule",{value:!0}),t.TextureAtlas=void 0;var a=i(237),s=i(860),h=i(374),u=i(160),d=i(345),f=i(485),g=i(385),x=i(147),y=i(855),p={texturePage:0,texturePosition:{x:0,y:0},texturePositionClipSpace:{x:0,y:0},offset:{x:0,y:0},size:{x:0,y:0},sizeClipSpace:{x:0,y:0}};t.TextureAtlas=function(){function e(t,i,r){c._(this,e),this._document=t,this._config=i,this._unicodeService=r,this._didWarmUp=!1,this._cacheMap=new f.FourKeyMap,this._cacheMapCombined=new f.FourKeyMap,this._pages=[],this._activePages=[],this._workBoundingBox={top:0,left:0,bottom:0,right:0},this._workAttributeData=new x.AttributeData,this._textureSize=512,this._onAddTextureAtlasCanvas=new d.EventEmitter,this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event,this._onRemoveTextureAtlasCanvas=new d.EventEmitter,this.onRemoveTextureAtlasCanvas=this._onRemoveTextureAtlasCanvas.event,this._requestClearModel=!1,this._createNewPage(),this._tmpCanvas=o(t,4*this._config.deviceCellWidth+4,this._config.deviceCellHeight+4),this._tmpCtx=(0,h.throwIfFalsy)(this._tmpCanvas.getContext("2d",{alpha:this._config.allowTransparency,willReadFrequently:!0}))}return l._(e,[{key:"pages",get:function(){return this._pages}},{key:"dispose",value:function(){var e=!0,t=!1,i=void 0;try{for(var r,n=this.pages[Symbol.iterator]();!(e=(r=n.next()).done);e=!0)r.value.canvas.remove()}catch(e){t=!0,i=e}finally{try{e||null==n.return||n.return()}finally{if(t)throw i}}this._onAddTextureAtlasCanvas.dispose()}},{key:"warmUp",value:function(){this._didWarmUp||(this._doWarmUp(),this._didWarmUp=!0)}},{key:"_doWarmUp",value:function(){for(var e=function(e){i.enqueue(function(){if(!t._cacheMap.get(e,y.DEFAULT_COLOR,y.DEFAULT_COLOR,y.DEFAULT_EXT)){var i=t._drawToCache(e,y.DEFAULT_COLOR,y.DEFAULT_COLOR,y.DEFAULT_EXT);t._cacheMap.set(e,y.DEFAULT_COLOR,y.DEFAULT_COLOR,y.DEFAULT_EXT,i)}})},t=this,i=new g.IdleTaskQueue,r=33;r<126;r++)e(r)}},{key:"beginFrame",value:function(){return this._requestClearModel}},{key:"clearTexture",value:function(){if(0!==this._pages[0].currentRow.x||0!==this._pages[0].currentRow.y){var e=!0,t=!1,i=void 0;try{for(var r,n=this._pages[Symbol.iterator]();!(e=(r=n.next()).done);e=!0)r.value.clear()}catch(e){t=!0,i=e}finally{try{e||null==n.return||n.return()}finally{if(t)throw i}}this._cacheMap.clear(),this._cacheMapCombined.clear(),this._didWarmUp=!1}}},{key:"_createNewPage",value:function(){if(e.maxAtlasPages&&this._pages.length>=Math.max(4,e.maxAtlasPages)){for(var t=this._pages.filter(function(t){return 2*t.canvas.width<=(e.maxTextureSize||4096)}).sort(function(e,t){return t.canvas.width!==e.canvas.width?t.canvas.width-e.canvas.width:t.percentageUsed-e.percentageUsed}),i=-1,r=0,n=0;n<t.length;n++)if(t[n].canvas.width!==r)i=n,r=t[n].canvas.width;else if(n-i==3)break;var o=t.slice(i,i+4),a=o.map(function(e){return e.glyphs[0].texturePage}).sort(function(e,t){return e>t?1:-1}),s=this.pages.length-o.length,c=this._mergePages(o,s);c.version++;for(var l=a.length-1;l>=0;l--)this._deletePage(a[l]);this.pages.push(c),this._requestClearModel=!0,this._onAddTextureAtlasCanvas.fire(c.canvas)}var h=new C(this._document,this._textureSize);return this._pages.push(h),this._activePages.push(h),this._onAddTextureAtlasCanvas.fire(h.canvas),h}},{key:"_mergePages",value:function(e,t){var i=2*e[0].canvas.width,r=new C(this._document,i,e),n=!0,o=!1,a=void 0;try{for(var s,c=e.entries()[Symbol.iterator]();!(n=(s=c.next()).done);n=!0){var l=_._(s.value,2),h=l[0],u=l[1],d=h*u.canvas.width%i,v=Math.floor(h/2)*u.canvas.height;r.ctx.drawImage(u.canvas,d,v);var f=!0,g=!1,x=void 0;try{for(var y,p=u.glyphs[Symbol.iterator]();!(f=(y=p.next()).done);f=!0){var m=y.value;m.texturePage=t,m.sizeClipSpace.x=m.size.x/i,m.sizeClipSpace.y=m.size.y/i,m.texturePosition.x+=d,m.texturePosition.y+=v,m.texturePositionClipSpace.x=m.texturePosition.x/i,m.texturePositionClipSpace.y=m.texturePosition.y/i}}catch(e){g=!0,x=e}finally{try{f||null==p.return||p.return()}finally{if(g)throw x}}this._onRemoveTextureAtlasCanvas.fire(u.canvas);var L=this._activePages.indexOf(u);-1!==L&&this._activePages.splice(L,1)}}catch(e){o=!0,a=e}finally{try{n||null==c.return||c.return()}finally{if(o)throw a}}return r}},{key:"_deletePage",value:function(e){this._pages.splice(e,1);for(var t=e;t<this._pages.length;t++){var i=this._pages[t],r=!0,n=!1,o=void 0;try{for(var a,s=i.glyphs[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var c=a.value;c.texturePage--}}catch(e){n=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(n)throw o}}i.version++}}},{key:"getRasterizedGlyphCombinedChar",value:function(e,t,i,r,n){return this._getFromCacheMap(this._cacheMapCombined,e,t,i,r,n)}},{key:"getRasterizedGlyph",value:function(e,t,i,r,n){return this._getFromCacheMap(this._cacheMap,e,t,i,r,n)}},{key:"_getFromCacheMap",value:function(e,t,i,n,o){var a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return(r=e.get(t,i,n,o))||(r=this._drawToCache(t,i,n,o,a),e.set(t,i,n,o,r)),r}},{key:"_getColorFromAnsiIndex",value:function(e){if(e>=this._config.colors.ansi.length)throw Error("No color found for idx "+e);return this._config.colors.ansi[e]}},{key:"_getBackgroundColor",value:function(e,t,i,r){if(this._config.allowTransparency)return u.NULL_COLOR;switch(e){case 0x1000000:case 0x2000000:n=this._getColorFromAnsiIndex(t);break;case 0x3000000:var n,o=x.AttributeData.toColorRGB(t);n=u.channels.toColor(o[0],o[1],o[2]);break;default:n=i?u.color.opaque(this._config.colors.foreground):this._config.colors.background}return n}},{key:"_getForegroundColor",value:function(e,t,i,r,n,o,s,c,l,h){var d,_=this._getMinimumContrastColor(e,t,i,r,n,o,s,l,c,h);if(_)return _;switch(n){case 0x1000000:case 0x2000000:this._config.drawBoldTextInBrightColors&&l&&o<8&&(o+=8),d=this._getColorFromAnsiIndex(o);break;case 0x3000000:var v=x.AttributeData.toColorRGB(o);d=u.channels.toColor(v[0],v[1],v[2]);break;default:d=s?this._config.colors.background:this._config.colors.foreground}return this._config.allowTransparency&&(d=u.color.opaque(d)),c&&(d=u.color.multiplyOpacity(d,a.DIM_OPACITY)),d}},{key:"_resolveBackgroundRgba",value:function(e,t,i){switch(e){case 0x1000000:case 0x2000000:return this._getColorFromAnsiIndex(t).rgba;case 0x3000000:return t<<8;default:return i?this._config.colors.foreground.rgba:this._config.colors.background.rgba}}},{key:"_resolveForegroundRgba",value:function(e,t,i,r){switch(e){case 0x1000000:case 0x2000000:return this._config.drawBoldTextInBrightColors&&r&&t<8&&(t+=8),this._getColorFromAnsiIndex(t).rgba;case 0x3000000:return t<<8;default:return i?this._config.colors.background.rgba:this._config.colors.foreground.rgba}}},{key:"_getMinimumContrastColor",value:function(e,t,i,r,n,o,a,s,c,l){if(1!==this._config.minimumContrastRatio&&!l){var h=this._getContrastCache(c),d=h.getColor(e,r);if(void 0!==d)return d||void 0;var _=this._resolveBackgroundRgba(t,i,a),v=this._resolveForegroundRgba(n,o,a,s),f=u.rgba.ensureContrastRatio(_,v,this._config.minimumContrastRatio/(c?2:1));if(!f)return void h.setColor(e,r,null);var g=u.channels.toColor(f>>24&255,f>>16&255,f>>8&255);return h.setColor(e,r,g),g}}},{key:"_getContrastCache",value:function(e){return e?this._config.colors.halfContrastCache:this._config.colors.contrastCache}},{key:"_drawToCache",value:function(t,i,r,o){var c=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l="number"==typeof t?String.fromCharCode(t):t,u=Math.min(this._config.deviceCellWidth*Math.max(l.length,2)+4,this._textureSize);this._tmpCanvas.width<u&&(this._tmpCanvas.width=u);var d=Math.min(this._config.deviceCellHeight+8,this._textureSize);if(this._tmpCanvas.height<d&&(this._tmpCanvas.height=d),this._tmpCtx.save(),this._workAttributeData.fg=r,this._workAttributeData.bg=i,this._workAttributeData.extended.ext=o,this._workAttributeData.isInvisible())return p;var _=!!this._workAttributeData.isBold(),v=!!this._workAttributeData.isInverse(),f=!!this._workAttributeData.isDim(),g=!!this._workAttributeData.isItalic(),y=!!this._workAttributeData.isUnderline(),C=!!this._workAttributeData.isStrikethrough(),m=!!this._workAttributeData.isOverline(),L=this._workAttributeData.getFgColor(),w=this._workAttributeData.getFgColorMode(),b=this._workAttributeData.getBgColor(),M=this._workAttributeData.getBgColorMode();if(v){var R=L;L=b,b=R;var A=w;w=M,M=A}var E=this._getBackgroundColor(M,b,v,f);this._tmpCtx.globalCompositeOperation="copy",this._tmpCtx.fillStyle=E.css,this._tmpCtx.fillRect(0,0,this._tmpCanvas.width,this._tmpCanvas.height),this._tmpCtx.globalCompositeOperation="source-over";var S=_?this._config.fontWeightBold:this._config.fontWeight;this._tmpCtx.font="".concat(g?"italic":""," ").concat(S," ").concat(this._config.fontSize*this._config.devicePixelRatio,"px ").concat(this._config.fontFamily),this._tmpCtx.textBaseline=a.TEXT_BASELINE;var k=1===l.length&&(0,h.isPowerlineGlyph)(l.charCodeAt(0)),T=1===l.length&&(0,h.isRestrictedPowerlineGlyph)(l.charCodeAt(0)),D=this._getForegroundColor(i,M,b,r,w,L,v,f,_,(0,h.treatGlyphAsBackgroundColor)(l.charCodeAt(0)));this._tmpCtx.fillStyle=D.css;var B=4*!T,F=!1;!1!==this._config.customGlyphs&&(F=(0,s.tryDrawCustomChar)(this._tmpCtx,l,B,B,this._config.deviceCellWidth,this._config.deviceCellHeight,this._config.fontSize,this._config.devicePixelRatio));var P,I=!k;if(P="number"==typeof t?this._unicodeService.wcwidth(t):this._unicodeService.getStringCellWidth(t),y){this._tmpCtx.save();var O=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/15)),U=.5*(O%2==1);if(this._tmpCtx.lineWidth=O,this._workAttributeData.isUnderlineColorDefault())this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle;else if(this._workAttributeData.isUnderlineColorRGB())I=!1,this._tmpCtx.strokeStyle="rgb(".concat(x.AttributeData.toColorRGB(this._workAttributeData.getUnderlineColor()).join(","),")");else{I=!1;var N=this._workAttributeData.getUnderlineColor();this._config.drawBoldTextInBrightColors&&this._workAttributeData.isBold()&&N<8&&(N+=8),this._tmpCtx.strokeStyle=this._getColorFromAnsiIndex(N).css}this._tmpCtx.beginPath();for(var W=Math.ceil(B+this._config.deviceCharHeight)-U-(c?2*O:0),z=W+O,H=W+2*O,G=this._workAttributeData.getUnderlineVariantOffset(),q=0;q<P;q++){this._tmpCtx.save();var j=B+q*this._config.deviceCellWidth,X=B+(q+1)*this._config.deviceCellWidth,V=j+this._config.deviceCellWidth/2;switch(this._workAttributeData.extended.underlineStyle){case 2:this._tmpCtx.moveTo(j,W),this._tmpCtx.lineTo(X,W),this._tmpCtx.moveTo(j,H),this._tmpCtx.lineTo(X,H);break;case 3:var Y=O<=1?H:Math.ceil(B+this._config.deviceCharHeight-O/2)-U,J=O<=1?W:Math.ceil(B+this._config.deviceCharHeight+O/2)-U,K=new Path2D;K.rect(j,W,this._config.deviceCellWidth,H-W),this._tmpCtx.clip(K),this._tmpCtx.moveTo(j-this._config.deviceCellWidth/2,z),this._tmpCtx.bezierCurveTo(j-this._config.deviceCellWidth/2,J,j,J,j,z),this._tmpCtx.bezierCurveTo(j,Y,V,Y,V,z),this._tmpCtx.bezierCurveTo(V,J,X,J,X,z),this._tmpCtx.bezierCurveTo(X,Y,X+this._config.deviceCellWidth/2,Y,X+this._config.deviceCellWidth/2,z);break;case 4:var Q=0===G?0:G>=O?2*O-G:O-G;!1==!(G>=O)||0===Q?(this._tmpCtx.setLineDash([Math.round(O),Math.round(O)]),this._tmpCtx.moveTo(j+Q,W)):(this._tmpCtx.setLineDash([Math.round(O),Math.round(O)]),this._tmpCtx.moveTo(j,W),this._tmpCtx.lineTo(j+Q,W),this._tmpCtx.moveTo(j+Q+O,W)),this._tmpCtx.lineTo(X,W),G=(0,h.computeNextVariantOffset)(X-j,O,G);break;case 5:var $=X-j,Z=Math.floor(.6*$),ee=Math.floor(.3*$),et=$-Z-ee;this._tmpCtx.setLineDash([Z,ee,et]),this._tmpCtx.moveTo(j,W),this._tmpCtx.lineTo(X,W);break;default:this._tmpCtx.moveTo(j,W),this._tmpCtx.lineTo(X,W)}this._tmpCtx.stroke(),this._tmpCtx.restore()}if(this._tmpCtx.restore(),!F&&this._config.fontSize>=12&&!this._config.allowTransparency&&" "!==l){this._tmpCtx.save(),this._tmpCtx.textBaseline="alphabetic";var ei=this._tmpCtx.measureText(l);if(this._tmpCtx.restore(),"actualBoundingBoxDescent"in ei&&ei.actualBoundingBoxDescent>0){this._tmpCtx.save();var er=new Path2D;er.rect(B,W-Math.ceil(O/2),this._config.deviceCellWidth*P,H-W+Math.ceil(O/2)),this._tmpCtx.clip(er),this._tmpCtx.lineWidth=3*this._config.devicePixelRatio,this._tmpCtx.strokeStyle=E.css,this._tmpCtx.strokeText(l,B,B+this._config.deviceCharHeight),this._tmpCtx.restore()}}}if(m){var en=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/15)),eo=.5*(en%2==1);this._tmpCtx.lineWidth=en,this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle,this._tmpCtx.beginPath(),this._tmpCtx.moveTo(B,B+eo),this._tmpCtx.lineTo(B+this._config.deviceCharWidth*P,B+eo),this._tmpCtx.stroke()}if(F||this._tmpCtx.fillText(l,B,B+this._config.deviceCharHeight),"_"===l&&!this._config.allowTransparency){var ea=n(this._tmpCtx.getImageData(B,B,this._config.deviceCellWidth,this._config.deviceCellHeight),E,D,I);if(ea)for(var es=1;es<=5&&(this._tmpCtx.save(),this._tmpCtx.fillStyle=E.css,this._tmpCtx.fillRect(0,0,this._tmpCanvas.width,this._tmpCanvas.height),this._tmpCtx.restore(),this._tmpCtx.fillText(l,B,B+this._config.deviceCharHeight-es),ea=n(this._tmpCtx.getImageData(B,B,this._config.deviceCellWidth,this._config.deviceCellHeight),E,D,I));es++);}if(C){var ec=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/10)),el=.5*(this._tmpCtx.lineWidth%2==1);this._tmpCtx.lineWidth=ec,this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle,this._tmpCtx.beginPath(),this._tmpCtx.moveTo(B,B+Math.floor(this._config.deviceCharHeight/2)-el),this._tmpCtx.lineTo(B+this._config.deviceCharWidth*P,B+Math.floor(this._config.deviceCharHeight/2)-el),this._tmpCtx.stroke()}this._tmpCtx.restore();var eh=this._tmpCtx.getImageData(0,0,this._tmpCanvas.width,this._tmpCanvas.height);if(this._config.allowTransparency?function(e){for(var t=0;t<e.data.length;t+=4)if(e.data[t+3]>0)return!1;return!0}(eh):n(eh,E,D,I))return p;for(var eu=this._findGlyphBoundingBox(eh,this._workBoundingBox,u,T,F,B);;){if(0===this._activePages.length){var ed=this._createNewPage();eg=ed,(ex=ed.currentRow).height=eu.size.y;break}ex=(eg=this._activePages[this._activePages.length-1]).currentRow;var e_=!0,ev=!1,ef=void 0;try{for(var eg,ex,ey,ep=this._activePages[Symbol.iterator]();!(e_=(ey=ep.next()).done);e_=!0){var eC=ey.value;eu.size.y<=eC.currentRow.height&&(eg=eC,ex=eC.currentRow)}}catch(e){ev=!0,ef=e}finally{try{e_||null==ep.return||ep.return()}finally{if(ev)throw ef}}for(var em=!0,eL=!1,ew=void 0,eb=this._activePages.length-1;eb>=0;eb--)try{for(var eM,eR=this._activePages[eb].fixedRows[Symbol.iterator]();!(em=(eM=eR.next()).done);em=!0){var eA=eM.value;eA.height<=ex.height&&eu.size.y<=eA.height&&(eg=this._activePages[eb],ex=eA)}}catch(e){eL=!0,ew=e}finally{try{em||null==eR.return||eR.return()}finally{if(eL)throw ew}}if(ex.y+eu.size.y>=eg.canvas.height||ex.height>eu.size.y+2){var eE=!1;if(eg.currentRow.y+eg.currentRow.height+eu.size.y>=eg.canvas.height){var eS=void 0,ek=!0,eT=!1,eD=void 0;try{for(var eB,eF=this._activePages[Symbol.iterator]();!(ek=(eB=eF.next()).done);ek=!0){var eP=eB.value;if(eP.currentRow.y+eP.currentRow.height+eu.size.y<eP.canvas.height){eS=eP;break}}}catch(e){eT=!0,eD=e}finally{try{ek||null==eF.return||eF.return()}finally{if(eT)throw eD}}if(eS)eg=eS;else if(e.maxAtlasPages&&this._pages.length>=e.maxAtlasPages&&ex.y+eu.size.y<=eg.canvas.height&&ex.height>=eu.size.y&&ex.x+eu.size.x<=eg.canvas.width)eE=!0;else{var eI=this._createNewPage();eg=eI,(ex=eI.currentRow).height=eu.size.y,eE=!0}}eE||(eg.currentRow.height>0&&eg.fixedRows.push(eg.currentRow),ex={x:0,y:eg.currentRow.y+eg.currentRow.height,height:eu.size.y},eg.fixedRows.push(ex),eg.currentRow={x:0,y:ex.y+ex.height,height:0})}if(ex.x+eu.size.x<=eg.canvas.width)break;ex===eg.currentRow?(ex.x=0,ex.y+=ex.height,ex.height=0):eg.fixedRows.splice(eg.fixedRows.indexOf(ex),1)}return eu.texturePage=this._pages.indexOf(eg),eu.texturePosition.x=ex.x,eu.texturePosition.y=ex.y,eu.texturePositionClipSpace.x=ex.x/eg.canvas.width,eu.texturePositionClipSpace.y=ex.y/eg.canvas.height,eu.sizeClipSpace.x/=eg.canvas.width,eu.sizeClipSpace.y/=eg.canvas.height,ex.height=Math.max(ex.height,eu.size.y),ex.x+=eu.size.x,eg.ctx.putImageData(eh,eu.texturePosition.x-this._workBoundingBox.left,eu.texturePosition.y-this._workBoundingBox.top,this._workBoundingBox.left,this._workBoundingBox.top,eu.size.x,eu.size.y),eg.addGlyph(eu),eg.version++,eu}},{key:"_findGlyphBoundingBox",value:function(e,t,i,r,n,o){t.top=0;for(var a=r?this._config.deviceCellHeight:this._tmpCanvas.height,s=r?this._config.deviceCellWidth:i,c=!1,l=0;l<a;l++){for(var h=0;h<s;h++){var u=l*this._tmpCanvas.width*4+4*h+3;if(0!==e.data[u]){t.top=l,c=!0;break}}if(c)break}t.left=0,c=!1;for(var d=0;d<o+s;d++){for(var _=0;_<a;_++){var v=_*this._tmpCanvas.width*4+4*d+3;if(0!==e.data[v]){t.left=d,c=!0;break}}if(c)break}t.right=s,c=!1;for(var f=o+s-1;f>=o;f--){for(var g=0;g<a;g++){var x=g*this._tmpCanvas.width*4+4*f+3;if(0!==e.data[x]){t.right=f,c=!0;break}}if(c)break}t.bottom=a,c=!1;for(var y=a-1;y>=0;y--){for(var p=0;p<s;p++){var C=y*this._tmpCanvas.width*4+4*p+3;if(0!==e.data[C]){t.bottom=y,c=!0;break}}if(c)break}return{texturePage:0,texturePosition:{x:0,y:0},texturePositionClipSpace:{x:0,y:0},size:{x:t.right-t.left+1,y:t.bottom-t.top+1},sizeClipSpace:{x:t.right-t.left+1,y:t.bottom-t.top+1},offset:{x:-t.left+o+(r||n?Math.floor((this._config.deviceCellWidth-this._config.deviceCharWidth)/2):0),y:-t.top+o+(r||n?1===this._config.lineHeight?0:Math.round((this._config.deviceCellHeight-this._config.deviceCharHeight)/2):0)}}}}]),e}();var C=function(){function e(t,i,r){c._(this,e);var n=!0,a=!1,s=void 0;if(this._usedPixels=0,this._glyphs=[],this.version=0,this.currentRow={x:0,y:0,height:0},this.fixedRows=[],r)try{for(var l,u,d=r[Symbol.iterator]();!(n=(u=d.next()).done);n=!0){var _=u.value;(l=this._glyphs).push.apply(l,v._(_.glyphs)),this._usedPixels+=_._usedPixels}}catch(e){a=!0,s=e}finally{try{n||null==d.return||d.return()}finally{if(a)throw s}}this.canvas=o(t,i,i),this.ctx=(0,h.throwIfFalsy)(this.canvas.getContext("2d",{alpha:!0}))}return l._(e,[{key:"percentageUsed",get:function(){return this._usedPixels/(this.canvas.width*this.canvas.height)}},{key:"glyphs",get:function(){return this._glyphs}},{key:"addGlyph",value:function(e){this._glyphs.push(e),this._usedPixels+=e.size.x*e.size.y}},{key:"clear",value:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.currentRow.x=0,this.currentRow.y=0,this.currentRow.height=0,this.fixedRows.length=0,this.version++}}]),e}()},160:function(e,t,i){var r,n,o,a,s,c,l=function(e){var t=e.toString(16);return t.length<2?"0"+t:t},h=function(e,t){return e<t?(t+.05)/(e+.05):(e+.05)/(t+.05)};Object.defineProperty(t,"__esModule",{value:!0}),t.contrastRatio=t.toPaddedHex=t.rgba=t.rgb=t.css=t.color=t.channels=t.NULL_COLOR=void 0;var u=i(399),d=0,v=0,f=0,g=0;t.NULL_COLOR={css:"#00000000",rgba:0},(r=n||(t.channels=n={})).toCss=function(e,t,i,r){return void 0!==r?"#".concat(l(e)).concat(l(t)).concat(l(i)).concat(l(r)):"#".concat(l(e)).concat(l(t)).concat(l(i))},r.toRgba=function(e,t,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:255;return(e<<24|t<<16|i<<8|r)>>>0},r.toColor=function(e,t,i,n){return{css:r.toCss(e,t,i,n),rgba:r.toRgba(e,t,i,n)}},function(e){function t(e,t){var i;return g=Math.round(255*t),d=(i=_._(c.toChannels(e.rgba),3))[0],v=i[1],f=i[2],{css:n.toCss(d,v,f,g),rgba:n.toRgba(d,v,f,g)}}e.blend=function(e,t){if(1==(g=(255&t.rgba)/255))return{css:t.css,rgba:t.rgba};var i=t.rgba>>24&255,r=t.rgba>>16&255,o=t.rgba>>8&255,a=e.rgba>>24&255,s=e.rgba>>16&255,c=e.rgba>>8&255;return d=a+Math.round((i-a)*g),v=s+Math.round((r-s)*g),f=c+Math.round((o-c)*g),{css:n.toCss(d,v,f),rgba:n.toRgba(d,v,f)}},e.isOpaque=function(e){return 255==(255&e.rgba)},e.ensureContrastRatio=function(e,t,i){var r=c.ensureContrastRatio(e.rgba,t.rgba,i);if(r)return n.toColor(r>>24&255,r>>16&255,r>>8&255)},e.opaque=function(e){var t,i=(255|e.rgba)>>>0;return d=(t=_._(c.toChannels(i),3))[0],v=t[1],f=t[2],{css:n.toCss(d,v,f),rgba:i}},e.opacity=t,e.multiplyOpacity=function(e,i){return g=255&e.rgba,t(e,g*i/255)},e.toColorRGB=function(e){return[e.rgba>>24&255,e.rgba>>16&255,e.rgba>>8&255]}}(o||(t.color=o={})),function(e){var t,i;if(!u.isNode){var r=document.createElement("canvas");r.width=1,r.height=1;var o=r.getContext("2d",{willReadFrequently:!0});o&&((t=o).globalCompositeOperation="copy",i=t.createLinearGradient(0,0,1,1))}e.toColor=function(e){if(e.match(/#[\da-f]{3,8}/i))switch(e.length){case 4:return d=parseInt(e.slice(1,2).repeat(2),16),v=parseInt(e.slice(2,3).repeat(2),16),f=parseInt(e.slice(3,4).repeat(2),16),n.toColor(d,v,f);case 5:return d=parseInt(e.slice(1,2).repeat(2),16),v=parseInt(e.slice(2,3).repeat(2),16),f=parseInt(e.slice(3,4).repeat(2),16),g=parseInt(e.slice(4,5).repeat(2),16),n.toColor(d,v,f,g);case 7:return{css:e,rgba:(parseInt(e.slice(1),16)<<8|255)>>>0};case 9:return{css:e,rgba:parseInt(e.slice(1),16)>>>0}}var r,o=e.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(o)return d=parseInt(o[1]),v=parseInt(o[2]),f=parseInt(o[3]),g=Math.round(255*(void 0===o[5]?1:parseFloat(o[5]))),n.toColor(d,v,f,g);if(!t||!i||(t.fillStyle=i,t.fillStyle=e,"string"!=typeof t.fillStyle)||(t.fillRect(0,0,1,1),d=(r=_._(t.getImageData(0,0,1,1).data,4))[0],v=r[1],f=r[2],255!==(g=r[3])))throw Error("css.toColor: Unsupported css format");return{rgba:n.toRgba(d,v,f,g),css:e}}}(a||(t.css=a={})),function(e){function t(e,t,i){var r=e/255,n=t/255,o=i/255;return .2126*(r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4))+.7152*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))+.0722*(o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4))}e.relativeLuminance=function(e){return t(e>>16&255,e>>8&255,255&e)},e.relativeLuminance2=t}(s||(t.rgb=s={})),function(e){function t(e,t,i){for(var r=e>>24&255,n=e>>16&255,o=e>>8&255,a=t>>24&255,c=t>>16&255,l=t>>8&255,u=h(s.relativeLuminance2(a,c,l),s.relativeLuminance2(r,n,o));u<i&&(a>0||c>0||l>0);)a-=Math.max(0,Math.ceil(.1*a)),c-=Math.max(0,Math.ceil(.1*c)),l-=Math.max(0,Math.ceil(.1*l)),u=h(s.relativeLuminance2(a,c,l),s.relativeLuminance2(r,n,o));return(a<<24|c<<16|l<<8|255)>>>0}function i(e,t,i){for(var r=e>>24&255,n=e>>16&255,o=e>>8&255,a=t>>24&255,c=t>>16&255,l=t>>8&255,u=h(s.relativeLuminance2(a,c,l),s.relativeLuminance2(r,n,o));u<i&&(a<255||c<255||l<255);)a=Math.min(255,a+Math.ceil(.1*(255-a))),c=Math.min(255,c+Math.ceil(.1*(255-c))),l=Math.min(255,l+Math.ceil(.1*(255-l))),u=h(s.relativeLuminance2(a,c,l),s.relativeLuminance2(r,n,o));return(a<<24|c<<16|l<<8|255)>>>0}e.blend=function(e,t){if(1==(g=(255&t)/255))return t;var i=e>>24&255,r=e>>16&255,o=e>>8&255;return d=i+Math.round(((t>>24&255)-i)*g),v=r+Math.round(((t>>16&255)-r)*g),f=o+Math.round(((t>>8&255)-o)*g),n.toRgba(d,v,f)},e.ensureContrastRatio=function(e,r,n){var o=s.relativeLuminance(e>>8),a=s.relativeLuminance(r>>8);if(h(o,a)<n){if(a<o){var c=t(e,r,n),l=h(o,s.relativeLuminance(c>>8));if(l<n){var u=i(e,r,n);return l>h(o,s.relativeLuminance(u>>8))?c:u}return c}var d=i(e,r,n),_=h(o,s.relativeLuminance(d>>8));if(_<n){var v=t(e,r,n);return _>h(o,s.relativeLuminance(v>>8))?d:v}return d}},e.reduceLuminance=t,e.increaseLuminance=i,e.toChannels=function(e){return[e>>24&255,e>>16&255,e>>8&255,255&e]}}(c||(t.rgba=c={})),t.toPaddedHex=l,t.contrastRatio=h},345:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.runAndSubscribe=t.forwardEvent=t.EventEmitter=void 0,t.EventEmitter=function(){function e(){c._(this,e),this._listeners=[],this._disposed=!1}return l._(e,[{key:"event",get:function(){var e=this;return this._event||(this._event=function(t){return e._listeners.push(t),{dispose:function(){if(!e._disposed){for(var i=0;i<e._listeners.length;i++)if(e._listeners[i]===t)return void e._listeners.splice(i,1)}}}}),this._event}},{key:"fire",value:function(e,t){for(var i=[],r=0;r<this._listeners.length;r++)i.push(this._listeners[r]);for(var n=0;n<i.length;n++)i[n].call(void 0,e,t)}},{key:"dispose",value:function(){this.clearListeners(),this._disposed=!0}},{key:"clearListeners",value:function(){this._listeners&&(this._listeners.length=0)}}]),e}(),t.forwardEvent=function(e,t){return e(function(e){return t.fire(e)})},t.runAndSubscribe=function(e,t){return t(void 0),e(function(e){return t(e)})}},859:function(e,t){var i=function(e){var t=!0,i=!1,r=void 0;try{for(var n,o=e[Symbol.iterator]();!(t=(n=o.next()).done);t=!0)n.value.dispose()}catch(e){i=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(i)throw r}}e.length=0};Object.defineProperty(t,"__esModule",{value:!0}),t.getDisposeArrayDisposable=t.disposeArray=t.toDisposable=t.MutableDisposable=t.Disposable=void 0,t.Disposable=function(){function e(){c._(this,e),this._disposables=[],this._isDisposed=!1}return l._(e,[{key:"dispose",value:function(){this._isDisposed=!0;var e=!0,t=!1,i=void 0;try{for(var r,n=this._disposables[Symbol.iterator]();!(e=(r=n.next()).done);e=!0)r.value.dispose()}catch(e){t=!0,i=e}finally{try{e||null==n.return||n.return()}finally{if(t)throw i}}this._disposables.length=0}},{key:"register",value:function(e){return this._disposables.push(e),e}},{key:"unregister",value:function(e){var t=this._disposables.indexOf(e);-1!==t&&this._disposables.splice(t,1)}}]),e}(),t.MutableDisposable=function(){function e(){c._(this,e),this._isDisposed=!1}return l._(e,[{key:"value",get:function(){return this._isDisposed?void 0:this._value},set:function(e){var t;this._isDisposed||e===this._value||(null==(t=this._value)||t.dispose(),this._value=e)}},{key:"clear",value:function(){this.value=void 0}},{key:"dispose",value:function(){var e;this._isDisposed=!0,null==(e=this._value)||e.dispose(),this._value=void 0}}]),e}(),t.toDisposable=function(e){return{dispose:e}},t.disposeArray=i,t.getDisposeArrayDisposable=function(e){return{dispose:function(){return i(e)}}}},485:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.FourKeyMap=t.TwoKeyMap=void 0;var i=function(){function e(){c._(this,e),this._data={}}return l._(e,[{key:"set",value:function(e,t,i){this._data[e]||(this._data[e]={}),this._data[e][t]=i}},{key:"get",value:function(e,t){return this._data[e]?this._data[e][t]:void 0}},{key:"clear",value:function(){this._data={}}}]),e}();t.TwoKeyMap=i,t.FourKeyMap=function(){function e(){c._(this,e),this._data=new i}return l._(e,[{key:"set",value:function(e,t,r,n,o){this._data.get(e,t)||this._data.set(e,t,new i),this._data.get(e,t).set(r,n,o)}},{key:"get",value:function(e,t,i,r){var n;return null==(n=this._data.get(e,t))?void 0:n.get(i,r)}},{key:"clear",value:function(){this._data.clear()}}]),e}()},399:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isChromeOS=t.isLinux=t.isWindows=t.isIphone=t.isIpad=t.isMac=t.getSafariVersion=t.isSafari=t.isLegacyEdge=t.isFirefox=t.isNode=void 0,t.isNode=void 0!==a.default;var i=t.isNode?"node":navigator.userAgent,r=t.isNode?"node":navigator.platform;t.isFirefox=i.includes("Firefox"),t.isLegacyEdge=i.includes("Edge"),t.isSafari=/^((?!chrome|android).)*safari/i.test(i),t.getSafariVersion=function(){if(!t.isSafari)return 0;var e=i.match(/Version\/(\d+)/);return null===e||e.length<2?0:parseInt(e[1])},t.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(r),t.isIpad="iPad"===r,t.isIphone="iPhone"===r,t.isWindows=["Windows","Win16","Win32","WinCE"].includes(r),t.isLinux=r.indexOf("Linux")>=0,t.isChromeOS=/\bCrOS\b/.test(i)},385:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.DebouncedIdleTask=t.IdleTaskQueue=t.PriorityTaskQueue=void 0;var r=i(399),n=function(){function e(){c._(this,e),this._tasks=[],this._i=0}return l._(e,[{key:"enqueue",value:function(e){this._tasks.push(e),this._start()}},{key:"flush",value:function(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}},{key:"clear",value:function(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}},{key:"_start",value:function(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}},{key:"_process",value:function(e){this._idleCallback=void 0;for(var t=0,i=0,r=e.timeRemaining(),n=0;this._i<this._tasks.length;){if(t=Date.now(),this._tasks[this._i]()||this._i++,1.5*(i=Math.max(t=Math.max(1,Date.now()-t),i))>(n=e.timeRemaining()))return r-t<-20&&console.warn("task queue exceeded allotted deadline by ".concat(Math.abs(Math.round(r-t)),"ms")),void this._start();r=n}this.clear()}}]),e}(),o=function(e){function t(){return c._(this,t),s._(this,t,arguments)}return d._(t,e),l._(t,[{key:"_requestCallback",value:function(e){var t=this;return setTimeout(function(){return e(t._createDeadline(16))})}},{key:"_cancelCallback",value:function(e){clearTimeout(e)}},{key:"_createDeadline",value:function(e){var t=Date.now()+e;return{timeRemaining:function(){return Math.max(0,t-Date.now())}}}}]),t}(n);t.PriorityTaskQueue=o,t.IdleTaskQueue=!r.isNode&&"requestIdleCallback"in window?function(e){function t(){return c._(this,t),s._(this,t,arguments)}return d._(t,e),l._(t,[{key:"_requestCallback",value:function(e){return requestIdleCallback(e)}},{key:"_cancelCallback",value:function(e){cancelIdleCallback(e)}}]),t}(n):o,t.DebouncedIdleTask=function(){function e(){c._(this,e),this._queue=new t.IdleTaskQueue}return l._(e,[{key:"set",value:function(e){this._queue.clear(),this._queue.enqueue(e)}},{key:"flush",value:function(){this._queue.flush()}}]),e}()},147:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ExtendedAttrs=t.AttributeData=void 0,t.AttributeData=function(){function e(){c._(this,e),this.fg=0,this.bg=0,this.extended=new i}return l._(e,[{key:"clone",value:function(){var t=new e;return t.fg=this.fg,t.bg=this.bg,t.extended=this.extended.clone(),t}},{key:"isInverse",value:function(){return 0x4000000&this.fg}},{key:"isBold",value:function(){return 0x8000000&this.fg}},{key:"isUnderline",value:function(){return this.hasExtendedAttrs()&&0!==this.extended.underlineStyle?1:0x10000000&this.fg}},{key:"isBlink",value:function(){return 0x20000000&this.fg}},{key:"isInvisible",value:function(){return 0x40000000&this.fg}},{key:"isItalic",value:function(){return 0x4000000&this.bg}},{key:"isDim",value:function(){return 0x8000000&this.bg}},{key:"isStrikethrough",value:function(){return 0x80000000&this.fg}},{key:"isProtected",value:function(){return 0x20000000&this.bg}},{key:"isOverline",value:function(){return 0x40000000&this.bg}},{key:"getFgColorMode",value:function(){return 0x3000000&this.fg}},{key:"getBgColorMode",value:function(){return 0x3000000&this.bg}},{key:"isFgRGB",value:function(){return 0x3000000==(0x3000000&this.fg)}},{key:"isBgRGB",value:function(){return 0x3000000==(0x3000000&this.bg)}},{key:"isFgPalette",value:function(){return 0x1000000==(0x3000000&this.fg)||0x2000000==(0x3000000&this.fg)}},{key:"isBgPalette",value:function(){return 0x1000000==(0x3000000&this.bg)||0x2000000==(0x3000000&this.bg)}},{key:"isFgDefault",value:function(){return 0==(0x3000000&this.fg)}},{key:"isBgDefault",value:function(){return 0==(0x3000000&this.bg)}},{key:"isAttributeDefault",value:function(){return 0===this.fg&&0===this.bg}},{key:"getFgColor",value:function(){switch(0x3000000&this.fg){case 0x1000000:case 0x2000000:return 255&this.fg;case 0x3000000:return 0xffffff&this.fg;default:return -1}}},{key:"getBgColor",value:function(){switch(0x3000000&this.bg){case 0x1000000:case 0x2000000:return 255&this.bg;case 0x3000000:return 0xffffff&this.bg;default:return -1}}},{key:"hasExtendedAttrs",value:function(){return 0x10000000&this.bg}},{key:"updateExtended",value:function(){this.extended.isEmpty()?this.bg&=-0x10000001:this.bg|=0x10000000}},{key:"getUnderlineColor",value:function(){if(0x10000000&this.bg&&~this.extended.underlineColor)switch(0x3000000&this.extended.underlineColor){case 0x1000000:case 0x2000000:return 255&this.extended.underlineColor;case 0x3000000:return 0xffffff&this.extended.underlineColor}return this.getFgColor()}},{key:"getUnderlineColorMode",value:function(){return 0x10000000&this.bg&&~this.extended.underlineColor?0x3000000&this.extended.underlineColor:this.getFgColorMode()}},{key:"isUnderlineColorRGB",value:function(){return 0x10000000&this.bg&&~this.extended.underlineColor?0x3000000==(0x3000000&this.extended.underlineColor):this.isFgRGB()}},{key:"isUnderlineColorPalette",value:function(){return 0x10000000&this.bg&&~this.extended.underlineColor?0x1000000==(0x3000000&this.extended.underlineColor)||0x2000000==(0x3000000&this.extended.underlineColor):this.isFgPalette()}},{key:"isUnderlineColorDefault",value:function(){return 0x10000000&this.bg&&~this.extended.underlineColor?0==(0x3000000&this.extended.underlineColor):this.isFgDefault()}},{key:"getUnderlineStyle",value:function(){return 0x10000000&this.fg?0x10000000&this.bg?this.extended.underlineStyle:1:0}},{key:"getUnderlineVariantOffset",value:function(){return this.extended.underlineVariantOffset}}],[{key:"toColorRGB",value:function(e){return[e>>>16&255,e>>>8&255,255&e]}},{key:"fromColorRGB",value:function(e){return(255&e[0])<<16|(255&e[1])<<8|255&e[2]}}]),e}();var i=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;c._(this,e),this._ext=0,this._urlId=0,this._ext=t,this._urlId=i}return l._(e,[{key:"ext",get:function(){return this._urlId?-0x1c000001&this._ext|this.underlineStyle<<26:this._ext},set:function(e){this._ext=e}},{key:"underlineStyle",get:function(){return this._urlId?5:(0x1c000000&this._ext)>>26},set:function(e){this._ext&=-0x1c000001,this._ext|=e<<26&0x1c000000}},{key:"underlineColor",get:function(){return 0x3ffffff&this._ext},set:function(e){this._ext&=-0x4000000,this._ext|=0x3ffffff&e}},{key:"urlId",get:function(){return this._urlId},set:function(e){this._urlId=e}},{key:"underlineVariantOffset",get:function(){var e=(0xe0000000&this._ext)>>29;return e<0?0xfffffff8^e:e},set:function(e){this._ext&=0x1fffffff,this._ext|=e<<29&0xe0000000}},{key:"clone",value:function(){return new e(this._ext,this._urlId)}},{key:"isEmpty",value:function(){return 0===this.underlineStyle&&0===this._urlId}}]),e}();t.ExtendedAttrs=i},782:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.CellData=void 0;var r=i(133),n=i(855),o=i(147);t.CellData=function(e){function t(){var e;return c._(this,t),e=s._(this,t,arguments),e.content=0,e.fg=0,e.bg=0,e.extended=new o.ExtendedAttrs,e.combinedData="",e}return d._(t,e),l._(t,[{key:"isCombined",value:function(){return 2097152&this.content}},{key:"getWidth",value:function(){return this.content>>22}},{key:"getChars",value:function(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,r.stringFromCodePoint)(2097151&this.content):""}},{key:"getCode",value:function(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}},{key:"setFromCharData",value:function(e){this.fg=e[n.CHAR_DATA_ATTR_INDEX],this.bg=0;var t=!1;if(e[n.CHAR_DATA_CHAR_INDEX].length>2)t=!0;else if(2===e[n.CHAR_DATA_CHAR_INDEX].length){var i=e[n.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=i&&i<=56319){var r=e[n.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=r&&r<=57343?this.content=1024*(i-55296)+r-56320+65536|e[n.CHAR_DATA_WIDTH_INDEX]<<22:t=!0}else t=!0}else this.content=e[n.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|e[n.CHAR_DATA_WIDTH_INDEX]<<22;t&&(this.combinedData=e[n.CHAR_DATA_CHAR_INDEX],this.content=2097152|e[n.CHAR_DATA_WIDTH_INDEX]<<22)}},{key:"getAsCharData",value:function(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}],[{key:"fromCharData",value:function(e){var i=new t;return i.setFromCharData(e),i}}]),t}(o.AttributeData)},855:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.WHITESPACE_CELL_CODE=t.WHITESPACE_CELL_WIDTH=t.WHITESPACE_CELL_CHAR=t.NULL_CELL_CODE=t.NULL_CELL_WIDTH=t.NULL_CELL_CHAR=t.CHAR_DATA_CODE_INDEX=t.CHAR_DATA_WIDTH_INDEX=t.CHAR_DATA_CHAR_INDEX=t.CHAR_DATA_ATTR_INDEX=t.DEFAULT_EXT=t.DEFAULT_ATTR=t.DEFAULT_COLOR=void 0,t.DEFAULT_COLOR=0,t.DEFAULT_ATTR=256|t.DEFAULT_COLOR<<9,t.DEFAULT_EXT=0,t.CHAR_DATA_ATTR_INDEX=0,t.CHAR_DATA_CHAR_INDEX=1,t.CHAR_DATA_WIDTH_INDEX=2,t.CHAR_DATA_CODE_INDEX=3,t.NULL_CELL_CHAR="",t.NULL_CELL_WIDTH=1,t.NULL_CELL_CODE=0,t.WHITESPACE_CELL_CHAR=" ",t.WHITESPACE_CELL_WIDTH=1,t.WHITESPACE_CELL_CODE=32},133:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Utf8ToUtf32=t.StringToUtf32=t.utf32ToString=t.stringFromCodePoint=void 0,t.stringFromCodePoint=function(e){return e>65535?String.fromCharCode(55296+((e-=65536)>>10))+String.fromCharCode(e%1024+56320):String.fromCharCode(e)},t.utf32ToString=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length,r="",n=t;n<i;++n){var o=e[n];o>65535?(o-=65536,r+=String.fromCharCode(55296+(o>>10))+String.fromCharCode(o%1024+56320)):r+=String.fromCharCode(o)}return r},t.StringToUtf32=function(){function e(){c._(this,e),this._interim=0}return l._(e,[{key:"clear",value:function(){this._interim=0}},{key:"decode",value:function(e,t){var i=e.length;if(!i)return 0;var r=0,n=0;if(this._interim){var o=e.charCodeAt(n++);56320<=o&&o<=57343?t[r++]=1024*(this._interim-55296)+o-56320+65536:(t[r++]=this._interim,t[r++]=o),this._interim=0}for(var a=n;a<i;++a){var s=e.charCodeAt(a);if(55296<=s&&s<=56319){if(++a>=i)return this._interim=s,r;var c=e.charCodeAt(a);56320<=c&&c<=57343?t[r++]=1024*(s-55296)+c-56320+65536:(t[r++]=s,t[r++]=c)}else 65279!==s&&(t[r++]=s)}return r}}]),e}(),t.Utf8ToUtf32=function(){function e(){c._(this,e),this.interim=new Uint8Array(3)}return l._(e,[{key:"clear",value:function(){this.interim.fill(0)}},{key:"decode",value:function(e,t){var i=e.length;if(!i)return 0;var r,n,o,a,s=0,c=0,l=0;if(this.interim[0]){var h=!1,u=this.interim[0];u&=192==(224&u)?31:224==(240&u)?15:7;for(var d,_=0;(d=63&this.interim[++_])&&_<4;)u<<=6,u|=d;for(var v=192==(224&this.interim[0])?2:224==(240&this.interim[0])?3:4,f=v-_;l<f;){if(l>=i)return 0;if(128!=(192&(d=e[l++]))){l--,h=!0;break}this.interim[_++]=d,u<<=6,u|=63&d}h||(2===v?u<128?l--:t[s++]=u:3===v?u<2048||u>=55296&&u<=57343||65279===u||(t[s++]=u):u<65536||u>1114111||(t[s++]=u)),this.interim.fill(0)}for(var g=i-4,x=l;x<i;){for(;!(!(x<g)||128&(r=e[x])||128&(n=e[x+1])||128&(o=e[x+2])||128&(a=e[x+3]));)t[s++]=r,t[s++]=n,t[s++]=o,t[s++]=a,x+=4;if((r=e[x++])<128)t[s++]=r;else if(192==(224&r)){if(x>=i)return this.interim[0]=r,s;if(128!=(192&(n=e[x++]))||(c=(31&r)<<6|63&n)<128){x--;continue}t[s++]=c}else if(224==(240&r)){if(x>=i)return this.interim[0]=r,s;if(128!=(192&(n=e[x++]))){x--;continue}if(x>=i)return this.interim[0]=r,this.interim[1]=n,s;if(128!=(192&(o=e[x++]))){x--;continue}if((c=(15&r)<<12|(63&n)<<6|63&o)<2048||c>=55296&&c<=57343||65279===c)continue;t[s++]=c}else if(240==(248&r)){if(x>=i)return this.interim[0]=r,s;if(128!=(192&(n=e[x++]))){x--;continue}if(x>=i)return this.interim[0]=r,this.interim[1]=n,s;if(128!=(192&(o=e[x++]))){x--;continue}if(x>=i)return this.interim[0]=r,this.interim[1]=n,this.interim[2]=o,s;if(128!=(192&(a=e[x++]))){x--;continue}if((c=(7&r)<<18|(63&n)<<12|(63&o)<<6|63&a)<65536||c>1114111)continue;t[s++]=c}}return s}}]),e}()},776:function(e,t,i){var r=this&&this.__decorate||function(e,t,i,r){var n,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==("undefined"==typeof Reflect?"undefined":f._(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a},n=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.traceCall=t.setTraceLogger=t.LogService=void 0;var o,a=i(859),h=i(97),u={trace:h.LogLevelEnum.TRACE,debug:h.LogLevelEnum.DEBUG,info:h.LogLevelEnum.INFO,warn:h.LogLevelEnum.WARN,error:h.LogLevelEnum.ERROR,off:h.LogLevelEnum.OFF},_=t.LogService=function(e){function t(e){var i;return c._(this,t),(i=s._(this,t))._optionsService=e,i._logLevel=h.LogLevelEnum.OFF,i._updateLogLevel(),i.register(i._optionsService.onSpecificOptionChange("logLevel",function(){return i._updateLogLevel()})),o=i,i}return d._(t,e),l._(t,[{key:"logLevel",get:function(){return this._logLevel}},{key:"_updateLogLevel",value:function(){this._logLevel=u[this._optionsService.rawOptions.logLevel]}},{key:"_evalLazyOptionalParams",value:function(e){for(var t=0;t<e.length;t++)"function"==typeof e[t]&&(e[t]=e[t]())}},{key:"_log",value:function(e,t,i){this._evalLazyOptionalParams(i),e.call.apply(e,[console,(this._optionsService.options.logger?"":"xterm.js: ")+t].concat(v._(i)))}},{key:"trace",value:function(e){for(var t,i,r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];this._logLevel<=h.LogLevelEnum.TRACE&&this._log(null!=(i=null==(t=this._optionsService.options.logger)?void 0:t.trace.bind(this._optionsService.options.logger))?i:console.log,e,n)}},{key:"debug",value:function(e){for(var t,i,r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];this._logLevel<=h.LogLevelEnum.DEBUG&&this._log(null!=(i=null==(t=this._optionsService.options.logger)?void 0:t.debug.bind(this._optionsService.options.logger))?i:console.log,e,n)}},{key:"info",value:function(e){for(var t,i,r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];this._logLevel<=h.LogLevelEnum.INFO&&this._log(null!=(i=null==(t=this._optionsService.options.logger)?void 0:t.info.bind(this._optionsService.options.logger))?i:console.info,e,n)}},{key:"warn",value:function(e){for(var t,i,r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];this._logLevel<=h.LogLevelEnum.WARN&&this._log(null!=(i=null==(t=this._optionsService.options.logger)?void 0:t.warn.bind(this._optionsService.options.logger))?i:console.warn,e,n)}},{key:"error",value:function(e){for(var t,i,r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];this._logLevel<=h.LogLevelEnum.ERROR&&this._log(null!=(i=null==(t=this._optionsService.options.logger)?void 0:t.error.bind(this._optionsService.options.logger))?i:console.error,e,n)}}]),t}(a.Disposable);t.LogService=_=r([n(0,h.IOptionsService)],_),t.setTraceLogger=function(e){o=e},t.traceCall=function(e,t,i){if("function"!=typeof i.value)throw Error("not supported");var r=i.value;i.value=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];if(o.logLevel!==h.LogLevelEnum.TRACE)return r.apply(this,t);o.trace("GlyphRenderer#".concat(r.name,"(").concat(t.map(function(e){return JSON.stringify(e)}).join(", "),")"));var n=r.apply(this,t);return o.trace("GlyphRenderer#".concat(r.name," return"),n),n}}},726:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createDecorator=t.getServiceDependencies=t.serviceRegistry=void 0;var i="di$target",r="di$dependencies";t.serviceRegistry=new Map,t.getServiceDependencies=function(e){return e[r]||[]},t.createDecorator=function(e){if(t.serviceRegistry.has(e))return t.serviceRegistry.get(e);var n=function(e,t,o){if(3!=arguments.length)throw Error("@IServiceName-decorator can only be used to decorate a parameter");e[i]===e?e[r].push({id:n,index:o}):(e[r]=[{id:n,index:o}],e[i]=e)};return n.toString=function(){return e},t.serviceRegistry.set(e,n),n}},97:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.IDecorationService=t.IUnicodeService=t.IOscLinkService=t.IOptionsService=t.ILogService=t.LogLevelEnum=t.IInstantiationService=t.ICharsetService=t.ICoreService=t.ICoreMouseService=t.IBufferService=void 0;var r,n,o=i(726);t.IBufferService=(0,o.createDecorator)("BufferService"),t.ICoreMouseService=(0,o.createDecorator)("CoreMouseService"),t.ICoreService=(0,o.createDecorator)("CoreService"),t.ICharsetService=(0,o.createDecorator)("CharsetService"),t.IInstantiationService=(0,o.createDecorator)("InstantiationService"),(r=n||(t.LogLevelEnum=n={}))[r.TRACE=0]="TRACE",r[r.DEBUG=1]="DEBUG",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.OFF=5]="OFF",t.ILogService=(0,o.createDecorator)("LogService"),t.IOptionsService=(0,o.createDecorator)("OptionsService"),t.IOscLinkService=(0,o.createDecorator)("OscLinkService"),t.IUnicodeService=(0,o.createDecorator)("UnicodeService"),t.IDecorationService=(0,o.createDecorator)("DecorationService")}},g={};function x(e){var t=g[e];if(void 0!==t)return t.exports;var i=g[e]={exports:{}};return o[e].call(i.exports,i,i.exports,x),i.exports}var y={};return Object.defineProperty(y,"__esModule",{value:!0}),y.WebglAddon=void 0,e=x(345),t=x(859),i=x(399),r=x(666),n=x(776),y.WebglAddon=function(o){function a(t){if(c._(this,a),i.isSafari&&16>(0,i.getSafariVersion)()){var r;if(!document.createElement("canvas").getContext("webgl2",{antialias:!1,depth:!1,preserveDrawingBuffer:!0}))throw Error("Webgl2 is only supported on Safari 16 and above")}return(r=s._(this,a))._preserveDrawingBuffer=t,r._onChangeTextureAtlas=r.register(new e.EventEmitter),r.onChangeTextureAtlas=r._onChangeTextureAtlas.event,r._onAddTextureAtlasCanvas=r.register(new e.EventEmitter),r.onAddTextureAtlasCanvas=r._onAddTextureAtlasCanvas.event,r._onRemoveTextureAtlasCanvas=r.register(new e.EventEmitter),r.onRemoveTextureAtlasCanvas=r._onRemoveTextureAtlasCanvas.event,r._onContextLoss=r.register(new e.EventEmitter),r.onContextLoss=r._onContextLoss.event,r}return d._(a,o),l._(a,[{key:"activate",value:function(i){var o=this,a=i._core;if(!i.element)return void this.register(a.onWillOpen(function(){return o.activate(i)}));this._terminal=i;var s=a.coreService,c=a.optionsService,l=a._renderService,h=a._characterJoinerService,u=a._charSizeService,d=a._coreBrowserService,_=a._decorationService,v=a._logService,f=a._themeService;(0,n.setTraceLogger)(v),this._renderer=this.register(new r.WebglRenderer(i,h,u,d,s,_,c,f,this._preserveDrawingBuffer)),this.register((0,e.forwardEvent)(this._renderer.onContextLoss,this._onContextLoss)),this.register((0,e.forwardEvent)(this._renderer.onChangeTextureAtlas,this._onChangeTextureAtlas)),this.register((0,e.forwardEvent)(this._renderer.onAddTextureAtlasCanvas,this._onAddTextureAtlasCanvas)),this.register((0,e.forwardEvent)(this._renderer.onRemoveTextureAtlasCanvas,this._onRemoveTextureAtlasCanvas)),l.setRenderer(this._renderer),this.register((0,t.toDisposable)(function(){var e=o._terminal._core._renderService;e.setRenderer(o._terminal._core._createRenderer()),e.handleResize(i.cols,i.rows)}))}},{key:"textureAtlas",get:function(){var e;return null==(e=this._renderer)?void 0:e.textureAtlas}},{key:"clearTextureAtlas",value:function(){var e;null==(e=this._renderer)||e.clearTextureAtlas()}}]),a}(t.Disposable),y}()},"object"==f._(i)&&"object"==f._(t)?t.exports=o():"function"==typeof define&&define.amd?void 0!==(r=o())&&e.v(r):"object"==f._(i)?i.WebglAddon=o():n.WebglAddon=o()}]);

//# debugId=11286554-f7ca-add8-10b6-9dd4f1e9bdac
//# sourceMappingURL=ae286581564403f3.js.map