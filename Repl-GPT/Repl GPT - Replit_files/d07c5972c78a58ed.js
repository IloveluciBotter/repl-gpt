;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="4c8c6c02-81a3-34de-e2ed-abffe8ede2f0")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,74032,e=>{e.v({"fade-in":"LoadingState-module___WZova__fade-in",header:"LoadingState-module___WZova__header",loadingAnimation:"LoadingState-module___WZova__loadingAnimation",root:"LoadingState-module___WZova__root"})},695337,e=>{e.v({surface:"KeyboardShortcutsModal-module__Tz_71q__surface"})},918218,e=>{e.v({right:"ExpandAgentButton-module__Sr5bZG__right",root:"ExpandAgentButton-module__Sr5bZG__root",show:"ExpandAgentButton-module__Sr5bZG__show"})},576779,e=>{e.v({animationWrapper:"FigmaImport-module__p8csWa__animationWrapper",overlay:"FigmaImport-module__p8csWa__overlay",progressBarContainer:"FigmaImport-module__p8csWa__progressBarContainer",progressBarFill:"FigmaImport-module__p8csWa__progressBarFill",progressBarTrack:"FigmaImport-module__p8csWa__progressBarTrack"})},111724,e=>{e.v({measureBar:"FreemiumUsagePopover-module___B9tOa__measureBar",usageCard:"FreemiumUsagePopover-module___B9tOa__usageCard"})},680189,e=>{e.v({flippedIcon:"workspaceTour-module__-kv3kW__flippedIcon",iconSurface:"workspaceTour-module__-kv3kW__iconSurface"})},980713,e=>{e.v({baseButton:"Deploy-module__8ZcrnG__baseButton",baseButtonLoading:"Deploy-module__8ZcrnG__baseButtonLoading",deployIconDot:"Deploy-module__8ZcrnG__deployIconDot",deployIconDotWrapper:"Deploy-module__8ZcrnG__deployIconDotWrapper",deployIconWithStatus:"Deploy-module__8ZcrnG__deployIconWithStatus",openPaneButton:"Deploy-module__8ZcrnG__openPaneButton",pulse:"Deploy-module__8ZcrnG__pulse",roundedButton:"Deploy-module__8ZcrnG__roundedButton",roundedButtonLoading:"Deploy-module__8ZcrnG__roundedButtonLoading"})},60166,e=>{e.v({agent:"RunStatusButton-module__27k_5G__agent",agentStatusIcon:"RunStatusButton-module__27k_5G__agentStatusIcon",root:"RunStatusButton-module__27k_5G__root",running:"RunStatusButton-module__27k_5G__running"})},700283,e=>{e.v({flipped:"FiletreeButton-module__3d0q-a__flipped"})},317941,e=>{e.v({avatar:"index-module__PnN-4a__avatar",inviteDialog:"index-module__PnN-4a__inviteDialog",remainingCountButton:"index-module__PnN-4a__remainingCountButton",stacked:"index-module__PnN-4a__stacked"})},384132,e=>{e.v({emptySpacer:"NavMenu-module__rNmZaG__emptySpacer",menu:"NavMenu-module__rNmZaG__menu",repl:"NavMenu-module__rNmZaG__repl",usage:"NavMenu-module__rNmZaG__usage"})},342571,e=>{e.v({desktopAppWindowsOs:"index-module__IZzwWa__desktopAppWindowsOs",desktopDragRegion:"index-module__IZzwWa__desktopDragRegion",left:"index-module__IZzwWa__left",planningHeader:"index-module__IZzwWa__planningHeader",planningHeaderLeft:"index-module__IZzwWa__planningHeaderLeft",planningTimeline:"index-module__IZzwWa__planningTimeline",right:"index-module__IZzwWa__right"})},375032,e=>{e.v({"fade-out":"Border-module__AS8LXG__fade-out",pulse:"Border-module__AS8LXG__pulse",root:"Border-module__AS8LXG__root"})},231927,e=>{e.v({container:"index-module__4PIZ9q__container",interactionBlanket:"index-module__4PIZ9q__interactionBlanket",root:"index-module__4PIZ9q__root"})},33171,e=>{e.v({closeButton:"Tab-module__U4WksG__closeButton",tab:"Tab-module__U4WksG__tab",tabButton:"Tab-module__U4WksG__tabButton",title:"Tab-module__U4WksG__title"})},13891,e=>{e.v({desktopAppWindowsOs:"index-module__QGsN1W__desktopAppWindowsOs",dragArea:"index-module__QGsN1W__dragArea",dropPreview:"index-module__QGsN1W__dropPreview",newTab:"index-module__QGsN1W__newTab",newTabIconButton:"index-module__QGsN1W__newTabIconButton",newTabTextButton:"index-module__QGsN1W__newTabTextButton",tabBar:"index-module__QGsN1W__tabBar",tabs:"index-module__QGsN1W__tabs"})},248611,e=>{e.v({surface:"index-module__3SVBeW__surface"})},357210,e=>{e.v({grip:"ResizeHandle-module__D5nG1G__grip",root:"ResizeHandle-module__D5nG1G__root",stacked:"ResizeHandle-module__D5nG1G__stacked"})},224373,e=>{e.v({grip:"ResizeHandle-module__nCKbhG__grip",left:"ResizeHandle-module__nCKbhG__left",right:"ResizeHandle-module__nCKbhG__right",root:"ResizeHandle-module__nCKbhG__root"})},861781,e=>{e.v({root:"index-module__mWTpga__root"})},491694,e=>{e.v({root:"Search-module__fSv4Tq__root"})},943124,e=>{e.v({root:"index-module__0C7YZG__root"})},755181,e=>{e.v({contentContainer:"Workspace-module__bV5fda__contentContainer",desktopApp:"Workspace-module__bV5fda__desktopApp"})},838720,e=>{e.v({emailVerificationWrapper:"replEnvironmentDesktop-module__rxGmJG__emailVerificationWrapper",surface:"replEnvironmentDesktop-module__rxGmJG__surface"})},453926,e=>{"use strict";var n,t,r,i,a,o,s,l,u,c,d,p,f,h,g=e.i(276385),m=e.i(931849),v=e.i(878420),x=e.i(569384),y=e.i(973245),w=e.i(304277),b=e.i(566901),_=e.i(552207);function j(){var e=(0,x._)(["\n  query ReplEnvironmentDesktop(\n    $replId: String!\n    $environment: KeybindingsEnvironmentEnum!\n    $platform: KeybindingsPlatformEnum!\n  ) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        ...ReplEnvironmentDesktopRepl\n      }\n      ... on ReplOrgPermissionDeniedError {\n        replId\n        orgId\n        ownerUsername\n        ownerImage\n      }\n      ... on Error {\n        message\n      }\n    }\n    currentUser {\n      id\n      isVerified\n      ...ReplEnvironmentDesktopCurrentUser\n      keybindings(environment: $environment, platform: $platform) {\n        keybindings\n      }\n    }\n  }\n  ","\n  ","\n"]);return j=function(){return e},e}var S={},I=(0,y.gql)(j(),_.ReplEnvironmentDesktopReplFragmentDoc,_.ReplEnvironmentDesktopCurrentUserFragmentDoc),C=e.i(82464),k=e.i(911185),E=e.i(721281),T=e.i(872734),P=e.i(480028),R=e.i(660614),A=e.i(929872),D=e.i(625484),V=e.i(219577),O=e.i(751299),F=e.i(74032),M=(0,P.cvarsFrom)("LoadingState.module.css",["--header-height"]);function L(e){return(0,g.jsxs)(A.Surface,{style:(0,E._)({},M.headerHeight,V.APP_HEADER_HEIGHT+"px"),clsx:F.default.root,children:[(0,g.jsx)(A.Surface,{row:!0,clsx:F.default.header,justify:"space-between",px:6,children:(0,g.jsxs)(D.View,{row:!0,align:"center",children:[(0,g.jsx)(T.default,{}),(0,g.jsx)(O.NavMenu,{children:(0,g.jsx)(g.Fragment,{})})]})}),(0,g.jsx)(D.View,{grow:!0,shrink:!0,align:"center",justify:"center",clsx:F.default.loadingAnimation,children:e.animation?(0,g.jsx)(R.default,{height:100}):null})]})}var G=e.i(952914),U=e.i(530658),N=e.i(389959),B=e.i(951262);function W(){var e=(0,x._)(["\n  mutation SaveReplLayoutState($input: SetReplLayoutStateInput!) {\n    setReplLayoutState(input: $input) {\n      ... on Repl {\n        id\n        layoutState\n      }\n    }\n  }\n"]);return W=function(){return e},e}var z={},H=(0,y.gql)(W()),q=e.i(877212),K=e.i(204203),$=e.i(545525),Q=e.i(787182),Y=e.i(921521),X=e.i(993796),J=e.i(125674),Z=e.i(441329),ee=e.i(956111),en=e.i(400081),et=e.i(42783),er=e.i(346715),ei=e.i(297083),ea=e.i(817556),eo=e.i(541793),es=e.i(161322),el=e.i(858248),eu=e.i(709485),ec=e.i(971131),ed=(0,eo.atom)(!1),ep=(0,eo.atom)(null,function(e,n,t){e(ed)?(0,ec.flushSync)(function(){n(ef,null),n(ed,!1)}):(t&&n(ef,t),n(ed,!0))}),ef=(0,eo.atom)(null),eh=(0,eo.atom)([]),eg=e.i(814563),em=e.i(223808);e.i(242933);var ev=e.i(424360);e.i(925218);var ex=e.i(372988),ey=e.i(960933),ew=ey.Type.String();ey.Type.String();var eb=ey.Type.Object({width:ey.Type.Number(),height:ey.Type.Number()}),e_=ey.Type.Object({x:ey.Type.Number(),y:ey.Type.Number()}),ej=ey.Type.Intersect([e_,eb]),eS=ey.Type.Object({top:ey.Type.Number(),bottom:ey.Type.Number(),left:ey.Type.Number(),right:ey.Type.Number()}),eI=ey.Type.Object({id:ey.Type.String(),type:ey.Type.Literal("paneGroup"),panes:ey.Type.Array(ew),percent:ey.Type.Number(),activeIndex:ey.Type.Number()}),eC=ey.Type.Object({id:ey.Type.String(),type:ey.Type.Literal("floatingPaneGroup"),panes:ey.Type.Array(ew),activeIndex:ey.Type.Number(),rect:ej}),ek=ey.Type.Recursive(function(e){return ey.Type.Object({type:ey.Type.Literal("split"),stacked:ey.Type.Boolean(),children:ey.Type.Array(ey.Type.Union([eI,e])),percent:ey.Type.Number()})});ey.Type.Union([eI,ek]);var eE=ey.Type.Object({tiling:ey.Type.Union([ek,eI,ey.Type.Null()]),floating:ey.Type.Array(eC)});ey.Type.Union([ey.Type.Literal("left"),ey.Type.Literal("right")]),ey.Type.Object({inset:ey.Type.Optional(eS),size:eb,gap:ey.Type.Number(),headerHeight:ey.Type.Number()});var eT=ey.Type.Union([ey.Type.Literal("above"),ey.Type.Literal("below"),ey.Type.Literal("leftOf"),ey.Type.Literal("rightOf")]);function eP(e,n){var t,r,i,a,o={width:t=.5*n.width,height:r=.5*n.height,x:n.x+(n.width-t)/2,y:n.y+(n.height-r)/2};if(i=e.x,a=e.y,i>o.x&&i<o.x+o.width&&a>o.y&&a<o.y+o.height)return{dropLocation:"middle",previewRect:n};var s={x:n.x+n.width/2,y:n.y+n.height/2},l=.3*n.width,u=s.x-l/2;if(e.x>=u&&e.x<=u+l){var c=e.y<=s.y?"above":"below",d=n.height/2;return{dropLocation:c,previewRect:{x:n.x,y:"above"===c?n.y:n.y+d,width:n.width,height:d}}}var p=e.x<=s.x?"leftOf":"rightOf",f=n.width/2;return{dropLocation:p,previewRect:{x:"leftOf"===p?n.x:n.x+f,y:n.y,width:f,height:n.height}}}ey.Type.Union([eT,ey.Type.Literal("replace")]),ey.Type.Union([ey.Type.Literal("up"),ey.Type.Literal("left"),ey.Type.Literal("right"),ey.Type.Literal("down")]);var eR={height:0,width:0};function eA(e){if(e.length<1)throw Error("Expected a path with a parent");return e.slice(0,-1)}function eD(e){return"floatingPaneGroup"!==e.type}e.s(["getParentPath",()=>eA,"isTiledNode",()=>eD],319105);var eV=e.i(633600),eO=e.i(119468);function eF(e,n){var t=(0,eV._)(n),r=t[0],i=t.slice(1);if("floating"===r){if(!e.floating)return null;var a=i[0];if("number"!=typeof a)throw Error("Expected floatingIndex");var o=e.floating[a];if(!o)throw Error("Expected paneGroup");return o}if("tiling"!==r)throw Error("Expected tiling path");var s=e.tiling;if(!s)return null;var l=s,u=i.length,c=0,d=!0,p=!1,f=void 0;try{for(var h,g=i[Symbol.iterator]();!(d=(h=g.next()).done);d=!0){var m=h.value;if("paneGroup"===l.type)break;if("number"!=typeof m)throw Error("Expected number");c++,l=l.children[m]}}catch(e){p=!0,f=e}finally{try{d||null==g.return||g.return()}finally{if(p)throw f}}return u===c?l:null}function eM(e,n){var t=e.floating.find(function(e){return e.panes.includes(n)});if(t)return{index:t.panes.indexOf(n),paneGroup:t,paneGroupPath:["floating",e.floating.indexOf(t)],floating:!0};var r=e.tiling;if(!r)return null;for(var i=[{paneGroupPath:["tiling"],parent:null,grandparent:null,node:r}];i.length;){var a=i.shift();if(!a)throw Error("Expected item");if("split"===a.node.type){var o=!0,s=!1,l=void 0;try{for(var u,c=a.node.children[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var d=u.value;i.push({grandparent:a.parent,parent:a.node,node:d,paneGroupPath:(0,er._)(a.paneGroupPath).concat([a.node.children.indexOf(d)])})}}catch(e){s=!0,l=e}finally{try{o||null==c.return||c.return()}finally{if(s)throw l}}}else if(a.node.panes.includes(n))return{paneGroupPath:a.paneGroupPath,paneGroup:a.node,parent:a.parent,grandparent:a.grandparent,index:a.node.panes.indexOf(n),floating:!1}}return null}function eL(e,n){var t=e.tiling;return t?function e(n,t,r){if("paneGroup"===n.type)return{paneGroup:n,path:r};var i=0,a=n.children.length-1;return"topRight"!==t||n.stacked?"bottomRight"===t?i=a:"bottomLeft"===t&&n.stacked&&(i=a):i=a,e(n.children[i],t,(0,er._)(r).concat([i]))}(t,n,["tiling"]):null}function eG(e,n){var t=e.tiling,r=e.floating,i=(0,er._)(r);for(t&&i.push(t);i.length;){var a=i.shift();if(!a)throw Error("Expected item");if("split"===a.type)i.push.apply(i,(0,er._)(a.children));else if(a.id===n)return a}return null}function eU(e,n){var t=e.tiling;if(null===t)return null;for(var r=[[t,["tiling"]]];r.length;){var i=function(){var e=r.shift();if(!e)throw Error("Expected item");var t=(0,U._)(e,2),i=t[0],a=t[1];return"split"!==i.type?"continue":i.children.some(function(e){return"paneGroup"===e.type&&e.id===n})?{v:{node:i,path:a}}:void i.children.forEach(function(e,n){r.push([e,(0,er._)(a).concat([n])])})}();if("object"===(0,eO._)(i))return i.v}return null}function eN(e,n){var t=eM(e,n);if((null==t?void 0:t.paneGroup.type)==="paneGroup"){var r=eU(e,t.paneGroup.id);if(r){var i=r.node.children,a=i.indexOf(t.paneGroup);return a<i.length-1?i[a+1]:i[a-1]}}return null}function eB(e){var n=e.relativeTo,t=e.rects,r=e.direction,i=t.get(n);if(!i)throw Error("Expected relativeTo rect to be included in rects");var a=null,o=!0,s=!1,l=void 0;try{for(var u,c=t[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var d=(0,U._)(u.value,2),p=d[0],f=d[1];if(p===n)continue;var h=function(e){var n=e.from,t=e.other;switch(e.direction){case"above":return n.y-t.y;case"below":return t.y-n.y;case"rightOf":return t.x-n.x;case"leftOf":return n.x-t.x}}({from:i,other:f,direction:r});if(("leftOf"!==r&&"above"!==r||!(h<=0))&&("rightOf"!==r&&"below"!==r||!(h<0))){var g=function(e,n,t){var r=(0,U._)("x"===t?[[e.x,e.x+e.width],[n.x,n.x+n.width]]:[[e.y,e.y+e.height],[n.y,n.y+n.height]],2),i=r[0],a=r[1],o=Math.max(i[0],a[0]);return Math.min(i[1],a[1])-o}(i,f,"leftOf"===r||"rightOf"===r?"y":"x");!(g<=0)&&(!a||a.distance>h||a.distance===h&&a.overlap<g)&&(a={key:p,rect:f,distance:h,overlap:g})}}}catch(e){s=!0,l=e}finally{try{o||null==c.return||c.return()}finally{if(s)throw l}}return(null==a?void 0:a.key)||null}var eW={top:0,bottom:0,left:0,right:0};function ez(e,n){var t=n.inside,r=n.minVisibleX,i=n.minVisibleY,a=-e.width+r,o=t.width-r,s=t.height-i;return{x:Math.min(Math.max(a,e.x),o),y:Math.min(Math.max(0,e.y),s)}}function eH(e,n){var t=void 0===n.activeIndex?0:n.activeIndex;if(n.isFloating)return void e.floating.push({id:n.id,type:"floatingPaneGroup",panes:n.panes,activeIndex:t,rect:n.rect});var r=null;if(Array.isArray(n.relativeTo))r=n.relativeTo;else{var i=eM(e,n.relativeTo);if(!i)throw Error("Expected pane");r=i.paneGroupPath}if(null===r)throw Error("Expected relativeTo");if("tiling"!==r[0])throw Error("Expected tiling path");var a=n.placement,o=n.panes,s=n.percent,l="above"===a||"below"===a,u="rightOf"===a||"below"===a;if(!e.tiling&&1===r.length){e.tiling={id:n.id,type:"paneGroup",percent:100,panes:o,activeIndex:t};return}if(!e.tiling)throw Error("Expected tiling");var c=eF(e,r);if(!c||!eD(c))throw Error("Expected tiled node");if(1===r.length&&"replace"===a){e.tiling={id:n.id,type:"paneGroup",percent:100,panes:o,activeIndex:t};return}if(1===r.length&&"paneGroup"===e.tiling.type){var d=[e.tiling];e.tiling={type:"split",percent:100,stacked:l,children:d},eq({id:n.id,insertIndex:+!!u,panes:o,children:d,percent:s,activeIndex:t});return}if(1===r.length&&"split"===e.tiling.type){if(!!e.tiling.stacked==!!l)return void eq({id:n.id,panes:o,percent:s,activeIndex:t,insertIndex:u?e.tiling.children.length:0,children:e.tiling.children});var p={id:n.id,panes:o,type:"paneGroup",percent:void 0===s?50:s,activeIndex:t},f=u?[c,p]:[p,c];return c.percent=100-p.percent,void(e.tiling={type:"split",stacked:l,children:f,percent:100})}if(0===r.length)throw Error("Expected relativeTo length");var h=eF(e,eA(r));if((null==h?void 0:h.type)!=="split")throw Error("Expected split parent");if("replace"===a){var g=h.children.indexOf(c);h.children.splice(g,1,{id:n.id,panes:o,percent:c.percent,type:"paneGroup",activeIndex:t});return}if(!!h.stacked==!!l){var m=h.children.indexOf(c);eq({id:n.id,panes:o,percent:s,activeIndex:t,insertIndex:u?m+1:m,children:h.children});return}if(!!h.stacked!=!!l){var v={id:n.id,panes:o,type:"paneGroup",percent:void 0===s?50:s,activeIndex:t},x=u?[c,v]:[v,c],y=c.percent;c.percent=100-v.percent;var w=h.children.indexOf(c);h.children[w]={type:"split",stacked:l,children:x,percent:y};return}}function eq(e){var n=e.id,t=e.percent,r=e.children,i=e.panes,a=e.insertIndex,o=e.activeIndex;if(void 0!==t){var s=(100-t)/100;r.forEach(function(e){e.percent=e.percent*s}),r.splice(a,0,{id:n,panes:i,type:"paneGroup",percent:t,activeIndex:o});return}var l=r.reduce(function(e,n){return e+n.percent},0)/r.length,u=100/(100+l);r.forEach(function(e){e.percent=e.percent*u}),r.splice(a,0,{id:n,panes:i,type:"paneGroup",percent:l*u,activeIndex:o})}function eK(e,n){var t=eG(e,n.paneGroupId);if(!t)throw Error("Expected paneGroup");!function(e,n){var t,r=n.index,i=n.paneIds,a=n.activate;if(void 0!==r&&r>e.panes.length)throw Error("Invalid index");var o=void 0===r?e.panes.length:r;(t=e.panes).splice.apply(t,[o,0].concat((0,er._)(i))),(void 0===a||a)&&(e.activeIndex=o)}(t,n)}function e$(e,n){e.panes.splice(n,1),0===e.activeIndex||n>e.activeIndex||(e.activeIndex=e.activeIndex-1)}function eQ(e,n){var t=eM(e,n);if(!t)throw Error("Expected pane");if(t.floating){if(1===t.paneGroup.panes.length){var r=t.paneGroupPath[1];if("number"!=typeof r)throw Error("Expected floatingIndex");eY(e,["floating",r])}else e$(t.paneGroup,t.index);return}var i=t.paneGroup,a=t.paneGroupPath,o=t.parent;if(!i)throw Error("paneGroup eith paneId not found: "+n);var s=i.panes.indexOf(n);if(-1===s)throw Error("Expected paneIndex");if(!o&&1===i.panes.length){e.tiling=null;return}i.panes.length>1?e$(i,s):eY(e,a)}function eY(e,n){var t=(0,eV._)(n),r=t[0],i=t.slice(1);if("tiling"===r&&0===i.length){e.tiling=null;return}if("floating"===r&&0===i.length){e.floating=[];return}var a=eF(e,n);if(!a)throw Error("Expected node");if("floatingPaneGroup"===a.type){var o=e.floating.indexOf(a);if(-1===o)throw Error("Expected paneGroupIndex");e.floating.splice(o,1);return}var s=eA(n),l=eF(e,s);if((null==l?void 0:l.type)!=="split")throw Error("Expected split");var u=l.children.indexOf(a);if(-1===u)throw Error("Expected paneGroupIndex");var c=l.children;if(c.splice(u,1),c.length>1){var d=100/c.reduce(function(e,n){return e+n.percent},0);c.forEach(function(e){e.percent=e.percent*d});return}var p=(0,U._)(c,1)[0],f=s.length>1?eF(e,eA(s)):null;if(!f){p.percent=100,e.tiling=p;return}if("split"!==f.type)throw Error("Expected split");var h=f.children.indexOf(l);if(-1===h)throw Error("Expected parentIndex");p.percent=l.percent,f.children[h]=p}function eX(e,n){var t=n.paneGroupPath,r=n.rect,i=eF(e,t);if((null==i?void 0:i.type)!=="paneGroup")throw Error("Expected paneGroup");eY(e,t),eH(e,{id:i.id,isFloating:!0,panes:i.panes,rect:r,activeIndex:i.activeIndex})}function eJ(e,n){var t="floatingIndex"in n?e.floating[n.floatingIndex]:eF(e,n.paneGroupPath);if(!t||!("panes"in t))throw Error("Expected paneGroup");eQ(e,n.paneId);var r=void 0===n.index?t.panes.length:n.index;t.panes.splice(r,0,n.paneId),n.activate?t.activeIndex=r:t.activeIndex>=r&&t.activeIndex++}function eZ(e,n){var t=n.leftPath,r=n.percent,i=n.snapPercent,a=void 0===i?0:i,o=eF(e,t);if(!o||!eD(o))throw Error("Expected leftNode");var s=eF(e,eA(t));if((null==s?void 0:s.type)!=="split")throw Error("Expected splitNode");var l=s.children.indexOf(o);if(-1===l)throw Error("Expected leftNodeIndex");var u=l+1,c=s.children[u];if(!c)throw Error("Expected rightNode");if(r<=a){if(o.percent=0,r<0&&l>0)for(var d=Math.abs(r),p=l-1;d>0;){var f=s.children[p];if(f.percent>d){f.percent-=d;break}if(d-=f.percent,f.percent=0,0===p)break;p--}var h=s.children.reduce(function(e,n){return n===c?e:e+n.percent},0);c.percent=100-h;return}var g=o.percent+c.percent,m=s.children.slice(l).reduce(function(e,n){return e+n.percent},0);if(r>g-a){if(o.percent=Math.min(m,Math.max(g,r)),c.percent=0,r>g&&u<s.children.length-1)for(var v=r-g,x=u+1;v>0;){var y=s.children[x];if(y.percent>v){y.percent-=v;break}if(v-=y.percent,y.percent=0,x===s.children.length-1)break;x++}return}var w=o.percent-r;c.percent=c.percent+w,o.percent=r}e.i(319105);var e0=e.i(131141),e1=(0,eo.atom)([]),e2=(0,eo.atom)([]),e4=(0,eo.atom)([]),e8={x:0,y:0,width:0,height:0},e3={type:"commands",data:{autoFocus:!1}},e6=(0,eg.atomFamily)(function(e){return(0,eo.atom)({paneId:e,type:"tile",rectAtom:(0,eo.atom)((0,v._)({},e8)),dataAtom:(0,eo.atom)((0,v._)({},e3)),isHidden:!1,isCommitted:!1,highlight:!1})}),e5=(0,eo.atom)(function(e){return e(e1).map(function(n){return e(e6(n))})}),e9=(0,eo.atom)(function(e){return e(e5).filter(function(e){return!e.isHidden})}),e7=(0,eo.atom)(function(e){return e(e5).filter(function(e){return e.isHidden})}),ne=(0,eo.atom)(function(e){return e(e4).map(function(n){return e(nt(n))})}),nn=(0,eg.atomFamily)(function(e){return(0,eo.atom)({handleId:e,rect:e8,stacked:!1,parentPath:["tiling"],leftPath:["tiling"],rightPath:["tiling"]})}),nt=(0,eg.atomFamily)(function(e){return(0,eo.atom)({id:e,rectAtom:(0,eo.atom)((0,v._)({},e8)),panes:[],path:["tiling"],activeIndex:0})}),nr=(0,eo.atom)(function(){return 34}),ni=(0,eo.atom)({x:0,y:0,width:0,height:0});e.i(282890);var na=e.i(66718),no=(0,eo.atom)(null),ns=(0,eo.atom)(null,function(e,n,t){t!==e(no)&&n(no,t)}),nl=(0,eo.atom)(null,function(e,n,t){var r=e6(t);e(r).isCommitted||n(r,function(e){return(0,e0.produce)(e,function(e){e.isCommitted=!0})})}),nu=(0,eo.atom)(function(e){var n=e(no);if(!n)return null;var t=e(e6(n)),r=e(t.dataAtom);return"markdown"===r.type?r.data.path:(0,na.isFilePane)(r)&&r.data.path||null}),nc=e.i(992785),nd=e.i(568817);ey.Type.Object({width:ey.Type.Number({minimum:0}),isOpen:ey.Type.Boolean(),activeContent:ey.Type.Union([ey.Type.Literal("filetree"),ey.Type.Literal("inbox")])});var np=(0,eo.atom)({width:180,isOpen:!1,activeContent:"filetree"}),nf=(0,eo.atom)(function(e){return e(np).isOpen}),nh=(0,eo.atom)(function(e){return e(np).activeContent}),ng=(0,eo.atom)(function(e){var n=e(np);return n.isOpen?n.width:0}),nm=(0,eo.atom)(!0),nv=(0,eo.atom)(!1),nx=(0,eo.atom)({tiling:null,floating:[]}),ny=(0,eo.atom)(function(e){return e(e5).filter(function(n){return(0,na.isFilePane)(e(n.dataAtom))})}),nw=(0,eo.atom)(function(e){var n=!0,t=!1,r=void 0;try{for(var i,a=e(e5)[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var o=i.value;if(!o.isCommitted&&(0,na.isFilePane)(e(o.dataAtom)))return o.paneId}}catch(e){t=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(t)throw r}}return null}),nb=(0,eo.atom)(function(e){var n=!0,t=!1,r=void 0;try{for(var i,a=e(e5)[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var o=i.value;if(!o.isCommitted&&!(0,na.isFilePane)(e(o.dataAtom)))return o.paneId}}catch(e){t=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(t)throw r}}return null}),n_=(0,eo.atom)(function(e){var n=[],t=!0,r=!1,i=void 0;try{for(var a,o=e(e9)[Symbol.iterator]();!(t=(a=o.next()).done);t=!0){var s=a.value;n.push([s.paneId,e(s.dataAtom)])}}catch(e){r=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(r)throw i}}return n}),nj=(0,eo.atom)([]),nS=(0,eo.atom)(function(e){var n=[],t=!0,r=!1,i=void 0;try{for(var a,o=e(e7)[Symbol.iterator]();!(t=(a=o.next()).done);t=!0){var s=a.value;n.push([s.paneId,e(s.dataAtom)])}}catch(e){r=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(r)throw i}}return n}),nI=(0,eo.atom)(function(e){var n=[],t=!0,r=!1,i=void 0;try{for(var a,o=e(e5)[Symbol.iterator]();!(t=(a=o.next()).done);t=!0){var s=a.value;n.push([s.paneId,e(s.dataAtom)])}}catch(e){r=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(r)throw i}}return n}),nC=(0,eo.atom)(function(e){return e(nI).length}),nk=(0,eo.atom)(function(e){var n=e(ni);return!!(n.width&&n.height)}),nE=(0,eo.atom)(null),nT=(0,eo.atom)(null,function(e,n,t){var r=e(e5).find(function(n){var r=e(n.dataAtom);return(0,na.isFilePane)(r)?t===(0,na.getFilePathForPane)(r):"markdown"===r.type&&t===r.data.path});r&&(n(ns,r.paneId),n(nl,r.paneId))}),nP=(0,eo.atom)(null);function nR(e,n){var t=e.x,r=e.y;return t>n.x&&t<n.x+n.width&&r>n.y&&r<n.y+n.height}function nA(e,n){var t,r,i,a,o,s,l,u,c,d=(r=(t={point:e,rect:n}).rect,i=t.point,a=r.height>r.width?r.width/r.height:1,o=r.width>r.height?r.height/r.width:1,s=(i.x-r.x)*o,(c=Math.min(s,l=(r.x+r.width-i.x)*o,u=(i.y-r.y)*a,(r.y+r.height-i.y)*a))===s?"left":c===l?"right":c===u?"top":"bottom"),p={x:n.x,y:n.y,width:n.width,height:n.height},f="below";return"top"===d?(p.height=n.height/2,f="above"):"bottom"===d?(p.height=n.height/2,p.y=n.y+n.height/2,f="below"):"left"===d?(p.width=n.width/2,p.x=n.x,f="leftOf"):"right"===d&&(p.width=n.width/2,p.x=n.x+n.width/2,f="rightOf"),{placement:f,rect:p}}function nD(e){return"handle:"+e.leftPath.join(":")}function nV(e){return(0,J.default)(function(){return(0,eg.selectAtom)(e,function(e){return{width:e.width,height:e.height}},function(e,n){return e.height===n.height&&e.width===n.width})},[e])}function nO(e){return(0,J.default)(function(){return(0,eg.selectAtom)(e,function(e){return{x:e.x,y:e.y}},function(e,n){return e.x===n.x&&e.y===n.y})},[e])}var nF=ey.Type.Object({type:ey.Type.Literal("centered")}),nM=ey.Type.Object({type:ey.Type.Literal("sidebar"),width:ey.Type.Number({minimum:300})}),nL=(0,eo.atom)("leftSidebar"),nG=(0,eo.atom)(function(e){return"leftSidebar"===e(nL)?"agent-filetree":"filetree-agent"});ey.Type.Union([nM,nF]);var nU=(0,eo.atom)({type:"sidebar",width:450});(0,eg.selectAtom)(nU,function(e){return null!==e});var nN=(0,eg.selectAtom)(nU,function(e){return"centered"===e.type});(0,eo.atom)(!0);var nB=(0,eo.atom)(6),nW=(0,eo.atom)(0),nz=(0,eo.atom)(function(e){var n=e(np),t=e(nB),r=t+e(nW),i=e(nG),a=e(nU),o=n.isOpen?n.width+2*t:t,s=t+("sidebar"===a.type?a.width:450)+("sidebar"===a.type&&0===a.width?0:t);return{top:r,bottom:t,left:"agent-filetree"===i?s:o,right:"agent-filetree"===i?o:s}}),nH=(0,eo.atom)(function(e){var n=e(nr),t=e(nB),r=e(ni);return{headerHeight:n,inset:e(nz),gap:t,size:{width:r.width,height:r.height}}}),nq=(0,eo.atom)(null,function(e,n,t){n(ni,t),n(n$,e(nx))});function nK(e,n){return(0,nc.default)(e,n)}var n$=(0,eo.atom)(null,function(e,n,t){var r=function(t){var r=t.paneId,i=t.rect,a=t.type,o=t.isHidden;s.delete(r);var l=e6(r),u=e(l);nK(e(u.rectAtom),i)||n(u.rectAtom,i);var c=(0,e0.produce)(u,function(e){e.paneId=r,e.type=a,e.isHidden=o});nK(u,c)||n(l,c)},i=e(e1),a=e(e2),o=e(e4),s=new Set(i),l=new Set(a),u=new Set(o),c=function(e,n){var t=n.size,r=n.gap,i=n.headerHeight,a=n.inset,o=void 0===a?eW:a,s=[],l=[],u=[],c=[],d=null,p={x:o.left,y:o.top,width:t.width-(o.left+o.right),height:t.height-(o.top+o.bottom)},f=e.tiling;if((null==f?void 0:f.type)==="paneGroup"){var h={x:p.x,y:p.y+i,width:p.width,height:p.height-i},g={x:h.x,y:h.y-i,width:h.width,height:i};c.push({id:f.id,rect:g,panes:f.panes,activeIndex:f.activeIndex,path:["tiling"]}),l.push.apply(l,(0,er._)(f.panes.map(function(e,n){return{paneId:e,rect:h,active:n===f.activeIndex}})))}else f&&f.children.forEach(function(n,t){return function n(t,a,o,s){var p,f,h,g=a.children.indexOf(t),m=a.children.length,v=a.stacked?o.height:o.width,x=(p=o.width,f=o.height,h=t.percent/100,a.stacked?f=(v-(r*(m-1)+i*m))*h+i:p=(v-r*(m-1))*h,{width:p,height:f}),y=x.width,w=x.height,b=function(){var e=o.x,n=o.y;if(0===g)return{x:e,y:n};if(!d)throw Error("Expected previousRect");return a.stacked?n=d.y+d.height+r:e=d.x+d.width+r,{x:e,y:n}}(),_={x:b.x,y:b.y,height:w,width:y};if(d=_,"paneGroup"===t.type){var j={x:_.x,y:_.y+i,width:_.width,height:_.height-i},S={x:j.x,y:j.y-i,width:j.width,height:i};c.push({id:t.id,rect:S,panes:t.panes,activeIndex:t.activeIndex,path:s}),l.push.apply(l,(0,er._)(t.panes.map(function(e,n){return{paneId:e,rect:j,active:n===t.activeIndex}})))}else t.children.forEach(function(e,r){return n(e,t,_,(0,er._)(s).concat([r]))});if(0!==g){var I={x:_.x-(a.stacked?0:r),y:_.y-(a.stacked?r:0),width:a.stacked?_.width:r,height:a.stacked?r:_.height},C=eA(s),k=(0,er._)(C).concat([g-1]),E=eF(e,k);if(!E||!eD(E))throw Error("Expected leftNode");var T=void 0;0===E.percent?T="left":0===t.percent&&(T="right"),u.push({parentPath:C,leftPath:k,rightPath:s,stacked:a.stacked,rect:I,snapped:T})}}(n,f,p,["tiling",t])});var m={x:p.x-o.left,y:p.y-o.top,width:p.width+o.left+o.right,height:p.height+o.top+o.bottom};return e.floating.forEach(function(e,n){var t=ez(e.rect,{inside:m,minVisibleX:2*i,minVisibleY:i}),r={height:i,width:e.rect.width,x:t.x,y:t.y},a={x:t.x,y:t.y+i,width:e.rect.width,height:Math.max(e.rect.height-i,0)};c.push({id:e.id,rect:r,panes:e.panes,activeIndex:e.activeIndex,path:["floating",n]}),s.push.apply(s,(0,er._)(e.panes.map(function(n,t){return{paneId:n,rect:a,active:t===e.activeIndex}})))}),{tiles:l,gutters:u,headers:c,floating:s}}(t,e(nH)),d=c.tiles,p=c.floating,f=c.gutters,h=c.headers,g=f.map(nD);nK(a,g)||n(e2,g);var m=(0,er._)(d).concat((0,er._)(p)).map(function(e){return e.paneId});nK(i,m)||n(e1,(0,nd.default)(m,{existing:i,getKey:function(e){return e}}));var v=[];h.forEach(function(t){u.delete(t.id);var r=nt(t.id),i=e(r);v.push(t.id),nK(e(i.rectAtom),t.rect)||n(i.rectAtom,t.rect);var a=(0,e0.produce)(i,function(e){e.panes=t.panes,e.activeIndex=t.activeIndex,e.path=t.path});nK(i,a)||n(r,a)}),nK(o,v)||n(e4,v),d.forEach(function(e){r({paneId:e.paneId,rect:e.rect,isHidden:!e.active,type:"tile"})}),p.forEach(function(e){r({paneId:e.paneId,rect:e.rect,isHidden:!e.active,type:"floating"})}),f.forEach(function(t){var r={handleId:nD(t),rect:t.rect,parentPath:t.parentPath,leftPath:t.leftPath,rightPath:t.rightPath,stacked:t.stacked,snapped:t.snapped};l.delete(r.handleId);var i=nn(r.handleId);nK(e(i),r)||n(i,r)}),s.forEach(e6.remove),l.forEach(nn.remove),u.forEach(nt.remove);var x=e(no);x&&s.has(x)&&n(no,null),n(nx,t)}),nQ=e.i(869226),nY=e.i(719518),nX=e.i(15053),nJ=e.i(173738),nZ=e.i(282453),n0=(0,eo.atom)(null),n1=(0,eo.atom)(null,function(e,n,t){nZ.default.set(n3(t.popupId),Date.now()+6048e5),nZ.default.set(n8(t.popupId),t.state);var r=!0,i=!1,a=void 0;try{for(var o,s=nZ.default.keys().filter(function(e){return e.startsWith(n4)})[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var l=o.value,u=nZ.default.get(l);if("number"==typeof u&&u<Date.now()){var c=l.split(":")[1];nZ.default.remove(n3(c)),nZ.default.remove(n8(c))}}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}}),n2=(0,eo.atom)(function(e){return!!e(n0)}),n4="popup-id-ttl:";function n8(e){return"".concat("popup-id-data:").concat(e)}function n3(e){return"".concat(n4).concat(e)}var n6=(0,eo.atom)(function(e){var n=e(nx),t={};e(e5).forEach(function(n){t[n.paneId]=e(n.dataAtom)});var r=e(nU),i=(null==r?void 0:r.type)==="sidebar"?{width:r.width}:void 0,a=e(np);return{layout:n,data:t,agent:i,filetree:a.isOpen?{width:a.width,isOpen:!0,activeContent:a.activeContent}:void 0}}),n5=(0,eo.atom)(null),n9=(0,eo.atom)(null),n7=(0,eo.atom)(null),te=(0,eo.atom)(null,function(e,n,t){return(0,ei._)(function(){var r,i,a,o,s,l,u;return(0,ea._)(this,function(c){switch(c.label){case 0:var d;if((r=e(n9))&&!r.retry||r&&Date.now()-r.timestamp<6e4||!e(nk)||(i=e(n6),a=t.replId,o=e(n5),!t.force&&(0,nc.default)(o,i)))return[2];if(s=e(n0))return n(n1,{popupId:s,state:i}),n(n5,i),[2];return n(n7,l=(0,nX.v4)()),[4,(d=i,(0,ei._)(function(){var e,n;return(0,ea._)(this,function(t){switch(t.label){case 0:n=void 0,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,null===nJ.apolloClient||void 0===nJ.apolloClient?void 0:nJ.apolloClient.mutate({mutation:H,variables:{input:{replId:a,state:d}}})];case 2:return n=t.sent(),[3,4];case 3:return t.sent(),[2,{success:!1,retry:!0}];case 4:if((null==n||null==(e=n.data)?void 0:e.setReplLayoutState.__typename)==="Repl")return[2,{success:!0,retry:void 0}];return[2,{success:!1,retry:!1}]}})})())];case 1:if(u=c.sent(),e(n7)!==l)return[2];if(n(n7,null),u.retry)return n(n9,{timestamp:Date.now(),retry:!0}),[2];if(!u.success)return n(n9,{timestamp:Date.now(),retry:!1}),[2];return n(n5,i),[2]}})})()}),tn=(0,eo.atom)(null,function(e,n,t){var r=t.data,i=t.layout,a=t.type;Object.entries(r).forEach(function(t){var r=(0,U._)(t,2),i=r[0],a=r[1],o=e6(i);n(o,(0,e0.produce)(e(o),function(e){e.isCommitted=!0})),n(e(o).dataAtom,a)}),n(nx,i),n(n$,i),n(nP,a),n(n5,e(n6))}),tt=(0,eo.atom)(!1),tr=(0,eo.atom)(function(e){return e(tt)?e(no):null}),ti=(0,eo.atom)(null,function(e,n,t){n(ns,t),n(tt,!0)}),ta=(0,eo.atom)(null,function(e,n,t){n(tt,!0);var r=eG(e(nx),t.paneGroupId);if(!r){var i=Error("Expected paneGroup");throw n(nE,{error:i,tags:{layoutstate:!0},origin:"Layout: state/maximize/maximizePaneGroupAtom"}),i}var a=r.panes[r.activeIndex];if(!a){var o=Error("Expected paneId");throw n(nE,{error:o,tags:{layoutstate:!0},origin:"Layout: state/maximize/maximizePaneGroupAtom"}),o}n(ns,a)}),to=(0,eo.atom)(null,function(e,n){e(n2)||n(tt,!1)}),ts=(0,eo.atom)(null,function(e,n,t){e(tr)===t?n(to):n(ti,t)}),tl=(0,eo.atom)(null,function(e,n,t){var r=eG(e(nx),t.paneGroupId);if(!r){var i=Error("Expected paneGroup");throw n(nE,{error:i,tags:{layoutstate:!0},origin:"Layout: state/maximize/toggleMaximizePaneGroupAtom"}),i}var a=r.panes[r.activeIndex];if(!a){var o=Error("Expected paneId");throw n(nE,{error:o,tags:{layoutstate:!0},origin:"Layout: state/maximize/toggleMaximizePaneGroupAtom"}),o}n(ts,a)}),tu=(0,eo.atom)(function(e){var n=e(ni),t=n.width+n.x,r=-n.x,i=e(nB);return{x:r,width:t,y:i,height:n.height-i}}),tc=(0,eo.atom)(function(e){var n=e(nr),t=e(tu);return{x:t.x,y:t.y,width:t.width,height:n}}),td=(0,eo.atom)(function(e){var n=e(nr),t=e(tu);return{x:t.x,y:t.y+n,width:t.width,height:t.height-n}}),tp=e.i(408880),tf=(0,eo.atom)(null,function(e,n,t){var r=eG(e(nx),t);if(!r)return null;n(ns,r.panes[r.activeIndex])}),th=(0,eo.atom)(null,function(e,n,t){var r=e(nx),i=eM(r,t);if(!i)throw Error("Expected pane");var a=!i.paneGroup.panes.some(function(e){return e!==t}),o=t===e(no),s=eN(r,t),l=(0,e0.produce)(r,function(e){try{eQ(e,t)}catch(e){throw n(nE,{error:e,tags:{layoutstate:!0},origin:"Layout: state/removePane/removePaneAtom"}),e}});if(n(n$,l),a&&e(tt)&&!e(n2)&&n(tt,!1),o&&(a||n(tf,i.paneGroup.id),a&&s)){do"split"===s.type&&(s=s.children[0]);while("paneGroup"!==s.type)n(tf,s.id)}}),tg=(0,eo.atom)(null,function(e,n,t){var r=e(nx),i=eM(r,t),a=null==i?void 0:i.paneGroup.panes.filter(function(e){return e!==t});if(null==a?void 0:a.length){var o=(0,e0.produce)(r,function(e){try{var t=!0,r=!1,i=void 0;try{for(var o,s=a[Symbol.iterator]();!(t=(o=s.next()).done);t=!0){var l=o.value;eQ(e,l)}}catch(e){r=!0,i=e}finally{try{t||null==s.return||s.return()}finally{if(r)throw i}}}catch(e){throw n(nE,{error:e,tags:{layoutstate:!0},origin:"Layout: state/removePane/removePaneAtom"}),e}});n(n$,o)}}),tm=(0,eo.atom)(null,function(e,n,t){var r=e(nx),i=eM(r,t);i&&n(n$,(0,e0.produce)(r,function(e){var n=!1,r=!0,a=!1,o=void 0;try{for(var s,l=i.paneGroup.panes[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){var u=s.value;n&&eQ(e,u),u===t&&(n=!0)}}catch(e){a=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw o}}}))}),tv=(0,eo.atom)(null,function(e,n,t){var r=e(nx),i=eG(r,t.paneGroupId);if(!i){var a=Error("Expected pane group");throw n(nE,{error:a,tags:{layoutstate:!0},origin:"Layout: state/splits/removePaneGroupAtom"}),a}var o=(0,e0.produce)(r,function(e){try{i.panes.forEach(function(n){eQ(e,n)})}catch(e){throw n(nE,{error:e,tags:{layoutstate:!0},origin:"Layout: state/splits/removePaneGroupAtom"}),e}});e(tt)&&!e(n2)&&n(tt,!1),n(n$,o)}),tx=(0,eo.atom)(null,function(e,n,t){var r=e(nx),i=eM(r,t.paneId);if(!i){var a=Error("Expected relativeToPane");throw n(nE,{error:a,tags:{layoutstate:!0},origin:"Layout: state/splits/splitPaneAtom"}),a}var o=(0,nX.v4)();n(e(e6(o)).dataAtom,{type:"commands",data:{autoFocus:!!t.autoFocus}});var s=(0,e0.produce)(r,function(e){try{eH(e,{id:(0,nX.v4)(),isFloating:!1,placement:t.placement,relativeTo:i.paneGroupPath,panes:[o]})}catch(e){throw n(nE,{error:e,tags:{layoutstate:!0},origin:"Layout: state/splits/splitPaneAtom"}),e}});n(n$,s),n(ns,o)}),ty=(0,eo.atom)(null,function(e,n,t){var r=e(nx),i=(0,nX.v4)();n(e(e6(i)).dataAtom,t.pane),(0,na.isToolPane)(t.pane)&&n(nl,i);var a=(0,e0.produce)(r,function(e){try{eH(e,{id:(0,nX.v4)(),isFloating:!1,placement:t.placement,relativeTo:t.relativeTo,panes:[i],percent:t.percent})}catch(e){throw n(nE,{error:e,tags:{layoutstate:!0},origin:"Layout: state/splits/insertSplitPaneAtom"}),e}});return n(n$,a),i}),tw=(0,eo.atom)(null,function(e,n,t){var r=e(nx);n(n$,(0,e0.produce)(r,function(e){eZ(e,{leftPath:t.leftPath,percent:t.percent})}))}),tb=e.i(965863),t_=(0,eo.atom)(null,function(e,n,t){if(0===t.panes.length){var r=Error("Expect at least one pane");throw n(nE,{error:r,origin:"Layout: state/insertPaneGroup/insertPaneGroupAtom"}),r}var i=e(nx),a=t.panes.map(function(){return(0,nX.v4)()}),o=(0,e0.produce)(i,function(e){try{eH(e,{id:(0,nX.v4)(),panes:a,relativeTo:t.relativeTo||["tiling"],placement:t.placement,percent:t.percent})}catch(e){throw n(nE,{error:e,tags:{layoutstate:!0},origin:"Layout: state/insertPaneGroup/insertPaneGroupAtom"}),e}});if(n(n$,o),t.panes.forEach(function(t,r){var i=a[r];n(e(e6(i)).dataAtom,t),(0,na.isToolPane)(t)&&n(nl,i);var o=(0,na.isSingleton)(t.type)?e(e5).find(function(n){return e(n.dataAtom).type===t.type&&n.paneId!==i}):null;o&&n(th,o.paneId)}),t.commit){var s=!0,l=!1,u=void 0;try{for(var c,d=a[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var p=c.value;n(nl,p)}}catch(e){l=!0,u=e}finally{try{s||null==d.return||d.return()}finally{if(l)throw u}}}return t.makeActive&&n(ns,a[0]),a}),tj={top:"above",left:"leftOf",right:"rightOf",bottom:"below"},tS=(0,eo.atom)(null,function(e,n,t){n(ty,{pane:t.pane,relativeTo:["tiling"],placement:tj[t.edge]})}),tI=(0,eo.atom)(null,function(e,n,t){var r=e(nx),i=(0,nX.v4)(),a=(0,nX.v4)(),o=(0,e0.produce)(r,function(e){try{eH(e,{id:a,panes:[i],isFloating:!0,rect:t.rect})}catch(e){throw n(nE,{error:e,tags:{layoutstate:!0},origin:"Layout: state/insertPaneGroup/insertFloatingPaneGroupAtom"}),e}});return n(n$,o),n(e(e6(i)).dataAtom,t.pane),(0,na.isToolPane)(t.pane)&&n(nl,i),t.makeActive&&(n(ns,i),t.makeModal&&n(tb.modalPaneGroupIdAtom,a)),i}),tC=(0,eo.atom)(null,function(e,n,t){var r=t.paneId,i=t.activate,a=e(nx);if("tile"===e(e6(r)).type?n(n$,(0,e0.produce)(a,function(e){try{!function(e,n){var t=eM(e,n.paneId);if(t){var r=t.paneGroupPath;t.paneGroup.activeIndex=t.index;var i=r.map(function(e,n){return r.slice(0,n+1)}),a=!0,o=!1,s=void 0;try{for(var l,u=i[Symbol.iterator]();!(a=(l=u.next()).done);a=!0){var c=l.value,d=eF(e,c);if(!d)throw Error("Expected node");if("floatingPaneGroup"===d.type)throw Error("Expected tiled pane");if(1!==c.length){var p=c[c.length-1];if("number"!=typeof p)throw Error("Expected number");var f=eF(e,eA(c));if((null==f?void 0:f.type)!=="split")throw Error("Expected split");var h=f.stacked?n.minPercentVertical:n.minPercentHorizontal;if(!(d.percent>=h)){var g=p===f.children.length-1,m=g?(0,er._)(c.slice(0,-1)).concat([p-1]):c,v=g?f.children[p-1].percent-(h-d.percent):h;eZ(e,{leftPath:m,percent:v})}}}}catch(e){o=!0,s=e}finally{try{a||null==u.return||u.return()}finally{if(o)throw s}}}}(e,{paneId:r,minPercentHorizontal:30,minPercentVertical:20})}catch(e){throw n(nE,{error:e,origin:"Layout: revealPaneAtom/revealTiledPane"}),e}})):n(n$,(0,e0.produce)(a,function(e){try{!function(e,n){var t=eM(e,n.paneId);if(t){var r=t.paneGroup;if("floatingPaneGroup"!==r.type)throw Error("Expected floatingPaneGroup");r.activeIndex=t.index,r.rect.width=Math.max(r.rect.width,n.minWidth),r.rect.height=Math.max(r.rect.height,n.minHeight)}}(e,{paneId:r,minWidth:200,minHeight:140})}catch(e){throw n(nE,{error:e,origin:"Layout: revealPaneAtom/revealFloatingPane"}),e}})),!i){var o=eM(a,r),s=e(no);if(!o)throw Error("Expected pane");if(!s)return;var l=eM(a,s);if(!l)throw Error("Expected active pane");if(l.paneGroup.id!==o.paneGroup.id)return}n(ns,r)}),tk=(0,eo.atom)(null),tE=(0,eg.selectAtom)(tk,function(e){return null!==e}),tT=(0,eo.atom)(null,function(e,n,t){n(tk,t),requestAnimationFrame(function(){n(tk,null)})}),tP=(0,eo.atom)(null),tR=(0,eo.atom)(null),tA=(0,eg.selectAtom)(tR,Boolean),tD=(0,eo.atom)(null,function(e,n,t){switch(t.type){case"start":var r=e(nU);if("sidebar"!==r.type)return;n(tR,{startWidth:r.width});break;case"update":var i=e(tR);if(!i)return;var a=e(nG),o=i.startWidth+t.moveDelta.x*("filetree-agent"===a?-1:1),s=.5*e(ni).width;n(nU,function(e){return(0,e0.produce)(e,function(e){"sidebar"===e.type&&(o<300?e.width=300-o>150?0:300:o>s?e.width=s:e.width=o)})}),n(n$,e(nx));break;case"end":var l=e(nU);if("sidebar"!==l.type)return;var u=e(tR);if(n(tR,null),l.width>0&&l.width<300&&u){var c={width:l.width}.width>u.startWidth;n(tV,(0,v._)({type:"sidebar"},c?{width:450}:{width:300}))}}}),tV=(0,eo.atom)(null,function(e,n,t){n(tT,{headers:new Map(e(e4).map(function(e){return[e,{snappiness:400}]})),panes:new Map(e(e1).map(function(e){return[e,{snappiness:400}]}))}),n(nU,t),n(n$,e(nx))}),tO=(0,eo.atom)(null,function(e,n,t){n(tV,{type:"sidebar",width:450*!!t})}),tF=(0,eg.selectAtom)(nU,function(e){return"sidebar"===e.type&&0===e.width}),tM=(0,eo.atom)(null,function(e,n,t){n(tV,"centered"===t?{type:t}:{type:"sidebar",width:450})}),tL=(0,eo.atom)(null,function(e,n,t){n(tO,!0);var r=e(tP);null==r||r.setSessionId(null!=t?t:null),null==r||r.focusInput()}),tG=(0,eo.atom)(null,function(e,n,t){if(0===t.panes.length)return[];var r=e(nx),i=t.panes.map(function(){return(0,nX.v4)()}),a=(0,e0.produce)(r,function(e){try{eK(e,{paneIds:i,activate:t.activate,paneGroupId:t.paneGroupId,index:t.index})}catch(e){throw n(nE,{error:e,tags:{layoutstate:!0},origin:"Layout: state/tabs/insertPanesAtom"}),e}});return n(n$,a),t.panes.forEach(function(r,a){var o=i[a];n(e(e6(o)).dataAtom,r);var s=(0,na.isSingleton)(r.type)?e(e5).find(function(n){return e(n.dataAtom).type===r.type&&n.paneId!==o}):null;s&&n(th,s.paneId),(t.commit||(0,na.isToolPane)(r))&&n(nl,o)}),t.activate&&n(tC,{paneId:(0,U._)(i,1)[0],activate:!0}),i}),tU=(0,eo.atom)(null,function(e,n,t){var r,i=t.pane,a=t.activate,o=t.commit,s=t.placement;if("agentChat"===i.type)return void n(tL,null==(r=i.data)?void 0:r.sessionId);var l=e(nx);if(!l.tiling){var u=n(ty,{pane:i,relativeTo:["tiling"],placement:"replace"});return a&&n(ns,u),u}if("after"===s.type){var c=eM(l,s.paneId);if(c){var d=(0,U._)(n(tG,{panes:[i],paneGroupId:c.paneGroup.id,index:c.index+1,activate:a}),1)[0];return a&&n(ns,d),d}}if("secondary"===s.type&&s.relativeTo){var p=eN(l,s.relativeTo);if(p){if("paneGroup"===p.type){var f=(0,U._)(n(tG,{panes:[i],paneGroupId:p.id,activate:a}),1)[0];return a&&n(ns,f),f}var h=n(ty,{pane:i,relativeTo:s.relativeTo,placement:"rightOf"});return a&&n(ns,h),h}var g=eM(l,s.relativeTo);if((null==g?void 0:g.paneGroup.type)==="floatingPaneGroup"){var m=e(e6(s.relativeTo)),v=e(m.rectAtom);return n(tI,{rect:{x:v.x+v.width,y:v.y,width:v.width,height:v.height},pane:i,makeActive:a})}}var x=n(ty,{pane:i,relativeTo:["tiling"],placement:"rightOf"});return a&&n(ns,x),o&&n(nl,x),x}),tN=e.i(903381),tB=(0,eo.atom)(null,function(e,n,t){var r;n(e(e6(t.paneId)).dataAtom,t.pane),(t.makeActive||t.reveal)&&n(tC,{paneId:t.paneId,activate:null!=(r=t.makeActive)&&r}),(t.commit||(0,na.isToolPane)(t.pane))&&n(nl,t.paneId)}),tW=((n={}).EXACT="EXACT",n.FUZZY="FUZZY",n.NONE="NONE",n);function tz(e,n){return(null==e?void 0:e.ports)||(null==n?void 0:n.ports)?(null==e?void 0:e.ports)&&!(null==n?void 0:n.ports)||!(null==e?void 0:e.ports)&&(null==n?void 0:n.ports)?"FUZZY":(null==e?void 0:e.ports)&&(null==n?void 0:n.ports)&&e.ports.port!==n.ports.port?"NONE":(null==e?void 0:e.ports)&&(null==n?void 0:n.ports)&&e.ports.port===n.ports.port?e.ports.path===n.ports.path?"EXACT":"FUZZY":"NONE":"EXACT"}var tH=(0,eo.atom)(null,function(e,n,t){var r=e(nx),i=eM(r,t);if(!i){var a=Error("Expected selectedPane");throw n(nE,{error:a,tags:{layoutstate:!0},origin:"Layout: state/tabs/selectTabAtom"}),a}n(nt(i.paneGroup.id),function(e){return(0,e0.produce)(e,function(e){e.activeIndex=i.index})});var o=!0,s=!1,l=void 0;try{for(var u,c=i.paneGroup.panes[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var d=u.value,p=e6(d);n(p,function(e){return(0,e0.produce)(e,function(e){e.isHidden=e.paneId!==t})})}}catch(e){s=!0,l=e}finally{try{o||null==c.return||c.return()}finally{if(s)throw l}}n(nx,(0,e0.produce)(r,function(e){try{var r=eM(e,t);if(!(null==r?void 0:r.paneGroup))throw Error("Expected pane group");var i=r.paneGroup,a=i.panes.indexOf(t);if(-1===a)throw Error("Expected index");i.activeIndex=a}catch(e){throw n(nE,{error:e,tags:{layoutstate:!0},origin:"Layout: state/tabs/selectTabAtom"}),e}})),0===e(e(e6(t)).rectAtom).width?n(tC,{paneId:t,activate:!0}):n(ns,t)}),tq=(0,eo.atom)(null,function(e,n,t){var r=e(nx),i=eL(r,"topRight"),a=eL(r,"topLeft");if(!i||!a||!r.tiling){var o=n(ty,{pane:t,relativeTo:["tiling"],placement:"replace"});n(nl,o);return}if("paneGroup"===r.tiling.type){var s=n(ty,{pane:t,relativeTo:["tiling"],placement:"rightOf"});n(nl,s);return}if("split"===r.tiling.type&&2===r.tiling.children.length&&"paneGroup"===r.tiling.children[1].type){var l=r.tiling.stacked,u=n(ty,{pane:t,relativeTo:i.path,placement:l?"rightOf":"above"});n(nl,u);return}n(tG,{panes:[t],paneGroupId:i.paneGroup.id,commit:!0})}),tK=(0,eo.atom)(null,function(e,n,t){if(!e(e5).find(function(n){var r=e(n.dataAtom);return"webview"===r.type&&tz(t,r.data)!==tW.NONE}))return void n(tq,{type:"webview",data:t})}),t$=(0,eo.atom)(null,function(e,n,t){var r=e(nx),i=(0,e0.produce)(r,function(e){var r=eM(e,t.paneId);if(!r){var i=Error("Expected pane");throw n(nE,{error:i,tags:{layoutstate:!0},origin:"Layout: state/tabs/movePaneAtom"}),i}var a=eG(e,t.toPaneGroupId);if(!a){var o=Error("Expected toPaneGroup");throw n(nE,{error:o,tags:{layoutstate:!0},origin:"Layout: state/tabs/movePaneAtom"}),o}var s=1===r.paneGroup.panes.length,l=!a.panes.includes(t.paneId);if(!s||l)try{eQ(e,t.paneId),eK(e,{paneIds:[t.paneId],paneGroupId:t.toPaneGroupId,index:t.index}),l&&n(nl,t.paneId)}catch(e){throw n(nE,{error:e,tags:{layoutstate:!0},origin:"Layout: state/tabs/movePaneAtom"}),e}});n(n$,i)}),tQ=(0,eo.atom)(null,function(e,n,t){var r=e(no);if(r){var i=e(nx),a=eM(i,r);if(a){var o=a.paneGroup,s=eB({relativeTo:r,rects:new Map(e(e5).filter(function(e){return!e.isHidden}).map(function(n){return[n.paneId,e(n.rectAtom)]})),direction:t}),l=s?eM(i,s):null;if(l)return void n(t$,{paneId:r,toPaneGroupId:l.paneGroup.id});var u=o.panes.find(function(e){return e!==r});u&&n(n$,(0,e0.produce)(i,function(e){eQ(e,r),eH(e,{id:(0,nX.v4)(),relativeTo:u,panes:[r],placement:t})}))}}}),tY=(0,eo.atom)(!1),tX=(0,eo.atom)(null,function(e,n,t){var r=e(ny).map(function(n){return{paneId:n.paneId,path:(0,na.getFilePathForPane)(e(n.dataAtom))}}).filter(function(e){return t===e.path}),i=[],a=e(nx),o=(0,e0.produce)(a,function(e){var t=!0,a=!1,o=void 0;try{for(var s,l=r[Symbol.iterator]();!(t=(s=l.next()).done);t=!0){var u=s.value.paneId,c=eM(e,u);if(!c){var d=Error("Expected pane");throw n(nE,{error:d,tags:{layoutstate:!0},origin:"Layout: state/tabs/removePanesForFileAtom"}),d}c.floating||1!==c.paneGroup.panes.length?eQ(e,u):i.push(u)}}catch(e){a=!0,o=e}finally{try{t||null==l.return||l.return()}finally{if(a)throw o}}}),s=!0,l=!1,u=void 0;try{for(var c,d=i[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var p=c.value;n(tB,{paneId:p,pane:{type:"commands",data:{autoFocus:!1}}})}}catch(e){l=!0,u=e}finally{try{s||null==d.return||d.return()}finally{if(l)throw u}}n(n$,o)}),tJ=(0,eo.atom)(null,function(e,n,t){var r=t.node.path;if(t.eventType===tN.ChangeEventType.Delete)return void n(tX,r);var i=e(ny).filter(function(n){return(0,na.getFilePathForPane)(e(n.dataAtom))===r}),a={type:(0,na.getPaneTypeForFile)({path:t.to}),data:{path:t.to}},o=!0,s=!1,l=void 0;try{for(var u,c=i[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var d=u.value.paneId;n(tB,{paneId:d,pane:a})}}catch(e){s=!0,l=e}finally{try{o||null==c.return||c.return()}finally{if(s)throw l}}}),tZ=(0,eo.atom)(null,function(e,n,t){var r=e(no),i=e(nx);if(r){var a=eM(i,r);if(a)return void n(tG,{panes:t,paneGroupId:null==a?void 0:a.paneGroup.id,activate:!0,index:a.index+t.length})}var o=eL(i,"topLeft");if(o)return void n(tG,{activate:!0,paneGroupId:o.paneGroup.id,index:o.paneGroup.activeIndex+t.length,panes:t});var s=i.floating.length?i.floating[0]:null;s?n(tG,{activate:!0,paneGroupId:s.id,index:s.activeIndex+t.length,panes:t}):n(t_,{panes:t,placement:"leftOf",makeActive:!0,relativeTo:["tiling"]})}),t0=(0,eo.atom)(null,function(e,n){n(tZ,[{type:"commands",data:{autoFocus:!0}}])}),t1=(0,eo.atom)(null,function(e,n){var t=e(no);return!!t&&(n(th,t),!0)}),t2=(0,eo.atom)(null,function(e,n,t){var r=e(no);if(r){var i=function(e,n){var t=n.paneId,r=n.dir,i=eM(e,t);if(i){var a=i.index,o=i.paneGroup.panes;return"previous"===r?o[0===a?o.length-1:a-1]:o[a===o.length-1?0:a+1]}}(e(nx),{paneId:r,dir:t});i&&n(tH,i)}}),t4=(0,eo.atom)(null,function(e,n,t){var r=t.paneId,i=t.pane;n(tB,{paneId:r,pane:i});var a=(0,na.isSingleton)(i.type)?e(e5).find(function(n){return e(n.dataAtom).type===i.type&&n.paneId!==r}):null;if(a){var o=eM(e(nx),a.paneId);if(!(null==o?void 0:o.floating)&&(null==o?void 0:o.paneGroup.panes.length)===1)return void n(tB,{paneId:a.paneId,pane:{type:"commands",data:{autoFocus:!1}}});n(th,a.paneId)}}),t8=(0,eo.atom)(null,function(e,n,t){var r=e(e(e6(t.b)).dataAtom);n(tB,{paneId:t.a,pane:r});var i=eM(e(nx),t.b);(null==i?void 0:i.floating)||(null==i?void 0:i.paneGroup.panes.length)!==1?n(th,t.b):n(t4,{paneId:t.b,pane:{type:"commands",data:{autoFocus:!1}}})}),t3=(0,eo.atom)(null,function(e,n,t){var r=e6(t);n(r,function(e){return(0,e0.produce)(e,function(e){e.highlight=!0})}),setTimeout(function(){n(r,function(e){return(0,e0.produce)(e,function(e){e.highlight=!1})})},200)}),t6=(0,eo.atom)(null,function(e,n,t){if("agentChat"===t.pane.type){var r;n(tL,null==(r=t.pane.data)?void 0:r.sessionId);return}var i=e(nx),a=t.activate,o=void 0===a||a,s=t.update,l=void 0===s||s,u=function(r){return r.paneId===e(no)&&n(t3,r.paneId),(o||t.reveal)&&n(tH,r.paneId),l&&n(tB,{paneId:r.paneId,pane:t.pane,makeActive:o,reveal:t.reveal}),r.paneId};if("diff"===t.pane.type){var c=e(e5).find(function(n){var r=e(n.dataAtom);return(0,tp.default)(r,t.pane)});if(c)return u(c)}if("webview"===t.pane.type){var d=e(e5).filter(function(n){return"webview"===e(n.dataAtom).type}),p=d.find(function(n){var r=e(n.dataAtom);return"webview"===r.type&&"webview"===t.pane.type&&tz(r.data,t.pane.data)!==tW.NONE});if(p)return u(p);if(d.length>0)return u(d[0])}var f=e(e5).find(function(n){return e(n.dataAtom).type===t.pane.type});if((0,na.isSingleton)(t.pane.type)&&f)return u(f);var h=eL(i,"topRight");if(!h)return n(t_,{panes:[t.pane],placement:"rightOf",relativeTo:["tiling"],makeActive:o,commit:t.commit})[0];var g=h.paneGroup.panes.find(function(n){var t=e(e6(n));if(t.isHidden)return!1;var r=e(t.dataAtom);return!t.isCommitted&&!(0,na.isFilePaneType)(r.type)});if(g)return n(tB,{paneId:g,pane:t.pane,makeActive:o,reveal:t.reveal}),g;var m=!!t.commit||o,v=n(tG,{panes:[t.pane],paneGroupId:h.paneGroup.id,activate:m,commit:t.commit});return t.reveal&&n(tC,{paneId:v[0],activate:m}),v[0]}),t5=e.i(151386),t9=(0,eo.atom)(!1),t7=(0,eo.atom)(!1),re=(0,N.createContext)(null);function rn(e){var n,t,r,i=e.children,a=e.savedLayoutState,o=e.popupId,s=e.initialPane,l=e.agentCenteredLayout,u=void 0!==l&&l,c=e.agentLayoutVariation,d=e.agentPosition,p=void 0===d?"leftSidebar":d,f=(0,t5.useFilePaneFlag)(),h=(n=(0,m.useRouter)(),t=(0,Z.isInBonsaiWebview)(n),r=(0,Z.doesBonsaiWebviewSupportFeature)(n,"workspace2"),t&&!r?6:V.APP_HEADER_HEIGHT),v=(0,Y.default)(),x=(0,U._)((0,N.useState)(function(){var e,n,t=(0,eo.createStore)();if(t.set(nL,p),t.set(t7,f),t.set(t9,v),t.set(nW,v?h:0),v||t.set(ni,{width:window.innerWidth,height:window.innerHeight,x:0,y:0}),o&&(t.set(n0,o),t.set(tt,!0)),null==a?void 0:a.filetree){var r,i=(r=a.filetree.width,Math.min(Math.round(.4*window.innerWidth),r)),l="activeContent"in a.filetree?a.filetree.activeContent:null;t.set(np,{width:i,isOpen:i>0,activeContent:"inbox"===l?"inbox":"filetree"})}if(u)t.set(nU,{type:"centered"});else{var d,g,m=null!=(g=null==a||null==(d=a.agent)?void 0:d.width)?g:null;t.set(nU,{type:"sidebar",width:null===m?450:Math.min(Math.round(.5*window.innerWidth),m)})}var x=null!=a?a:(e=(0,nX.v4)(),n={type:"split-with-console"===c?"runnerOutput":"split-with-automations"===c?"automations":"webview"},{data:(0,E._)({},e,n),layout:{floating:[],tiling:{type:"paneGroup",panes:[e],activeIndex:0,id:(0,nX.v4)(),percent:100}},type:"default"});return t.set(tn,x),null!=s&&(t.get(e9).some(function(e){return t.get(e.dataAtom).type===(null==s?void 0:s.type)})||t.set(t6,{pane:s,commit:!0})),t}),1)[0];return(0,g.jsx)(re.Provider,{value:x,children:i})}function rt(){var e=(0,N.useContext)(re);if(!e)throw Error("Expected store in context");return e}function rr(e){return(0,es.useAtomValue)(e,{store:rt()})}function ri(e){return(0,ex.useCreateObservableAtom)(e,rt())}var ra=function(e){return(0,es.useSetAtom)(e,{store:rt()})};function ro(e){return(0,nY.useAtomCallback)((0,N.useCallback)(function(n){return n(e)},[e]),{store:rt()})}var rs=e.i(323049),rl=e.i(446530),ru=e.i(123850),rc=(0,eo.atom)(null),rd=(0,ru.createCssVarTokens)(["backgroundColor","borderRadius","zIndex","border","opacity","visibility","width","height","x","y","innerScale","innerOpacity"]),rp=rd.cssVars,rf=rd.styleTokens,rh=(0,eg.selectAtom)(rc,function(e){return(0,E._)({},rp.border,(null==e?void 0:e.type)==="detachPreview"&&e.progress<.98?"1px dashed ".concat(P.tokens.foregroundDefault):"1px solid ".concat(P.tokens.accentPrimaryDefault))},nc.default),rg=(0,eg.selectAtom)(rc,function(e){return null==e?void 0:e.rect},nc.default),rm=(0,eg.selectAtom)(rg,function(e){var n;return e?(n={},(0,E._)(n,rp.width,e.width+"px"),(0,E._)(n,rp.height,e.height+"px"),n):null},nc.default),rv=(0,eg.selectAtom)(rg,function(e){var n;return e?(n={},(0,E._)(n,rp.x,e.x+"px"),(0,E._)(n,rp.y,e.y+"px"),n):null},nc.default),rx=(0,eg.selectAtom)(rc,function(e){var n,t;return e?"detachPreview"===e.type?(n={},(0,E._)(n,rp.zIndex,rs.zIndexLevels.detachPreview.toString()),(0,E._)(n,rp.borderRadius,"100%"),(0,E._)(n,rp.backgroundColor,"transparent"),n):(t={},(0,E._)(t,rp.zIndex,rs.zIndexLevels.dropPreview.toString()),(0,E._)(t,rp.borderRadius,"8px"),(0,E._)(t,rp.backgroundColor,P.tokens.accentPrimaryDimmer),t):null},nc.default),ry=(0,eg.selectAtom)(rc,function(e){var n,t,r;return e?"detachPreview"===e.type?(t={},(0,E._)(t,rp.opacity,(.5*e.progress).toString()),(0,E._)(t,rp.visibility,"visible"),t):(r={},(0,E._)(r,rp.opacity,"0.2"),(0,E._)(r,rp.visibility,"visible"),r):(n={},(0,E._)(n,rp.opacity,"0"),(0,E._)(n,rp.visibility,"hidden"),n)},nc.default),rw=(0,eg.selectAtom)(rc,function(e){return(0,E._)({},rp.innerOpacity,(null==e?void 0:e.type)==="detachPreview"?"0.5":"0")},nc.default),rb=(0,eg.selectAtom)(rc,function(e){return(0,E._)({},rp.innerScale,(null==e?void 0:e.type)==="detachPreview"?e.progress.toString():"1")},nc.default),r_=(0,rl.cssRecord)({root:[{position:"absolute",pointerEvents:"none",opacity:rf.opacity,width:rf.width,height:rf.height,transform:"translate(".concat(rf.x,", ").concat(rf.y,")"),backgroundColor:rf.backgroundColor,borderRadius:rf.borderRadius,border:rf.border,zIndex:rf.zIndex,visibility:rf.visibility,transition:"transform 140ms, width 140ms, height 140ms, border-radius 140ms, opacity 140ms ease-out 200ms","@media (prefers-reduced-motion: reduce)":{transitionDuration:"0ms"}}],inner:[{width:"100%",height:"100%",borderRadius:"100%",background:"radial-gradient(transparent, ".concat(P.tokens.backgroundHighest,")"),opacity:rf.innerOpacity,transform:"scale(".concat(rf.innerScale,")")}]}),rj=(0,N.memo)(function(){var e=(0,N.useRef)(null);(0,nQ.useStyleSet)(e,ri(rv)),(0,nQ.useStyleSet)(e,ri(rm)),(0,nQ.useStyleSet)(e,ri(rh)),(0,nQ.useStyleSet)(e,ri(rx)),(0,nQ.useStyleSet)(e,ri(ry));var n=(0,N.useRef)(null);return(0,nQ.useStyleSet)(n,ri(rw)),(0,nQ.useStyleSet)(n,ri(rb)),(0,g.jsx)("div",{ref:e,css:r_.root,children:(0,g.jsx)("div",{ref:n,css:r_.inner})})}),rS=(0,eo.atom)(function(e){var n=e(np),t=e(ni),r=e(nB),i=e(nr)+r,a=n.width,o=n.isOpen,s={y:i,width:a,isOpen:o,opacity:+!!o,height:t.height-i};return"agent-filetree"===e(nG)?(0,v._)({x:o?t.width-a-r:t.width},s):(0,v._)({x:o?r:-(a+r)},s)}),rI=(0,eo.atom)(function(e){var n=e(np),t=e(nB);return n.isOpen?{isOpen:!0,width:t}:{isOpen:!1,width:t}}),rC=(0,eo.atom)(function(e){var n=e(rS),t=e(nG),r=e(nU),i=e(nB),a="sidebar"===r.type?r.width:450;switch(t){case"filetree-agent":return{left:n.isOpen?n.width+2*i:i,right:i+a+i};case"agent-filetree":return{right:n.isOpen?n.width+2*i:i,left:i+a+i}}return{right:i,left:n.isOpen?n.width+i:i}}),rk=(0,eo.atom)(null,function(e,n){n(rc,{type:"dropPreview",rect:e(rT)})}),rE=(0,eo.atom)(null,function(e,n,t){n(rc,null),n(tY,!1),n(t_,{panes:t.panes,placement:"leftOf",makeActive:!0,relativeTo:["tiling"]})}),rT=(0,eo.atom)(function(e){if(e(n2))return e(tu);var n=e(nW),t=e(ni),r=e(nB),i=e(nr),a=e(rC),o=i+n+r;return{x:a.left,y:o,width:t.width-a.left-a.right,height:t.height-o-r}});function rP(){var e=(0,x._)(["\n  query FiletypeAssociations {\n    currentUser {\n      id\n      filetypeAssociations\n    }\n  }\n"]);return rP=function(){return e},e}function rR(){var e=(0,x._)(["\n  mutation SetFiletypeAssociation($input: FiletypeAssociationInput!) {\n    setFiletypeAssociation(input: $input) {\n      ... on UserFiletypeAssociations {\n        associations\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on UserError {\n        message\n      }\n      ... on Error {\n        message\n      }\n    }\n  }\n"]);return rR=function(){return e},e}var rA={},rD=(0,y.gql)(rP()),rV=(0,y.gql)(rR()),rO=(0,eo.atom)({}),rF=(0,eo.atom)(null),rM=(0,eo.atom)(null,function(e,n,t){(0,nc.default)(t,e(rO))||n(rO,t)}),rL=(0,eo.atom)(null,function(e,n,t){return(0,ei._)(function(){var r,i,a,o,s,l;return(0,ea._)(this,function(u){switch(u.label){case 0:r=e(rO),n(rM,(0,e0.produce)(r,function(e){t.newAssociation?e[t.fileExtension]={extensionId:t.newAssociation.extensionId,fileHandlerId:t.newAssociation.fileHandlerId}:delete e[t.fileExtension]})),u.label=1;case 1:return u.trys.push([1,3,,4]),[4,null===nJ.apolloClient||void 0===nJ.apolloClient?void 0:nJ.apolloClient.mutate({mutation:rV,variables:{input:t}})];case 2:if((null==(o=u.sent())||null==(a=o.data)||null==(i=a.setFiletypeAssociation)?void 0:i.__typename)!=="UserFiletypeAssociations")throw Error("Failed to set Filetype Association: "+(null==o||null==(l=o.data)||null==(s=l.setFiletypeAssociation)?void 0:s.message));return[3,4];case 3:return u.sent(),n(rO,r),[3,4];case 4:return[2]}})})()}),rG=1920/1020,rU=(0,eo.atom)(null,function(e,n,t){var r,i,a,o,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{location:"bottomRight"},l=e(e5).find(function(n){return e(n.dataAtom).type===t.type});if(l){n(tB,{paneId:l.paneId,pane:t}),s.commit&&n(nl,l.paneId);return}var u=e(ni),c=e(nr),d=n(tI,{pane:t,rect:"bottomRight"===s.location?{width:r=Math.min(600,u.width),height:i=Math.min(600/rG+c,u.height),x:u.width-r,y:u.height-i}:(o=Math.min((a=Math.min(600,u.width))/rG+c,u.height),{width:a,height:o,x:(u.width-a)/2,y:(u.height-o)/2})});s.commit&&n(nl,d)}),rN=(0,eo.atom)(null,function(e,n,t){e(e5).filter(function(n){return e(n.dataAtom).type===t}).forEach(function(e){return n(th,e.paneId)})}),rB=(0,eo.atom)(null),rW=(0,eo.atom)(null,function(e,n,t){if("end"===t.type)return void n(rB,null);if("update"===t.type){var r=e(rB);if(!r){var i=Error("Expected tilingResize");throw n(nE,{error:i,tags:{layoutstate:!0},origin:"Layout: state/resizeTiling"}),i}var a=r.stacked,o=r.leftPath,s=r.startPercent,l=r.resizeDistance,u=r.initialLayout,c=r.snapPercent,d=s+(a?t.moveDelta.y:t.moveDelta.x)/l*100,p=e(ni);d/100*p.width<240&&(d=240/p.width*100),n(n$,(0,e0.produce)(u,function(e){eZ(e,{leftPath:o,percent:d,snapPercent:c})}));return}var f=e(nx),h=t.stacked?window.innerHeight:window.innerWidth,g=eF(f,t.leftPath);if(!g||!eD(g)){var m=Error("Expected left node");throw n(nE,{error:m,tags:{layoutstate:!0},origin:"Layout: state/resizeTiling"}),m}var v=eA(t.leftPath),x=g.percent,y=null;try{y=function(e){var n=e.layout,t=e.splitPath,r=e.tilingOptions,i=function(e,n){var t=n.splitPath,r=eF(e,t);if(!r||"split"!==r.type)throw Error("Expected split node");for(var i=100,a=eA(t);a.length;){var o=eF(e,a);if(!o)break;a=eA(a),"split"===o.type&&o.stacked===r.stacked&&(i*=o.percent/100)}return i}(n,{splitPath:t}),a=eF(n,t);if((null==a?void 0:a.type)!=="split")throw Error("Expected split node");var o=r.size,s=r.gap,l=r.headerHeight,u=r.inset,c=void 0===u?{top:0,bottom:0,left:0,right:0}:u,d=a.children.length,p=a.stacked?s*(d-1)+l*d:s*(d-1);return i/100*((a.stacked?o.height-(c.top+c.bottom):o.width-(c.left+c.right))-p)}({splitPath:v,layout:f,tilingOptions:e(nH)})}catch(e){throw n(nE,{error:e,tags:{layoutstate:!0},origin:"Layout: state/resizeTiling"}),e}if(null===y)throw Error("Expected resizeDistance");n(rB,{stacked:t.stacked,leftPath:t.leftPath,startPercent:x,resizeDistance:y,snapPercent:30/h*100,initialLayout:f})});function rz(e){return(0,J.default)(function(){return nn(e)},[e])}function rH(e){var n=rz(e);return(0,J.default)(function(){return(0,eg.selectAtom)(n,function(e){return e.rect})},[n])}function rq(e){return(0,J.default)(function(){return(0,eo.atom)(function(n){var t=n(rB);return!!t&&e===nD({leftPath:t.leftPath})})},[e])}function rK(e){var n=rz(e);return(0,J.default)(function(){return(0,eg.selectAtom)(n,function(e){return e.stacked})},[n])}var r$=e.i(64386),rQ=function(e){var n=e.container,t=e.sidebarWidths,r=e.gap,i=n.width-t.left-t.right,a=n.width-100-i/2,o=(n.height-r)/2-100;return{middle:{rect:{x:0,y:0,width:0,height:0},paneId:null,visible:!1},above:{visible:!1,rect:{x:a,y:0,width:200,height:100}},below:{visible:!1,rect:{x:a,y:n.height-100-r,width:200,height:100}},leftOf:{visible:!1,rect:{x:t.left+r,y:o,width:100,height:200}},rightOf:{visible:!1,rect:{x:n.width-100-r,y:o,width:100,height:200}}}},rY=["above","rightOf","leftOf","below","middle"],rX=(0,eo.atom)(null),rJ=(0,eo.atom)(function(e){var n=e(rX);if(!n)return null;var t=eG(e(nx),n.paneGroupId);return t&&t.panes[t.activeIndex]||null}),rZ=(0,eg.selectAtom)(rX,function(e){return null==e?void 0:e.dropPoints}),r0=(0,eo.atom)(null,function(e,n,t){if(!e(tt)){var r=e(ni),i=eG(e(nx),t.paneGroupId);if(!i){var a=Error("Expected paneGroup");throw n(nE,{error:a,origin:"Layout: state/paneGroupDragAndDrop/dragStartAtom"}),a}var o=e(e6(i.panes[i.activeIndex])),s=e(o.rectAtom),l=e(nr),u={x:s.x,y:s.y-l,width:s.width,height:s.height+l},c=t.mouse.x-(r.x+s.x),d=e(nB),p=new Map(e(e4).filter(function(e){return e!==i.id}).map(function(e){return[e,{snappiness:400}]}));n(tT,{panes:new Map(e(e1).filter(function(e){return e!==o.paneId}).map(function(e){return[e,{snappiness:400}]})),headers:p}),n(rX,{startType:o.type,startPoint:{x:t.mouse.x-r.x,y:t.mouse.y-r.y},paneGroupId:t.paneGroupId,transformOriginX:Math.round(c)+"px",scale:1,fromRect:u,movedAtAll:!1,dropPoints:"floating"===o.type?rQ({container:r,sidebarWidths:e(rC),gap:d}):null})}}),r1=(0,eo.atom)(null,function(e,n,t){if(!e(tt)){var r=e(rX);if(!r)return void n(rc,null);var i=t.delta,a=r.paneGroupId,o=r.fromRect,s=e(nx),l=eG(e(nx),a);if(!l){var u=Error("Expected paneGroup");throw n(nE,{error:u,origin:"Layout: state/paneGroupDragAndDrop/dragUpdateAtom"}),u}var c=l.panes[l.activeIndex],d=eM(s,c);if(!d){var p=Error("Expected pane");throw n(nE,{error:p,tags:{layoutstate:!0},origin:"Layout: state/paneGroupDragAndDrop/dragUpdateAtom"}),p}var f=e6(c),h=nt(d.paneGroup.id),g=e(nr),m=Math.max(Math.abs(i.x),Math.abs(i.y)),v=m>=50,x=m>0;if(v&&!d.floating){var y=e(f).rectAtom,w=e(y),b=(0,e0.produce)(s,function(e){try{eX(e,{paneGroupPath:d.paneGroupPath,rect:{x:w.x+i.x,y:w.y-g+i.y,width:w.width,height:w.height+g}})}catch(e){throw n(nE,{error:e,tags:{layoutstate:!0},origin:"Layout: state/paneGroupDragAndDrop/dragUpdateAtom"}),e}});n(tT,{headers:new Map(e(e4).filter(function(e){return e!==d.paneGroup.id}).map(function(e){return[e,{snappiness:400}]})),panes:new Map(e(e1).filter(function(e){return e!==c}).map(function(e){return[e,{snappiness:400}]}))}),n(n$,b),n(r4,t.mouse);return}var _=e(h),j=e(f);l.id===e(tb.modalPaneGroupIdAtom)&&n(tb.modalPaneGroupIdAtom,null);var S="floating"===r.startType?ez({x:o.x+i.x,y:o.y+i.y,width:o.width,height:o.height},{inside:e(ni),minVisibleX:2*g,minVisibleY:g}):{x:o.x+i.x,y:o.y+i.y},I=S.x,C=S.y;if(n(_.rectAtom,function(e){return(0,e0.produce)(e,function(e){e.x=I,e.y=C})}),n(j.rectAtom,function(e){return(0,e0.produce)(e,function(e){e.x=I,e.y=C+g})}),!v&&!d.floating){var k=r.startPoint,E=1-.7*(1-Math.sqrt(1-Math.pow(m/50,2)));n(rc,{type:"detachPreview",rect:{x:k.x-50,y:k.y-50,width:100,height:100},progress:m/50}),n(rX,(0,e0.produce)(r,function(e){e.scale=E,e.movedAtAll=e.movedAtAll||x}));return}var T=e(nB);if(r.dropPoints)return void n(rX,function(n){return(0,e0.produce)(n,function(n){(null==n?void 0:n.dropPoints)&&function(e,n){var t=n.container,r=n.gap,i=n.sidebarWidths,a=n.headerHeight,o=n.paneRects,s=n.mouse,l={x:s.x-t.x,y:s.y-t.y},u=null,c=null;if(o.length){var d=!0,p=!1,f=void 0;try{for(var h,g=o[Symbol.iterator]();!(d=(h=g.next()).done);d=!0){var m=(0,U._)(h.value,2),v=m[0],x=m[1],y={x:x.x-r/2,y:x.y-r/2-a,width:x.width+r,height:x.height+r+a};if(nR(s,y)){u=v,c=x;break}}}catch(e){p=!0,f=e}finally{try{d||null==g.return||g.return()}finally{if(p)throw f}}if(e.middle.visible=!!c,c){var w={width:Math.min(100,c.width),height:Math.min(100,c.height)};e.middle.paneId=u,e.middle.rect={x:c.x+c.width/2-w.width/2,y:c.y-a+(c.height+a)/2-w.height/2-r,width:w.width,height:w.height+a/2}}}else{var b={x:t.x+i.left+r,y:t.y,width:t.width-r-i.left-i.right-r,height:t.height},_={width:Math.min(100,b.width),height:Math.min(100,b.height)};e.middle.rect={x:b.x+b.width/2-_.width/2,y:b.height/2-_.height/2,width:_.width,height:_.height},e.middle.visible=!0}var j=null,S=!0,I=!1,C=void 0;try{for(var k,E=rY[Symbol.iterator]();!(S=(k=E.next()).done);S=!0){var T=k.value,P=e[T].rect;if(nR(l,P)){j=T;break}}}catch(e){I=!0,C=e}finally{try{S||null==E.return||E.return()}finally{if(I)throw C}}var R=!0,A=!1,D=void 0;try{for(var V,O=rY[Symbol.iterator]();!(R=(V=O.next()).done);R=!0){var F=V.value;e[F].visible=!j||F===j}}catch(e){A=!0,D=e}finally{try{R||null==O.return||O.return()}finally{if(A)throw D}}}(n.dropPoints,{paneRects:e(r2),container:e(ni),sidebarWidths:e(rC),headerHeight:e(nr),gap:T,mouse:t.mouse})})});if(!d.floating)throw Error("Expected floating pane");n(r4,t.mouse)}}),r2=(0,eo.atom)(function(e){return e(e5).filter(function(e){return"tile"===e.type&&!e.isHidden}).map(function(n){return[n.paneId,e(n.rectAtom)]})}),r4=(0,eo.atom)(null,function(e,n,t){var r=e(nr),i=e(ni),a=e(r2),o=e(nB),s=function(e){var n=e.views,t=e.mouse,r=e.container,i=e.headerHeight,a=e.sidebarWidths,o=e.gap,s={x:Math.min(Math.max(t.x-r.x,1),r.width-1),y:Math.min(Math.max(t.y-r.y,1),r.height-1)},l=!0,u=!1,c=void 0;try{for(var d,p=n[Symbol.iterator]();!(l=(d=p.next()).done);l=!0){var f=(0,U._)(d.value,2),h=f[0],g=f[1],m={x:g.x,y:g.y-i,width:g.width,height:i},v={x:m.x-o/2,y:m.y-o/2,width:m.width+o,height:i+o/2};if(nR(s,v))return{dropPreview:m,drop:{type:"insert",paneId:h}};var x={x:g.x,y:g.y-i,width:g.width,height:g.height+i},y={x:x.x-o/2,y:x.y-o/2,width:x.width+o,height:x.height+o};if(nR(s,y)){var w=nA(s,x);return{dropPreview:w.rect,drop:{type:"split",relativeTo:h,placement:w.placement}}}}}catch(e){u=!0,c=e}finally{try{l||null==p.return||p.return()}finally{if(u)throw c}}var b=nA(s,{x:a.left,y:0,width:r.width-a.left-a.right,height:r.height});return{dropPreview:b.rect,drop:{type:"split",relativeTo:["tiling"],placement:b.placement}}}({views:a,container:i,mouse:t,headerHeight:r,sidebarWidths:e(rC),gap:o}),l=s.drop;n(rc,{type:"dropPreview",rect:s.dropPreview}),n(rX,function(e){return(0,e0.produce)(e,function(e){e&&(e.drop=l,e.movedAtAll=!0)})})}),r8=(0,eo.atom)(null,function(e,n,t){var r=t.delta;if(!e(tt)){n(rc,null);var i=e(rX);if(i){var a=i.paneGroupId,o=i.drop,s=i.fromRect,l=e(nx),u=eG(e(nx),a);if(!u){var c=Error("Expected paneGroup");throw n(nE,{error:c,origin:"Layout: state/paneGroupDragAndDrop/dragEndAtom"}),c}var d=u.panes[u.activeIndex],p=eM(l,d);if(!p){var f=Error("Expected pane");throw n(nE,{error:f,tags:{layoutstate:!0},origin:"Layout: state/paneGroupDragAndDrop/dragEndAtom"}),f}var h=(0,e0.produce)(l,function(t){if(!o&&p.floating&&"floating"===i.startType){var a=eF(t,p.paneGroupPath);if((null==a?void 0:a.type)!=="floatingPaneGroup")return;var l=e(nr),u=ez({x:s.x+r.x,y:s.y+r.y,width:s.width,height:s.height},{inside:e(ni),minVisibleX:2*l,minVisibleY:l}),c=u.x,f=u.y;a.rect.x=c,a.rect.y=f;return}if(o){if(p.paneGroup.panes.forEach(function(e){n(nl,e)}),"split"===o.type){if(null===t.tiling){var h=(0,nX.v4)();try{eH(t,{id:(0,nX.v4)(),panes:[h],placement:"leftOf",relativeTo:["tiling"]})}catch(e){throw n(nE,{error:e,tags:{layoutstate:!0},origin:"Layout: state/paneGroupDragAndDrop/dragEndAtom"}),e}}try{!function(e,n){var t=n.from,r=n.to,i=n.placement,a=eM(e,t);if(!a)throw Error("Expected fromPane");var o=a.paneGroup,s=o.panes,l=o.activeIndex;eY(e,a.paneGroupPath),eH(e,{id:a.paneGroup.id,relativeTo:r,panes:s,placement:i,activeIndex:l})}(t,{from:d,to:o.relativeTo,placement:o.placement})}catch(e){throw n(nE,{error:e,tags:{layoutstate:!0},origin:"Layout: state/paneGroupDragAndDrop/dragEndAtom"}),e}return}var g=eM(t,o.paneId);p.paneGroup.panes.forEach(function(e){eJ(t,{paneId:e,paneGroupPath:(null==g?void 0:g.paneGroupPath)||["tiling"],activate:!1})})}});n(rX,null),n(n$,h),(null==o?void 0:o.type)==="insert"&&n(tH,d)}}}),r3=(0,eo.atom)(function(e){var n=e(nU);switch(n.type){case"sidebar":return 0===n.width;case"centered":return!1}}),r6=(0,eo.atom)(function(e){var n=e(nU);switch(n.type){case"sidebar":return e(r3)?"collapsed":"sidebar";case"centered":return n.type}}),r5=(0,eo.atom)(function(e){var n=e(nU),t=e(nr),r=e(ni),i=e(nG),a=t+e(nB),o=r.height-a;switch(n.type){case"sidebar":var s=e(nB),l={width:n.width,height:o,y:a};switch(i){case"filetree-agent":return(0,v._)({x:r.width-n.width-s},l);case"agent-filetree":return(0,v._)({x:0===n.width?0:s},l);default:return{x:0,y:0,width:0,height:0}}case"centered":return{x:0,y:a,width:r.width,height:o}}});function r9(e){var n=e.rect,t=e.insets,r=e.agentFiltreeOrder,i=e.gap,a=e.paneGroupId,o=e.topLeftPaneGroup,s=e.topRightPaneGroup,l=e.sidebar,u=e.agent,c=e.agentRect,d=e.container,p=n.x,f=n.width;if(t.left>0&&(null==o?void 0:o.id)===a&&(p=t.left,"filetree-agent"===r?l.isOpen&&l.x+l.width+i>=t.left&&(p=n.x):"agent-filetree"===r&&(null==u?void 0:u.type)==="sidebar"&&c.x+c.width>t.left&&(p=n.x),f=n.width-(p-n.x)),t.right>0&&(null==s?void 0:s.id)===a){if("agent-filetree"===r){var h=d.width-(l.x+l.width),g=l.isOpen?h+l.width+i:0;g<=t.right&&(f-=t.right-(g-i))}else if("filetree-agent"===r&&(null==u?void 0:u.type)==="sidebar"){var m=u.width+i+i;m<=t.right&&(f-=t.right-m)}}return{x:p,width:f}}var r7=(0,eo.atom)({left:0,right:0}),ie=(0,eo.atom)(null,function(e,n,t,r){n(r7,function(e){return(0,r$._)((0,v._)({},e),(0,E._)({},t,r))}),n(n$,e(nx))}),it=(0,eo.atom)(function(e){var n,t,r=e(nx),i=e(ta),a={topLeft:null==(n=eL(r,"topLeft"))?void 0:n.paneGroup,topRight:null==(t=eL(r,"topRight"))?void 0:t.paneGroup};if(!a.topLeft||!a.topRight)return{left:0,right:0,leftPaneWidth:0,rightPaneWidth:0};if(i===a.topLeft||i===a.topRight){var o=e(td).width;return{left:o,right:o,leftPaneWidth:o,rightPaneWidth:o}}var s={left:e(nt(a.topLeft.id)),right:e(nt(a.topRight.id))},l={left:e(s.left.rectAtom),right:e(s.right.rectAtom)},u={insets:e(r7),agentFiltreeOrder:e(nG),gap:e(nB),topLeftPaneGroup:a.topLeft,topRightPaneGroup:a.topRight,sidebar:e(rS),agent:e(nU),agentRect:e(r5),container:e(ni)},c={left:r9((0,r$._)((0,v._)({},u),{rect:l.left,paneGroupId:a.topLeft.id})),right:r9((0,r$._)((0,v._)({},u),{rect:l.right,paneGroupId:a.topRight.id}))};return{leftPaneWidth:l.left.width,left:c.left.width,rightPaneWidth:l.right.width,right:c.right.width}});function ir(e){var n=il(e);return(0,J.default)(function(){return(0,eo.atom)(function(t){if(t(n))return t(tc);var r,i,a=t(nx),o=t(nt(e)),s=t(o.rectAtom),l={topLeft:null==(r=eL(a,"topLeft"))?void 0:r.paneGroup,topRight:null==(i=eL(a,"topRight"))?void 0:i.paneGroup},u=t(nB),c=r9({rect:s,insets:t(r7),agentFiltreeOrder:t(nG),gap:u,paneGroupId:e,topLeftPaneGroup:l.topLeft||null,topRightPaneGroup:l.topRight||null,sidebar:t(rS),agent:t(nU),agentRect:t(r5),container:t(ni)});if("floating"===o.path[0]){var d=s.y-u,p=s.height+u+1;return(0,r$._)((0,v._)({},s,c),{y:d,height:p})}return(0,v._)({},s,c)})},[n,e])}function ii(e){var n=ia(e),t=ir(e);return(0,J.default)(function(){var r=(0,eo.atom)(function(r){var i,a,o,s=r(t),l=r(n)||(null==(o=r(tk))||null==(a=o.headers)||null==(i=a.get(e))?void 0:i.dropState)?"transform":"top-left";return{x:s.x,y:s.y,positioning:l}});return(0,eg.selectAtom)(r,function(e){return e},nc.default)},[n,e,t])}function ia(e){return(0,J.default)(function(){return(0,eo.atom)(function(n){var t=n(rX);return t&&e===t.paneGroupId?t:null})},[e])}function io(e){var n=ia(e);return(0,J.default)(function(){return(0,eg.selectAtom)(n,function(e){var n;return null!=(n=null==e?void 0:e.scale)?n:1})},[n])}function is(e){return(0,J.default)(function(){return(0,eg.selectAtom)(nx,function(n){return eG(n,e)})},[e])}function il(e){var n=is(e);return(0,J.default)(function(){return(0,eo.atom)(function(e){if(e(n2))return!0;if(!e(tt))return!1;var t=e(n);if(!t)return!1;var r=e(no);return!!r&&t.panes.includes(r)})},[n])}function iu(e){var n=nt(e);return(0,J.default)(function(){return(0,eg.selectAtom)(n,function(e){return"floating"===e.path[0]})},[n])}var ic=e.i(205104),id=e.i(780671),ip=(0,eo.atom)(null,function(e,n,t){var r,i=t.path,a=e(nx),o=(0,v._)({},t);if(!o.opener){var s=e(rO),l=(0,id.getFileExtension)(i);if(l){var u=s[l];if(u){var c=e(nj).find(function(e){return e.extension.extensionId===u.extensionId});c&&(o.opener={paneType:"extension",extensionFileHandler:c,supports:function(){return!0}})}}}if(o.newPane)return void n(tS,{pane:ih(o),edge:null!=(r=o.newPaneEdge)?r:"left"});var d=eL(a,"topLeft");if(!d)return void n(ty,{pane:ih(o),relativeTo:["tiling"],placement:"replace"});var p=e(e5).find(function(n){var t,r=e(n.dataAtom);return(0,na.isFilePane)(r)?i===(0,na.getFilePathForPane)(r):!!((null==(t=o.opener)?void 0:t.paneType)==="extension"&&(0,na.isExtensionPane)(r))&&r.data.filePath===i&&o.opener.extensionFileHandler.extension.installationId===r.data.installationId||"markdown"===r.type&&i===r.data.path});if(p&&!o.newTab){var f=e(p.dataAtom);if((0,na.isFilePane)(f)||"markdown"===f.type){n(tH,p.paneId),n(tB,{paneId:p.paneId,pane:ih((0,v._)({opener:{paneType:f.type}},o))});return}if((0,na.isExtensionPane)(f))return void n(tH,p.paneId)}var h=d.paneGroup,g=eL(a,"topRight");if(g&&(h=g.paneGroup),o.newTab)return void n(tG,{panes:[ih(o)],paneGroupId:h.id,activate:!0,commit:!0,index:h.activeIndex+1});var m=e(e5).find(function(n){return!n.isCommitted&&((0,na.isFilePane)(e(n.dataAtom))||"markdown"===e(n.dataAtom).type)});if(m){n(tB,{paneId:m.paneId,pane:ih(o)}),n(tH,m.paneId);return}var x=e(ny).find(function(n){var t=e(n.dataAtom);return"codeEditor"===t.type&&""===(0,na.getFilePathForPane)(t)});if(x){n(tB,{paneId:x.paneId,pane:ih(o)}),n(tH,x.paneId);return}var y=h.panes.find(function(n){var t=e(e6(n));return"commands"===e(t.dataAtom).type});if(y){n(tB,{paneId:y,pane:ih(o)}),n(e6(y),function(e){return(0,e0.produce)(e,function(e){e.isCommitted=!1})}),n(tH,y);return}n(tG,{panes:[ih(o)],paneGroupId:h.id,activate:!0})});function ih(e){var n=e.path,t=e.col,r=e.line,i=e.opener;if(!(null==i?void 0:i.paneType)&&(0,ic.isMarkdownFile)(n.toLowerCase()))return{type:"markdown",data:{path:n}};if(!(null==i?void 0:i.paneType)&&(0,ic.isCsvFile)(n.toLowerCase()))return{type:"csvPreview",data:{path:n}};var a=(null==i?void 0:i.paneType)||(0,na.getPaneTypeForFile)({path:n});if("codeEditor"===a)return{type:"codeEditor",data:{path:n,col:t,line:r}};if("extension"===a){var o=i.extensionFileHandler;return{type:"extension",data:{filePath:n,extensionId:o.extension.extensionId,installationId:o.extension.installationId,name:o.extension.manifest.name,baseUrl:o.extension.baseUrl,path:o.handler}}}return"markdown"===a?{type:"markdown",data:{path:n}}:{type:a,data:{path:n}}}var ig=(0,eo.atom)(null,function(e,n,t){var r=t.paths.map(function(e){var n=e.match(/(.+?)(:(\d+))?(:(\d+))?$/);if(!n)return!1;var t=[n[1],void 0!==n[3]&&parseInt(n[3],10),void 0!==n[5]&&parseInt(n[5],10)],r=t[0],i=t[1],a=t[2];return{type:(0,na.getPaneTypeForFile)({path:r}),data:{path:r,line:i,col:a}}}).filter(Boolean),i=r.length-1,a=e(no);r.forEach(function(e,t){return(0,ei._)(function(){return(0,ea._)(this,function(r){return n(tU,{pane:e,activate:i===t,placement:{type:"secondary",relativeTo:a}}),[2]})})()})}),im=(0,eo.atom)(null,function(e,n,t){var r=t.urls.map(function(e){var n;try{n=new URL(e)}catch(e){return!1}return"0.0.0.0"===n.hostname||"localhost"===n.hostname?{ports:{type:"local",path:n.pathname,port:parseInt(n.port,10)}}:(window.open(e,"_blank"),!1)}).filter(Boolean);if(0!==r.length){var i=!0,a=!1,o=void 0;try{for(var s,l=r[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value;n(tK,u)}}catch(e){a=!0,o=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw o}}}}),iv=(0,eo.atom)(null,function(e,n,t){if(!e(tt)){var r=e(ni),i=t.pageX,a=t.pageY,o=e(e6(t.over)),s=eP({x:i-r.x,y:a-r.y},e(o.rectAtom)).previewRect;n(tY,!0),n(rc,{type:"dropPreview",rect:s})}}),ix=(0,eo.atom)(null,function(e,n,t){if(!e(tt)){var r=e(ni),i=t.pageX,a=t.pageY,o=t.over,s=e(e6(o)),l=eP({x:i-r.x,y:a-r.y},e(s.rectAtom)).dropLocation;n(rc,null),n(tY,!1);var u=e(nx);if("newPaneGroup"===t.type){if("middle"===l){var c=eM(u,s.paneId);if(!c)return;n(tG,{panes:t.panes,paneGroupId:c.paneGroup.id,activate:!0,index:c.index+1});return}n(t_,{panes:t.panes,placement:l,makeActive:!0,relativeTo:s.paneId});return}var d=o;if("middle"===l){if(d===t.paneId)return;var p=eM(u,s.paneId);if(!p)return;n(t$,{paneId:t.paneId,toPaneGroupId:p.paneGroup.id,index:p.index+1});return}if(d===t.paneId){var f=eM(u,t.paneId);if(!f){var h=Error("Expected pane");throw n(nE,{error:h,tags:{layoutstate:!0},origin:"Layout: state/paneDragAndDrop/expectedPane"}),h}if(f.floating)throw Error("Expected paneGroup");var g=f.paneGroup.panes.find(function(e){return e!==t.paneId});if(!g)return;d=g}var m=(0,e0.produce)(u,function(e){try{eQ(e,t.paneId),eH(e,{id:(0,nX.v4)(),panes:[t.paneId],relativeTo:d,placement:l}),n(nl,t.paneId)}catch(e){throw n(nE,{error:e,tags:{layoutstate:!0},origin:"Layout: state/paneDragAndDrop/updatedLayout"}),e}});n(n$,m)}});function iy(e){var n=(0,J.default)(function(){return(0,eo.atom)(function(n){return!!n(n2)||!!n(tt)&&n(no)===e})},[e]);return(0,J.default)(function(){return(0,eo.atom)(function(t){if(t(n))return t(td);var r=t(e6(e));return t(r.rectAtom)})},[e,n])}function iw(e){return(0,J.default)(function(){return(0,eo.atom)(function(n){var t=n(rX);return t&&e===n(rJ)?t:null})},[e])}function ib(e){var n=iw(e);return(0,J.default)(function(){return(0,eg.selectAtom)(n,function(e){var n;return null!=(n=null==e?void 0:e.scale)?n:1})},[n])}function i_(e){return(0,J.default)(function(){return(0,eo.atom)(function(n){return n(n(e6(e)).dataAtom)})},[e])}function ij(e){return(0,J.default)(function(){return(0,eo.atom)(function(n){return!!n(nN)||n(e6(e)).isHidden})},[e])}function iS(e){return(0,J.default)(function(){return(0,eg.selectAtom)(e6(e),function(e){return"floating"===e.type})},[e])}var iI=(0,eo.atom)(null),iC=(0,eo.atom)(function(e){var n=e(iI);if(!n)return null;if("sidebar"===n.target)return{target:"sidebar"};var t=eM(e(nx),n.paneId);if(!t)return null;var r=t.paneGroup;return{target:"pane",paneGroupId:r.id,activeIndex:r.activeIndex,panes:r.panes.map(function(n){var t=e(e6(n));return[t.paneId,e(t.dataAtom)]})}}),ik=(0,eo.atom)(function(e){var n=e(iC);if(!n)return null;if("sidebar"===n.target)return{target:"sidebar"};var t=n.paneGroupId,r=n.activeIndex;return{target:"pane",paneId:n.panes[r][0],paneGroupId:t}}),iE=(0,eo.atom)(function(e){var n=e(iI);if(!n||"sidebar"===n.target)return null;if(e(tr)===n.paneId)return e(td);var t=e(e6(n.paneId)),r=e(t.rectAtom),i=e(nr);return{x:Math.round(r.x),y:Math.round(r.y-i),width:Math.round(r.width),height:Math.round(r.height+i)}}),iT=(0,eo.atom)(null,function(e,n,t){var r=e(no),i=null!=t?t:r;if(i){n(iI,{target:"pane",paneId:i}),i!==r&&n(ns,i);return}var a=eL(e(nx),"topLeft"),o=a?a.paneGroup.panes[a.paneGroup.activeIndex]:null;if(o)return void n(iI,{target:"pane",paneId:o})}),iP=(0,eo.atom)(null,function(e,n){var t=e(iI);t&&(n(iI,null),"sidebar"!==t.target&&n(tC,{paneId:t.paneId,activate:!0}))}),iR=(0,eo.atom)(null,function(e,n){if(e(iC))return void n(iP);var t=e(no);if(t)return void n(iT,t);var r=eL(e(nx),"topLeft"),i=r?r.paneGroup.panes[r.paneGroup.activeIndex]:null;if(i)return void n(iT,i)}),iA=(0,eo.atom)(function(e){return null!==e(iI)}),iD=(0,eo.atom)(null,function(e,n){n(iI,null)}),iV=(0,eo.atom)(null,function(e,n,t){var r=e(no);if(!(!r||e(tr))){var i=eB({relativeTo:r,rects:new Map(e(e5).filter(function(e){return!e.isHidden}).map(function(n){return[n.paneId,e(n.rectAtom)]})),direction:t});i&&(n(no,i),e(iI)&&n(iI,{target:"pane",paneId:i}))}}),iO=(0,eo.atom)(null,function(e,n,t){var r=e(iC);null===r||"sidebar"!==r.target&&n(n$,(0,e0.produce)(e(nx),function(e){!function(e,n){var t=n.paneGroupId,r=n.direction,i=eG(e,t),a=eU(e,t);if((null==i?void 0:i.type)==="paneGroup"&&a){var o=a.node.children.indexOf(i);if(-1===o)throw Error("Expected index");var s=(0,er._)(a.path).concat([o]),l="down"===r||"right"===r,u=0===o,c=o===a.node.children.length-1,d=a.node.stacked===("up"===r||"down"===r),p=a.path.length>2;if(d&&!((c&&l||u&&!l)&&p))return function(e,n,t){var r=e.indexOf(n);if(-1===r)throw Error("Expected item to be in array");if(1!==e.length){var i=r===e.length-1;if("forward"===t&&i){e.pop(),e.unshift(n);return}if("back"===t&&0===r){e.shift(),e.push(n);return}var a="forward"===t?1:-1;e[r]=e[r+a],e[r+a]=n}}(a.node.children,i,l?"forward":"back");var f=(v=eU(e,i.id))?function e(n,t){var r=t.path,i=t.forwards,a=t.vertical,o=eF(n,r);if((null==o?void 0:o.type)!=="split")return null;var s=eA(r);if(0===s.length)return null;var l=eF(n,s);if((null==l?void 0:l.type)!=="split")return null;if(l.stacked!==a)return e(n,{path:s,forwards:i,vertical:a});var u=l.children.indexOf(o),c=0===u;if(!(u===l.children.length-1&&i||c&&!i)){var d=u+(i?1:-1),p=l.children[d],f=l.children[u];return p?{other:f,node:p,parent:l,path:(0,er._)(s).concat([d])}:null}if(1===s.length){var h=c&&!i?l.children.length-1:0;return{parent:l,other:l.children[u],path:(0,er._)(s).concat([h]),node:l.children[h]}}return e(n,{path:s,forwards:i,vertical:a})}(e,{path:v.path,forwards:"down"===r||"right"===r,vertical:"up"===r||"down"===r}):null;if(f){var h=s.slice(0,f.path.length+("paneGroup"===f.node.type?2:1));if("tiling"!==h[0])throw Error("Expected tiling path");var g=eF(e,h);if(!g||"floatingPaneGroup"===g.type)throw Error("Expected adjacentNode");if("split"!==f.other.type)throw Error("Expected split");var m=function(e,n){var t=e.indexOf(n),r=0,i=!0,a=!1,o=void 0;try{for(var s,l=e.slice(0,t)[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value.percent;r+=u}}catch(e){a=!0,o=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw o}}return{start:r,end:r+n.percent}}(f.other.children,g);if("paneGroup"===f.node.type){var v,x,y,w=(x={start:0,end:100},y=!f.parent.stacked,m.start-x.start<x.end-m.end?y?"above":"rightOf":y?"below":"leftOf");eY(e,(0,er._)(a.path).concat([o])),eH(e,{placement:w,id:i.id,panes:i.panes,activeIndex:i.activeIndex,percent:i.percent,relativeTo:f.path});return}var b=function(e,n){var t=e.children,r=e.stacked,i="above",a=0,o=0,s=0,l=0,u=!0,c=!1,d=void 0;try{for(var p,f=t[Symbol.iterator]();!(u=(p=f.next()).done);u=!0){var h=p.value,g={start:s,end:s+h.percent},m=Math.max(0,Math.min(n.end,g.end)-Math.max(n.start,g.start));m>l&&(l=m,a=o,i=n.start-g.start<g.end-n.end?r?"above":"rightOf":r?"below":"leftOf"),s+=h.percent,o++}}catch(e){c=!0,d=e}finally{try{u||null==f.return||f.return()}finally{if(c)throw d}}return{placement:i,index:a}}(f.node,m),_=b.index,j=b.placement;eY(e,(0,er._)(a.path).concat([o])),eH(e,{placement:j,id:i.id,panes:i.panes,activeIndex:i.activeIndex,percent:i.percent,relativeTo:(0,er._)(f.path).concat([_])})}}}(e,{paneGroupId:r.paneGroupId,direction:t.direction})}))}),iF={width:120,height:120},iM=(0,eo.atom)(null),iL=(0,eo.atom)(null,function(e,n,t){var r=e(nx);if("end"===t.type){n(iM,null),n(n$,r);return}if("update"===t.type){var i=e(iM);if(!i){var a=Error("Expected floatingResizeState");throw n(nE,{error:a,tags:{layoutstate:!0},origin:"Layout: state/resizeFloating"}),a}var o=e(nr),s=function(e,n){var t=n.edge,r=n.delta,i=n.minSize,a=void 0===i?eR:i,o=(0,v._)({},e),s=a.height,l=a.width;if("top"===t||"topLeft"===t||"topRight"===t){var u=e.height-r.y;o.height=Math.max(u,s),u<s?o.y=e.y+e.height-s:o.y=e.y+r.y}else("bottom"===t||"bottomLeft"===t||"bottomRight"===t)&&(o.height=Math.max(e.height+r.y,s));if("right"===t||"bottomRight"===t||"topRight"===t)o.width=Math.max(e.width+r.x,l);else if("left"===t||"bottomLeft"===t||"topLeft"===t){var c=e.width-r.x;o.width=Math.max(c,l),c<l?o.x=e.x+e.width-l:o.x=e.x+r.x}return o}(i.rectStart,{delta:t.moveDelta,edge:i.edge,minSize:iF}),l=i.paneId,u=(0,e0.produce)(r,function(e){var t=e.floating.find(function(e){return e.panes.includes(l)});if(!t){var r=Error("Expected floating");throw n(nE,{error:r,tags:{layoutstate:!0},origin:"Layout: state/resizeFloating"}),r}var i=t.rect;i.x=s.x,i.y=s.y-o,i.width=s.width,i.height=s.height+o});n(n$,u);return}var c=e(e5).find(function(e){return e.paneId===t.paneId});if(!c){var d=Error("Expected pane");throw n(nE,{error:d,tags:{layoutstate:!0},origin:"Layout: state/resizeFloating"}),d}n(ns,t.paneId),n(iM,{paneId:t.paneId,edge:t.edge,rectStart:e(c.rectAtom)})}),iG=(0,eo.atom)(null,function(e,n,t){n(tT,{headers:new Map(e(e4).map(function(e){return[e,{snappiness:400}]})),panes:new Map(e(e1).map(function(e){return[e,{snappiness:400}]}))}),n(np,function(e){return(0,e0.produce)(e,function(e){e.activeContent===t&&e.isOpen?e.isOpen=!1:(e.isOpen=!0,e.activeContent=t,0===e.width&&(e.width=180))})}),n(n$,e(nx))}),iU=(0,eo.atom)(null,function(e,n){n(tT,{headers:new Map(e(e4).map(function(e){return[e,{snappiness:400}]})),panes:new Map(e(e1).map(function(e){return[e,{snappiness:400}]}))}),n(np,function(e){return(0,e0.produce)(e,function(e){e.isOpen=!1})}),n(n$,e(nx))}),iN=(0,eo.atom)(null,function(e,n){var t=e(np);t.isOpen?n(iU):n(iG,t.activeContent)}),iB=(0,eo.atom)(null),iW=(0,eo.atom)(null,function(e,n){var t=e(np);n(iB,{startWidth:t.width,startIsOpen:t.isOpen})}),iz=(0,eo.atom)(function(e){return!!e(iB)}),iH=(0,eo.atom)(null,function(e,n,t){var r=e(iB);if(r){var i=t*("agent-filetree"===e(nG)?-1:1),a=.4*e(ni).width,o=Math.min(Math.max(r.startWidth+i,0),a),s=i>0;0===o&&s?o=140:!s&&o<140&&140-o>20&&(o=0),n(np,function(e){return(0,e0.produce)(e,function(e){e.width=o,0===o?e.isOpen=!1:e.isOpen=r.startIsOpen})}),r.startIsOpen&&n(n$,e(nx))}}),iq=(0,eo.atom)(null,function(e,n){var t=e(np),r=e(iB);t.isOpen||n(np,function(e){return(0,e0.produce)(e,function(e){var n;e.width=null!=(n=null==r?void 0:r.startWidth)?n:140})}),n(iB,null)}),iK=(0,eo.atom)(null,function(e,n,t){var r=e(nx),i=e(e6(t)),a=i.rectAtom,o=i.type,s=e(a),l=eM(r,t);if(!l){var u=Error("Expected pane");throw n(nE,{error:u,tags:{layoutstate:!0},origin:"Layout: state/toggleFloating"}),u}if("tile"===o)return void n(n$,(0,e0.produce)(r,function(e){eX(e,{paneGroupPath:l.paneGroupPath,rect:{x:s.x-16,y:s.y-16,width:s.width,height:s.height}})}));l.paneGroup.id===e(tb.modalPaneGroupIdAtom)&&n(tb.modalPaneGroupIdAtom,null);var c=e(e5).filter(function(e){return"tile"===e.type&&!e.isHidden}),d=e(nr),p={x:s.x+s.width/2,y:s.y+s.height/2},f=c.find(function(n){var t=e(n.rectAtom);return nR(p,{x:t.x,y:t.y-d,width:t.width,height:t.height+d})});f?(n(n$,(0,e0.produce)(r,function(e){var n=eM(e,f.paneId);l.paneGroup.panes.forEach(function(t){eJ(e,{paneId:t,paneGroupPath:(null==n?void 0:n.paneGroupPath)||["tiling"],activate:!1})})})),n(tH,l.paneGroup.panes[l.paneGroup.activeIndex])):n(n$,(0,e0.produce)(r,function(e){!function(e,n){var t=n.paneGroupPath,r=n.placement,i=n.to,a=eF(e,t);if((null==a?void 0:a.type)!=="floatingPaneGroup")throw Error("Expected floatingPaneGroup");if(eY(e,t),null===i){e.tiling={id:a.id,panes:a.panes,percent:100,type:"paneGroup",activeIndex:a.activeIndex};return}eH(e,{id:a.id,relativeTo:i,panes:a.panes,activeIndex:a.activeIndex,placement:r})}(e,{paneGroupPath:l.paneGroupPath,to:["tiling"],placement:"leftOf"})}))}),i$=(0,eo.atom)(null),iQ=(0,eo.atom)(function(e){var n=e(i$);return n&&e(e5).find(function(t){var r=e(t.dataAtom);return"videoPlayer"===r.type&&r.data.embedUrl===(null==n?void 0:n.embedUrl)})||null}),iY=(0,eo.atom)(function(e){var n=e(iQ);return n&&!n.isHidden?n:null}),iX=(0,eo.atom)(null,function(e,n,t){n(i$,t);var r,i="videoPlayer";t?n(rU,{type:i,data:{title:null!=(r=t.title)?r:"Tutorial",embedUrl:t.embedUrl}},{commit:!0,location:"center"}):n(rN,i)}),iJ=(0,eo.atom)(null,function(e,n){var t=e(iQ);if(null==t?void 0:t.isHidden){n(tH,t.paneId),n(nl,t.paneId);return}var r=e(i$);r&&n(iX,r)}),iZ=(0,eo.atom)(function(e){return e(e5).find(function(n){return"tutorial"===e(n.dataAtom).type})||null}),i0=(0,eo.atom)(null,function(e,n){var t=e(iZ);(null==t?void 0:t.isHidden)?n(tH,t.paneId):n(t_,{panes:[{type:"tutorial"}],placement:"leftOf",percent:25,relativeTo:["tiling"],makeActive:!1,commit:!0})}),i1=(0,eo.atom)(function(e){return!!(e(rX)||e(iM)||e(rB)||e(tY)||e(iz)||e(tA))}),i2=(0,eo.atom)(null,function(e,n,t){n(nL,t),n(n$,e(nx))}),i4=(0,eo.atom)(null,function(e,n,t){setTimeout(function(){n(i8,!1)},400),n(tM,t)}),i8=(0,eo.atom)(!1),i3=(0,eo.atom)(null,function(e,n,t){var r=e(nx),i=e(no)===t.to,a=(0,e0.produce)(r,function(e){try{eQ(e,t.from);var r=eM(e,t.to);r&&(eK(e,{paneIds:[t.from],activate:i,paneGroupId:r.paneGroup.id,index:r.index}),eQ(e,t.to))}catch(e){throw n(nE,{error:e,tags:{layoutstate:!0},origin:"Layout: state/removePane/removePaneAtom"}),e}});n(n$,a)}),i6=e.i(98816),i5=(0,eo.atom)(function(e){if(e(iA)||e(ed))return null;var n=e(no);if(!n)return null;var t=e(e6(n)),r=e(t.dataAtom),i=t.paneId+r.type;return(0,na.isFilePane)(r)&&(i+=r.data.path),i}),i9=e.i(613355),i7=e.i(998583),ae=e.i(221121),an=e.i(224996),at=e.i(918208),ar=e.i(149028),ai=(0,eo.atom)(null,function(e,n,t){if(null===t){n(rc,null),n(rX,function(e){return e?(0,e0.produce)(e,function(e){e.drop=null}):e});return}n(rX,function(e){return e?(0,e0.produce)(e,function(e){!function(e,n){if("edge"===n.type||"emptyLayout"===n.type){e.drop={type:"split",relativeTo:["tiling"],placement:"edge"===n.type?n.position:"replace"};return}var t=n.paneId;if("middle"===n.position){e.drop={type:"insert",paneId:t};return}e.drop={type:"split",relativeTo:t,placement:n.position}}(e,t)}):e});var r=e(ni),i=e(nr),a=e(ng),o=e(nB);if("pane"===t.type){var s=e(e6(t.paneId)),l=e(s.rectAtom);n(rc,{type:"dropPreview",rect:{x:l.x,y:l.y-i,width:l.width,height:l.height+i}});return}"emptyLayout"===t.type?n(rc,{type:"dropPreview",rect:function(e){var n=e.container,t=e.sidebarWidth,r=e.gap,i=e.location,a={x:t+r,y:0,width:n.width-t-2*r,height:n.height-r},o=a.x,s=a.y,l=a.width,u=a.height;switch(i){case"middle":return a;case"leftOf":return{x:o,y:s,width:l/2,height:u};case"rightOf":return{x:o+l/2,y:s,width:l/2,height:u};case"above":return{x:o,y:s,width:l,height:u/2};case"below":return{x:o,y:s+u/2,width:l,height:u/2}}}({container:r,sidebarWidth:a,location:t.position,gap:o})}):n(rc,{type:"dropPreview",rect:function(e,n){var t=n.container,r=n.sidebarWidth,i=n.position,a=n.gap,o={x:r+a,y:0,width:t.width-r-2*a,height:t.height-a};if((null==e?void 0:e.type)!=="split"){switch(i){case"above":case"below":o.height=o.height/2,"below"===i&&(o.y+=o.height);break;case"rightOf":case"leftOf":o.width=o.width/2,"rightOf"===i&&(o.x+=o.width)}return o}if(e.stacked){switch(i){case"above":o.height=o.height*(e.children[0].percent/100)/2;break;case"below":o.height=o.height*(e.children[e.children.length-1].percent/100)/2,o.y=t.height-o.height;break;case"leftOf":o.width=o.width/2;break;case"rightOf":o.width=o.width/2,o.x=t.width-o.width-a}return o}switch(i){case"above":o.height=o.height/2;break;case"below":o.height=o.height/2,o.y=t.height-o.height-a;break;case"leftOf":o.width=o.width*(e.children[0].percent/100)/2;break;case"rightOf":o.width=o.width*(e.children[e.children.length-1].percent/100)/2,o.x=t.width-o.width}return o}(e(nx).tiling,{container:r,sidebarWidth:a,position:t.position,gap:o})})}),aa=(0,ru.createCssVarTokens)(["opacity","width","height","transform","pointerEvents"]),ao=aa.cssVars,as=aa.styleTokens,al=(0,rl.cssRecord)({dropPoint:[i9.rcss.center,i9.rcss.top(0),i9.rcss.left(0),i9.rcss.position.absolute,{zIndex:rs.zIndexLevels.overlay,cursor:"grabbing",width:as.width,height:as.height,transform:as.transform,opacity:"var(".concat(ao.opacity,", 0)"),pointerEvents:as.pointerEvents,transition:"opacity 200ms ease-out 200ms","&:hover":{color:P.tokens.accentPrimaryStronger}}]}),au={above:(0,g.jsx)(ar.default,{}),below:(0,g.jsx)(ae.default,{}),leftOf:(0,g.jsx)(an.default,{}),rightOf:(0,g.jsx)(at.default,{}),middle:(0,g.jsx)(i7.default,{})};function ac(e){var n=(0,N.useRef)(null),t=(0,N.useMemo)(function(){return(0,eg.selectAtom)(rZ,function(n){return null==n?void 0:n[e]})},[e]),r=(0,N.useMemo)(function(){return(0,eg.selectAtom)(t,function(e){return e?(0,E._)({},ao.transform,"translate(".concat(e.rect.x,"px, ").concat(e.rect.y,"px)")):null},nc.default)},[t]);(0,nQ.useStyleSet)(n,ri(r));var i=(0,N.useMemo)(function(){return(0,eg.selectAtom)(t,function(e){var n;return e?(n={},(0,E._)(n,ao.width,e.rect.width+"px"),(0,E._)(n,ao.height,e.rect.height+"px"),n):null},nc.default)},[t]);(0,nQ.useStyleSet)(n,ri(i));var a=(0,N.useMemo)(function(){return(0,eg.selectAtom)(t,function(e){var n;return n={},(0,E._)(n,ao.opacity,(null==e?void 0:e.visible)?"1":"0"),(0,E._)(n,ao.pointerEvents,(null==e?void 0:e.visible)?"all":"none"),n},nc.default)},[t]);return(0,nQ.useStyleSet)(n,ri(a)),n}function ad(){var e=ac("middle"),n=ra(ai),t=ro((0,N.useMemo)(function(){return(0,eg.selectAtom)(rZ,function(e){var n;return null!=(n=null==e?void 0:e.middle.paneId)?n:null})},[]));return(0,g.jsx)(D.View,{css:al.dropPoint,innerRef:e,onMouseEnter:function(){var e=t(),r="middle";n(e?{type:"pane",position:r,paneId:e}:{type:"emptyLayout",position:r})},onMouseLeave:function(){return n(null)},children:(0,g.jsx)(i7.default,{size:32})})}function ap(e){var n=e.position,t=ac(n),r=ra(ai);return(0,g.jsx)(D.View,{css:al.dropPoint,innerRef:t,onMouseEnter:function(){return r({type:"edge",position:n})},onMouseLeave:function(){return r(null)},children:(0,N.cloneElement)(au[n],{size:32})})}var af=(0,N.memo)(function(){return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(ap,{position:"above"}),(0,g.jsx)(ap,{position:"below"}),(0,g.jsx)(ap,{position:"leftOf"}),(0,g.jsx)(ap,{position:"rightOf"}),(0,g.jsx)(ad,{})]})}),ah=(0,eo.atom)(null);function ag(e){return rr((0,J.default)(function(){return(0,eo.atom)(function(n){var t=n(e6(e));return n(t.dataAtom)})},[e]))}function am(){var e=rt();return(0,N.useCallback)(function(n){var t=e.get(e6(n));return{pane:e.get(t.dataAtom),isCommitted:t.isCommitted}},[e])}function av(){var e=ra(ns),n=ra(nl);return(0,J.default)(function(){return function(t,r){(null==r?void 0:r.commit)&&n(t),e(t)}},[n,e])}function ax(){return ra(t6)}var ay=(0,eo.atom)(null,function(e,n){n(tY,!1)});function aw(){return ra(ip)}function ab(){return{maximizePane:ra(ti),maximizePaneGroup:ra(ta),restoreMaximizedPaneGroup:ra(to),toggleMaximizePane:ra(ts),toggleMaximizedPaneGroup:ra(tl)}}function a_(e){var n,t,r=(n=nt(e),{activeIndexAtom:(0,J.default)(function(){return(0,eo.atom)(function(e){return e(n).activeIndex})},[n]),pathAtom:(0,J.default)(function(){return(0,eg.selectAtom)(n,function(e){return e.path},nc.default)},[n]),panesAtom:(0,J.default)(function(){return(0,eg.selectAtom)(n,function(e){return e.panes},nc.default)},[n]),activeFileAtom:(0,J.default)(function(){return(0,eo.atom)(function(e){var t=e(n),r=e(e6(t.panes[t.activeIndex])),i=e(r.dataAtom);return(0,na.isFilePane)(i)?(0,na.getFilePathForPane)(i):null})},[n])}),i=r.activeIndexAtom,a=r.pathAtom,o=r.panesAtom;return{activeIndex:ri(i),path:ri(a),panes:ri(o),activeTabPaneId:ri((t=nt(e),(0,J.default)(function(){return(0,eo.atom)(function(e){var n=e(t);return e(e6(n.panes[n.activeIndex])).paneId})},[t])))}}function aj(e){var n,t,r,i,a,o,s,l,u,c,d=iy(e),p=nV(d),f=nO(d),h=ib(e),g=(n=iw(e),(0,J.default)(function(){return(0,eo.atom)(function(t){var r,i,a,o,s,l=t(n);if(l)return null!=(o=l.transformOriginX)?o:"0px";var u=null==(a=t(tk))||null==(i=a.panes)||null==(r=i.get(e))?void 0:r.dropState;return null!=(s=null==u?void 0:u.transformOrginX)?s:"0x"})},[n,e])),m=(t=iy(e),(0,J.default)(function(){return(0,eo.atom)(function(e){var n=e(t),r=e(ni);return{x:Math.round(r.x+n.x),y:Math.round(r.y+n.y)}})},[t])),x=ij(e),y=(0,J.default)(function(){return(0,eo.atom)(function(n){var t,r,i,a=n(e6(e));if(a.isHidden)return rs.zIndexLevels.hiddenPane;var o=e===n(no);return n(tr)===e?rs.zIndexLevels.maximizedPane:e===n(rJ)||(null==(i=n(tk))||null==(r=i.panes)||null==(t=r.get(e))?void 0:t.dropState)?rs.zIndexLevels.draggingPane:"floating"===a.type?o?rs.zIndexLevels.floatingPaneActive:rs.zIndexLevels.floatingPane:o?rs.zIndexLevels.tiledPaneActive:rs.zIndexLevels.tiledPane})},[e]),w=(0,J.default)(function(){return(0,eo.atom)(function(n){var t,r,i=n(tk);return null!=(r=null==i||null==(t=i.panes)?void 0:t.get(e))&&r})},[e]),b=(r=i_(e),(0,J.default)(function(){return(0,eg.selectAtom)(r,function(e){return e.type})},[r])),_=iS(e),j=(0,J.default)(function(){return(0,eo.atom)(function(n){var t,r=null==(t=eM(n(nx),e))?void 0:t.paneGroup;return!!r&&r.id===n(tb.modalPaneGroupIdAtom)})},[e]),S=(0,J.default)(function(){return(0,eo.atom)(function(n){return n(no)===e})},[e]),I=(0,J.default)(function(){return(0,eo.atom)(function(n){return n(no)===e})},[e]),C=(0,J.default)(function(){return(0,eg.selectAtom)(e6(e),function(e){return e.isCommitted})},[e]),k=i_(e),E=(i=iS(e),a=iw(e),(0,J.default)(function(){return(0,eo.atom)(function(e){return e(tt)?null:e(a)?"dragging":e(i)?"floating":"tiled"})},[i,a])),T=(o=iw(e),(0,J.default)(function(){return(0,eo.atom)(function(n){var t,r,i;return!!n(o)||!!(null==(i=n(tk))||null==(r=i.panes)||null==(t=r.get(e))?void 0:t.dropState)})},[o,e])),P=(s=iw(e),(0,J.default)(function(){return(0,eg.selectAtom)(s,function(e){var n;return null!=(n=null==e?void 0:e.movedAtAll)&&n})},[s])),R=(0,J.default)(function(){return(0,eo.atom)(function(n){if((null==(t=n(nx).tiling)?void 0:t.type)!=="paneGroup")return!1;var t,r,i=null==(r=eM(n(nx),e))?void 0:r.paneGroup;return!!i&&1===i.panes.length})},[e]),A=(l=iy(e),u=ib(e),c=ij(e),(0,J.default)(function(){return(0,eo.atom)(function(e){var n=e(c);return(0,r$._)((0,v._)({},e(l)),{scale:e(u),opacity:+!n})})},[l,u,c])),D=(0,J.default)(function(){return(0,eo.atom)(function(n){return n(tr)===e})},[e]);return{properties:ri(A),size:ri(p),position:ri(f),scale:ri(h),paneType:ri(b),transformOriginXAtom:ri(g),viewportInset:ri(m),zIndex:ri(y),disableInteractions:ri(i1),getTransitionEnabled:ro(w),data:ri(k),isFloating:ri(_),isModal:ri(j),isActive:ri(S),isActivePane:ri(I),isCommitted:ri(C),isHidden:ri(x),isBeingDragged:ri(T),hasMovedWhileDragging:ri(P),headerHeight:ri(nr),border:ri(E),isOnlyPane:ri(R),isMaximized:ri(D)}}function aS(e){var n,t,r,i,a,o,s,l,u,c=nV(ir(e)),d=ii(e),p=io(e),f=(t=ia(e),(0,J.default)(function(){return(0,eo.atom)(function(n){var r,i,a,o,s,l=n(t);if(l)return null!=(o=l.transformOriginX)?o:"0px";var u=null==(a=n(tk))||null==(i=a.headers)||null==(r=i.get(e))?void 0:r.dropState;return null!=(s=null==u?void 0:u.transformOrginX)?s:"0x"})},[t,e])),h=(r=ia(e),i=il(e),a=iu(e),n=is(e),o=(0,J.default)(function(){return(0,eo.atom)(function(e){var t=e(no);if(!t)return!1;var r=e(n);return!!r&&r.panes.includes(t)})},[n]),(0,J.default)(function(){return(0,eo.atom)(function(n){var t,s,l;return n(i)?rs.zIndexLevels.maximizedHeader:n(r)||(null==(l=n(tk))||null==(s=l.headers)||null==(t=s.get(e))?void 0:t.dropState)?rs.zIndexLevels.draggingHeader:n(a)?n(o)?rs.zIndexLevels.floatingHeaderActive:rs.zIndexLevels.floatingHeader:rs.zIndexLevels.tiledHeader})},[r,i,a,o,e])),g=(0,J.default)(function(){return(0,eo.atom)(function(n){var t,r,i=n(tk);return null!=(r=null==i||null==(t=i.headers)?void 0:t.get(e))&&r})},[e]),m=il(e),x=iu(e),y=(0,J.default)(function(){return(0,eo.atom)(function(n){return n(tb.modalPaneGroupIdAtom)===e})},[e]),w=(0,J.default)(function(){return(0,eo.atom)(function(n){var t;return(null==(t=n(rX))?void 0:t.paneGroupId)===e})},[e]);return{properties:ri((s=ir(e),l=io(e),u=ii(e),(0,J.default)(function(){return(0,eo.atom)(function(e){var n=e(nN);return(0,r$._)((0,v._)({},e(s)),{scale:e(l),positioning:e(u).positioning,opacity:+!n})})},[s,l,u]))),size:ri(c),position:ri(d),scale:ri(p),transformOriginX:ri(f),zIndex:ri(h),getTransitionEnabled:ro(g),isMaximized:ri(m),isFloating:ri(x),isModal:ri(y),isBeingDragged:ri(w)}}function aI(){return{view:ri(rS),resizeHandleView:ri(rI),isOpen:ri(nf),activeContent:ri(nh),toggle:ra(iN),toggleContent:ra(iG),closeSidebar:ra(iU),resize:{start:ra(iW),update:ra(iH),end:ra(iq)},getTransitionEnabled:ro(tE)}}function aC(){var e=ri(r5),n=ri(nB),t=ri(r6),r=ra(tD),i=ra(tO);return{rect:e,gutter:n,displayState:t,collapsedWidth:0,getTransitionEnabled:ro(tE),resizeSidebar:r,toggle:i,setChatRef:ra(tP),agentFiletreeOrder:ri(nG),setAgentPosition:ra(i2),headerHeight:ri(nr),isCollapsed:ri(tF)}}var ak=(0,eg.selectAtom)(nx,function(e){var n=e.tiling;return(null==n?void 0:n.type)==="paneGroup"&&1===n.panes.length}),aE=e.i(106020),aT=e.i(292849),aP=e.i(827456),aR=e.i(259493);function aA(e){var n=e.currentPaneId,t=e.type,r=(0,aP.usePaneUIContext)(),i=ra(t8),a=ra(tH),o=(0,tb.useGetPanes)(),s=(0,aR.useGetPaneBindings)(),l=n?"Move existing tab here":"Jump to existing tab";return(0,N.useCallback)(function(e){var u=e.searchQuery;return(0,ei._)(function(){var e,c,d,p,f,h,m,v,x,y,w,b,_,j,S,I,C,k,E,T,P,R,A,D,V;return(0,ea._)(this,function(O){switch(O.label){case 0:if(e=o(),!(c=n?e.filter(function(e){return(0,U._)(e,1)[0]!==n}):e).length||!u&&"files"===t)return[2,[]];d=new Map,p=[],f=!0,h=!1,m=void 0;try{for(v=c[Symbol.iterator]();!(f=(x=v.next()).done);f=!0)(y=(0,U._)(x.value,2))[0],w=y[1],(0,na.isFilePane)(w)&&w.data.path&&p.push(w.data.path)}catch(e){h=!0,m=e}finally{try{f||null==v.return||v.return()}finally{if(h)throw m}}return[4,(0,aT.filterFiles)(u,p)];case 1:b=O.sent(),_=!0,j=!1,S=void 0;try{for(I=b[Symbol.iterator]();!(_=(C=I.next()).done);_=!0)k=C.value,d.set(k.path,{score:k.score,ranges:k.ranges})}catch(e){j=!0,S=e}finally{try{_||null==I.return||I.return()}finally{if(j)throw S}}E=[],T=!0,P=!1,R=void 0;try{for(A=function(){var e=(0,U._)(V.value,2),o=e[0],u=e[1],c=(0,na.isToolPane)(u);if("tools"===t&&!c||"tools"===t&&"commands"===u.type||"files"===t&&c)return"continue";var p=(0,na.isFilePane)(u)?u.data.path:null,f=p?d.get(p):null;if("deployments"===u.type){var h=s(o);if((null==h?void 0:h.type)==="deployments"){var m=h.getTabs();if(m)return E.push({match:aE.fzfMatchLabel,data:{type:"context",label:r.getTitle(u),icon:(0,g.jsx)(r.Icon,{pane:u})},commands:function(){return m.map(function(e){return{match:aE.fzfMatchLabel,data:{key:o+e.id,type:"action",label:e.label,icon:(0,g.jsx)(e.Icon,{size:16}),run:function(){a(o),h.setTab(e.id)}}}})}}),"continue"}}var v=p&&f?function(){return{score:f.score,render:(0,aT.createFileMatchRender)({path:p,ranges:f.ranges,description:l})}}:aE.fzfMatchLabel,x=r.getTitle(u),y=r.Icon({pane:u});E.push({match:v,data:{key:o,type:"action",label:x,icon:y,run:function(){return n?i({a:n,b:o}):a(o)},description:l}})},D=c[Symbol.iterator]();!(T=(V=D.next()).done);T=!0)A()}catch(e){P=!0,R=e}finally{try{T||null==D.return||D.return()}finally{if(P)throw R}}return[2,E]}})})()},[n,o,r,a,i,s,l,t])}var aD=e.i(333980),aV=e.i(927989),aO=e.i(794633),aF=e.i(32109),aM=e.i(384401),aL=e.i(888330),aG=e.i(615778),aU=e.i(44239),aN="Search";function aB(){var e=(0,es.useSetAtom)(ep);return(0,N.useCallback)(function(n){e(n)},[e])}var aW=e.i(262206),az=e.i(739521),aH=e.i(980338),aq={id:"toggleGlobalCommandBarCommand",name:"Toggle Commandbar",description:"Opens or closes the command bar",default:(0,aW.defaultKeyCombo)({cmdOrCtrl:!0,key:"k"})};function aK(e){var n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{enabled:!0}).enabled,t=(0,es.useSetAtom)(eh);(0,N.useEffect)(function(){if(n&&null!==e)return t(function(n){return(0,er._)(n).concat([e])}),function(){t(function(n){return n.filter(function(n){return n!==e})})}},[t,e,n])}var a$=(0,rl.cssRecord)({surface:[i9.rcss.maxHeight("70vh"),i9.rcss.borderRadius(8)]});let aQ=(0,N.memo)(function(){var e,n,t,r,i,a,o,s,l,u,c,d=(0,es.useAtomValue)(ed),p=aB(),f=(e=ax(),n=(0,N.useCallback)(function(n){(0,el.track)(eu.events.TOOL_OPENED,{source:"Command Bar",tool:n.pane.type}),e(n)},[e]),t=(0,aP.usePaneUIContext)(),r=(0,aO.useToolPanes)(),i=(0,tb.useGetPanes)(),a=(0,N.useCallback)(function(){var e=i().map(function(e){var n=(0,U._)(e,2);return(n[0],n[1]).type}),a=[],o=!0,s=!1,l=void 0;try{for(var u,c=r[Symbol.iterator]();!(o=(u=c.next()).done);o=!0)!function(){var r=u.value;if(!((0,na.isSingleton)(r.type)&&e.includes(r.type))){var i=t.getTitle(r),o=t.Icon({pane:r});a.push({match:(0,aD.matchToolPane)({pane:r,aliases:aV.paneAliases.get(r.type)}),data:{key:"extension"===r.type?"extension-".concat(r.data.installationId,"-").concat(r.data.path):void 0,type:"action",label:i,description:t.getDescription(r,{short:!0}),icon:o,run:function(){n({pane:r})}}})}}()}catch(e){s=!0,l=e}finally{try{o||null==c.return||c.return()}finally{if(s)throw l}}return a},[r,n,i,t]),o=aA({type:"tools"}),s=(0,aM.useKeyCombo)("toggleGlobalCommandBarCommand"),l=(0,J.default)(function(){return{type:"context",icon:(0,g.jsx)(aG.default,{}),label:"",description:aN,keyboardShortcut:s}},[s]),u=(0,J.default)(function(){return(0,eo.atom)(function(e){var n=e(eh),t={data:{type:"context",label:aL.toolsCommandLabel,icon:(0,g.jsx)(aU.default,{})},commands:function(e){var n=e.searchQuery;return(0,ei._)(function(){return(0,ea._)(this,function(e){switch(e.label){case 0:return[4,o({searchQuery:n})];case 1:return[2,er._.apply(void 0,[e.sent()]).concat((0,er._)(a()))]}})})()}};return{data:l,commands:function(){return(0,er._)(n).concat([t])}}})},[a,l,o]),c=(0,J.default)(function(){return(0,eo.atom)(function(e){var n=e(u),t=e(ef);return t?[n,t]:n})},[u]),(0,es.useAtomValue)(c)),h=(0,aM.useKeyCombo)(aq.id);return(0,g.jsx)(az.Modal,{hideCloseButton:!0,isOpen:d,onRequestClose:p,noPadding:!0,skipTransition:!0,topPadding:8,children:(0,g.jsx)(A.Surface,{css:a$.surface,children:(0,g.jsx)(aH.CommandBar,{keyboardShortcut:h,onAction:function(){return p()},command:f,autoFocus:!0})})})});var aY=e.i(692043);function aX(){var e=(0,x._)(["\n  query ExtensionStore($replId: String!, $userId: Int) {\n    extensionList(includeNonBlessed: true, userId: $userId) {\n      ...TopLevelExtension\n      installation(replId: $replId) {\n        ...TopLevelExtensionInstallation\n      }\n    }\n  }\n  ","\n  ","\n"]);return aX=function(){return e},e}var aJ=(0,y.gql)(aX(),aY.TopLevelExtensionFragmentDoc,aY.TopLevelExtensionInstallationFragmentDoc),aZ=e.i(761201),a0=e.i(253344),a1=e.i(47503),a2=e.i(207237),a4=e.i(140487),a8=e.i(960178),a3=(0,rl.cssRecord)({container:i9.rcss.colWithGap(24)});function a6(e){var n=e.fileExtension,t=e.onCancel,r=e.onConfirm;return(0,g.jsxs)(D.View,{css:a3.container,children:[(0,g.jsx)(a8.Header,{level:1,variant:"headerDefault",children:"Make this extension default?"}),(0,g.jsxs)(a8.Text,{children:["Do you want to use this extension to open ",n," files by default? You can always use another file opener by right clicking on the file and opening it with something else"]}),(0,g.jsxs)(D.View,{row:!0,gap:12,justify:"end",children:[(0,g.jsx)(a4.Button,{onClick:function(){return t()},text:"Cancel"}),(0,g.jsx)(a4.Button,{colorway:"positive",onClick:function(){return r()},text:"Yes, use this extension by default"})]})]})}var a5=e.i(222342);function a9(){var e=(0,tb.useGetActivePaneId)(),n=ro(n_),t=ro(nS),r=ro(n6),i=ra(tU),a=ra(tC),o=ra(tB),s=ro(nw),l=ro(nb),u=ro(tt);return(0,N.useCallback)(function(c){var d=c.pane,p=c.activate,f=c.updateOnReveal,h=e(),g=(0,na.isFilePane)(d)?s():l();g||(g=function(e){var n,t,r=e.panes,i=e.pane;if((0,na.isFilePane)(i)){var a,o,s=i.data.path;return null!=(o=null==(a=r.find(function(e){var n=(0,U._)(e,2)[1];return(0,na.isFilePane)(n)&&n.data.path===s}))?void 0:a[0])?o:null}if((0,na.isExtensionPane)(i))return null!=(u=null==(l=r.find(function(e){var n=(0,U._)(e,2)[1];return!!(0,na.isExtensionPane)(n)&&n.data.installationId===i.data.installationId&&n.data.path===i.data.path&&n.data.filePath===i.data.filePath}))?void 0:l[0])?u:null;if("diff"===i.type){var l,u,c,d=r.find(function(e){var n=(0,U._)(e,2),t=(n[0],n[1]);return"diff"===t.type&&(0,nc.default)(t.data,i.data)});return null!=(c=null==d?void 0:d[0])?c:null}return(0,na.isSingleton)(i.type)&&null!=(t=null==(n=r.find(function(e){return(0,U._)(e,2)[1].type===i.type}))?void 0:n[0])?t:null}({panes:(0,er._)(n()).concat((0,er._)(t())),pane:d}));var m=u();if(g&&h){var v,x,y=r().layout,w=null==(v=eM(y,h))?void 0:v.paneGroup,b=null==(x=eM(y,g))?void 0:x.paneGroup;if(!m||(null==w?void 0:w.id)===(null==b?void 0:b.id))return(void 0===f||f)&&o({paneId:g,pane:d}),a({paneId:g,activate:p}),g}var _=c.placement;return m&&null!=h?_={type:"after",paneId:h}:(null==_?void 0:_.type)!=="secondary"||_.relativeTo||(_={type:"secondary",relativeTo:h}),i({pane:d,activate:p,placement:_})},[e,s,l,i,n,t,r,u,a,o])}var a7=e.i(778203);function oe(){var e,n=aw(),t=(0,tb.useActivatePane)(),r=(e=(0,tb.useObservableActiveFile)(),(0,J.default)(function(){return function(n){return e.subscribe(n)}},[e])),i=(0,tb.useGetActiveFile)(),a=(0,a5.default)(),o=a9(),s=(0,tb.useGetActivePaneId)(),l=ro(n6),u=ra(tn),c=(0,a7.default)(),d=(0,i6.default)(c),p=(0,N.useCallback)(function(e){o({pane:{type:"extension",data:{extensionId:e.extensionId,installationId:e.installationId,baseUrl:e.baseUrl,path:e.path,name:e.name}},activate:!0,placement:{type:"secondary",relativeTo:s()}})},[o,s]);return(0,J.default)(function(){return{openFile:n,watchActiveFile:r,getActiveFile:i,activatePane:t,toasts:a,revealOrInsertTool:p,getLayoutState:l,setLayoutState:u,getSshConfig:function(){return d.current}}},[n,r,i,t,a,p,l,u,d])}var on=e.i(475032),ot=e.i(529810);e.i(244719);var or=e.i(667279),oi=e.i(196380),oa=e.i(100811),oo=e.i(9293),os=e.i(62820),ol=e.i(409792),ou=e.i(343252),oc=e.i(873379),od=e.i(557964),op=e.i(167626),of=((t={}).RAW="RAW",t.PROXY="PROXY",t.THROW="THROW",t.HANDLER="HANDLER",t),oh=((r={}).GET="GET",r.SET="SET",r.APPLY="APPLY",r.CONSTRUCT="CONSTRUCT",r.ENDPOINT="ENDPOINT",r.RELEASE="RELEASE",r),og=Symbol("Comlink.proxy"),om=Symbol("Comlink.endpoint"),ov=Symbol("Comlink.releaseProxy"),ox=Symbol("Comlink.thrown"),oy=function(e){return(void 0===e?"undefined":(0,eO._)(e))==="object"&&null!==e||"function"==typeof e},ow=new Map([["proxy",{canHandle:function(e){return oy(e)&&e[og]},serialize:function(e){var n=new MessageChannel,t=n.port1,r=n.port2;return ob(e,t),[r,[r]]},deserialize:function(e){var n;return e.start(),function e(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},i=!1,a=new Proxy(r,{get:function(r,o){if(oj(i),o===ov)return function(){return oT(n,{type:oh.RELEASE,path:t.map(function(e){return e.toString()})}).then(function(){o_(n),i=!0})};if("then"===o){if(0===t.length)return{then:function(){return a}};var s=oT(n,{type:oh.GET,path:t.map(function(e){return e.toString()})}).then(oE);return s.then.bind(s)}return e(n,(0,er._)(t).concat([o]))},set:function(e,r,a){oj(i);var o=(0,U._)(ok(a),2),s=o[0],l=o[1];return oT(n,{type:oh.SET,path:(0,er._)(t).concat([r]).map(function(e){return e.toString()}),value:s},l).then(oE)},apply:function(r,a,o){oj(i);var s=t[t.length-1];if(s===om)return oT(n,{type:oh.ENDPOINT}).then(oE);if("bind"===s)return e(n,t.slice(0,-1));var l=(0,U._)(oS(o),2),u=l[0],c=l[1];return oT(n,{type:oh.APPLY,path:t.map(function(e){return e.toString()}),argumentList:u},c).then(oE)},construct:function(e,r){oj(i);var a=(0,U._)(oS(r),2),o=a[0],s=a[1];return oT(n,{type:oh.CONSTRUCT,path:t.map(function(e){return e.toString()}),argumentList:o},s).then(oE)}});return a}(e,[],n)}}],["throw",{canHandle:function(e){return oy(e)&&ox in e},serialize:function(e){var n=e.value;return[(0,op._)(n,Error)?{isError:!0,value:{message:n.message,name:n.name,stack:n.stack}}:{isError:!1,value:n},[]]},deserialize:function(e){if(e.isError)throw Object.assign(Error(e.value.message),e.value);throw e.value}}]]);function ob(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:self,t=arguments.length>2?arguments[2]:void 0;function r(i){if(i&&i.data&&(!t||i.origin===t.origin&&i.source===t.source)){var a,o=(0,v._)({path:[]},i.data),s=o.id,l=o.type,u=o.path,c=(i.data.argumentList||[]).map(oE);try{var d=u.slice(0,-1).reduce(function(e,n){return e[n]},e),p=u.reduce(function(e,n){return e[n]},e);switch(l){case oh.GET:a=p;break;case oh.SET:d[u.slice(-1)[0]]=oE(i.data.value),a=!0;break;case oh.APPLY:a=p.apply(d,c);break;case oh.CONSTRUCT:var f=(0,od._)(p,(0,er._)(c));a=oC(f);break;case oh.ENDPOINT:var h,g,m=new MessageChannel,x=m.port1,y=m.port2;ob(e,y),h=x,g=[x],oI.set(h,g),a=h;break;case oh.RELEASE:a=void 0;break;default:return}}catch(e){a=(0,E._)({value:e},ox,0)}Promise.resolve(a).catch(function(e){return(0,E._)({value:e},ox,0)}).then(function(e){var t=(0,U._)(ok(e),2),i=t[0],a=t[1];n.postMessage((0,r$._)((0,v._)({},i),{id:s}),a),l===oh.RELEASE&&(n.removeEventListener("message",r),o_(n))})}}return n.addEventListener("message",r),n.start&&n.start(),function(){n.removeEventListener("message",r),o_(n)}}function o_(e){"MessagePort"===e.constructor.name&&e.close()}function oj(e){if(e)throw Error("Proxy has been released and is not useable")}function oS(e){var n,t=e.map(ok);return[t.map(function(e){return e[0]}),(n=t.map(function(e){return e[1]}),Array.prototype.concat.apply([],n))]}var oI=new WeakMap;function oC(e){return Object.assign(e,(0,E._)({},og,!0))}function ok(e){var n=!0,t=!1,r=void 0;try{for(var i,a=ow[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var o=(0,U._)(i.value,2),s=o[0],l=o[1];if(l.canHandle(e)){var u=(0,U._)(l.serialize(e),2),c=u[0],d=u[1];return[{type:of.HANDLER,name:s,value:c},d]}}}catch(e){t=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(t)throw r}}return[{type:of.RAW,value:e},oI.get(e)||[]]}function oE(e){switch(e.type){case of.HANDLER:return ow.get(e.name).deserialize(e.value);case of.RAW:return e.value}}function oT(e,n,t){return new Promise(function(r){var i=[,,,,].fill(0).map(function(){return Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)}).join("-");e.addEventListener("message",function n(t){t.data&&t.data.id&&t.data.id===i&&(e.removeEventListener("message",n),r(t.data))}),e.start&&e.start(),e.postMessage((0,v._)({id:i},n),t)})}var oP=e.i(623059),oR=Symbol("timeout"),oA=e.i(881476);function oD(){var e=(0,x._)(["\n  fragment InitialCurrentUserData on CurrentUser {\n    id\n    username\n    image\n    bio\n  }\n"]);return oD=function(){return e},e}function oV(){var e=(0,x._)(["\n  fragment SocialCurrentUserData on CurrentUser {\n    url\n    socials {\n      id\n      url\n      type\n    }\n    firstName\n    lastName\n    displayName\n    fullName\n    followCount\n    followerCount\n  }\n"]);return oV=function(){return e},e}function oO(){var e=(0,x._)(["\n  fragment RolesCurrentUserData on CurrentUser {\n    roles {\n      id\n      name\n      key\n      tagline\n    }\n  }\n"]);return oO=function(){return e},e}function oF(){var e=(0,x._)(["\n  fragment PlanCurrentUserData on CurrentUser {\n    isUserHacker: subscriptionIsType(subscriptionType: HACKER)\n    ...CoreSubscriptionPlanStatus\n  }\n  ","\n"]);return oF=function(){return e},e}function oM(){var e=(0,x._)(["\n  fragment SocialUserData on User {\n    url\n    socials {\n      id\n      url\n      type\n    }\n    firstName\n    lastName\n    displayName\n    fullName\n    followCount\n    followerCount\n  }\n"]);return oM=function(){return e},e}function oL(){var e=(0,x._)(["\n  fragment RolesUserData on User {\n    roles {\n      id\n      name\n      key\n      tagline\n    }\n  }\n"]);return oL=function(){return e},e}function oG(){var e=(0,x._)(["\n  fragment PlanUserData on User {\n    isUserHacker: subscriptionIsType(subscriptionType: HACKER)\n    isUserPro: subscriptionIsType(subscriptionType: HACKER_PRO)\n  }\n"]);return oG=function(){return e},e}function oU(){var e=(0,x._)(["\n  fragment InitialReplData on Repl {\n    id\n    url\n    title\n    description\n    timeCreated\n    slug\n    isPrivate\n  }\n"]);return oU=function(){return e},e}function oN(){var e=(0,x._)(["\n  fragment SocialReplData on Repl {\n    likeCount\n    publicForkCount\n    iconUrl\n    imageUrl\n  }\n"]);return oN=function(){return e},e}function oB(){var e=(0,x._)(["\n  fragment InitialUserData on User {\n    id\n    username\n    image\n    bio\n  }\n"]);return oB=function(){return e},e}function oW(){var e=(0,x._)(["\n  fragment OwnerData on Repl {\n    owner {\n      __typename\n      ... on User {\n        ...InitialUserData\n      }\n      ... on Team {\n        id\n        username\n        image\n        description\n      }\n    }\n  }\n  ","\n"]);return oW=function(){return e},e}function oz(){var e=(0,x._)(["\n  fragment MultiplayersData on Repl {\n    multiplayers {\n      ...InitialUserData\n    }\n  }\n  ","\n"]);return oz=function(){return e},e}function oH(){var e=(0,x._)(["\n  query extensionPortCurrentUser(\n    $includeSocialData: Boolean! = false\n    $includeRoles: Boolean! = false\n    $includePlan: Boolean! = false\n  ) {\n    user: currentUser {\n      ...InitialCurrentUserData\n      ...SocialCurrentUserData @include(if: $includeSocialData)\n      ...RolesCurrentUserData @include(if: $includeRoles)\n      ...PlanCurrentUserData @include(if: $includePlan)\n    }\n  }\n  ","\n  ","\n  ","\n  ","\n"]);return oH=function(){return e},e}function oq(){var e=(0,x._)(["\n  query extensionPortUserByUsername(\n    $username: String!\n    $includeSocialData: Boolean! = false\n    $includeRoles: Boolean! = false\n    $includePlan: Boolean! = false\n  ) {\n    userByUsername(username: $username) {\n      ...InitialUserData\n      ...SocialUserData @include(if: $includeSocialData)\n      ...RolesUserData @include(if: $includeRoles)\n      ...PlanUserData @include(if: $includePlan)\n    }\n  }\n  ","\n  ","\n  ","\n  ","\n"]);return oq=function(){return e},e}function oK(){var e=(0,x._)(["\n  query extensionPortUserById(\n    $id: Int!\n    $includeSocialData: Boolean! = false\n    $includeRoles: Boolean! = false\n    $includePlan: Boolean! = false\n  ) {\n    user(id: $id) {\n      ...InitialUserData\n      ...SocialUserData @include(if: $includeSocialData)\n      ...RolesUserData @include(if: $includeRoles)\n      ...PlanUserData @include(if: $includePlan)\n    }\n  }\n  ","\n  ","\n  ","\n  ","\n"]);return oK=function(){return e},e}function o$(){var e=(0,x._)(["\n  query currentUserEditorPreferences {\n    currentUser {\n      id\n      workspacePreferences\n    }\n  }\n"]);return o$=function(){return e},e}function oQ(){var e=(0,x._)(["\n  query extensionPortReplById(\n    $id: String!\n    $includeSocialData: Boolean! = false\n    $includeOwner: Boolean! = false\n    $includeMultiplayers: Boolean! = false\n  ) {\n    getRepl(id: $id) {\n      __typename\n      ... on Repl {\n        ...InitialReplData\n        ...SocialReplData @include(if: $includeSocialData)\n        ...OwnerData @include(if: $includeOwner)\n        ...MultiplayersData @include(if: $includeMultiplayers)\n      }\n      ... on ReplRedirect {\n        replUrl\n      }\n    }\n  }\n  ","\n  ","\n  ","\n  ","\n"]);return oQ=function(){return e},e}function oY(){var e=(0,x._)(["\n  query extensionPortReplByUrl(\n    $url: String!\n    $includeSocialData: Boolean! = false\n    $includeOwner: Boolean! = false\n    $includeMultiplayers: Boolean! = false\n  ) {\n    getRepl(url: $url) {\n      __typename\n      ... on Repl {\n        ...InitialReplData\n        ...SocialReplData @include(if: $includeSocialData)\n        ...OwnerData @include(if: $includeOwner)\n        ...MultiplayersData @include(if: $includeMultiplayers)\n      }\n    }\n  }\n  ","\n  ","\n  ","\n  ","\n"]);return oY=function(){return e},e}var oX=(0,y.gql)(oD()),oJ=(0,y.gql)(oV()),oZ=(0,y.gql)(oO()),o0=(0,y.gql)(oF(),oA.CoreSubscriptionPlanStatusFragmentDoc),o1=(0,y.gql)(oM()),o2=(0,y.gql)(oL()),o4=(0,y.gql)(oG()),o8=(0,y.gql)(oU()),o3=(0,y.gql)(oN()),o6=(0,y.gql)(oB()),o5=(0,y.gql)(oW(),o6),o9=(0,y.gql)(oz(),o6),o7=(0,y.gql)(oH(),oX,oJ,oZ,o0),se=(0,y.gql)(oq(),o6,o1,o2,o4),sn=(0,y.gql)(oK(),o6,o1,o2,o4),st=(0,y.gql)(o$()),sr=(0,y.gql)(oQ(),o8,o3,o5,o9),si=(0,y.gql)(oY(),o8,o3,o5,o9);function sa(e){return function(n){return(0,ei._)(function(){var t,r;return(0,ea._)(this,function(i){switch(i.label){case 0:return[4,null===nJ.apolloClient||void 0===nJ.apolloClient?void 0:nJ.apolloClient.query({query:e,variables:n||void 0})];case 1:if(null==(t=i.sent())?void 0:t.data)return[2,t.data];throw Error(null==t||null==(r=t.error)?void 0:r.message)}})})()}}var so=e.i(862927);function ss(e,n){var t={};for(var r in n)"function"==typeof n[r]&&(t[r]=function(e,n){return function(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];var a=!0,o=!1,s=void 0;try{for(var l,u=e[Symbol.iterator]();!(a=(l=u.next()).done);a=!0)(0,l.value)()}catch(e){o=!0,s=e}finally{try{a||null==u.return||u.return()}finally{if(o)throw s}}return n.apply(void 0,(0,er._)(r))}}(e,n[r]));return t}function sl(e,n){return function(){var t=e.store.get(e.extensionStateAtom),r=!0,i=!1,a=void 0;try{for(var o,s=n[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var l=o.value;if(!t.scopes.has(l)){var u="Scope not declared in extension.json: ".concat(l);e.logger.warn("".concat(u,". In the future this will throw an error"))}}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}}}var su=ey.Type.Record(ey.Type.String(),ey.Type.String({minLength:1})),sc=e.i(336106);function sd(){var e=(0,x._)(["\n  query ExtensionApiAuthToken($installationId: String!) {\n    extensionInstallationById(id: $installationId) {\n      ... on ExtensionInstallation {\n        id\n        token\n      }\n    }\n  }\n"]);return sd=function(){return e},e}e.i(439725);var sp=(0,y.gql)(sd());function sf(e){return{registerCommand:function(n,t){return(0,ei._)(function(){var r,i,a;return(0,ea._)(this,function(o){switch(o.label){case 0:if(t)return[3,2];return e.logger.warn("registerCommand: calling registerCommand with a single argument is deprecated. Pass a {commandId, contributions} object as the first command."),r=n,[4,(0,oa.parseCommandProxyToExtensionCommand)(r,e)];case 1:if(!(a=o.sent()).data.id)throw Error("Command: expected id to be defined");if(!("contributions"in a.data))throw Error("Command: In ".concat(a.data.id,", contributions should be an array"));return 0===a.data.contributions.length&&e.logger.warn("Command: ".concat(a.data.id," has no contributions")),(i={commandId:a.data.id,contributions:a.data.contributions}).contributions||(e.logger.warn("Command: '".concat(a.data.id,"' has no contributions")),i.contributions=[]),[3,4];case 2:return i=n,r=t,[4,(0,oa.parseCommandProxyToExtensionCommand)(r,e)];case 3:a=o.sent(),o.label=4;case 4:return e.store.set(or.registerExtensionCreateCommandAtom,{extensionStateAtom:e.extensionStateAtom,createCommand:{id:(0,a0.asExtensionCommandId)(i.commandId),contributions:i.contributions,create:function(){return(0,ei._)(function(){return(0,ea._)(this,function(e){return[2,a]})})()}}}),[2]}})})()},registerCreateCommand:function(n,t){return(0,ei._)(function(){var r,i;return(0,ea._)(this,function(a){if(!n.commandId||""===n.commandId)throw Error("Attempted to register command without id");if(!n.contributions||!Array.isArray(n.contributions))throw Error("Command: In ".concat(n.commandId,", contributions should be an array"));return 0===n.contributions.length&&e.logger.warn("Command: ".concat(n.commandId," has no contributions")),(r=n.contributions.filter(function(e){return!(e in oP.ContributionType)})).length>0&&e.logger.warn("Command: ".concat(n.commandId," has unrecognized contributions: ").concat(r.join(", "),". Valid contributions are ").concat(Object.values(oP.ContributionType))),i={id:(0,a0.asExtensionCommandId)(n.commandId),contributions:n.contributions,create:function(n){var r=n.path;return(0,ei._)(function(){var n;return(0,ea._)(this,function(i){switch(i.label){case 0:return[4,Promise.race([t({path:r}),new Promise(function(e){return setTimeout(function(){return e(null)},50)})])];case 1:if(null===(n=i.sent()))return[2,null];return[2,(0,oa.parseCommandProxyToExtensionCommand)(n,e)]}})})()}},e.store.set(or.registerExtensionCreateCommandAtom,{extensionStateAtom:e.extensionStateAtom,createCommand:i}),[2]})})()}}}function sh(e){return function(){if(!e.store.get(e.extensionStateAtom).enableExperimentalApi)throw Error("Experimental APIs are not enabled. (If you are the developer, please add the `experimental-api` scope to your extension.json)")}}var sg=e.i(995683),sm=e.i(703631);function sv(e){return e.error?{error:e.error,success:!1}:{success:!0,error:null}}var sx=e.i(968323),sy=e.i(12291),sw=e.i(664152),sb=function(e,n){var t=e.extension,r=n.showMessage,i=n.hideMessage,a=n.hideAllMessages,o=function(e){return function(n){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4e3,o=arguments.length>2?arguments[2]:void 0,u=Date.now();u-l>=6e4&&(l=u,s=0);var c=null!=(i=t.manifest.name.trim())?i:"Unknown Extension";s<10?(r({content:(0,g.jsxs)(g.Fragment,{children:[n,(0,g.jsx)("div",{children:(0,g.jsx)(a8.Text,{variant:"small",children:c})})]}),type:e,time:a>1e4?1e4:a,style:o}),s++):sw.logger.error("Extension reached showMessage throttle limit",{extensionId:t.extensionId,extensionName:t.manifest.name,content:n})}},s=0,l=Date.now();return{showConfirm:o("confirm"),showError:o("error"),showNotice:o("notice"),showWarning:o("warning"),hideMessage:i,hideAllMessages:a}},s_=e.i(412284),sj=e.i(703774);function sS(e){var n=e.extension,t=e.sandboxUrl,r=e.sandboxTitle,i=e.paneId,a=e.environmentAPIs,o=e.filePath,s=(0,N.useRef)(null),l=(0,a2.default)(),u=(0,a1.useCurrentUserId)(),c=(0,ot.default)(),d=(0,N.useRef)(),p=(0,s_.useExtensionsStore)(),f=(0,or.useExtensionStateAtom)(null==n?void 0:n.installationId),h=(0,sj.useTheme)(),g=(0,N.useRef)(h),m=(0,N.useRef)([]);g.current=h;var x=(0,J.default)(function(){return{}},[]),y=(0,oc.default)(c.container),w=(0,U._)((0,N.useState)(!1),2),b=w[0],_=w[1];(0,N.useEffect)(function(){y===os.ConnectionState.CONNECTED&&_(!0)},[y]),(0,N.useEffect)(function(){m.current.forEach(function(e){return e(h.theme)})},[h.theme]),(0,N.useEffect)(function(){return function(){d.current&&d.current()}},[]);var j=(0,N.useCallback)(function(){try{var e=new URL(t);if("https:"===e.protocol)return!0;return!1}catch(e){return!1}},[t]),S=(0,N.useCallback)(function(){!s.current||!j()||n&&f&&u&&(d.current&&d.current(),d.current=function(e){var n=e.extensionIframe,t=new URL(n.src).origin,r=function(e){var n,t,r,i,a,o,s,l,u,c,d,p=e.filePath,f=e.replId,h=e.environmentAPIs,g=e.logger.createLogger({api:"debug"});return(0,r$._)((0,v._)({filePath:p},(n=e.services.fs,t=e.logger.createLogger({api:"fs"}),ss([sl(e,["read"])],(0,v._)({readFile:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8";return(0,ei._)(function(){var r,i;return(0,ea._)(this,function(a){switch(a.label){case 0:return r=(0,sm.normalizePath)(e),[4,n.readFile(r)];case 1:var o;if((i=a.sent()).error)return[2,{error:i.error,content:null}];return[2,{error:null,content:(o=i.content,"utf8"===t?o.toString():"binary"===t?o.toBuffer():o)}]}})})()},readDir:function(e){return(0,ei._)(function(){var t,r;return(0,ea._)(this,function(i){switch(i.label){case 0:return t=(0,sm.normalizePath)(e),[4,n.readDir(t)];case 1:if((r=i.sent()).error)return[2,{error:r.error,children:null}];return[2,{error:null,children:r.children}]}})})()},watchFile:function(e,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"binary",a=(0,sm.normalizePath)(e);(0,ic.isOTFile)(a)&&t.warn("Extension used watchFile on a text file. This works, but watchTextFile is preferred.");var o=n.watchFile(a,{onChange:function(e){"utf8"===i?r.onChange(e.toString("utf8")):r.onChange(e.asBuffer)},onError:function(e){r.onError(e.message)},onMoveOrDelete:function(e){r.onMoveOrDelete({eventType:e.eventType,node:e.node})}});return oC(function(){o()})},watchDir:function(e,t){var r=(0,sm.normalizePath)(e),i=n.watchDir(r,{onChange:function(n){t.onChange(n.map(function(n){return{path:(0,sm.asDir)(e)+n.filename,type:n.type}}))},onError:function(e){t.onError(e)},onMoveOrDelete:function(e){t.onMoveOrDelete(e)}});return oC(function(){i()})}},ss([sl(e,["write-exec"])],{createDir:function(e){return(0,ei._)(function(){var t;return(0,ea._)(this,function(r){switch(r.label){case 0:return t=(0,sm.normalizePath)(e),[4,n.createDir(t)];case 1:return[2,sv(r.sent())]}})})()},deleteDir:function(e){return(0,ei._)(function(){var t;return(0,ea._)(this,function(r){switch(r.label){case 0:return t=(0,sm.normalizePath)(e),[4,n.deleteDir(t)];case 1:return[2,sv(r.sent())]}})})()},writeFile:function(e,t){return(0,ei._)(function(){var r,i,a;return(0,ea._)(this,function(o){switch(o.label){case 0:if(r=(0,sm.normalizePath)(e),"string"!=typeof t)return[3,1];return i=t,[3,4];case 1:if(!(0,op._)(t,Blob))return[3,3];return a=sg.default.from,[4,t.arrayBuffer()];case 2:return i=a.apply(sg.default,[o.sent()]),[3,4];case 3:i=sg.default.from(t),o.label=4;case 4:return[4,n.writeFile(r,i)];case 5:return[2,sv(o.sent())]}})})()},deleteFile:function(e){return(0,ei._)(function(){var t;return(0,ea._)(this,function(r){switch(r.label){case 0:return t=(0,sm.normalizePath)(e),[4,n.deleteFile(t)];case 1:return[2,sv(r.sent())]}})})()},copyFile:function(e,t){return(0,ei._)(function(){var r;return(0,ea._)(this,function(i){switch(i.label){case 0:return r=(0,sm.normalizePath)(e),[4,n.copyFile(r,t)];case 1:return[2,sv(i.sent())]}})})()},move:function(e,t){return(0,ei._)(function(){var r,i,a;return(0,ea._)(this,function(o){switch(o.label){case 0:return r=(0,sm.normalizePath)(e),[4,n.stat(r)];case 1:if(!(i=o.sent()).exists)return[2,{error:"File or directory does not exist",success:!1}];if(i.type!==tN.FileType.File)return[3,3];return[4,n.moveFile(r,t)];case 2:return a=o.sent(),[3,5];case 3:return[4,n.moveDir(r,t)];case 4:a=o.sent(),o.label=5;case 5:return[2,sv(a)]}})})()},watchTextFile:function(e,r){(0,ic.isOTFile)(e)||t.warn("It appears that you are trying to use watchTextFile on a non-OT file. Please use fs.watchFile instead");var i=n.watchTextFile(e,{onReady:function(e){var n=e.fetchChanges,t=e.initialContent,i=e.transformSelection,a=e.updateSelections,o=e.version,s=e.writeChange;r.onReady(oC({writeChange:s,fetchChanges:n,initialContent:t,version:o,transformSelection:i,updateSelections:a}))},onChange:function(e){var n=e.latestContent,t=e.changeSource,i=e.changes,a=e.version;return(0,ei._)(function(){return(0,ea._)(this,function(e){return r.onChange({latestContent:n.toString(),version:a,changeSource:t,changes:i.toJSON()}),[2]})})()},onError:function(e){r.onError(e.message)},onMoveOrDelete:function(e){r.onMoveOrDelete({eventType:e.eventType,node:e.node})}});return oC(function(){i()})}})))),function(e){var n=e.services.container,t=null;function r(){return(0,ei._)(function(){var e;return(0,ea._)(this,function(r){switch(r.label){case 0:if(t)return[2];return[4,n.exec("bash","-c","echo $REPLIT_DB_URL")];case 1:if((e=r.sent()).error||!e.output)throw Error("unable to find REPLIT_DB_URL");return t=e.output.trim(),[2]}})})()}return ss([sl(e,["repldb:read"])],(0,v._)({getReplDbValue:function(e){return(0,ei._)(function(){return(0,ea._)(this,function(i){switch(i.label){case 0:return[4,r()];case 1:return i.sent(),[4,n.exec("curl","-s","".concat(t,"/").concat(e))];case 2:return[2,i.sent().output]}})})()},listReplDbKeys:function(e){return(0,ei._)(function(){var i;return(0,ea._)(this,function(a){switch(a.label){case 0:return[4,r()];case 1:return a.sent(),[4,n.exec("curl","-s","".concat(t,"?prefix=").concat(e))];case 2:if((i=a.sent()).error||!i.output)return[2,{error:i.error}];return[2,{keys:i.output.split("\n")}]}})})()}},ss([sl(e,["repldb:write"])],{setReplDbValue:function(e,i){return(0,ei._)(function(){return(0,ea._)(this,function(a){switch(a.label){case 0:return[4,r()];case 1:return a.sent(),[4,n.exec("curl",t,"-s","-d","".concat(e,"=").concat(i))];case 2:return a.sent(),[2]}})})()},deleteReplDbKey:function(e){return(0,ei._)(function(){var i;return(0,ea._)(this,function(a){switch(a.label){case 0:return[4,r()];case 1:return a.sent(),[4,n.exec("curl","-s","-XDELETE","".concat(t,"/").concat(e))];case 2:if((i=a.sent()).error||!i.output)return[2,{error:i.error}];return[2,{keys:i.output.split("\n")}]}})})()}})))}(e),{watchActiveFile:function(e){return oC(r.environmentAPIs.watchActiveFile(e))},openFile:(r=e).environmentAPIs.openFile,getActiveFile:function(){return r.environmentAPIs.getActiveFile()}},(i=e.getThemeContext,a=e.onThemeChange,{getCurrentTheme:function(){return i().theme},getCurrentThemeValues:function(){return i().theme.values.global},onThemeChange:function(e){var n=a(e);return oC(function(){n()})},onThemeChangeValues:function(e){var n=a(function(n){return e(n.values.global)});return oC(function(){n()})}}),sb(e,h.toasts),{currentUser:sa(o7),userById:sa(sn),userByUsername:sa(se),currentRepl:function(e){return sa(sr)((0,v._)({id:f},e))},replById:sa(sr),replByUrl:sa(si)},(o=e.services.container.client(),s=e.logger.createLogger({api:"exec"}),(0,v._)({},ss([sl(e,["write-exec"])],{exec:function(e){return(0,ei._)(function(){var n,t,r,i;return(0,ea._)(this,function(a){switch(a.label){case 0:return[4,e.args];case 1:return n=a.sent(),[4,e.env];case 2:if(t=a.sent(),s.info("exec: [".concat(n.join(", "),"]"),{environmentVariables:t}),!so.Value.Check(su,t))throw Error("Invalid environment variables");return[4,e.splitStderr];case 3:return r=a.sent(),i=function(){},[2,oC({dispose:function(){i()},promise:new Promise(function(a){i=o.openChannel({service:"exec"},function(o){var l=o.channel;l.onCommand(function(n){r?n.output?e.onOutput(n.output):n.stderr&&e.onStdErr(n.stderr):n.output&&e.onOutput(n.output)}),l.request({exec:{args:n,env:t,splitStderr:!!r}}).then(function(n){if(n.ok)return void a({exitCode:0,error:null});if(n.channelClosed){var t="Channel closed before command's execution finished";e.onError(t),a({exitCode:null,error:t});return}if("open"===l.status&&i(),n.error){var r,o,s=Number(null==(o=n.error)||null==(r=o.match(/-?[0-9]+/g))?void 0:r[0]);a({exitCode:"number"==typeof s?s:null,error:n.error});return}throw Error("Unknown error")}).catch(function(n){s.error("exec: threw crosis error:\n".concat(String(n||"")));var t="exec() failed due to internal error. See console for details.";e.onError(t),a({error:t,exitCode:null})})})})})]}})})()}}))),(l=e.extension,u=e.paneId,c=e.environmentAPIs,d=!1,{activatePane:function(){u&&(c.activatePane(u),d||(d=!0,(0,el.track)(eu.events.EXTENSION_USED,{action:"used",extensionId:l.extensionId,extensionName:l.manifest.name})))}})),{commands:{registerCommand:function(n,t){return(0,ei._)(function(){var r;return(0,ea._)(this,function(i){switch(i.label){case 0:if(!n.commandId||""===n.commandId)throw Error("Attempted to register command without id");if(!n.contributions||!Array.isArray(n.contributions))throw Error("Command: In ".concat(n.commandId,", contributions should be an array"));return 0===n.contributions.length&&e.logger.warn("Command: ".concat(n.commandId," has no contributions")),[4,(0,oa.parseCommandProxyToExtensionCommand)(t,e)];case 1:return r=i.sent(),e.store.set(or.registerExtensionCreateCommandAtom,{extensionStateAtom:e.extensionStateAtom,createCommand:{id:n.commandId,contributions:n.contributions,create:function(){return(0,ei._)(function(){return(0,ea._)(this,function(e){return[2,r]})})()}}}),[2]}})})()},registerCreateCommand:function(n,t){return(0,ei._)(function(){var r,i;return(0,ea._)(this,function(a){if(!n.commandId||""===n.commandId)throw Error("Attempted to register command without id");if(!n.contributions||!Array.isArray(n.contributions))throw Error("Command: In ".concat(n.commandId,", contributions should be an array"));return 0===n.contributions.length&&e.logger.warn("Command: ".concat(n.commandId," has no contributions")),(r=n.contributions.filter(function(e){return!(e in oP.ContributionType)})).length>0&&e.logger.warn("Command: ".concat(n.commandId," has unrecognized contributions: ").concat(r.join(", "),". Valid contributions are ").concat(Object.values(oP.ContributionType))),i={id:n.commandId,contributions:n.contributions,create:function(n){var r=n.path;return(0,ei._)(function(){var n;return(0,ea._)(this,function(i){switch(i.label){case 0:return[4,Promise.race([t({path:r}),new Promise(function(e){return setTimeout(function(){return e(oR)},50)})])];case 1:if(null===(n=i.sent()))return[2,null];if(n===oR)return e.logger.warn("Command took too long to create. When using registerCreateCommand, you must return a command within ".concat(50,"ms")),[2,null];return[2,(0,oa.parseCommandProxyToExtensionCommand)(n,e)]}})})()}},e.store.set(or.registerExtensionCreateCommandAtom,{extensionStateAtom:e.extensionStateAtom,createCommand:i}),[2]})})()}},experimental:(0,r$._)((0,v._)({},ss([sh(e)],{hasExperimentalApi:function(){return!0}})),{editor:ss([sh(e)],(0,v._)({},{getPreferences:function(){return(0,ei._)(function(){var e,n,t,r;return(0,ea._)(this,function(i){switch(i.label){case 0:return[4,null===nJ.apolloClient||void 0===nJ.apolloClient?void 0:nJ.apolloClient.query({query:st})];case 1:if(null==(t=i.sent())||null==(n=t.data)||null==(e=n.currentUser)?void 0:e.workspacePreferences)return[2,(0,sc.getUserPreferences)(t.data.currentUser.workspacePreferences)];throw Error(null==t||null==(r=t.error)?void 0:r.message)}})})()}})),commands:ss([sh(e)],(0,v._)({},sf(e))),auth:ss([sh(e)],(0,v._)({},{getAuthToken:function(){return(0,ei._)(function(){var n,t;return(0,ea._)(this,function(r){switch(r.label){case 0:if(e.extension.isLocal)return[2,[btoa(JSON.stringify({alg:"none",typ:"JWT",local:!0,key:"there-is-no-key-for-local-extensions"})),btoa(JSON.stringify({installationId:e.extension.installationId,extensionId:e.extension.extensionId,userId:e.userId,origin:"https://staging.replit.com"})),"this-is-a-locally-generated-jwt-that-will-fail-verification-to-avoid-being-used-accidentally-in-prod-so-please-check-the-header-for-whether-this-is-a-local-extension"].join(".")];return[4,null===nJ.apolloClient||void 0===nJ.apolloClient?void 0:nJ.apolloClient.query({query:sp,variables:{installationId:e.extension.installationId}})];case 1:if(!(null==(n=r.sent())?void 0:n.data))throw Error("Failed to authenticate: something went wrong");if("NotFoundError"===(t=n.data.extensionInstallationById).__typename)throw Error("Failed to authenticate: invalid installation ID");if("ExtensionInstallation"!==t.__typename||!t.token)throw Error("Failed to authenticate: something went wrong");return[2,t.token]}})})()}})),internal:ss([sh(e)],(0,v._)({},sf(e)))}),internal:function(e){var n,t,r;return e.store.get(e.extensionStateAtom).enableInternalApi?{hasInternalApi:function(){return!0},ghostwriter:{},container:(n=e.services.container,{getConnectionState:function(){return n.getConnectionState()},onConnectionStateChanged:function(e){var t=n.onConnectionStateChanged(e);return oC(function(){t()})}}),layout:{revealOrInsertTool:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=e.logger.createLogger({api:"revealOrInsertTool"});if(!e.extension.manifest.tools)return void t.warn("No tools defined in extension manifest");if(e.extension.manifest.tools.length<n+1)return void t.warn("Tool index out of bounds");var r=e.extension.manifest.tools[n],i=r.name||e.extension.manifest.name,a=r.handler;e.environmentAPIs.revealOrInsertTool({extensionId:e.extension.extensionId,installationId:e.extension.installationId,baseUrl:e.extension.baseUrl,path:a,name:i})},getLayoutState:function(){return e.environmentAPIs.getLayoutState()},setLayoutState:function(n){return e.environmentAPIs.setLayoutState(n)}},secrets:(t=e.services.secrets,{setSecret:function(e){return(0,ei._)(function(e){var n,r;return(0,ea._)(this,function(i){switch(i.label){case 0:return n=e.key,r=e.value,[4,t.addEntries([{key:n,value:r}])];case 1:return i.sent(),[2,(0,sx.Ok)(!0)]}})}).apply(this,arguments)},getSecret:function(e){return(0,ei._)(function(){var n;return(0,ea._)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,t.read()];case 1:return[2,sx.Ok.apply(void 0,[r.sent().get(e.key)])];case 2:return n=r.sent(),[2,(0,sx.Err)(n)];case 3:return[2]}})})()},getReferenceCode:function(e){return(0,ei._)(function(){return(0,ea._)(this,function(n){return[2,(0,sy.getEnvCodeForLanguage)(e.filePath,e.key)]})})()}}),dotReplit:{getConfig:(r=e.services.dotReplit).getConfig,update:r.updateDotReplit},ssh:{getSshConfig:function(){return(0,ei._)(function(){return(0,ea._)(this,function(n){return[2,e.environmentAPIs.getSshConfig()]})})()}},commands:sf(e)}:null}(e),debug:{info:function(e,n){return g.info(e,n)},warn:function(e,n){return g.warn(e,n)},error:function(e,n){return g.error(e,n)}},handshake:function(n){return(0,ei._)(function(){var t,r,i,a;return(0,ea._)(this,function(o){switch(o.label){case 0:return[4,null==n?void 0:n.clientName];case 1:return r=null!=(t=o.sent())?t:"(unset)",[4,null==n?void 0:n.clientVersion];case 2:return a=null!=(i=o.sent())?i:"(unset)",(0,el.track)(eu.events.EXTENSION_USED,{action:"sandbox_initialized",clientName:r,clientVersion:a,extensionId:e.extension.extensionId,extensionName:e.extension.manifest.name,installationId:e.extension.installationId}),(0,ei._)(function(){var n,t,i;return(0,ea._)(this,function(o){switch(o.label){case 0:if(!e.extension.isLocal||"@replit/extensions"!==r)return[2];return[4,e.services.container.exec("sh","-c","npm view @replit/extensions --json version 2>/dev/null")];case 1:if((t=o.sent()).error)throw t.error;if(!t.output)throw Error("No output from npm");if((i=JSON.parse(null==(n=t.output)?void 0:n.trim()))===a)return[2];return e.logger.warn("There is a new version of @replit/extensions available. You are using ".concat(a,", but the latest version is ").concat(i),{clientVersion:a,latestVersion:i}),[2]}})})(),[2,{success:!0}]}})})()}})}(e);if(!n.contentWindow)throw Error("No contentWindow");var i=ob(r,function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:self,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"*";return{postMessage:function(n,r){e.postMessage(n,t,r)},addEventListener:n.addEventListener.bind(n),removeEventListener:n.removeEventListener.bind(n)}}(n.contentWindow,self,t),{origin:t,source:n.contentWindow}),a=function(r){if(r.origin===t&&n.contentWindow===r.source){var i=r.data;i.payload&&e.logger.warn("Extension sent deprecated postMessage",i)}};return window.addEventListener("message",a),function(){i(),window.removeEventListener("message",a)}}({extension:n,extensionIframe:s.current,services:c,paneId:i,replId:l,getThemeContext:function(){return g.current},onThemeChange:function(e){return m.current.push(e),function(){m.current.splice(m.current.indexOf(e),1)}},store:p,extensionStateAtom:f,environmentAPIs:a,filePath:o,logger:n.logger.createLogger({sandboxUrl:t,sandboxTitle:r}),userId:u,ghostwriter:x}))},[u,g,c,j,i,p,f,a,l,o,n,t,r,x]);return{isValidExtensionPaneUrl:j,didConnectOnce:b,getIframeProps:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,r$._)((0,v._)({title:r,src:t},ol.default,e),{ref:(0,ou.mergeRefs)([s,e.ref],{breadcrumb:"client/workspace/extensions/sandbox/useExtensionSandbox.tsx:191"}),onLoad:function(n){S(),e.onLoad&&e.onLoad(n)}})},reloadSandbox:(0,N.useCallback)(function(){if(s.current){var e=s.current.src;s.current.src=e}},[])}}function sI(e){var n=e.extension,t=e.environmentAPIs;if(!n.manifest.background)throw Error("ExtensionBackground loaded without a background script defined in manifest");var r=(0,or.useExtensionStateAtom)(n.installationId),i=sS({extension:n,sandboxUrl:(0,oo.getAssetUrl)(n.baseUrl,n.manifest.background.page),sandboxTitle:"Extension Background: "+n.manifest.name,environmentAPIs:t,paneId:null,filePath:null}),a=i.didConnectOnce,o=i.isValidExtensionPaneUrl,s=i.getIframeProps;return o()&&a&&r?(0,g.jsx)("iframe",(0,v._)({},s({css:{width:"0px",height:"0px",border:"none"}}))):null}var sC=e.i(838124),sk=e.i(557154),sE=e.i(934565),sT=e.i(952030),sP=e.i(373764);function sR(){var e,n,t,r,i,a=(0,a2.default)(),o=(0,a1.useCurrentUserId)(),s=(0,ot.default)().container,l=(0,on.default)(s).url,u=(0,sC.useIsExtensionRepl)(),c=(0,oi.useInstallExtension)(),d=ax(),p=(0,oi.useInstallExtensionLocallyByURL)(),f=(0,oi.useLoadExtension)(),h=(0,oi.useInitializeExtensionSystem)();(0,sC.useSyncReplConfigIsExtension)();var m=(0,or.useExtensions)(),x=oe(),y=(0,U._)((0,N.useState)(!1),2),b=y[0],_=y[1];(0,N.useEffect)(function(){a&&o&&h({replId:a,userId:o})},[a,o,h]);var j=(0,or.useFileHandlers)(),S=ra(nj);(0,N.useEffect)(function(){S(j)},[j,S]);var I=ra(rL);t=(e=(0,v._)({},rA,void 0),w.useQuery(rD,e)).data,r=ra(rM),i=null==t||null==(n=t.currentUser)?void 0:n.filetypeAssociations,(0,N.useEffect)(function(){i&&r(i)},[r,i]);var C=rr(rF),k=ra(rF),E=function(e){var n=e.filterUser;return function(e){var t=e.active;return(0,ei._)(function(){var e,r;return(0,ea._)(this,function(i){switch(i.label){case 0:if(!t)return[2,[]];return[4,null===nJ.apolloClient||void 0===nJ.apolloClient?void 0:nJ.apolloClient.query({query:aJ,variables:{replId:a,userId:n?o:void 0}})];case 1:if(!(e=i.sent())||e.error||!(r=e.data.extensionList))return[2,[]];return[2,r.map(function(e){var n;return{match:aE.matchLabel,data:{type:"action",label:e.name,icon:(0,g.jsx)(sP.default,{}),description:null!=(n=e.description)?n:"",run:function(){e.url&&(e.installation?f({installationId:(0,a0.asInstallationId)(e.installation.id)}):c({replId:a,extensionId:(0,a0.asExtensionId)(e.id)}))}}}})]}})})()}},T=(0,or.useExtensionCommands)(oP.ContributionType.CommandBar);return aK({data:{type:"group",key:"Extensions",description:"Commands from Extensions"},commands:function(){return(0,ei._)(function(){var e;return(0,ea._)(this,function(n){switch(n.label){case 0:return e=[{data:{}}],[4,Promise.all(T.map(function(n){return(0,ei._)(function(){var t;return(0,ea._)(this,function(r){switch(r.label){case 0:return[4,n.create({path:e})];case 1:if(!(t=r.sent()))return[2,null];return[2,(0,oa.wrapExtensionCommand)(t,{path:e})]}})})()}))];case 1:return[2,n.sent().filter(Boolean)]}})})()}},{enabled:!0}),aK({match:aE.matchLabel,commands:function(e){return e.active||""!==e.searchQuery?[{match:aE.matchLabel,data:{type:"action",label:"Extension Devtools",icon:(0,g.jsx)(sT.default,{}),description:"Manage and deploy this Repl as an extension",run:function(){d({pane:{type:"extensionDevtools"}})}}},{match:aE.matchLabel,data:{type:"action",label:"URL",icon:(0,g.jsx)(sT.default,{}),description:"Add an extension by URL",run:function(){_(!0)}}},{match:aE.matchLabel,data:{type:"action",label:"From this Repl",icon:(0,g.jsx)(sT.default,{}),description:"Load this Repl as an extension",run:function(){l&&p(l)}}},{match:aE.matchLabel,data:{type:"context",label:"My Extensions",icon:(0,g.jsx)(sP.default,{}),description:"Browse extensions you have created"},commands:E({filterUser:!0})},{match:aE.matchLabel,data:{type:"action",label:"Docs",icon:(0,g.jsx)(sE.default,{}),description:"Read the Extensions docs",run:function(){window.open(aZ.LINKS_DOCS.EXTENSIONS,"_blank","noopener")}}}]:[]},data:{type:"context",label:"Extensions",icon:(0,g.jsx)(sP.default,{}),description:"Manage extensions"}},{enabled:u}),(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(az.Modal,{isOpen:b,onRequestClose:function(){return _(!1)},children:(0,g.jsx)(sk.default,{prompt:"Add an extension by URL",desc:"Insert extension url",placeholder:"https://example-extension.replit.app",type:"text",onCancel:function(){return _(!1)},onConfirm:function(e){p(e)}})}),(0,g.jsx)(az.Modal,{isOpen:!!C,onRequestClose:function(){return k(null)},children:C?(0,g.jsx)(a6,{fileExtension:C.fileExtension,extensionId:C.extensionId,fileHandlerId:C.fileHandlerId,onCancel:function(){return k(null)},onConfirm:function(){return(0,ei._)(function(){var e;return(0,ea._)(this,function(n){switch(n.label){case 0:return e=C.fileExtension,[4,I({fileExtension:e,newAssociation:{extensionId:C.extensionId,fileHandlerId:C.fileHandlerId}})];case 1:return n.sent(),k(null),[2]}})})()}}):null}),m.map(function(e){return e.manifest.background?(0,g.jsx)(sI,{environmentAPIs:x,extension:e},e.installationId):null})]})}var sA=e.i(127227),sD=e.i(292297),sV=e.i(761922);function sO(){var e=(0,ot.default)().fs,n=(0,U._)((0,N.useState)(!1),2),t=n[0],r=n[1],i=(0,U._)((0,N.useState)(!1),2),a=i[0],o=i[1],s=(0,N.useId)();(0,N.useEffect)(function(){if(!a)return e.onDiskQuotaExceeded(function(){r(!0)})},[e,a]);var l=(0,N.useCallback)(function(){r(!1)},[r]);return(0,g.jsx)(az.Modal,{isOpen:t,onRequestClose:l,children:(0,g.jsx)(D.View,{gap:24,children:(0,g.jsxs)(D.View,{gap:24,children:[(0,g.jsxs)(a8.Header,{level:3,variant:"headerDefault",children:["Oops! This Repl's disk is full"," ",(0,g.jsx)(sD.default,{color:P.tokens.accentNegativeDefault,size:20})]}),(0,g.jsxs)(a8.Text,{variant:"subheadDefault",children:["Please free up space by deleting some files. You can open the file tree by clicking the ",(0,g.jsx)(sV.default,{})," icon on the left."]}),(0,g.jsx)(a8.Text,{children:"You can check how much space you are using from the Repl Resources section under the file tree."}),(0,g.jsxs)(D.View,{row:!0,gap:8,tag:"label",children:[(0,g.jsx)(sA.Checkbox,{id:s,checked:a,onChange:o}),(0,g.jsx)(a8.Text,{variant:"small",children:"Do not show this message again for this session."})]}),(0,g.jsx)(a4.Button,{onClick:l,text:"Close"})]})})})}var sF=e.i(816639),sM=e.i(989740),sL=e.i(679668),sG=e.i(515791);function sU(){var e=ra(tJ),n=(0,sM.default)({moveOrDeleteFile:e}),t=n.isConverging,r=n.didContentsDiverge,i=n.showMoreDetail,a=n.failedFiles,o=n.failedFilesOptions,s=n.selectedFile,l=n.setSelectedFile,u=n.reviewingPrompt,c=n.onChoice,d=n.local,p=n.remote,f=[i9.rcss.minHeight("7em"),i9.rcss.maxHeight("50vh"),i9.rcss.overflowY("auto"),{"> div":{display:"flex",alignItems:"stretch",width:"100%",height:"100%"},"> div > .cm-editor":{flex:"1 1 auto",width:"100%"}}];return(0,g.jsx)(az.Modal,{css:[{maxHeight:"90%"}],preventClose:!0,maxWidth:"90%",isOpen:r,onRequestClose:function(){},children:(0,g.jsxs)(D.View,{gap:24,children:[(0,g.jsx)(a8.Header,{level:3,variant:"headerDefault",children:"Replit is out of sync!"}),(0,g.jsxs)(a8.Text,{children:["Sometimes Replit has trouble making sure everyone's code is the same. Let us know which version of"," ",a.length>1?"these files":"this file"," you'd like to keep."," ",a.length>1?(0,g.jsxs)("strong",{children:["There are ",a.length," files impacted by this."]}):""]}),t?(0,g.jsx)(sG.default,{}):(0,g.jsxs)(g.Fragment,{children:[o.length?(0,g.jsx)(sL.Select,{"aria-label":"Select file with diverged contents",initialSelectedItem:o[0],selectedItem:o.find(function(e){return e.path===s}),items:o,onChange:function(e){l(e.path)}}):null,i?(0,g.jsxs)(D.View,{css:[i9.rcss.backgroundColor.redDimmest,i9.rcss.font.code],pt:16,p:8,row:!0,gap:16,justify:"start",align:"center",children:[(0,g.jsx)(a8.Text,{variant:"subheadDefault",multiline:!1,children:"Debug View"}),(0,g.jsxs)(a8.Text,{multiline:!1,children:["Divergence type: ",null==u?void 0:u.case]})]}):null,(0,g.jsxs)(D.View,{row:!0,gap:8,children:[(0,g.jsxs)(D.View,{css:[{flexBasis:0}],grow:!0,shrink:!0,children:[(0,g.jsx)(a8.Text,{variant:"subheadDefault",multiline:!1,children:"My changes"}),(0,g.jsx)(A.Surface,{elevated:!0,grow:!0,shrink:!0,py:8,children:(0,g.jsx)(D.View,{css:f,children:(0,g.jsx)(sF.DiffComponent,{diffViewer:d})})}),(0,g.jsxs)(D.View,{pt:16,children:[(0,g.jsx)(a8.Text,{css:[i9.rcss.textAlign.center],children:"This might disrupt other people's work or create unexpected bugs."}),(0,g.jsx)(a4.Button,{onClick:function(){c("local")},text:"Reset to Mine"})]})]}),(0,g.jsxs)(D.View,{css:[{flexBasis:0}],grow:!0,shrink:!0,children:[(0,g.jsx)(a8.Text,{variant:"subheadDefault",multiline:!1,children:"Shared changes"}),(0,g.jsx)(A.Surface,{elevated:!0,grow:!0,shrink:!0,py:8,children:(0,g.jsx)(D.View,{css:f,children:(0,g.jsx)(sF.DiffComponent,{diffViewer:p})})}),(0,g.jsxs)(D.View,{pt:16,justify:"end",children:[(0,g.jsx)(a8.Text,{css:[i9.rcss.textAlign.center],children:"This is the safest option and won't disrupt other's work."}),(0,g.jsx)(a4.Button,{onClick:function(){c("remote")},text:"Sync to Shared",colorway:"primary"})]})]})]})]})]})})}var sN=e.i(260924),sB=e.i(317919),sW=e.i(399344),sz=e.i(703916),sH=e.i(316699),sq=e.i(142685),sK=e.i(610357);e.i(653863);var s$=e.i(973519),sQ=e.i(744895),sY=e.i(702522),sX=e.i(41e4),sJ=e.i(927158),sZ=e.i(90376),s0=e.i(759097),s1=["","","","","",""];function s2(e){return new Promise(function(n){return setTimeout(n,e)})}var s4=e.i(989481),s8=e.i(793579),s3=e.i(366492),s6=e.i(279042);function s5(){var e=(0,x._)(["\n  fragment ReplEnvironmentDesktopMyReplsSearchRepl on Repl {\n    id\n    title\n    timeUpdated\n    url\n    iconUrl\n    ...ReplLinkRepl\n    owner {\n      ... on User {\n        id\n        username\n        image\n      }\n      ... on Team {\n        id\n        username\n        image\n      }\n    }\n  }\n  ","\n"]);return s5=function(){return e},e}function s9(){var e=(0,x._)(["\n  query ReplEnvironmentDesktopMyReplsSearch($query: String, $count: Int) {\n    currentUser {\n      id\n      search {\n        repls(query: $query, count: $count) {\n          id\n          ...ReplEnvironmentDesktopMyReplsSearchRepl\n        }\n      }\n    }\n  }\n  ","\n"]);return s9=function(){return e},e}var s7=(0,y.gql)(s5(),s6.ReplLinkReplFragmentDoc),le=(0,y.gql)(s9(),s7),ln=e.i(314531),lt=e.i(46654),lr=e.i(228108),li=e.i(290446),la=e.i(243074),lo=(0,rl.cssRecord)({root:[i9.rcss.viewStyle,i9.rcss.rowWithGap(8),i9.rcss.align.center,i9.rcss.px(8),{textDecoration:"none"}],meta:{fontSize:10}});function ls(e){var n=e.repl,t=e.height,r=e.isActive,i=e.searchQuery,a=n.title,o=(0,N.useMemo)(function(){return i?ln.default.match(i,a):null},[i,a]);return(0,g.jsxs)(s3.default,{href:n.url,passHref:!0,style:{height:t},css:lo.root,children:[(0,g.jsx)(lr.default,{alt:n.title,size:32,iconUrl:n.iconUrl}),(0,g.jsxs)(D.View,{grow:!0,shrink:!0,gap:2,children:[(0,g.jsx)(li.HighlightMatches,{text:n.title,highlight:null==o?void 0:o.ranges,dimmed:!r}),(0,g.jsxs)(a8.Text,{css:lo.meta,color:"dimmest",multiline:!1,children:[n.owner.username,"  edited ",(0,lt.ago)(n.timeUpdated)]})]})]})}function ll(){var e=aw(),n=ax();return(0,N.useCallback)(function(t){return(0,na.isFilePane)(t)&&t.data.path?e((0,r$._)((0,v._)({},t.data),{path:t.data.path})):n({pane:t})},[n,e])}var lu=e.i(926118),lc=(0,eo.atom)(!1),ld=(0,eo.atom)(null,function(e,n){e(lc)?(0,ec.flushSync)(function(){n(lc,!1)}):n(lc,!0)});function lp(){return(0,es.useSetAtom)(ld)}var lf=e.i(62534),lh=e.i(695337),lg={id:"toggleKeyboardShortcuts",name:"Keyboard shortcuts Help",description:"Opens the keyboard shortcuts modal",default:"Shift-/"};let lm=function(){var e=(0,es.useAtomValue)(lc),n=lp();return(0,g.jsx)(az.Modal,{isOpen:e,onRequestClose:n,maxWidth:1200,centered:!0,children:(0,g.jsx)(D.View,{gap:12,children:(0,g.jsx)(lx,{})})})};var lv=["toggleGlobalCommandBarCommand","agent.switchMode","agent.toggle","webviewpane.reload","toggleKeyboardShortcuts","sidebar.toggle","paneMenu.toggle","files.searchContents","files.searchFiles","repl.showShell"];function lx(){var e=(0,aM.useKeyBindings)(),n=ll(),t=lp(),r=(0,er._)(e.values()).filter(function(e){return e.shortcut}).filter(function(e){return void 0===e.scope}).sort(function(e,n){var t=lv.indexOf(e.id),r=lv.indexOf(n.id);return -1!==t&&-1!==r?t-r:e.description&&!n.description?-1:!e.description&&n.description?1:e.name.localeCompare(n.name)}),i=(0,N.useCallback)(function(){n({type:"preferences",data:{tab:1}}),t()},[n,t]);return(0,g.jsxs)(D.View,{p:0,gap:12,children:[(0,g.jsx)(a8.Header,{level:2,variant:"subheadBig",children:"Keyboard shortcuts"}),r.length>0?(0,g.jsx)(A.Surface,{className:lh.default.surface,children:r.map(function(e){return(0,g.jsxs)(D.View,{row:!0,align:"start",justify:"space-between",gap:8,"data-testid":e.id,children:[(0,g.jsxs)(D.View,{grow:0,shrink:!0,gap:2,children:[(0,g.jsx)(a8.Text,{multiline:!1,children:e.name}),e.description?(0,g.jsx)(a8.Text,{color:"dimmest",multiline:!1,children:e.description}):null]}),e.shortcut?(0,g.jsx)(lu.KeyComboBlocks,{small:!0,keyCombo:e.shortcut}):null]},e.id)})}):(0,g.jsx)(D.View,{children:(0,g.jsx)(a8.Text,{color:"dimmest",children:"No keyboard shortcuts found."})}),(0,g.jsx)(D.View,{align:"start",children:(0,g.jsx)(a4.Button,{variant:"outlined",onClick:i,iconLeft:(0,g.jsx)(lf.default,{}),text:"Customize keyboard shortcuts"})})]})}var ly=e.i(556088),lw=e.i(61524),lb=e.i(171362),l_=e.i(369948),lj=e.i(360877),lS=e.i(357399),lI=["fontSize","wrapping","minimapDisplay","indentDetection","indentFormatPastes","indentIsSpaces","keyboardHandler","showFileTreeGitStatus","codeIntelligence","shellBellAudio","accessibleTerminal","webviewAutoOpenOnPortOpened","forwardPortsAutomatically","multiselectModifierKey","codeSuggestion","chatEngine","ghostwriterModelSelection"],lC=e.i(982829),lk=e.i(211733),lE=e.i(133783),lT=e.i(959407),lP=e.i(6560),lR=e.i(578166),lA=e.i(77164),lD=e.i(718610);function lV(e){return(0,N.useMemo)(function(){var n=function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=[];return Object.entries(t).forEach(function(t){var a,o=(0,U._)(t,2),s=o[0],l=o[1],u=(0,er._)(r).concat([s]);if(l.children){var c,d=n(l.children,u);i.push({match:aE.matchLabel,data:{type:"context",label:l.label,icon:null!=(c=l.icon)?c:(0,g.jsx)(g.Fragment,{})},commands:function(){return d}})}else l.component&&i.push({match:aE.matchLabel,data:{type:"action",label:l.label,icon:null!=(a=l.icon)?a:(0,g.jsx)(g.Fragment,{}),run:function(){return e(u)}}})}),i},t=n(lA.developerTabs);return{data:{type:"context",label:"Developer",icon:(0,g.jsx)(lD.default,{})},commands:function(e){return e.active||""!==e.searchQuery?t:[]}}},[e])}var lO=e.i(1736),lF=e.i(729122),lM=e.i(589721),lL=e.i(267103);function lG(){var e=(0,x._)(["\n  query ConfiguredTools($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        hasAuthUsers\n        defaultBucket {\n          ... on Bucket {\n            id\n          }\n        }\n      }\n    }\n  }\n"]);return lG=function(){return e},e}var lU={},lN=(0,y.gql)(lG()),lB=e.i(424746),lW=e.i(630818),lz=e.i(882027);function lH(e){var n,t,r,i,a,o,s,l,u,c,d,p,f,h,m,x,y,b,_,j=e.openPane,S=e.currentPaneId,I=(0,ot.default)().fs,C=(0,aP.usePaneUIContext)(),k=(0,N.useCallback)(function(e){var n=e.path,t=(0,na.getPaneTypeForFile)({path:n});(0,el.track)(eu.events.TOOL_OPENED,{source:"New Tab",tool:t}),j({pane:{type:t,data:{path:n}}})},[j]),E=ra(i3),T=ro(nI),P=(0,N.useCallback)(function(e){if((0,el.track)(eu.events.TOOL_OPENED,{source:"New Tab",tool:e.type}),S&&(0,na.isSingleton)(e.type)){var n=T().find(function(n){var t=(0,U._)(n,2);return t[0],t[1].type===e.type});if(n)return E({from:n[0],to:S})}j({pane:e})},[j,T,S,E]),R=lV((0,N.useCallback)(function(e){P({type:"developer",data:{tab:e}})},[P])),A=(0,lO.useShouldHideFileInWorkspace)(),D=(0,tb.useGetRecentFiles)(),V=l$(S),O=(x=(n=(0,a2.default)(),a=(i=(null==(r=(null==(t=(0,lM.useNewPanePrimaryOutputQuery)({variables:{replId:n}}).data)?void 0:t.getRepl.__typename)==="Repl"?t.getRepl:null)?void 0:r.config)||{}).isServer,o=i.isAgentStack,s=i.isExpertMode,(0,N.useMemo)(function(){return o?[{type:"automations"}]:s?(0,er._)(a?[{type:"webview"}]:[]).concat([{type:"runnerOutput"}]):[{type:"webview"}]},[a,o,s])),y=(p=(null==(d=(u={variables:{replId:(0,a2.default)()}},c=(0,v._)({},lU,u),w.useQuery(lN,c)).data)?void 0:d.getRepl.__typename)==="Repl"?d.getRepl:null,f=void 0!==(0,lB.useNeonDevelopmentDatabase)().database,h=!!(null==p?void 0:p.hasAuthUsers),m=(null==p||null==(l=p.defaultBucket)?void 0:l.__typename)==="Bucket",(0,N.useMemo)(function(){var e=[];return h&&e.push({type:"replitAuth"}),f&&e.push({type:"neon"}),m&&e.push({type:"objectStorage"}),e},[f,h,m])),b=(0,aO.useToolPanes)(),_=rr(nI),(0,N.useMemo)(function(){var e=new Map,n=new Set,t=[],r=function(r,i){if((0,na.isExtensionPane)(i))return void t.push(i);if(!n.has(i.type)){n.add(i.type);var a=e.get(r);a?a.push(i):e.set(r,[i])}},i=!0,a=!1,o=void 0;try{for(var s,l=x[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value;r("output",u)}}catch(e){a=!0,o=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw o}}var c=!0,d=!1,p=void 0;try{for(var f,h=y[Symbol.iterator]();!(c=(f=h.next()).done);c=!0){var g=f.value;r("configured",g)}}catch(e){d=!0,p=e}finally{try{c||null==h.return||h.return()}finally{if(d)throw p}}var m=!0,v=!1,w=void 0;try{for(var j,S=lq[Symbol.iterator]();!(m=(j=S.next()).done);m=!0){var I=j.value;r("suggested",I)}}catch(e){v=!0,w=e}finally{try{m||null==S.return||S.return()}finally{if(v)throw w}}var C=!0,k=!1,E=void 0;try{for(var T,P=b[Symbol.iterator]();!(C=(T=P.next()).done);C=!0){var R=T.value;r("rest",R)}}catch(e){k=!0,E=e}finally{try{C||null==P.return||P.return()}finally{if(k)throw E}}var A=[],D=!0,V=!1,O=void 0;try{for(var F,M=e.values()[Symbol.iterator]();!(D=(F=M.next()).done);D=!0){var L=F.value,G=!0,N=!1,B=void 0;try{for(var W,z=L[Symbol.iterator]();!(G=(W=z.next()).done);G=!0)!function(){var e=W.value,n=!(0,na.isSingleton)(e.type)&&!(0,na.isFilePane)(e)&&_.find(function(n){var t=(0,U._)(n,2);return(t[0],t[1]).type===e.type});n&&A.push(n)}()}catch(e){N=!0,B=e}finally{try{G||null==z.return||z.return()}finally{if(N)throw B}}}}catch(e){V=!0,O=e}finally{try{D||null==M.return||M.return()}finally{if(V)throw O}}return{groupedPanes:e,existingNonSingletonTools:A,extensions:t}},[x,y,b,_])),F=O.groupedPanes,M=O.existingNonSingletonTools,L=O.extensions;return(0,N.useMemo)(function(){var e,n,t,r=(0,lP.createFindOrCreateFileCommand)({openFile:k,fs:I,shouldHideFile:A,getRecentFiles:D}),i=(n=(e={fs:I,openFile:k}).openFile,t=e.fs,{match:aE.fzfMatchLabel,data:{type:"context",label:"New file",description:"Create a new file",icon:(0,g.jsx)(sT.default,{})},commands:function(e){var r=e.searchQuery,i=e.active;return r&&i?[{match:aE.matchLabel,data:{type:"action",description:"Create a new file",label:r,icon:(0,g.jsx)(lW.default,{path:r}),run:function(){return(0,ei._)(function(){return(0,ea._)(this,function(e){switch(e.label){case 0:return[4,t.stat(r)];case 1:if(e.sent().exists)return[2,{type:"error",message:'"'.concat(r,'" already exists')}];return[4,t.writeFile(r,sg.default.from(""))];case 2:if(e.sent().error)return[2,{type:"error",message:'Could not create "'+r+'"'}];return n({path:r}),[2]}})})()}}}]:[]}}),a=[];V&&a.push(V);var o=function(e,n){if(n.panes&&0!==n.panes.length){var t=[],r=!0,i=!1,o=void 0;try{for(var s,l=n.panes[Symbol.iterator]();!(r=(s=l.next()).done);r=!0)!function(){var e=s.value;M.some(function(n){var t=(0,U._)(n,2);return(t[0],t[1]).type===e.type})||t.push(lK(e,P,C,n.large))}()}catch(e){i=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}a.push({data:"context"===e.type?(0,r$._)((0,v._)({},e),{icon:(0,g.jsx)(g.Fragment,{})}):e,commands:function(){return t}})}};return o({type:"context",label:"Your App"},{panes:F.get("output"),large:!0}),o({type:"group",key:"configured"},{panes:F.get("configured")}),M.length>0&&S&&a.push({data:{label:"Jump to existing tab",type:"context",icon:(0,g.jsx)(g.Fragment,{})},commands:function(){return M.map(function(e){var n=(0,U._)(e,2),t=n[0];return lK(n[1],function(){E({from:t,to:S})},C)})}}),o({type:"context",label:"Suggested"},{panes:F.get("suggested")}),o({type:"group",key:"Other tools"},{panes:F.get("rest")}),a.push({data:{type:"context",label:"Extensions",icon:(0,g.jsx)(g.Fragment,{})},commands:function(){return L.map(function(e){return lK(e,P,C)})}}),M.length>0&&a.push({data:{key:"existing-non-singleton-tools",type:"group"},commands:function(){return M.map(function(e){var n=(0,U._)(e,2);return lK((n[0],n[1]),P,C)})}}),a.push(R),a.push({data:{type:"context",label:"Files",icon:(0,g.jsx)(g.Fragment,{})},commands:function(){return[r,i]}}),{data:{type:"group",key:"root",description:"Search for tools & files"},commands:function(){return a}}},[I,D,A,k,R,F,L,M,S,E,P,C,V])}var lq=[{type:"deployments"},{type:"integrations"},{type:"neon"},{type:"objectStorage"},{type:"replitAuth"},{type:"securityScan"},{type:"envEditor"}];function lK(e,n,t){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=r?24:void 0,a=t.getTitle(e),o=t.Icon({pane:e,size:i});return{match:(0,aD.matchToolPane)({pane:e,aliases:aV.paneAliases.get(e.type),iconSize:i}),data:{key:"extension"===e.type?"extension-".concat(e.data.installationId,"-").concat(e.data.path):void 0,type:"action",label:a,icon:o,run:function(){return n(e)}}}}function l$(e){var n=ra(th),t=aC(),r=(0,lL.useObservable)(t.isCollapsed),i=t.toggle;return(0,N.useMemo)(function(){return r?{match:aE.matchLabel,data:{type:"action",label:"Open Agent",icon:(0,g.jsx)(lz.default,{}),run:function(){e&&n(e),i(!0)}}}:null},[r,i,n,e])}var lQ=e.i(368964),lY={nextTab:{id:"tabs.next",name:"Switch to next tab",default:(0,E._)({},lQ.KeybindingsEnvironmentEnum.DesktopApp,(0,aW.defaultKeyCombo)({cmdOrCtrl:!0,shift:!0,key:"]"}))},previousTab:{id:"tabs.previous",name:"Switch to previous tab",default:(0,E._)({},lQ.KeybindingsEnvironmentEnum.DesktopApp,(0,aW.defaultKeyCombo)({cmdOrCtrl:!0,shift:!0,key:"["}))},newTab:{id:"tabs.new",name:"New tab",description:"Opens a tab in the current active group",default:(0,E._)({},lQ.KeybindingsEnvironmentEnum.DesktopApp,(0,aW.defaultKeyCombo)({cmdOrCtrl:!0,key:"t"}))},closeTab:{id:"tabs.close",name:"Close tab",description:"Close the current active tab",default:(0,E._)({},lQ.KeybindingsEnvironmentEnum.DesktopApp,(0,aW.defaultKeyCombo)({cmdOrCtrl:!0,key:"w"}))},reopenClosedTab:{id:"tabs.reopenClosed",name:"Reopen closed tab",default:(0,E._)({},lQ.KeybindingsEnvironmentEnum.DesktopApp,(0,aW.defaultKeyCombo)({cmdOrCtrl:!0,shift:!0,key:"t"}))},findFile:{id:"files.find",name:"Find file",default:(0,aW.defaultKeyCombo)({cmdOrCtrl:!0,key:"p"})},searchFileContents:{id:"files.searchContents",name:"Search file contents",default:lR.keyboardShortcut},run:{id:"repl.run",name:"Run Repl",default:(0,aW.defaultKeyCombo)({cmdOrCtrl:!0,key:"Enter"})},toggleInviteDialog:{id:"repl.multiplayers",name:"See multiplayers",default:(0,aW.defaultKeyCombo)({cmdOrCtrl:!0,key:"m"})},showShell:{id:"repl.showShell",name:"Show shell",default:(0,aW.defaultKeyCombo)({ctrl:!0,key:"`"}),description:"Opens or reveals a Shell in a tab"},showConsole:{id:"repl.showConsole",name:"Show console",description:"Opens or reveals the Console in a tab",default:void 0},showReplitAi:{id:"repl.showGhostwriter",name:"Show Replit AI",description:"Opens or reveals Replit AI in a tab",default:void 0},showSettings:{id:"repl.showSettings",name:"Show settings",description:"Opens or reveals the Settings tab",default:(0,E._)({},lQ.KeybindingsEnvironmentEnum.DesktopApp,(0,aW.defaultKeyCombo)({cmdOrCtrl:!0,key:","}))},saveAllFiles:{id:"repl.saveAllFiles",name:"Save all files",description:"Forces all changes to be flushed to disk",default:void 0},showGit:{id:"repl.showGit",name:"Show git",description:"Opens or reveals the Git tool in a tab",default:void 0},toggleFloatPaneGroup:{id:"paneGroup.toggleFloat",name:"Toggle float group",description:"Floats or un-floats the current active group",default:void 0},toggleMaximizePaneGroup:{id:"paneGroup.toggleMaximize",name:"Toggle maximize group",description:"Maximizes or restores the current active group",default:void 0},removePaneGroup:{id:"paneGroup.close",name:"Close group",description:"Closes all tabs in the current active group",default:void 0},removeOthersInPaneGroup:{id:"paneGroup.closeOthers",name:"Close other tabs in group",description:"Closes all tabs except the visible one in the current active group",default:void 0},insertPaneGroupUp:{id:"paneGroup.insertUp",name:"Insert group above",description:"Adds a new group above the current active group",default:void 0},insertPaneGroupRight:{id:"paneGroup.insertRight",name:"Insert group right",description:"Adds a new group to the right of the current active group",default:void 0},insertPaneGroupLeft:{id:"paneGroup.insertLeft",name:"Insert group left",description:"Adds a new group to the left of the current active group",default:void 0},insertPaneGroupDown:{id:"paneGroup.insertDown",name:"Insert group below",description:"Adds a new group below the current active group",default:void 0},moveTabUpGroup:{id:"tabs.move.groupUp",name:"Move tab into group above",description:"Moves the current active tab into the group above",default:void 0},moveTabRightGroup:{id:"tabs.move.groupRight",name:"Move tab into group right",description:"Moves the current active tab into the group to the right",default:void 0},moveTabLeftGroup:{id:"tabs.move.groupLeft",name:"Move tab into group left",description:"Moves the current active tab into the group to the left",default:void 0},moveTabDownGroup:{id:"tabs.move.groupDown",name:"Move tab into group below",description:"Moves the current active tab into the group below",default:void 0},moveFocusUp:{id:"paneGroup.focusUp",name:"Move focus to group above",description:"Move focus to the group above the current active group",default:void 0},moveFocusRight:{id:"paneGroup.focusRight",name:"Move focus to group right",description:"Move focus to the group to the right of the current active group",default:void 0},moveFocusLeft:{id:"paneGroup.focusLeft",name:"Move focus to group left",description:"Move focus to the group to the left of the current active group",default:void 0},moveFocusDown:{id:"paneGroup.focusDown",name:"Move focus to group below",description:"Move focus to the group below the current active group",default:void 0},webviewRefresh:{id:"webviewpane.reload",name:"Refresh preview",description:"Reload the preview pane",default:(0,aW.defaultKeyCombo)({alt:!0,key:"r"})},keepTab:{id:"tab.keep",name:"Keep tab",description:"Converts a preview tab to a persisted tab",default:void 0}},lX=e.i(464092),lJ=e.i(51606),lZ=e.i(243914),l0=e.i(115357),l1=e.i(428070),l2=e.i(559073),l4=e.i(121817),l8=e.i(592877),l3=e.i(566818),l6=e.i(170314),l5=Object.values(lY);let l9=(0,N.memo)(function(e){var n,t,r,i,a,o,s,l,u,c,d,p,f,h,m,v,x,y,w,b,_=e.isAdmin,j=e.isSubscribed,S=aB(),I=(0,tb.useGetRecentFiles)(),C=(0,ot.default)(),k=C.fs,T=C.container,P=(0,lX.useForkContext)(),R=P.fork,A=P.isForking,D=(0,lF.useRunInfo)(),V=D.isOffline,O=D.isWorkflowsLoading,F=D.isRunning,M=(0,lF.useOnToggleRun)(),L=(0,lO.useShouldHideFileInWorkspace)(),G=aw(),B=ra(t0),W=ra(t1),z=ra(tQ),H=ra((n=(0,tb.usePopClosedPane)(),(0,J.default)(function(){return(0,eo.atom)(null,function(e,t){var r=n();if(r){t(tZ,[r.pane]);var i=e(no);i&&t(nl,i)}})},[n]))),q=ra(iV),K=ra(t2),$=ra(nl),Q=rr(no),X=rr((0,J.default)(function(){return(0,eo.atom)(function(e){var n=e(no);if(!n)return null;var t=eM(e(nx),n);return t?t.paneGroup.id:null})},[])),en=ra(iK),et=ab().toggleMaximizePane,es=ra(tv),ec=ra(tg),ed=ra(iD),ep=ra(tx),ef=(0,aR.usePaneBindings)(Q),eh=(0,ee.useQueryParam)("replUrl","string"),eg=(0,a2.default)(),em=(0,Y.default)(),ev=ro(nC),ex=ax(),ey=(0,a7.default)(),ew=(0,lE.default)(),eb=(0,on.default)(T).url,e_=(0,a5.default)().showNotice,ej=_||!1,eS=(0,ee.useQueryParam)("debug","boolean"),eI=(0,lT.default)("vscode"),eC=eI.openEditor,ek=eI.onConfirmConfig,eE=eI.isConfigModalOpen,eT=eI.closeConfigModal,eP=(0,sH.default)(function(e){return(0,el.track)(eu.events.PROJECT_RAN,{replId:eg,placement:e})},500);(0,aM.useCommandBinding)(function(){return[lY.saveAllFiles.id,function(){k.flush(void 0,tN.FlushSource.MANUAL_SAVE)}]},[k]),(0,aM.useCommandBinding)(function(){return[lY.newTab.id,function(){return B()}]},[B]),(0,aM.useCommandBinding)(function(){return[lY.nextTab.id,function(){return K("next")}]},[K]),(0,aM.useCommandBinding)(function(){return[lY.previousTab.id,function(){return K("previous")}]},[K]),(0,aM.useCommandBinding)(function(){return[lY.closeTab.id,function(){var e=W();return e||ev()>0}]},[W,ev]),(0,aM.useCommandBinding)(function(){return[lY.reopenClosedTab.id,function(){return H()}]},[H]),(0,aM.useCommandBinding)(function(){return[lY.moveTabUpGroup.id,function(){return z("above")}]},[z]),(0,aM.useCommandBinding)(function(){return[lY.moveTabRightGroup.id,function(){return z("rightOf")}]},[z]),(0,aM.useCommandBinding)(function(){return[lY.moveTabLeftGroup.id,function(){return z("leftOf")}]},[z]),(0,aM.useCommandBinding)(function(){return[lY.moveTabDownGroup.id,function(){return z("below")}]},[z]),(0,aM.useCommandBinding)(function(){return Q?[lY.keepTab.id,function(){return $(Q)}]:void 0},[Q,$]),(0,aM.useCommandBinding)(function(){return Q?[lY.insertPaneGroupUp.id,function(){return ep({paneId:Q,placement:"above",autoFocus:!0})}]:void 0},[Q]),(0,aM.useCommandBinding)(function(){return Q?[lY.insertPaneGroupRight.id,function(){return ep({paneId:Q,placement:"rightOf",autoFocus:!0})}]:void 0},[Q]),(0,aM.useCommandBinding)(function(){return Q?[lY.insertPaneGroupLeft.id,function(){return ep({paneId:Q,placement:"leftOf",autoFocus:!0})}]:void 0},[Q]),(0,aM.useCommandBinding)(function(){return Q?[lY.insertPaneGroupDown.id,function(){return ep({paneId:Q,placement:"below",autoFocus:!0})}]:void 0},[Q]),(0,aM.useCommandBinding)(function(){return[aq.id,function(){return S()}]},[S]);var eR=lp(),eA=(0,Z.useIsInMobileWorkspace)();(0,aM.useCommandBinding)(function(){return[lg.id,function(){if(function(){var e=document.activeElement;if(!e)return!1;var n=e.tagName.toLowerCase();return"textarea"===n||("input"===n?["text","password","email","search","tel","url","number","date","datetime-local","month","time","week"].includes(e.type.toLowerCase()):!!e.isContentEditable||"true"===e.getAttribute("contenteditable"))}()||eA)return!1;eR()}]},[eR]);var eD=(0,aM.useKeyCombo)(lY.findFile.id);(0,aM.useCommandBinding)(function(){return[lY.findFile.id,function(){return S(lP.createFindOrCreateFileCommand({openFile:G,fs:k,shouldHideFile:L,getRecentFiles:I,keyboardShortcut:eD}))}]},[S]);var eV=aA({type:"files"});aK(lP.createFindOrCreateFileCommand({openFile:G,fs:k,shouldHideFile:L,getRecentFiles:I,getCurrentlyOpenFilePanesCommands:eV,keyboardShortcut:eD}));var eO=(0,aM.useKeyCombo)(lY.searchFileContents.id),eF=ax(),eL=(0,N.useCallback)(function(e){(0,na.isFilePane)(e.pane)||(0,el.track)(eu.events.TOOL_OPENED,{source:"Command Bar",tool:e.pane.type}),eF(e)},[eF]);(0,aM.useCommandBinding)(function(){return[lY.searchFileContents.id,function(){if((null==ef?void 0:ef.type)==="searchReplace"){null==(e=ef.focusSearchInput)||e.call(ef);return}(0,el.track)(eu.events.SEARCH_PANE_USED,{action:"opened_via_shortcut"});var e,n,t=void 0;(null==ef?void 0:ef.type)==="codeEditor"&&(t=null==(n=ef.getCurrentSelectionText)?void 0:n.call(ef)),eL({pane:{type:"searchReplace",data:{initialQuery:t}}})}]},[ef,eL]),(0,aM.useCommandBinding)(function(){return Q?[lY.toggleFloatPaneGroup.id,function(){return en(Q)}]:void 0},[Q]),(0,aM.useCommandBinding)(function(){return Q?[lY.toggleMaximizePaneGroup.id,function(){return et(Q)}]:void 0},[Q]),(0,aM.useCommandBinding)(function(){return X?[lY.removePaneGroup.id,function(){es({paneGroupId:X}),ed()}]:void 0},[X]),(0,aM.useCommandBinding)(function(){return Q?[lY.removeOthersInPaneGroup.id,function(){ec(Q)}]:void 0},[Q]),(0,aM.useCommandBinding)(function(){return[lY.moveFocusUp.id,function(){return q("above")}]},[]),(0,aM.useCommandBinding)(function(){return[lY.moveFocusDown.id,function(){return q("below")}]},[]),(0,aM.useCommandBinding)(function(){return[lY.moveFocusRight.id,function(){return q("rightOf")}]},[]),(0,aM.useCommandBinding)(function(){return[lY.moveFocusLeft.id,function(){return q("leftOf")}]},[]),aK((t=(0,aP.usePaneUIContext)(),(0,J.default)(function(){return{data:{type:"context",label:"Open with Code Search",icon:(0,g.jsx)(s8.default,{}),key:"codeSearch"},commands:function(e){var n=e.searchQuery;if(!n)return[];var r={type:"searchReplace",data:{initialQuery:n}};return[{match:(0,aE.createFzfMatchLabel)({defaultScore:s4.commandDefaultScores.codeSearch,matchScoreMultiplier:s4.commandMatchScoreMultipliers.codeSearch,filterLowMatchScores:!1}),data:{type:"action",label:t.getTitle(r),icon:t.Icon({pane:r}),run:function(){ex({pane:r})}}}]}}},[t,ex]))),aK(l$()),aK(lR.createSearchFileContentsCommand({container:T,activeOnly:!0,keyboardShortcut:eO,openFile:G})),(0,aM.useCommandBinding)(function(){if(!V&&!O)return[lY.run.id,function(){M(lC.RunReason.KEYBOARD_SHORTCUT),eP("shortcut_cmd_enter")}]},[M]);var eG=(0,aM.useKeyCombo)(lY.run.id);aK({match:aE.fzfMatchLabel,data:{type:"action",icon:(0,g.jsx)(l1.default,{}),label:"New window",keyboardShortcut:"Cmd-Shift-n",description:"Open a new window",run:function(){sq.desktopAppApi.openNewWindow()}}},{enabled:em}),aK({match:aE.fzfMatchLabel,data:{type:"action",icon:(0,g.jsx)(l2.default,{}),label:"Run",description:"Run Repl",run:function(){M(lC.RunReason.KEYBOARD_SHORTCUT)},keyboardShortcut:eG}},{enabled:!F}),aK({match:aE.fzfMatchLabel,data:{type:"action",icon:(0,g.jsx)(l3.default,{}),label:"Stop",description:"Stop Repl",run:function(){M(lC.RunReason.KEYBOARD_SHORTCUT)}}},{enabled:F}),aK({match:aE.fzfMatchLabel,data:{type:"action",icon:(0,g.jsx)(l4.default,{}),label:"Kill 1",description:"Kill the Repl pid1 process if it's in a bad state (admin only)",run:function(){T.exec("kill","1")}}},{enabled:ej}),aK({match:aE.fzfMatchLabel,data:{type:"action",icon:(0,g.jsx)(lZ.default,{}),label:"Open development URL",run:function(){if(!eb)throw Error("Expected dotdevUrl");window.open(eb,"_blank","noopener")}}}),aK({match:aE.fzfMatchLabel,data:{type:"action",icon:(0,g.jsx)(l0.default,{}),label:"Open in desktop app",description:"Open this Repl in the desktop app",run:function(){if(!eh)throw Error("Expected Repl URL query param");var e="".concat(window.location.origin,"/desktopApp/open?replUrl=").concat(eh);window.open(e,"_blank")}}},{enabled:!em}),aK({match:aE.fzfMatchLabel,data:{type:"action",icon:(0,g.jsx)(l6.default,{}),label:"Open in VS Code",description:"Connect to this Repl in VS Code via SSH",run:function(){(0,el.track)(eu.events.WORKSPACE,{action:"open_in_vscode_clicked",source:"command_bar",editor:"vscode"}),eC()}}},{enabled:!!ey&&j}),aK({match:aE.fzfMatchLabel,data:{type:"action",icon:(0,g.jsx)(lJ.default,{}),label:"Copy SSH Command",description:"Copy a shell command to connect to this Repl via SSH",run:function(){if(!ey)throw Error("Expected sshConfig");var e=ey.sshPort,n=ey.sshUser,t=ey.sshHostname,r="ssh -i ".concat(ew,"/.ssh/replit -p ").concat(e," ").concat(n,"@").concat(t);(0,el.track)(eu.events.WORKSPACE,{action:"ssh_key_copied",source:"command_bar"}),(0,sK.default)(r),e_("Copied SSH command")}}},{enabled:!!ey&&j}),aK((i=(r={description:"Jump to another Repl",onRun:function(e){window.location.href=e.url}}).description,a=r.onRun,o=(0,i6.default)(a),(0,J.default)(function(){return{match:(0,aE.createFzfMatchLabel)({defaultScore:s4.commandDefaultScores.myRepls}),data:{type:"context",label:"My Apps",icon:(0,g.jsx)(la.default,{}),description:i},commands:function(e){return(0,ei._)(function(e){var n;return(0,ea._)(this,function(t){switch(t.label){case 0:var r;if(n=e.searchQuery,!e.active)return[2,[]];return[4,(r={query:n,count:50},(0,ei._)(function(){var e;return(0,ea._)(this,function(n){switch(n.label){case 0:if(!nJ.apolloClient)throw Error("Expected apolloClient");return[4,nJ.apolloClient.query({query:le,variables:r})];case 1:return[2,(null==(e=n.sent().data.currentUser)?void 0:e.search.repls.filter(function(e){return!!e.owner}))||[]]}})})())];case 1:return[2,t.sent().map(function(e){var t,r,i,a;return r=(t={repl:e,searchQuery:n,run:function(){return o.current(e)}}).repl,i=t.searchQuery,a=t.run,{match:function(){return{score:1,render:{height:44,content:(0,g.jsx)(ls,{repl:r,height:44,searchQuery:i})}}},data:{type:"action",label:r.title,icon:(0,g.jsx)(lr.default,{alt:r.title,size:16,iconUrl:r.iconUrl}),run:function(){return a(r)}}}})]}})}).apply(this,arguments)}}},[i,o]))),aK({match:(0,aE.createFzfMatchLabel)({defaultScore:s4.commandDefaultScores.fork}),data:{type:"action",label:"Remix",icon:(0,g.jsx)(l8.default,{}),description:"Remix App",run:function(){A||R()}}}),l=(s=lw.usePreferences.apply(void 0,(0,er._)(lI))).preferences,u=s.update,c=function(e){Object.keys(e).forEach(function(n){var t=e[n];(0,el.track)(eu.events.SETTINGS_TOGGLED,{settingChanged:n,updatedValue:t,isCommandBar:!0})}),u(e)},p=(d=(0,sj.useTheme)()).setActiveTheme,f=d.theme,aK({match:(0,aE.createFzfMatchLabel)({defaultScore:s4.commandDefaultScores.settings,matchScoreMultiplier:s4.commandMatchScoreMultipliers.settings}),data:{type:"context",label:"Settings",description:"Change Replit Settings",icon:(0,g.jsx)(lS.default,{})},commands:function(e){var n=e.active,t=e.searchQuery;if(!n&&!t)return[];var r={match:(0,aE.createFzfMatchLabel)({defaultScore:s4.commandDefaultScores.settings,matchScoreMultiplier:s4.commandMatchScoreMultipliers.settings}),data:{type:"context",label:"Theme",icon:(0,g.jsx)(lj.default,{}),description:"Change Replit Theme"},commands:function(){return lb.officialThemes.map(function(e){return{match:(0,aE.createFzfMatchLabel)({defaultScore:s4.commandDefaultScores.settings,matchScoreMultiplier:s4.commandMatchScoreMultipliers.settings}),data:{type:"action",label:e.title,icon:f.id===e.id?(0,g.jsx)(l_.default,{}):(0,g.jsx)(lS.default,{opacity:0}),description:"Use "+e.title+" theme "+(f.id===e.id?" (current)":""),run:function(){p(e.id)}}}})}},i=Object.values(ly.userPreferences).filter(function(e){return -1!==lI.indexOf(e.editorPreferencesKey)}).map(function(e){return{match:(0,aE.createFzfMatchLabel)({defaultScore:s4.commandDefaultScores.settings,matchScoreMultiplier:s4.commandMatchScoreMultipliers.settings}),data:{type:"context",label:e.name,icon:(0,g.jsx)(lS.default,{}),description:e.description},commands:function(){return e.options.map(function(n){var t=l[e.editorPreferencesKey],r=!!e.editorPreferencesKey&&n.editorPreferencesValue===t;return{match:(0,aE.createFzfMatchLabel)({defaultScore:s4.commandDefaultScores.settings,matchScoreMultiplier:s4.commandMatchScoreMultipliers.settings}),data:{type:"action",label:n.title,icon:r?(0,g.jsx)(l_.default,{}):(0,g.jsx)(lS.default,{opacity:0}),description:n.description,run:function(){return(0,ei._)(function(){return(0,ea._)(this,function(t){switch(t.label){case 0:if(!e.editorPreferencesKey)throw Error("editorPreferencesKey is not defined");return[4,c((0,E._)({},e.editorPreferencesKey,n.editorPreferencesValue))];case 1:return t.sent(),[2]}})})()}}}})}}});return(0,er._)(i).concat([r])}},{enabled:!0}),aK(lV((0,N.useCallback)(function(e){eL({pane:{type:"developer",data:{tab:e}}})},[eL])));var eU=(h=(0,a2.default)(),m=(0,s$.useGlobalModal)().show,(0,N.useMemo)(function(){var e=[];return e.push({match:aE.matchLabel,data:{type:"action",label:"[Admin] Show Slack Agent Stack Connector Modal [DEPRECATED]",icon:(0,g.jsx)(sY.default,{}),run:function(){m("SlackConnectorSetupModalDeprecated",{replId:h})}}}),{match:aE.matchLabel,data:{icon:(0,g.jsx)(sQ.default,{}),label:"Admin",type:"context",description:"Manage internal only settings"},commands:function(){return e},numCommands:e.length}},[m,h]));aK(eU,{enabled:ej&&eU.numCommands>0});var eN=(v=(0,sX.useUploadPid2)(),x=(0,U._)((0,sX.usePid2UploadState)(),1)[0],y=(0,a5.default)().showNotice,w=(0,sJ.usePid2Callback)(function(e){return function(){return(0,ei._)(function(){var n;return(0,ea._)(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,e.healthCheck.ping.rpc({})];case 1:if((n=t.sent()).ok)return[2,{ok:!0,payload:n.payload}];return[2,{ok:!1}];case 2:return t.sent(),[2,{ok:!1}];case 3:return[2]}})})()}}),b=(0,sJ.usePid2Callback)(function(e){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;return(0,ei._)(function(){var r,i,a;return(0,ea._)(this,function(o){switch(o.label){case 0:r=0,o.label=1;case 1:if(!(r<n))return[3,8];i=s1[r%s1.length],y("".concat(i," Pinging PID2... (attempt ").concat(r+1,"/").concat(n,")")),o.label=2;case 2:return o.trys.push([2,4,,5]),[4,e.healthCheck.ping.rpc({})];case 3:if((a=o.sent()).ok)return y(" PID2 is ready! ".concat(JSON.stringify(a.payload))),[2,!0];return[3,5];case 4:return o.sent(),[3,5];case 5:if(!(r<n-1))return[3,7];return[4,s2(t)];case 6:o.sent(),o.label=7;case 7:return r++,[3,1];case 8:return y(" PID2 not responding after ".concat(n," attempts")),[2,!1]}})})()}}),(0,N.useMemo)(function(){var e=[];return e.push({match:aE.matchLabel,data:{type:"action",icon:(0,g.jsx)(sZ.default,{}),label:"Ping PID2",description:"Check if PID2 is healthy and responding",run:function(){return(0,ei._)(function(){var e;return(0,ea._)(this,function(n){switch(n.label){case 0:if(!w)return y("PID2 client not available"),[2];return[4,w()];case 1:return(null==(e=n.sent())?void 0:e.ok)?y(" PID2 is healthy: ".concat(JSON.stringify(e.payload))):y(" PID2 ping failed"),[2]}})})()}}}),e.push({match:aE.matchLabel,data:{type:"action",icon:(0,g.jsx)(s0.default,{}),label:x===sX.Pid2UploadState.IDLE?"Upload PID2 bundle":"Upload PID2 bundle (".concat(x.toLowerCase(),")"),description:x===sX.Pid2UploadState.IDLE?"Upload and install the latest PID2 bundle to the container":"Current status: ".concat(x.toLowerCase()),run:function(){return(0,ei._)(function(){return(0,ea._)(this,function(e){switch(e.label){case 0:if(x!==sX.Pid2UploadState.IDLE&&x!==sX.Pid2UploadState.ERROR)return[3,5];return[4,v()];case 1:return e.sent(),[4,s2(2e3)];case 2:if(e.sent(),!b)return[3,4];return[4,b(5,1e3)];case 3:e.sent(),e.label=4;case 4:return[3,6];case 5:y("PID2 upload already in progress: ".concat(x)),e.label=6;case 6:return[2]}})})()}}}),{match:aE.matchLabel,data:{icon:(0,g.jsx)(sQ.default,{}),label:"PID2",type:"context",description:"PID2 debug commands"},commands:function(){return e},numCommands:e.length}},[v,x,y,w,b]));return aK(eN,{enabled:(ej||eS)&&eN.numCommands>0}),(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(az.Modal,{isOpen:eE,onRequestClose:eT,centered:!0,children:(0,g.jsx)(lk.default,{onConfirm:ek})})})});var l7=e.i(921211),ue=e.i(672963),un=e.i(670413),ut=e.i(337761),ur=e.i(967629),ui=e.i(496019),ua=e.i(352767),uo=e.i(608263),us=(0,ur.keyframes)({"0%":{transform:"translate(0, 0)"},"8.33%, 25%":{transform:"translate(-50%, 0)"},"33.33%, 50%":{transform:"translate(-50%, -50%)"},"58.33%, 75%":{transform:"translate(0, -50%)"},"83.33%, 100%":{transform:"translate(0, 0)"}}),ul=(0,rl.cssRecord)({root:[i9.rcss.color.foregroundDimmest,i9.rcss.position.relative,i9.rcss.width("100%"),i9.rcss.height("100%"),{overflow:"hidden"}],arrows:[i9.rcss.position.absolute,i9.rcss.top(0),i9.rcss.left(0),i9.rcss.flex.row,i9.rcss.flex.wrap,i9.rcss.width("200%"),i9.rcss.height("200%"),{animationName:us,animationDirection:"normal",animationTimingFunction:"ease-out",animationIterationCount:"infinite"}],arrow:[i9.rcss.width("50%"),i9.rcss.height("50%"),i9.rcss.center]});function uu(e){var n=e.delay,t=e.duration;return(0,g.jsx)(D.View,{css:ul.root,children:(0,g.jsxs)(D.View,{css:ul.arrows,style:{animationDelay:n?n+"ms":void 0,animationDuration:t?t+"ms":"8000ms"},children:[(0,g.jsx)(D.View,{css:ul.arrow,children:(0,g.jsx)(ui.default,{size:12})}),(0,g.jsx)(D.View,{css:ul.arrow,children:(0,g.jsx)(ua.default,{size:12})}),(0,g.jsx)(D.View,{css:ul.arrow,children:(0,g.jsx)(l_.default,{size:12})}),(0,g.jsx)(D.View,{css:ul.arrow,children:(0,g.jsx)(uo.default,{size:12})})]})})}var uc=e.i(886513),ud=e.i(283110),up=(0,rl.cssRecord)({root:[i9.rcss.position.relative],circle:[i9.rcss.top(-6),i9.rcss.right(-6),i9.rcss.minWidth(12),i9.rcss.borderRadius(8),i9.rcss.position.absolute,i9.rcss.backgroundColor.backgroundHighest,i9.rcss.shadow(3),{textAlign:"center",fontSize:10,border:"1px solid",borderColor:P.tokens.outlineDefault}],count:[{textAlign:"center",fontSize:10}]});function uf(e){var n=e.count,t=(0,uc._)(e,["count"]);return(0,g.jsxs)(D.View,{css:up.root,children:[(0,g.jsx)(ud.default,(0,v._)({},t)),(0,g.jsx)(D.View,{css:[up.circle,up.count],children:n})]})}function uh(){return(0,g.jsxs)(D.View,{css:up.root,children:[(0,g.jsx)(ud.default,{}),(0,g.jsx)(D.View,{css:up.circle,children:(0,g.jsx)(l_.default,{size:6})})]})}function ug(e){var n,t=e.paneId,r=e.paneGroupId,i=(0,aP.usePaneUIContext)(),a=ag(t),o=ra(th),s=ra(tm),l=ra(tg),u=rr((0,J.default)(function(){return(0,eo.atom)(function(e){var n=eM(e(nx),t);return n?n.paneGroup.panes.findIndex(function(e){return e===t}):null})},[t])),c=rr((n=({paneGroupId:({paneGroupId:r}).paneGroupId}).paneGroupId,(0,J.default)(function(){return(0,eo.atom)(function(e){var t=eG(e(nx),n);return t?t.panes.length:null})},[n])));return(0,J.default)(function(){var e=i.getTitle(a),n=[{match:aE.matchLabel,data:{type:"action",label:"Close "+e,icon:(0,g.jsx)(ud.default,{}),run:function(){o(t)}}}];return c&&c>1&&(null!==u&&u<c-1&&n.push({match:aE.matchLabel,data:{type:"action",label:"Close to the right",icon:(0,g.jsx)(uh,{}),run:function(){s(t)}}}),n.push({match:aE.matchLabel,data:{type:"action",label:"Close all other tabs",icon:(0,g.jsx)(uf,{count:c-1}),run:function(){l(t)}}})),n},[i,a,c,u,o,t,s,l])}function um(){var e=am(),n=ra(nl);return(0,N.useCallback)(function(t){var r=e(t),i=r.isCommitted,a=r.pane;return!i&&(0,na.isFilePane)(a)?{match:aE.matchLabel,data:{type:"action",label:"Keep open",icon:(0,g.jsx)(sV.default,{}),run:function(){return n(t)}}}:null},[e,n])}var uv=e.i(761732),ux=e.i(659666),uy=new Map([["left",{label:"Move Left",icon:(0,g.jsx)(ua.default,{})}],["right",{label:"Move Right",icon:(0,g.jsx)(l_.default,{})}],["up",{label:"Move Up",icon:(0,g.jsx)(uo.default,{})}],["down",{label:"Move Down",icon:(0,g.jsx)(ui.default,{})}]]),uw=e.i(491404),ub=new Map([["leftOf",{label:"Move Left",icon:(0,g.jsx)(ua.default,{})}],["rightOf",{label:"Move Right",icon:(0,g.jsx)(l_.default,{})}],["above",{label:"Move Up",icon:(0,g.jsx)(uo.default,{})}],["below",{label:"Move Down",icon:(0,g.jsx)(ui.default,{})}]]),u_=e.i(769767),uj=new Map([["leftOf",{commandId:lY.insertPaneGroupUp.id,label:"Insert Left",icon:(0,g.jsx)(an.default,{})}],["rightOf",{commandId:lY.insertPaneGroupRight.id,label:"Insert Right",icon:(0,g.jsx)(at.default,{})}],["above",{commandId:lY.insertPaneGroupLeft.id,label:"Insert Up",icon:(0,g.jsx)(ar.default,{})}],["below",{commandId:lY.insertPaneGroupDown.id,label:"Insert Down",icon:(0,g.jsx)(ae.default,{})}]]),uS=e.i(417095),uI=e.i(792774),uC=e.i(308212);function uk(e){var n,t,r,i,a,o,s,l,u,c,d,p,f,h,m,x,y,w,b,_,j,S,I,C,k,T,P,R,A,D,V,O,F,M,L,G,N=e.paneGroupId,B=e.paneId,W=function(e){var n,t,r=e.paneId,i=aS(e.paneGroupId),a=(0,uv.default)(i.isMaximized),o=(0,uv.default)(i.isFloating),s=!a&&!o,l=(n=(0,aM.useKeyBindings)(),t=ra(tx),(0,J.default)(function(){return(0,er._)(uj.entries()).map(function(e){var i,a,o=(0,U._)(e,2),s=o[0],l=o[1],u=l.commandId,c=l.label,d=l.icon;return{match:aE.matchLabel,data:{label:c,icon:d,type:"action",keyboardShortcut:null!=(a=null==(i=n.get(u))?void 0:i.shortcut)?a:void 0,run:function(){t({placement:s,paneId:r,autoFocus:!0}),(0,el.track)(eu.events.WORKSPACE,{action:"split_used",placement:s})}}}})},[n,t,r]));return(0,J.default)(function(){return s?[{match:aE.matchLabel,data:{type:"context",label:"Add pane",icon:(0,g.jsx)(u_.default,{})},commands:function(e){var n=e.active,t=e.searchQuery;return n||t?l:[]}}]:[]},[s,l])}({paneId:B,paneGroupId:N}),z=(n=aj(B),t=rr(tt),r=(0,uv.default)(n.isFloating),i=!t&&!r,a=ra(tQ),(0,J.default)(function(){var e=(0,er._)(ub.entries()).map(function(e){var n=(0,U._)(e,2),t=n[0],r=n[1],i=r.label,o=r.icon;return{match:aE.matchLabel,data:{label:i,icon:o,type:"action",run:function(){a(t)}}}});return i?[{match:aE.matchLabel,data:{type:"context",label:"Move tab",icon:(0,g.jsx)(uw.default,{})},commands:function(n){var t=n.active,r=n.searchQuery;return t||r?e:[]}}]:[]},[i,a])),H=(o=aS(N),s=(0,uv.default)(o.isMaximized),l=(0,uv.default)(o.isFloating),u=!s&&!l,c=ra(iO),(0,J.default)(function(){var e=(0,er._)(uy.entries()).map(function(e){var n=(0,U._)(e,2),t=n[0],r=n[1],i=r.label,a=r.icon;return{match:aE.matchLabel,data:{label:i,icon:a,type:"action",run:function(){c({direction:t})}}}});return u?[{match:aE.matchLabel,data:{type:"context",label:"Move group",icon:(0,g.jsx)(ux.default,{})},commands:function(n){var t=n.active,r=n.searchQuery;return t||r?e:[]}}]:[]},[u,c])),q=(p=(d=ab()).maximizePaneGroup,f=d.restoreMaximizedPaneGroup,h=aS(N),m=(0,uv.default)(h.isMaximized),x=rr(n2),y=(0,aM.useKeyCombo)(lY.toggleMaximizePaneGroup.id),(0,J.default)(function(){return m?x?[]:[{match:aE.matchLabel,data:{type:"action",label:"Restore",icon:(0,g.jsx)(uI.default,{}),run:function(){return f()},keyboardShortcut:y}}]:[{match:aE.matchLabel,data:{type:"action",label:"Maximize",icon:(0,g.jsx)(uS.default,{}),run:function(){return p({paneGroupId:N})},keyboardShortcut:y}}]},[m,y,x,f,p,N])),K=(w=ra(tv),b=ra(iD),_=rr(n2),j=(0,aM.useKeyCombo)(lY.removePaneGroup.id),(0,J.default)(function(){return _?[]:[{match:aE.matchLabel,data:{type:"action",label:"Close",icon:(0,g.jsx)(ud.default,{}),run:function(){b(),w({paneGroupId:N})},keyboardShortcut:j}}]},[b,w,_,j,N])),$=(I=(S={paneId:B,paneGroupId:N}).paneId,C=S.paneGroupId,k=ra(iK),T=aS(C),P=(0,uv.default)(T.isMaximized),R=(0,uv.default)(T.isFloating),A=(0,aM.useKeyCombo)(lY.toggleFloatPaneGroup.id),(0,J.default)(function(){return P?[]:[{match:aE.matchLabel,data:{type:"action",label:R?"Unfloat":"Float",icon:R?(0,g.jsx)(i7.default,{}):(0,g.jsx)(l1.default,{}),keyboardShortcut:A,run:function(){k(I)}}}]},[I,k,A,R,P])),Q=(V=aS((D={paneId:B,paneGroupId:N}).paneGroupId),O=aj(D.paneId),F=a_(D.paneGroupId),M=ro(nI),L=ra(n1),G=(0,uv.default)(V.isMaximized),(0,J.default)(function(){return G?[]:[{match:aE.matchLabel,data:{type:"action",label:"New window",icon:(0,g.jsx)(uC.default,{}),run:function(){var e=(0,nX.v4)(),n=M().filter(function(e){var n=(0,U._)(e,1)[0];return F.panes.current.includes(n)});L({popupId:e,state:{type:"saved",layout:{floating:[],tiling:{id:(0,nX.v4)(),type:"paneGroup",percent:100,activeIndex:F.activeIndex.current,panes:F.panes.current}},data:n.reduce(function(e,n){var t=(0,U._)(n,2),r=t[0],i=t[1];return(0,r$._)((0,v._)({},e),(0,E._)({},r,i))},{})}}),window.open("".concat(window.location.origin+window.location.pathname,"?popupId=").concat(e),"_blank","popup=1,height=".concat(O.size.current.height,"px,width=").concat(O.size.current.width,"px")),(0,el.track)(eu.events.WORKSPACE,{action:"workspace_popout_opened",ai:n.some(function(e){var n=(0,U._)(e,2);return"ghostwriterChat"===(n[0],n[1]).type}),console:n.some(function(e){var n=(0,U._)(e,2);return"runnerOutput"===(n[0],n[1]).type}),editor:n.some(function(e){var n=(0,U._)(e,2);return"codeEditor"===(n[0],n[1]).type}),shell:n.some(function(e){var n=(0,U._)(e,2);return"shell"===(n[0],n[1]).type}),paneData:n})}}}]},[G,F.activeIndex,F.panes,M,L,O.size]));return(0,J.default)(function(){return[{data:{type:"group",key:"pane-group"},commands:function(){return(0,er._)(W).concat((0,er._)(z),(0,er._)(H),(0,er._)(q),(0,er._)($),(0,er._)(Q),(0,er._)(K))}}]},[W,z,H,q,$,Q,K])}var uE=e.i(546284),uT=e.i(993134),uP=e.i(707468);function uR(e){var n,t,r,i,a,o,s,l,u=e.paneId,c=(n=(0,aP.usePaneUIContext)(),t=(0,aO.useGetToolPanes)(),r=ra(t4),(0,N.useCallback)(function(){return{data:{type:"context",label:aL.toolsCommandLabel,icon:(0,g.jsx)(aU.default,{})},commands:function(){return t().map(function(e){return{match:aE.matchLabel,data:{type:"action",label:n.getTitle(e),icon:n.Icon({pane:e}),run:function(){(0,el.track)(eu.events.TOOL_OPENED,{source:"Tab Menu",tool:e.type}),r({paneId:u,pane:e})}}}})}}},[t,n,r,u])),d=(i=(0,tb.useGetRecentFiles)(),a=(0,tb.useGetOpenFiles)(),o=ra(t4),(0,N.useCallback)(function(){var e=a(),n=i().filter(function(n){return!e.includes(n)});return{data:{type:"context",label:"Recent",icon:(0,g.jsx)(uT.default,{})},commands:function(e){var t=e.searchQuery;return(0,lP.createFileCommands)({paths:n,searchQuery:t,run:function(e){o({paneId:u,pane:{type:(0,na.getPaneTypeForFile)({path:e}),data:{path:e}}})}})}}},[i,o,u,a])),p=(s=(0,ot.default)().fs,l=ra(t4),(0,J.default)(function(){return{match:aE.matchLabel,data:{type:"context",label:"Files",icon:(0,g.jsx)(sV.default,{})},commands:function(e){return(0,ei._)(function(e){var n,t,r;return(0,ea._)(this,function(i){switch(i.label){case 0:if(n=e.searchQuery,t=e.active,!n&&!t)return[2,[]];return[4,s.listFiles()];case 1:if((r=i.sent()).error)return[2,[]];if(!r.files)throw Error("Expected files");return[2,(0,lP.createFileCommands)({paths:r.files,searchQuery:n,run:function(e){l({paneId:u,pane:{type:(0,na.getPaneTypeForFile)({path:e}),data:{path:e}}})}})]}})}).apply(this,arguments)}}},[s,l,u]));return(0,J.default)(function(){return{match:aE.matchLabel,data:{type:"context",label:"Change tab",icon:(0,g.jsx)(uP.default,{})},commands:function(e){var n=e.searchQuery,t=e.active;return n||t?[d(),p,c()]:[]}}},[d,c,p])}var uA=(0,ur.css)(i9.rcss.center,{fontSize:P.tokens.fontSizeSmall,border:"1px solid",borderColor:P.tokens.outlineDefault,width:20,height:20,marginTop:-2,marginLeft:-2},i9.rcss.borderRadius(8));function uD(e){return(0,g.jsx)(D.View,{css:uA,children:(0,g.jsx)(D.View,{css:{lineHeight:1},children:e.count})})}var uV=(0,eo.atom)([]);function uO(e,n){var t=n.run,r=n.enabled,i=void 0===r||r,a=(0,es.useSetAtom)(uV);(0,N.useEffect)(function(){if(i){var n=(Array.isArray(e)?e:[e]).map(function(e){return{shortcut:e,run:t}});return a(function(e){return(0,er._)(e).concat((0,er._)(n))}),function(){a(function(e){return e.filter(function(e){return!n.includes(e)})})}}},[e,t,a,i])}function uF(){var e=(0,es.useAtomValue)(uV);return(0,N.useEffect)(function(){var n=function(n){var t=!0,r=!1,i=void 0;try{for(var a,o=e[Symbol.iterator]();!(t=(a=o.next()).done);t=!0){var s,l=a.value,u=l.shortcut,c=l.run;!!u.cmdOrCtrlKey==!!(0,un.getCmdOrCtrl)(n)&&!!u.altKey==!!n.altKey&&!!u.shiftKey==!!n.shiftKey&&(null==(s=u.key)?void 0:s.toLowerCase())===n.key.toLowerCase()&&(n.preventDefault(),c(u))}}catch(e){r=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(r)throw i}}};return document.addEventListener("keydown",n),function(){document.removeEventListener("keydown",n)}},[e]),null}var uM=e.i(877249),uL=(0,rl.cssRecord)({overlay:[i9.rcss.position.absolute,i9.rcss.overflow("hidden"),i9.rcss.zIndex(rs.zIndexLevels.overlay)],surface:[i9.rcss.position.relative,i9.rcss.borderRadius(8),i9.rcss.flex.shrink(1),{maxHeight:"100%",maxWidth:"100%",border:"1px solid",borderColor:P.tokens.outlineDefault,opacity:0},i9.rcss.shadow(3)],innerSurface:[i9.rcss.borderRadius(8)]}),uG=(0,rl.cssRecord)({root:[{borderTop:"1px solid",borderColor:P.tokens.outlineDimmer}],row:[i9.rcss.rowWithGap(2),i9.rcss.align.center,i9.rcss.justify.spaceBetween]});function uU(){var e=(0,aW.useCmdOrCtrl)();return(0,g.jsxs)(D.View,{css:uG.root,p:8,gap:8,children:[(0,g.jsxs)(D.View,{css:uG.row,children:[(0,g.jsx)(a8.Text,{color:"dimmest",variant:"small",multiline:!1,children:"Move focus"}),(0,g.jsxs)(D.View,{row:!0,gap:4,children:[(0,g.jsx)(lu.KeyComboBlocks,{keyCombo:"".concat(e),small:!0}),(0,g.jsx)(lu.KeyBlock,{text:(0,g.jsx)(uu,{duration:6e3,delay:6e3})})]})]}),(0,g.jsxs)(D.View,{css:uG.row,children:[(0,g.jsx)(a8.Text,{color:"dimmest",variant:"small",multiline:!1,children:"Move pane"}),(0,g.jsxs)(D.View,{row:!0,gap:4,children:[(0,g.jsx)(lu.KeyComboBlocks,{keyCombo:"".concat(e,"Shift-"),small:!0}),(0,g.jsx)(lu.KeyBlock,{text:(0,g.jsx)(uu,{duration:6e3,delay:1500})})]})]})]})}var uN=(0,N.memo)(function(){var e=function(){var e=rr(tt),n=rr(iE);if(n){var t={width:n.width,height:n.height,transform:"translate(".concat(n.x,"px, ").concat(n.y,"px)")},r=t.width,i=t.height,a=t.transform,o={border:"1px solid",borderColor:P.tokens.accentPrimaryStronger,borderRadius:P.tokens.borderRadius6,boxShadow:P.tokens.shadow3,transitionProperty:"transform, height, width",transitionDuration:uM.TRANSITIONS.duration,transitionTimingFunction:uM.TRANSITIONS.timingFunction};return(0,v._)({width:r,height:i,transform:a},e?void 0:o)}}(),n=ra(iD),t=(0,ue.default)(n,[]);return(0,N.useEffect)(function(){var e=setTimeout(function(){(0,ut.styleSet)(t,"opacity","1")});return function(){clearTimeout(e)}},[t]),(0,g.jsx)(l7.FocusScope,{restoreFocus:!0,autoFocus:!0,contain:!0,children:(0,g.jsx)(D.View,{style:e,css:uL.overlay,p:16,align:"end",children:(0,g.jsx)(A.Surface,{innerRef:t,elevated:!0,css:uL.surface,children:(0,g.jsx)(A.Surface,{css:uL.innerSurface,grow:!0,shrink:!0,elevated:!0,children:(0,g.jsx)(uH,{})})})})})}),uB={ArrowUp:"above",ArrowDown:"below",ArrowRight:"rightOf",ArrowLeft:"leftOf"},uW={ArrowUp:"up",ArrowDown:"down",ArrowRight:"right",ArrowLeft:"left"},uz=Object.keys(uB),uH=(0,N.memo)(function(){var e=ra(iV),n=ra(iO),t=ra(iP),r=rr(tt);uO({key:"Escape"},{run:function(){t()}}),uO(uz.map(function(e){return{key:e,cmdOrCtrlKey:!0}}),{run:function(n){e(uB[n.key])},enabled:!r}),uO(uz.map(function(e){return{key:e,cmdOrCtrlKey:!0,shiftKey:!0}}),{run:function(e){n({direction:uW[e.key]})},enabled:!r});var i=rr(ik);return i&&"sidebar"!==i.target?(0,g.jsx)(uq,{paneGroupId:i.paneGroupId,paneId:i.paneId}):null});function uq(e){var n,t,r,i,a,o,s,l,u,c,d,p,f,h,m,v,x,y,w,b,_,j=rr(tt),S=ra(iD),I=ra(iP),C=(n=e.paneGroupId,i=(r={paneId:t=e.paneId,paneGroupId:n}).paneId,a=r.paneGroupId,o=(0,aP.usePaneUIContext)(),s=ag(i),l=(0,aR.usePaneBindings)(i),u=um(),c=ug({paneId:i,paneGroupId:a}),d=(0,J.default)(function(){var e=o.getTitle(s),n=function(e){return!!e&&(void 0===e?"undefined":(0,eO._)(e))==="object"&&"data"in e},t=[{data:{type:"group",key:"pane-actions"},commands:function(){var e,t;return(null!=(t=null==l||null==(e=l.commands)?void 0:e.flatMap(function(e){return e.commands}))?t:[]).filter(n)}},{data:{type:"group",key:"pane-close"},commands:function(){return[u(i)].concat((0,er._)(c)).filter(n)}}];return{match:aE.matchLabel,data:{type:"context",label:e,icon:(0,g.jsx)(o.Icon,{pane:s})},commands:function(e){var n=e.active,r=e.searchQuery;return n||r?t:[]}}},[s,l,o,i,c,u]),f=(p={paneId:t,paneGroupId:n}).paneGroupId,h=p.paneId,m=rr((0,J.default)(function(){return(0,eo.atom)(function(e){var n=e(ne),t=[],r=[],i=!0,a=!1,o=void 0;try{for(var s,l=n[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value,c=u.panes.map(function(n){return[n,e(e(e6(n)).dataAtom)]}),d="floating"===u.path[0];(d?t:r).push({activeIndex:u.activeIndex,paneGroupId:u.id,isFloating:d,panes:c})}}catch(e){a=!0,o=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw o}}return{floating:t,tiling:r}})},[])),v=(0,aP.usePaneUIContext)(),x=ra(tC),y=ra(tG),w=uR({paneId:h}),b=(0,J.default)(function(){var e=m.tiling,n=m.floating,t=e.reduce(function(e,n){return e+n.panes.length},0)+n.reduce(function(e,n){return e+n.panes.length},0),r={match:aE.matchLabel,data:{type:"action",label:"New tab",icon:(0,g.jsx)(sT.default,{}),run:function(){y({paneGroupId:f,activate:!0,panes:[{type:"commands",data:{autoFocus:!0}}]})}}};return t?[w,{match:aE.matchLabel,data:{type:"context",label:(0,uE.default)("Tab",t),icon:(0,g.jsx)(uD,{count:t})},commands:function(t){var i=t.active,a=t.searchQuery;if(!(i||a))return[];var o=(0,er._)(e).concat((0,er._)(n)).map(function(e,n){return{data:{type:"group",key:"paneGroups"+n},commands:function(){return e.panes.map(function(e){var n=(0,U._)(e,2),t=n[0],r=n[1];return{match:aE.matchLabel,data:{type:"action",label:v.getTitle(r),icon:(0,g.jsx)(v.Icon,{pane:r}),run:function(){x({paneId:t,activate:!0})}}}})}}});return o.unshift(r),o}}]:[w,r]},[m,v,x,y,f,w]),_=uk({paneGroupId:n,paneId:t}),(0,J.default)(function(){return{data:{type:"group",key:"root",description:"Search"},commands:function(){return[d].concat((0,er._)(b),(0,er._)(_))}}},[d,b,_]));return(0,g.jsx)(aH.CommandBar,{iconBreadcrumbs:!0,command:C,onAction:function(){return S()},onKeyDown:function(e,n){var t=n.inputValue,r=n.hasHighlightedItem;if("Enter"===e.key&&!t&&!r){e.preventDefault(),I();return}(0,un.getCmdOrCtrl)(e)&&e.preventDefault()},footer:j?null:(0,g.jsx)(uU,{}),compact:!0})}var uK={id:"paneMenu.toggle",name:"Toggle pane context menu",default:(0,aW.defaultKeyCombo)({cmdOrCtrl:!0,key:"j"})};function u$(){var e=ra(iR),n=rr(iA);return((0,aM.useCommandBinding)(function(){return[uK.id,function(){return e()}]},[e]),n)?(0,g.jsx)(uN,{}):null}var uQ={id:"sidebar.toggle",name:"Toggle sidebar",description:"Opens or closes the sidebar",default:(0,aW.defaultKeyCombo)({cmdOrCtrl:!0,shift:!0,key:"b"})},uY=e.i(971465),uX=e.i(933101),uJ=e.i(159667),uZ=e.i(759025),u0=e.i(782370),u1=e.i(128068),u2=e.i(188507),u4=e.i(924908),u8=e.i(279606),u3=new Set(["planProgressData","agentPlanStepBegin","acknowledgeUserMessage","workflowsGetOutputToolData","presentResultsToolData","deployConfigData"]),u6=new Set(["generate_plan","modify_step","verification","scroll_file","open_file"]);function u5(){var e=(0,u4.useChatter)(),n=(0,lL.useObservable)(e.sessions.agent.current),t=null==n?void 0:n.agent.state,r=(0,N.useMemo)(function(){var e;return null!=(e=null==n?void 0:n.reduce(u9,100))?e:null},[n]);return(0,N.useMemo)(function(){return t&&r?u8.Observable.combine(t,r).map(function(e){var n=(0,U._)(e,2),t=n[0],r=n[1];return((null==t?void 0:t.state)===u2.AgentRunState.AGENT_STATE_PAUSED||(null==t?void 0:t.state)===u2.AgentRunState.AGENT_STATE_UNKNOWN)&&r}):null},[t,r])}var u9={direction:"reverse",state:{value:!1},map:function(e){return e.value},reducer:function(e,n){if(e.sender.type===u2.UserType.USER||e.sender.type!==u2.UserType.AI)return n.value=!1,!1;var t=e.contents.contents;switch(null==t?void 0:t.$kind){case"rapidBuildConcluded":return;case"agentPlanEventContents":n.value=t.agentPlanEventContents.requiresApproval;break;case"agentAskUserForActionRequest":n.value=!0;break;case"agentTimelineEventContents":var r=t.agentTimelineEventContents.toolData;if(r&&u3.has(r.$kind))return;var i=t.agentTimelineEventContents.toolName;if(u6.has(i))return;break;default:n.value=!1}return!1}},u7=e.i(200119),ce=e.i(602213);function cn(e){var n=e.isInLayout,t=(0,uc._)(e,["isInLayout"]),r=(0,lL.useObservable)((0,u7.useAgentIsWorking)()),i=(0,lL.useObservable)(u5()),a=(0,U._)((0,N.useState)(!1),2),o=a[0],s=a[1];(0,N.useEffect)(function(){if(!i||r||n)return void s(!1);var e=setTimeout(function(){return s(!o)},o?1e3:5e3);return function(){clearTimeout(e)}},[o,i,r,n]);var l=!n&&r||o;return(0,g.jsx)(ce.AgentAvatar,(0,v._)({loading:l},t))}var ct=e.i(136540),cr=e.i(918218),ci={id:"agent.toggle",name:"Toggle Agent",description:"Opens or closes the Agent",default:(0,aW.defaultKeyCombo)({cmdOrCtrl:!0,shift:!0,key:"i"})};function ca(){var e,n=aC(),t=(0,lL.useObservable)(n.displayState),r=(0,lL.useObservable)(n.agentFiletreeOrder),i=(0,u1.useObservableRef)(n.isCollapsed),a=(0,aM.useKeyCombo)(ci.id),o=n.toggle;return(0,aM.useCommandBinding)(function(){return[ci.id,function(){return o(!!i.current)}]},[o,i]),(0,g.jsx)(D.View,{clsx:[cr.default.root,(e={},(0,E._)(e,cr.default.show,"collapsed"===t),(0,E._)(e,cr.default.right,"filetree-agent"===r),e)],children:(0,g.jsx)(ct.IconButton,{tooltipContents:a?(0,g.jsx)(lu.KeyComboBlocks,{fontSize:10,keyCombo:a}):null,alt:"Expand Agent",onClick:function(){n.toggle(!0)},children:(0,g.jsx)(cn,{size:16,isInLayout:!1})})})}var co=[ci,uY.switchAgentModeCommand,uQ,aq,uK,lg].concat((0,er._)(l5),(0,er._)(sz.editorCommands),(0,er._)(uJ.gitCommands),[u0.clearOutputsHistoryCommand,uX.generateOrModifyWithAICommand,uZ.generateWithAIInShellCommand]),cs=e.i(202266);function cl(e){var n=(0,cs.useSaveKeybindings)();return(0,g.jsx)(aF.KeybindingsProvider,{commands:co,onChange:n,keybindings:e.keybindings,children:e.children})}var cu=e.i(574831),cc=e.i(135211);function cd(e){var n=e.children,t=(0,J.default)(function(){return new sN.StateCache(nZ.default.get("stateCache",ey.Type.Any()))},[]);return(0,g.jsx)(sN.StateCacheContext.Provider,{value:t,children:n})}function cp(){return(0,sW.usePostDeployModal)(),null}function cf(e){var n,t=e.ui,r=e.repl,i=e.services,a=e.userKeybindings,o=e.children;return(0,g.jsx)(cl,{keybindings:a,children:(0,g.jsx)(aP.PaneUIContextProvider,{value:t,children:(0,g.jsx)(cd,{children:(0,g.jsx)(cu.default.Provider,{value:i,children:(0,g.jsxs)(sB.DeploymentProvider,{replId:r.id,orgId:null==(n=r.org)?void 0:n.id,container:i.container,fs:i.fs,dotReplit:i.dotReplit,ports:i.ports,secrets:i.secrets,children:[(0,g.jsx)(cp,{}),(0,g.jsx)(lX.ForkContextProvider,{repl:r,forkParams:{trackingData:{forkSource:"replEnvironmentDesktop"}},children:(0,g.jsx)(s_.ExtensionStoreProvider,{children:(0,g.jsx)(cc.default,{children:o})})})]})})})})})}var ch=e.i(736318);function cg(){var e,n,t,r,i,a;return e=(0,ot.default)().fs,n=rr(nu),t=aw(),r=(0,N.useCallback)(function(e){var n;(0,ic.isMarkdownFile)(e.path.toLowerCase())?n={paneType:"markdown"}:(0,ic.isCsvFile)(e.path.toLowerCase())&&(n={paneType:"csvPreview"}),t((0,r$._)((0,v._)({},e),{opener:n}))},[t]),i=rr(nP),a=(0,N.useRef)(!1),(0,N.useEffect)(function(){if(i&&!a.current){if(!n){if(!window.location.hash)return;var e=new URL(window.location.href);history.pushState((0,r$._)((0,v._)({},history.state),{as:e.pathname}),document.title,window.location.origin+window.location.pathname+window.location.search);return}var t=(0,ch.deeplinkToHash)({path:n}),r=window.location.hash;if(!(r.slice(1)===n||r.startsWith(t+":"))){var o=new URL(window.location.href);o.hash=t,window.history.pushState((0,r$._)((0,v._)({},history.state),{as:o.pathname+o.hash}),"",o)}}},[n,i]),(0,N.useEffect)(function(){if(i){var n=function(){return(0,ei._)(function(){var n;return(0,ea._)(this,function(t){switch(t.label){case 0:return a.current=!0,[4,(0,ei._)(function(){var n,t,r,i;return(0,ea._)(this,function(a){switch(a.label){case 0:if(!(0,ch.hasHash)())return[2,null];return[4,(0,ch.parseHash)(e)];case 1:if(t=(n=a.sent()).path,r=n.line,i=n.col,!t)return[2,null];return[2,{path:t,line:r,col:i}]}})})()];case 1:return(n=t.sent())&&r(n),a.current=!1,[2]}})})()};return n(),window.addEventListener("hashchange",n),function(){window.removeEventListener("hashchange",n)}}},[i,e,r]),null}var cm=e.i(545082),cv=e.i(375310),cx=e.i(557862);function cy(){var e=(0,cv.usePendingDeleteFile)(),n=(0,cv.useSetPendingDeleteFile)(),t=(0,ot.default)().fs,r=function(){n(null)};return(0,g.jsx)(az.Modal,{isOpen:!!e,onRequestClose:r,children:e?(0,g.jsx)(cx.default,{name:e,description:e,entityType:"file",hideModal:r,delete:function(){e&&(t.deleteFile(e),n(null))}}):null})}var cw=e.i(569910),cb=e.i(134628),c_=e.i(479407),cj=e.i(203594),cS=e.i(16499);function cI(){var e,n,t=(0,m.useRouter)(),r=(0,Z.doesBonsaiWebviewSupportFeature)(t,"mobileBridge"),i=aI(),a=(0,cj.default)(),o=a.isSaving,s=a.isOffline,l=(0,N.useRef)(null),u=(0,cS.useSetAppKeyboardState)(),c=ax(),d=aB(),p=(e=(0,lF.useWorkflowsRunner)(),n=(0,lF.useOnToggleRun)(),{runState:(0,N.useMemo)(function(){return e?e.step:lC.RunState.OFFLINE},[e]),toggleRunState:(0,N.useCallback)(function(){n()},[n])}),f=p.runState,h=p.toggleRunState,g=(0,N.useCallback)(function(e){var n=function(e){switch(e){case cb.BridgeWorkspaceAction.OPEN_FILETREE:i.toggleContent("filetree");break;case cb.BridgeWorkspaceAction.TOGGLE_RUN_STATE:h();break;case cb.BridgeWorkspaceAction.TOGGLE_ALLPANES:d();break;case cb.BridgeWorkspaceAction.OPEN_NEW_PANE:case cb.BridgeWorkspaceAction.TOGGLE_DRAWER:break;default:(0,cw.default)(e)}},t=function(e){u(e)},r=function(e){var n=e.type,t=e.messageId;try{c({pane:{type:n}})}catch(e){(0,c_.sendErrorMessage)(t)}};(0,c_.workspaceBridgeMessageHandler)(e,function(e){var i=e.type;switch(i){case cb.BridgeMessageType.SET_KEYBOARD_STATE:t(e.keyboardState);break;case cb.BridgeMessageType.WORKSPACE_REQUEST_ACTION:n(e.action);break;case cb.BridgeMessageType.WORKSPACE_REQUEST_OPEN_PANE:r({messageId:e.id,type:e.paneType});break;default:(0,cw.default)(i)}})},[h,u,c,d,i]);return(0,N.useEffect)(function(){if(r){var e={messageType:cb.BridgeMessageType.WORKSPACE_STATE,isDrawerOpen:!1,isShowingAllPanes:!0,isSaving:o,isOffline:s,runState:f,activePaneType:null,activePaneFilePath:null,isInAgentMode:!1,insets:{top:0,bottom:0}},n=l.current;return(null==n||JSON.stringify(e)!==JSON.stringify(n))&&((0,c_.sendMessage)(e,(0,nX.v4)()),l.current=e),window.addEventListener("message",g),function(){window.removeEventListener("message",g)}}},[r,g,f,o,s,l]),null}var cC=e.i(545150),ck=e.i(394212),cE=e.i(906368),cT=e.i(718398),cP=e.i(852155),cR=e.i(299798),cA=e.i(112942),cD=e.i(45442),cV=e.i(399144),cO=e.i(28432),cF=e.i(940745),cM=e.i(576779);function cL(e){var n=e.text,t=Math.floor(100*e.progress);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(D.View,{row:!0,align:"center",justify:"center",gap:8,style:{cursor:"not-allowed"},children:[(0,g.jsx)(cF.default,{}),(0,g.jsx)(a8.Text,{children:n})]}),(0,g.jsx)(D.View,{clsx:cM.default.progressBarContainer,children:(0,g.jsx)(D.View,{clsx:cM.default.progressBarTrack,children:(0,g.jsx)(D.View,{clsx:cM.default.progressBarFill,style:{width:"".concat(t,"%")}})})}),(0,g.jsx)(D.View,{justify:"center",align:"center",children:(0,g.jsxs)(a8.Text,{variant:"small",color:"dimmer",children:[t,"%"]})})]})}function cG(e){var n=e.errorMessage;return(0,g.jsxs)(D.View,{align:"center",gap:8,children:[(0,g.jsx)(a8.Text,{children:n}),(0,g.jsx)(a8.Text,{children:"Please try again or contact support"}),(0,g.jsx)(s3.default,{href:"/~",children:(0,g.jsx)(a8.Text,{children:"Return to Home"})})]})}function cU(e){var n=e.onClick;return(0,g.jsxs)(D.View,{align:"center",gap:16,children:[(0,g.jsx)(a8.Text,{children:"You must login again to continue importing"}),(0,g.jsx)(a4.Button,{text:"Reconnect to Figma",onClick:n,colorway:"primary",iconRight:(0,g.jsx)(l_.default,{})})]})}function cN(){var e,n,t,r,i,a,o,s,l,u,c,d,p,f,h,v,x,y,w,b,_,j,S=(0,m.useRouter)(),I=(e=(0,a2.default)(),n=(0,U._)((0,cT.useUpdateReplForFigmaImportMutation)(),1)[0],t=(0,U._)((0,cT.useGetFigmaIntermediateTokenMutation)(),1)[0],i=(r=(0,U._)((0,N.useState)({status:"not_started"}),2))[0],a=r[1],s=(o=(0,U._)((0,N.useState)(0),2))[0],l=o[1],c=(u=(0,cT.useFigmaImportFlowQuery)({variables:{replId:e}})).data,p=null!=(d=!u.loading&&c&&"Repl"===c.getRepl.__typename&&c.getRepl.config.figmaImportStatus===lQ.FigmaImportStatus.Started?c.getRepl.config.figmaUrl:null)?d:null,f=ll(),h=(0,u4.useChatter)(),v=(0,N.useRef)(!1),x=(0,cD.useAgentSettings)().settings,y=(0,ee.useQueryParam)("initialQueuedPromptKey","string"),w=(0,i6.default)(p),b=(0,N.useCallback)(function(){return(0,ei._)(function(){var e,n,t,r,i,a;return(0,ea._)(this,function(o){switch(o.label){case 0:if(v.current)return[2];return v.current=!0,[4,h.sessions.create({sessionType:u2.SessionType.AGENT_SESSION})];case 1:if(!(e=o.sent()).ok)throw Error("Failed to create Agent session");return f({type:"agentChat",data:{sessionId:e.payload.id}}),[4,(n=e.payload).appendEvent({kind:"setupImportedProject",importSource:u2.ProjectImportSource.PROJECT_IMPORT_SOURCE_FIGMA,agentConfig:(0,cA.convertAgentSettingsFromGQLToAiChat)(x)})];case 2:if(o.sent(),t="initial_queued_prompt_".concat(y),!(r=nZ.default.get(t,"string")))return[2];return nZ.default.remove(t),i=r,(a=w.current)&&(i=i.replaceAll(a,"")+"\n\n(Figma URL: ".concat(a," has already been imported.)")),[4,n.appendEvent({kind:"message",intent:u2.MessageAction.AGENT,message:i})];case 3:return o.sent(),[2]}})})()},[h,f,y,w,x]),_=(0,N.useCallback)(function(t){var r=t.errorMessage;return(0,ei._)(function(){return(0,ea._)(this,function(t){switch(t.label){case 0:return a({status:"error",errorMessage:r}),[4,n({variables:{input:{id:e,figmaImportStatus:lQ.FigmaImportStatus.Failed}}})];case 1:return t.sent(),[2]}})})()},[e,n]),((0,cR.usePid2)(function(r,i){var o=i.signal;return(0,ei._)(function(){var i,s,u,c,p,f,h,g,m,v,x,y,w,j,S,I;return(0,ea._)(this,function(C){switch(C.label){case 0:if(!d)return[2];return[4,t({variables:{input:{figmaUrl:d}}})];case 1:if((null==(i=C.sent().data)?void 0:i.getFigmaIntermediateToken.__typename)==="NoOAuthFoundError")return a({status:"needs_auth",retryAuth:function(){return l(function(e){return e+1})}}),[2];if((null==i?void 0:i.getFigmaIntermediateToken.__typename)==="InvalidFigmaUrlError"||(null==i?void 0:i.getFigmaIntermediateToken.__typename)==="FigmaRateLimitError")return cE.captureException(i.getFigmaIntermediateToken,{extra:{replId:e,figmaUrl:d}}),sw.logger.error("Failed to get Figma intermediate token",{repl:e,figmaUrl:d,payload:i.getFigmaIntermediateToken}),_({errorMessage:i.getFigmaIntermediateToken.message}),[2];if(!(s=null==i?void 0:i.getFigmaIntermediateToken)||"FigmaImportIntermediateToken"!==s.__typename)return sw.logger.error("Failed to get Figma intermediate token",{repl:e,figmaUrl:d,payload:i}),_({errorMessage:"Something went wrong while authenticating. Please try again."}),[2];return u=s.token,a(function(e){return"in_progress"===e.status?e:{status:"in_progress",progress:0,text:"Preparing Figma import..."}}),[4,r.figmaImport.startImport.rpc({intermediateToken:u},{signal:o})];case 2:if(!(c=C.sent()).ok)switch(p=c.payload.code){case"INVALID_REQUEST":case"UNCAUGHT_ERROR":return _({errorMessage:c.payload.message||"Something went wrong while importing. Please try again."}),[2];case"UNEXPECTED_DISCONNECT":case"CANCEL":return[2];default:(0,cw.default)(p)}f=r.figmaImport.status.subscribe({},{signal:o}).resReadable,h=void 0,g=!1,m=!1,C.label=3;case 3:C.trys.push([3,8,9,14]),x=function(){var n=w.value;if(!n.ok){var t=n.payload.code;switch(t){case"FIGMA_TOKEN_EXPIRED":case"FIGMA_INVALID_TOKEN":return a({status:"needs_auth",retryAuth:function(){return l(function(e){return e+1})}}),{v:void 0};case"FIGMA_NODE_NOT_FOUND":return _({errorMessage:"The selected Figma component could not be found, please ensure you have selected a frame and copied the link to the frame."}),{v:void 0};case"FIGMA_FILE_NOT_FOUND":return _({errorMessage:"The Figma file could not be accessed, please ensure the linked account has permissions to access the frame."}),{v:void 0};case"FIGMA_SELECTION_TOO_LARGE":return _({errorMessage:"Your Figma selection is too large to process, please make sure you have selected a single frame."}),{v:void 0};case"FIGMA_RATE_LIMIT_EXCEEDED":return _({errorMessage:"Too many requests. Please wait a moment and try again."}),{v:void 0};case"NO_CODE_GENERATED":return _({errorMessage:"No code could be generated from your frame. Please try a different link."}),{v:void 0};case"TIMEOUT":return _({errorMessage:"The import took too long. Please try again, or try a smaller component."}),{v:void 0};case"FIGMA_NODE_NOT_SUPPORTED":return _({errorMessage:"The selected Figma component is not supported. Please make sure you have selected a frame and copied the link to the frame."}),{v:void 0};case"FIGMA_PAGE_WITH_MULTIPLE_CHILDREN":return _({errorMessage:"The selected Figma page has multiple children. Please make sure you have selected a single frame."}),{v:void 0};case"FIGMA_PAGE_WITH_NO_VALID_CHILDREN":return _({errorMessage:"The selected Figma page doesn't have any content we can convert to code. Please make sure you've selected a page with visible designs then try again."}),{v:void 0};case"INVALID_REQUEST":case"UNKNOWN":case"UNCAUGHT_ERROR":return _({errorMessage:n.payload.message||"Something went wrong while importing. Please try again."}),{v:void 0};case"NOT_STARTED":return sw.logger.error("Figma Import: Failed to import from Figma",{repl:e,figmaUrl:d,payload:n.payload}),cE.captureException(Error("Figma import: not started"),{extra:{replId:e,figmaUrl:d,payload:n.payload}}),_({errorMessage:n.payload.message||"Something went wrong while importing. Please try again."}),{v:void 0};case"READABLE_BROKEN":case"CANCEL":case"UNEXPECTED_DISCONNECT":return{v:void 0};default:(0,cw.default)(t)}}var r=n.payload;"progress"===r.kind?a(function(e){return"in_progress"===e.status&&e.progress>=r.number?e:{status:"in_progress",progress:r.number,text:r.statusText}}):"success"===r.kind&&(h=function(e){var n=e.file,t=e.frame,r="".concat(n," (").concat(t,")");if(r.length<=cP.maxTitleLength)return r;var i=cP.maxTitleLength-3;if(n.length<=i-1){var a=i-n.length,o=t.length>a?t.substring(0,a-1)+"":t;return"".concat(n," (").concat(o,")")}var s=i-Math.min(t.length,10),l=n,u=t;n.length>s&&(l=n.substring(0,s-1)+"");var c=i-l.length;return t.length>c&&(u=t.substring(0,c-1)+""),"".concat(l," (").concat(u,")")}({file:r.figmaFileName,frame:r.figmaSelectedFrameName}))},y=(0,ck._)(f),C.label=4;case 4:return[4,y.next()];case 5:if(!(g=!(w=C.sent()).done))return[3,7];if(j=x(),"object"===(0,eO._)(j))return[2,j.v];C.label=6;case 6:return g=!1,[3,4];case 7:return[3,14];case 8:return S=C.sent(),m=!0,v=S,[3,14];case 9:if(C.trys.push([9,,12,13]),!(g&&null!=y.return))return[3,11];return[4,y.return()];case 10:C.sent(),C.label=11;case 11:return[3,13];case 12:if(m)throw v;return[7];case 13:return[7];case 14:return a({status:"in_progress",progress:1,text:"Creating checkpoint"}),[4,r.git.init.rpc({initialCommit:!0,includeAllInitialFiles:!0},{signal:o})];case 15:if(!(I=C.sent()).ok)switch(I.payload.code){case"CANCEL":case"UNEXPECTED_DISCONNECT":return[2];default:cE.withScope(function(e){e.setExtra("gitInitError",I.payload),cE.captureException(Error("figma import: git init failed"))})}return a({status:"in_progress",progress:1,text:"Handing off to Agent"}),[4,b()];case 16:return C.sent(),[4,n({variables:{input:{id:e,title:h,makeTitleUnique:!0,figmaImportStatus:lQ.FigmaImportStatus.Completed}}})];case 17:return C.sent(),(0,el.track)(eu.events.FIGMA_IMPORT_USED,{action:"completed"}),(0,el.track)(eu.events.IMPORT,{action:"import_success",import_type:"figma"}),a({status:"success"}),[2]}})})()},[d,e,n,b,s,t,_]),c&&"Repl"===c.getRepl.__typename&&c.getRepl.config.figmaImportStatus===lQ.FigmaImportStatus.Failed&&"not_started"===i.status)?{status:"error",errorMessage:"Something went wrong"}:i);return"not_started"===I.status||"success"===I.status?null:("in_progress"===I.status?j=(0,g.jsx)(cL,{text:I.text,progress:I.progress}):"error"===I.status?j=(0,g.jsx)(cG,{errorMessage:I.errorMessage}):"needs_auth"===I.status&&(j=(0,g.jsx)(cU,{onClick:function(){S.push("/integrations")}})),(0,g.jsx)(cV.Portal,{children:(0,g.jsx)(D.View,{clsx:cM.default.overlay,style:{cursor:"in_progress"===I.status?"wait":"default"},children:(0,g.jsx)(cC.default,{children:(0,g.jsxs)(D.View,{clsx:cM.default.animationWrapper,tabIndex:-1,children:[(0,g.jsxs)(D.View,{align:"center",gap:16,children:[(0,g.jsx)(cO.Figma2ReplitIcons,{}),(0,g.jsx)(a8.Text,{multiline:!1,variant:"subheadBig",dataCy:"figma-lock-screen",children:"Importing from Figma..."})]}),(0,g.jsx)(D.View,{pt:16,px:16,gap:4,children:j})]})})})}))}var cB=e.i(850270),cW=e.i(278505),cz=e.i(119322);function cH(){var e=(0,ot.default)().replspaceApi,n=(0,U._)((0,N.useState)(!1),2),t=n[0],r=n[1],i=(0,U._)((0,N.useState)({status:"not_started"}),2),a=i[0],o=i[1],s=ll(),l=(0,cW.useSetGitHubImportMode)();if((0,cB.useDoGitHubImportFlow)({setConfigScreenLockIsOpen:r,openPane:s,onStatusChange:o}),(0,N.useEffect)(function(){if(!t)return void l(!1);l(!0);var n=e.onConfirmSendToken(function(e){e&&e(!0,!1)});return function(){n(),l(!1)}},[t,e,l]),!t)return null;var u="Importing";return"in_progress"===a.status?u=a.text:"error"===a.status&&(u="Import failed: ".concat(a.errorMessage)),(0,g.jsx)(cz.default,{reason:u})}var cq=e.i(649960),cK=e.i(332441),c$=e.i(418725),cQ=e.i(188019),cY=e.i(492267),cX=e.i(12558),cJ=e.i(659790),cZ=e.i(908410),c0=e.i(740616),c1=e.i(629756),c2=e.i(6338),c4=(0,rl.cssRecord)({container:[i9.rcss.position.relative],loadingGeneratedIcon:[c2.loadingStyle.foregroundPulse(P.tokens.blurpleDimmest,P.tokens.blurpleDefault),i9.rcss.borderRadius()]});function c8(e){var n=e.replId,t=e.replIconUrl,r=e.size,i=(0,c1.usePollForGeneratedReplIcon)({replId:n,replIconUrl:t}),a=i.loading,o=i.generatedIconUrl;return(0,g.jsx)(D.View,{css:c4.container,children:(0,g.jsx)(D.View,{css:a&&c4.loadingGeneratedIcon,children:(0,g.jsx)(lr.default,{iconUrl:o||t,size:void 0===r?20:r,alt:""})})})}var c3=e.i(341727),c6=e.i(751273),c5=e.i(196353),c9=e.i(497627),c7=(0,rl.cssRecord)({metadata:[],iconWrapper:[i9.rcss.position.relative],dimIcon:[{opacity:.2}],diconnectedIcon:[i9.rcss.position.absolute,{left:0,right:0,top:0,bottom:0,margin:"auto"}],title:[i9.rcss.flex.shrink(1),i9.rcss.truncate],placeholderTitle:[i9.rcss.width(100),i9.rcss.borderRadius("default"),{alignSelf:"stretch"},c2.loadingStyle.foregroundPulse(P.tokens.backgroundDefault,P.tokens.backgroundHigher)]});function de(e){var n,t=e.repl,r=e.hideTitle,i=(0,c3.default)().didDisconnect;return(0,g.jsxs)(D.View,{grow:!0,shrink:!0,row:!0,gap:6,align:"center",children:[(0,g.jsxs)(D.View,{css:c7.iconWrapper,children:[(null==(n=t.project)?void 0:n.id)?(0,g.jsx)(g.Fragment,{children:r?(0,g.jsx)(c5.default,{}):null}):(0,g.jsx)(D.View,{css:i&&c7.dimIcon,children:(0,g.jsx)(c8,{replId:t.id,replIconUrl:t.iconUrl,size:16})}),i?(0,g.jsx)(c6.Tooltip,{tooltip:"Reconnecting",children:(0,g.jsx)(c9.default,{size:16,css:c7.diconnectedIcon})}):null]}),r?null:(0,g.jsx)(a8.Text,{multiline:!1,css:c7.title,"data-cy":"header-repl-title",color:i?"dimmer":"default",translate:"no",children:t.title})]})}var dn=e.i(754873),dt=e.i(604963),dr=(0,rl.cssRecord)({popover:[i9.rcss.maxWidth(460),i9.rcss.width("100%")],button:[dn.interactive.nofill,i9.rcss.height(28),i9.rcss.flex.growAndShrink(1),i9.rcss.align.center,i9.rcss.rowWithGap(4),i9.rcss.px(6),i9.rcss.borderRadius(),i9.rcss.color.foregroundDefault,{'&[aria-expanded="true"]':{backgroundColor:P.tokens.interactiveBackgroundActive}}]});function di(e){var n=e.repl,t=e.getDesktopLayoutState,r=e.hideTitle,i=(0,U._)((0,N.useState)(!1),2),a=i[0],o=i[1],s=function(){var e=(0,Z.useDoesBonsaiSupportFeature)("simplifiedTabletUI"),n=(0,N.useCallback)(function(){e&&(0,c_.sendMessage)({messageType:cb.BridgeMessageType.SHOW_REPL_INFO},(0,cZ.nanoid)())},[e]);if(e)return n}();return(0,Z.useIsInBonsaiWebview)()?(0,g.jsx)(D.View,{css:dr.button,onClick:s,children:(0,g.jsx)(de,{repl:n,hideTitle:r})}):(0,g.jsxs)(dt.PopoverTrigger,{isOpen:a,onOpenChange:function(e){o(e),e&&(0,el.track)(eu.events.MODAL_VIEWED,{modal_name:"repl_metadata_popover"})},placement:"bottom start",label:"Repl info",css:dr.popover,children:[(0,g.jsx)(D.SpecializedView.button,{dataCy:"ws-repl-info-container",css:dr.button,onClick:function(){(0,el.track)(eu.events.WORKSPACE,{action:"repl_metadata_opened"})},"aria-expanded":a,children:(0,g.jsx)(de,{repl:n,hideTitle:r})}),(0,g.jsx)(c0.default,{getDesktopLayoutState:t,setIsEditing:o})]})}var da=e.i(76961),ds=e.i(248011),dl=e.i(663762),du=e.i(57527),dc=e.i(596139),dd=e.i(443394),dp=e.i(27820),df=e.i(257811),dh=e.i(672685),dg=e.i(788331),dm=e.i(42458),dv=e.i(111724);function dx(e){var n=e.icon,t=e.title,r=e.subtitle,i=e.current,a=e.max,o=e.nextCreditsAt,s=e.isMonthly,l=Math.min(i,a),u=Math.min(l/a,1),c=(0,dh.getPercentageFillColor)({decimal:u}),d=i>=a,p=null!=o&&"0m"!==(0,df.toCountdownDate)({date:o});return(0,g.jsxs)(A.Surface,{clsx:dv.default.usageCard,p:8,gap:8,background:"higher",children:[(0,g.jsxs)(D.View,{children:[(0,g.jsxs)(D.View,{row:!0,align:"baseline",justify:"space-between",grow:!0,children:[(0,g.jsxs)(D.View,{row:!0,align:"end",gap:6,children:[n,(0,g.jsx)(a8.Text,{color:"dimmer",height:"singleLine",style:{fontWeight:P.tokens.fontWeightMedium},children:t}),d?(0,g.jsx)(dm.default,{size:16,color:P.tokens.accentNegativeDefault}):null]}),(0,g.jsxs)(a8.Text,{color:"dimmer",children:[Math.floor(100*u),"%"]})]}),(0,g.jsx)(a8.Text,{variant:"small",color:"dimmer",children:r})]}),(0,g.jsx)(dp.MeasureBar,{css:dv.default.measureBar,total:a,current:l,color:c,tooltipHidden:!0}),o&&p&&d?(0,g.jsxs)(D.View,{row:!0,gap:3,children:[(0,g.jsxs)(a8.Text,{color:"dimmer",children:[s?"Monthly":"Daily"," credits will reset in"," "]}),(0,g.jsx)(df.Timestamp,{date:o,dateFormat:"countdown",live:!0,textColor:"dimmer"})]}):null]})}function dy(e){var n=e.agentLimit,t=e.agentUsage,r=e.cloudUsage,i=e.cloudLimit,a=e.agentNextCreditsAt,o=e.cloudNextCreditsAt,s=e.isUnderMonthlyQuota,l=(0,dd.getCurrentUrl)(),u=(0,X.useFlag)({controlName:"flag-free-plan",default:!1});if(void 0===n||void 0===t)return(0,g.jsx)(cF.default,{});var c=void 0!==r&&void 0!==i&&r/i>=.25;return(0,g.jsxs)(D.View,{gap:16,children:[(0,g.jsxs)(D.View,{gap:8,children:[(0,g.jsx)(a8.Text,{variant:"subheadDefault",height:"singleLine",children:"Free usage limits"}),(0,g.jsx)(dx,{icon:(0,g.jsx)(lz.default,{size:16}),title:u?!1===s?"Monthly Agent credits":"Daily Agent credits":"Agent usage",subtitle:"Build, test, and iterate in fast mode",current:t,max:n,nextCreditsAt:a,isMonthly:!1===s}),u&&c?(0,g.jsx)(dx,{icon:(0,g.jsx)(dg.default,{size:16}),title:"Monthly Cloud credits",subtitle:"AI integrations, publishing, and storing assets",current:r,max:i,nextCreditsAt:o,isMonthly:!0}):null]}),(0,g.jsx)(c$.default,{text:"Upgrade to Replit ".concat(dc.corePlanName),colorway:"primary",variant:"default",context:"agent_freemium_quota_v2",redirectPath:l,modalHeadingText:"Upgrade for more Agent usage",modalSubHeadingText:"Get more credits and build faster with Replit ".concat(dc.corePlanName)})]})}var dw=e.i(573605),db=e.i(176843),d_=e.i(552488),dj=(0,rl.cssRecord)({root:[i9.rcss.px(8),dn.interactive.nofill,i9.rcss.height(32),i9.rcss.align.center,i9.rcss.rowWithGap(4),i9.rcss.px(6),i9.rcss.borderRadius(),i9.rcss.color.foregroundDefault],measureBar:[i9.rcss.width(50),i9.rcss.height(8),{pointerEvents:"none"}],popoverWrapper:[i9.rcss.width(300)]});function dS(){var e,n,t,r,i,a,o,s=(0,U._)((0,N.useState)(!1),2),l=s[0],u=s[1],c=(0,dw.useGetAgentFreeUsage)(),d=c.agentUsage,p=c.agentUsageV2,f=c.refetch,h=(0,db.useGetCloudFreeUsage)(),m=h.cloudUsage,v=h.refetch;(0,du.useOnPresentToUser)((0,N.useCallback)(function(e){"cloudBudgetExceeded"===e.$kind&&u(!0)},[])),p?(e=p.usage,n=p.limit,t=p.nextCreditsAt,o=p.isUnderMonthlyQuota):(e=null==d?void 0:d.usage,n=null==d?void 0:d.limit),m&&"FreemiumCloudUsageLimits"===m.__typename&&(r=null==m?void 0:m.usage,i=null==m?void 0:m.limit,a=null==m?void 0:m.nextCreditsAt),(0,d_.useOnHitFreemiumAlertThreshold)({usage:e,limit:n,percentThreshold:d_.FREEMIUM_POPUP_WARNING_ALERT_THRESHOLD,onHitThreshold:function(){u(!0)}}),(0,d_.useOnHitFreemiumAlertThreshold)({usage:e,limit:n,percentThreshold:d_.FREEMIUM_POPUP_NEAR_LIMIT_ALERT_THRESHOLD,onHitThreshold:function(){u(!0)}}),(0,d_.useOnHitFreemiumAlertThreshold)({usage:e,limit:n,percentThreshold:d_.FREEMIUM_POPUP_REACHED_ALERT_THRESHOLD,onHitThreshold:function(){u(!0),(0,el.track)(eu.events.AGENT_USED,{action:"hit_freemium_quota"})}});var x=n&&e?e/n:0,y=i&&r?r/i:0;x=Math.min(x,1);var w=(0,dh.getPercentageFillColor)({decimal:x}),b=x>=1||y>=1;return x<.25&&y<.25?null:(0,g.jsxs)(dt.PopoverTrigger,{isOpen:l,onOpenChange:function(e){u(e),e&&(f(),v())},label:"Agent usage",placement:"bottom start",children:[(0,g.jsx)(a4.BaseButton,{css:dj.root,children:(0,g.jsxs)(D.View,{row:!0,align:"center",gap:8,children:[(0,g.jsx)(dp.MeasureBar,{css:dj.measureBar,total:null!=n?n:0,current:null!=e?e:0,color:w,tooltipHidden:!0}),(0,g.jsxs)(a8.Text,{variant:"small",color:"dimmer",children:[Math.floor(100*x),"%"]}),b?(0,g.jsx)(dm.default,{size:16,color:P.tokens.accentNegativeDefault}):null]})}),(0,g.jsx)(D.View,{css:dj.popoverWrapper,p:10,children:(0,g.jsx)(dy,{agentLimit:n,agentUsage:e,cloudUsage:r,cloudLimit:i,agentNextCreditsAt:t,cloudNextCreditsAt:a,isUnderMonthlyQuota:o})})]})}function dI(){var e=aB(),n=(0,aM.useKeyCombo)(aq.id),t=n?"".concat(aN," (").concat(n,")"):aN;return(0,g.jsx)(ct.IconButton,{alt:t,onClick:function(){return e()},size:28,dataCy:"command-bar-btn",children:(0,g.jsx)(s8.default,{})})}var dC=e.i(344677),dk=e.i(914279),dE=e.i(68893),dT=e.i(241703),dP=e.i(729678),dR=e.i(187505),dA=e.i(86159),dD=e.i(522821),dV=e.i(293265),dO=e.i(469429),dF=e.i(76430),dM=e.i(629536);e.i(709867),e.i(812432),e.i(33914);var dL=e.i(503536);e.i(709263),e.i(406345);var dG=e.i(634669);e.i(919015);var dU=e.i(733257);e.i(362874),e.i(680189);var dN=((i={}).Welcome="Welcome",i.AiFirstWorkspace="AiFirstWorkspace",i.Assistant="Assistant",i.Agent="Agent",i.SidebarDock="SidebarDock",i.Run="Run",i.Deploy="Deploy",i.NewTab="NewTab",i.Filetree="Filetree",i);(0,rl.cssRecord)({tooltipContainer:[i9.rcss.width("100%"),i9.rcss.maxWidth(300),i9.rcss.position.relative,i9.rcss.colWithGap(8),i9.rcss.pb(8)],textContent:[i9.rcss.width("100%"),{wordBreak:"break-word",overflowWrap:"anywhere"}]}),dM.AGENT_NAME;var dB="workspace-desktop-tour-2025",dW=e.i(785719),dz=e.i(980713);function dH(e){var n=e.color;return(0,g.jsxs)(D.View,{clsx:dz.default.deployIconWithStatus,children:[(0,g.jsx)(dL.default,{}),(0,g.jsx)(D.View,{tag:"span",clsx:dz.default.deployIconDotWrapper,children:(0,g.jsx)(D.View,{tag:"span",clsx:dz.default.deployIconDot,style:{backgroundColor:n}})})]})}function dq(e){var n=e.text,t=e.icon,r=e.disabled,i=e.rounded,a=e.onClick,o=e.tooltip,s=e.loading,l=e.iconOnly,u=e.tourStepRef,c=e.colorway,d=(0,g.jsx)(a4.Button,{ref:u,loading:s,size:"small",text:n,iconLeft:t,colorway:c,clsx:i?s?dz.default.roundedButtonLoading:dz.default.roundedButton:s?dz.default.baseButtonLoading:dz.default.baseButton,disabled:r,onClick:a,"data-icon-only":l});return o?(0,g.jsx)(c6.Tooltip,{tooltip:o,children:d}):d}function dK(e){var n,t,r,i,a,o,s,l,u,c,d,p,f,h,m=e.iconOnly,v=e.shouldSkipOpeningPane,x=void 0!==v&&v,y=(0,dk.useDeploymentMode)(),w=(0,dC.usePauseProvisionStage)(),b=(0,cY.useIsAgentStackRepl)().isAgentStackRepl,_=(0,dV.useAgentStackPlatformType)().agentStackPlatformType,j=function(e,n,t){switch(e){case dE.DeploymentMode.Ready:case dE.DeploymentMode.Suspended:case dE.DeploymentMode.ProcessingLifecycleCommand:case dE.DeploymentMode.Loading:switch(n){case lQ.AgentStackPlatformType.Slack:return"Publish to Slack";case lQ.AgentStackPlatformType.Telegram:return"Publish to Telegram";case lQ.AgentStackPlatformType.TimeBased:return"Publish Automation";default:return"Publish"}case dE.DeploymentMode.Preparing:return"Preparing";case dE.DeploymentMode.PreparingDatabase:switch(t){case!0:return"Approve";case!1:return"Preparing"}break;case dE.DeploymentMode.Deploying:switch(n){case lQ.AgentStackPlatformType.Slack:return"Publishing to Slack";case lQ.AgentStackPlatformType.Telegram:return"Publishing to Telegram";case lQ.AgentStackPlatformType.TimeBased:return"Publishing Automation";default:return"Publishing"}default:(0,cw.default)(e)}}(y,b&&_||null,!!w),S=!1,I=!1;switch(y){case dE.DeploymentMode.Ready:case dE.DeploymentMode.Suspended:case dE.DeploymentMode.ProcessingLifecycleCommand:h=(0,g.jsx)(dL.default,{});break;case dE.DeploymentMode.Loading:h=(0,g.jsx)(dL.default,{}),S=!0;break;case dE.DeploymentMode.Preparing:h=(0,g.jsx)(dL.default,{}),S=!0,I=!0;break;case dE.DeploymentMode.PreparingDatabase:w?(h=(0,g.jsx)(dW.default,{color:P.tokens.orangeStronger}),I=!0,S=!1):(h=(0,g.jsx)(cF.default,{}),I=!0,S=!0);break;case dE.DeploymentMode.Deploying:h=(0,g.jsx)(cF.default,{}),I=!0;break;default:(0,cw.default)(y)}var C=ax(),k=(0,sW.useSetDeploymentTriggerSource)(),E=!!(0,dD.useActiveAgentSessionId)(),T=(n=(0,ot.default)().dotReplit,r=(t=(0,U._)((0,N.useState)(null),2))[0],i=t[1],(0,N.useEffect)(function(){return n.watch(function(e){var n;if(e.error)return i(null);i((null==(n=e.config.deployment)?void 0:n.target)||null)})},[n]),r),R=(a=(0,sW.useDeployBuild)().deployBuild,o=(0,a2.default)(),s=(0,sW.useDotReplitService)(),l=(0,a5.default)().showError,u=(0,sW.useSecretsService)(),c=(0,sW.useDeploymentSubdomain)(),d=(0,sW.useDeploymentSecurityScanState)().enabled,p=(0,dP.useGetSecretsAsDeploymentEntries)({secrets:u,replId:o}),f=!!(0,dD.useActiveAgentSessionId)(),(0,N.useCallback)(function(){return(0,ei._)(function(){var e,n,t;return(0,ea._)(this,function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),[4,(0,dP.getDotReplitDeploymentConfig)(s)];case 1:return e=r.sent(),[4,p()];case 2:if(n=r.sent(),!(t=c)||!e.publicDir)return[2,!1];return[4,a({provider:lQ.HostingBuildProvider.Static,subdomain:t,config:{buildCommand:e.buildCommand,publicDir:e.publicDir,appType:lQ.DeployHostingBuildAppType.Static,ignorePorts:!1,runCommand:null},envVars:n,privacyMode:lQ.DeployHostingBuildPrivacyMode.Public,ignoredSecrets:[],hasAgentSession:f,enableSecurityScan:d,createNeonProductionDatabase:!1,pushDevelopmentDatabaseObjects:null})];case 3:return r.sent(),[2,!0];case 4:return l(r.sent().message||"Failed to deploy"),[2,!1];case 5:return[2]}})})()},[a,l,s,p,c,d,f])),A=(0,dA.useSetTourStepTarget)(dB,dN.Deploy);return(0,g.jsx)(dq,{text:j,icon:h,onClick:function(){return(0,ei._)(function(){return(0,ea._)(this,function(e){switch(e.label){case 0:if(y===dE.DeploymentMode.Ready&&(0,el.track)(eu.events.DEPLOY_PROJECT_SELECTED,{source:"deploy_button",has_agent_session:E}),k("workspace_header_publish_button"),!x)return[3,2];return[4,R()];case 1:if(e.sent())return[2];e.label=2;case 2:return C({pane:{type:"deployments",flow:{skipIntro:null!==T&&E,isAgentDeployment:null!==T&&E}}}),[2]}})})()},disabled:S,loading:I,rounded:!0,iconOnly:void 0!==m&&m,tourStepRef:A,colorway:y===dE.DeploymentMode.Ready?"primary":void 0})}function d$(){var e,n,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.hideOpenPaneButton,i=t.forcePrimaryColorway,a=(0,dR.useTrackClick)().trackClick,o=(0,dk.useDeploymentMode)(),s=(0,sW.useDeploymentError)(),l=(0,sW.useActiveBuildAction)(),u=(0,sW.useSetDeploymentTriggerSource)(),c=ax(),d=(0,sW.useDeployBuild)({openDeploymentsPane:function(){c({pane:{type:"deployments"}})}}).redeployWithNoNewOptions,p=(0,a5.default)().showError,f=(0,dC.usePauseProvisionStage)(),h=(0,dV.useAgentStackPlatformType)().agentStackPlatformType,m=(0,dF.useIsExpoStackWithLaunchEnabled)(),v=(0,q.useSupportsAgent)(),x=(0,U._)((0,N.useState)(void 0),2),y=x[0],w=x[1];(0,N.useEffect)(function(){if(l&&"HostingBuildDeployStatusAction"===l.__typename)switch(l.status){case lQ.HostingBuildStatus.Success:case lQ.HostingBuildStatus.Failed:w(l.status)}},[l]),(0,N.useEffect)(function(){o===dE.DeploymentMode.Deploying&&w(void 0)},[o]);var b=function(){switch(h){case lQ.AgentStackPlatformType.Slack:return"Republish to Slack";case lQ.AgentStackPlatformType.Telegram:return"Republish to Telegram";case lQ.AgentStackPlatformType.TimeBased:return"Republish Automation";default:return"Republish"}}(),_=function(){switch(h){case lQ.AgentStackPlatformType.Slack:return"Publishing to Slack";case lQ.AgentStackPlatformType.Telegram:return"Publishing to Telegram";case lQ.AgentStackPlatformType.TimeBased:return"Publishing Automation";default:return"Publishing"}}(),j=void 0,S=!1,I=!1;switch(o){case dE.DeploymentMode.Ready:e="Republish",n=(0,g.jsx)(dL.default,{}),y&&(y===lQ.HostingBuildStatus.Success?(n=(0,g.jsx)(dH,{color:P.tokens.accentPositiveDefault}),j="Success"):(n=(0,g.jsx)(dH,{color:P.tokens.accentNegativeDefault}),j="An error occurred"));break;case dE.DeploymentMode.Suspended:e=b,n=(0,g.jsx)(dH,{color:P.tokens.greyDefault}),j="Published app suspended";break;case dE.DeploymentMode.Loading:e=b,n=(0,g.jsx)(dL.default,{}),S=!0,I=!0;break;case dE.DeploymentMode.ProcessingLifecycleCommand:e=b,n=(0,g.jsx)(dH,{color:P.tokens.orangeStronger}),I=!0,j="Updating published app";break;case dE.DeploymentMode.Preparing:e="Preparing",n=(0,g.jsx)(cF.default,{}),I=!0,S=!0;break;case dE.DeploymentMode.PreparingDatabase:f?(e="Approve",n=(0,g.jsx)(dW.default,{color:P.tokens.orangeStronger}),I=!0,S=!1):(e="Preparing",n=(0,g.jsx)(cF.default,{}),I=!0,S=!0);break;case dE.DeploymentMode.Deploying:e=_,n=(0,g.jsx)(cF.default,{}),I=!0;break;default:(0,cw.default)(o)}return s&&(e="Error",n=(0,g.jsx)(dH,{color:P.tokens.accentNegativeDefault}),j=s),(0,g.jsxs)(D.View,{row:!0,gap:2,children:[(0,g.jsx)(dq,{text:e,icon:n,tooltip:j,onClick:function(){a({productArea:"publishing",target:"redeploy_button"}),(0,ei._)(function(){return(0,ea._)(this,function(e){switch(e.label){case 0:if(m||o===dE.DeploymentMode.Deploying||o===dE.DeploymentMode.Suspended||o===dE.DeploymentMode.ProcessingLifecycleCommand||o===dE.DeploymentMode.Preparing||o===dE.DeploymentMode.PreparingDatabase||y&&(w(void 0),y===lQ.HostingBuildStatus.Failed)||s)return c({pane:{type:"deployments",data:{view:dT.Views.Deployment}}}),[2];e.label=1;case 1:return e.trys.push([1,3,,4]),u("workspace_header_republish_button"),[4,d({hasAgentSession:v})];case 2:return e.sent(),[3,4];case 3:return p(e.sent().message),[3,4];case 4:return[2]}})})()},disabled:S,loading:I,colorway:i?"primary":void 0}),r?null:(0,g.jsx)(ct.IconButton,{filled:!0,size:28,alt:"Open Publishing pane",onClick:function(){c({pane:{type:"deployments"}})},clsx:dz.default.openPaneButton,children:(0,g.jsx)(l1.default,{})})]})}var dQ=function(){var e=ax();return(0,g.jsx)(a4.Button,{size:"small",text:"Republish",iconLeft:(0,g.jsx)(dL.default,{}),onClick:function(){e({pane:{type:"deployments"}})}})};function dY(e){var n=e.iconOnly,t=e.isDesignMode,r=e.hideOpenPaneButton,i=e.forcePrimaryColorway,a=(0,sW.useDeploymentId)(),o=(0,sW.useDeploymentCurrentBuild)(),s=(0,sW.useDeploymentDeployability)().deployability,l=(0,sW.useDeploymentSessionOrg)(),u=!!(null==l?void 0:l.id),c=(0,dO.useHasAgentCheckpoint)();return a&&o?s.redeploy.isAuthorized?(0,g.jsx)(d$,{hideOpenPaneButton:r,forcePrimaryColorway:i}):(0,g.jsx)(dQ,{}):(0,g.jsx)(dK,{iconOnly:n,shouldSkipOpeningPane:t&&!u&&c})}var dX=e.i(239612);function dJ(){var e=(0,x._)(["\n  fragment ProjectHeaderMenuOrg on Org {\n    id\n    slug\n  }\n"]);return dJ=function(){return e},e}function dZ(){var e=(0,x._)(["\n  query ProjectHeaderMenu($id: String!, $input: ProjectReplsInput!) {\n    getRepl(id: $id) {\n      ... on Repl {\n        id\n        title\n        ...CreateProjectForkRepl\n        project {\n          id\n          mainRepl {\n            id\n            title\n            ...CreateProjectForkRepl\n          }\n          repls(input: $input) {\n            items {\n              id\n              title\n              ...ReplLinkRepl\n            }\n            pageInfo {\n              hasNextPage\n              nextCursor\n            }\n          }\n        }\n      }\n    }\n  }\n  ","\n  ","\n"]);return dZ=function(){return e},e}var d0={};(0,y.gql)(dJ());var d1=(0,y.gql)(dZ(),dX.CreateProjectForkReplFragmentDoc,s6.ReplLinkReplFragmentDoc),d2=e.i(691056),d4=e.i(611361),d8=e.i(341126),d3=e.i(700582),d6=e.i(537548),d5=e.i(91720),d9=e.i(988676),d7=e.i(85742),pe=e.i(458496),pe=pe,pn=e.i(119274),pt=e.i(698043),pr=e.i(498540),pi=e.i(690821),pa=e.i(185591),po=e.i(616278),ps=e.i(606867),pl=(0,rl.cssRecord)({self:[i9.rcss.display.grid,i9.rcss.p(4),{gap:4,alignItems:"stretch"}],list:[i9.rcss.maxHeight(640)],listItem:[pe.default.item,i9.rcss.px(8),i9.rcss.height(28),{span:i9.rcss.color.foregroundDefault}],listItemLabel:{flex:1},listButtonLink:[i9.rcss.height(28),i9.rcss.px(6),i9.rcss.transition.none],currentReplIcon:[i9.rcss.color.foregroundDimmer],tourWrapper:[i9.rcss.p(8)]});function pu(e){var n=e.label,t=e.icon,r=(0,uc._)(e,["label","icon"]);return(0,g.jsxs)(d7.BaseListBoxItem,(0,r$._)((0,v._)({css:pl.listItem},r),{textValue:n,children:[(0,g.jsx)(d7.ListBoxItemLabel,{css:pl.listItemLabel,children:n}),(0,g.jsx)(ps.IconProvider,{size:16,children:t})]}))}var pc=(0,N.forwardRef)(function(e,n){var t,r,i,a,o,s,l,u,c,d,p,f,h=(0,a2.default)(),m=(0,U._)((0,N.useState)(""),2),x=m[0],y=m[1],b=(0,dA.useTourStep)(d6.projectsTour.id,d6.StepIds.Forks),_=(t={variables:{id:h,input:{}},notifyOnNetworkStatusChange:!0},r=(0,v._)({},d0,t),w.useQuery(d1,r)),j=_.refetch,S=(0,a5.default)(),I=S.showConfirm,C=S.showError,k=(0,U._)((0,d3.useCreateProjectFork)({onFork:function(){I("App forked, redirecting...")},onError:function(){C("Error creating fork - please try again")}}),2),E=k[0],T=k[1].loading;(0,d2.default)(function(){j({input:{filters:{title:{search:x}}},id:h})},[x],300);var P=(null==(i=_.data)?void 0:i.getRepl.__typename)==="Repl"?_.data.getRepl.project:null,R=(null==(a=_.previousData)?void 0:a.getRepl.__typename)==="Repl"?null==(o=_.previousData.getRepl.project)?void 0:o.repls.items:null,A=null!=(d=null==P?void 0:P.mainRepl)?d:(null==(s=_.previousData)?void 0:s.getRepl.__typename)==="Repl"&&null!=(c=null==(l=_.previousData.getRepl.project)?void 0:l.mainRepl)?c:null,V=(null==(u=_.data)?void 0:u.getRepl.__typename)==="Repl"?_.data.getRepl:null,O=(0,d4.useProjectPresenceUsersByRepl)({orgId:e.org.id,projectId:e.projectId}),F=(0,dA.useActiveTourStep)();return(0,g.jsxs)("div",{css:pl.self,ref:n,children:[(0,g.jsxs)(pt.SearchableListBox,{children:[(0,g.jsx)(pr.SearchField,{"aria-label":"Search Apps in Project",placeholder:"Search by App title...",onChange:y,isLoading:_.loading,autoFocus:!0}),(0,g.jsx)(d7.ListBox,{isLoading:_.loading,items:null!=(f=null!=(p=null==P?void 0:P.repls.items)?p:R)?f:[],css:pl.list,children:function(e){var n;return(0,g.jsx)(pu,(0,r$._)((0,v._)({icon:e.id===h?(0,g.jsx)(c6.Tooltip,{tooltip:"You are here",placement:"right",children:(0,g.jsx)(po.default,{css:pl.currentReplIcon})}):void 0,isDisabled:e.id===h,id:e.id,label:e.title},(0,pa.replLinkProps)(e)),{sessions:null!=(n=O[e.id])?n:[]}),e.id)}})]}),(0,g.jsx)(d9.DividerH,{}),(0,g.jsxs)(D.View,{children:[(0,g.jsx)(d5.ButtonLink,(0,r$._)((0,v._)({alignment:"start"},(0,d8.orgProjectLink)({org:e.org,projectId:e.projectId})),{target:"_blank",iconLeft:(0,g.jsx)(lZ.default,{}),text:"Project dashboard",variant:"nofill",css:pl.listButtonLink})),(0,g.jsxs)(pn.PopupMenu,{elevated:!1,placement:"right top",trigger:(0,g.jsx)(a4.Button,{alignment:"start",variant:"nofill",text:"New fork",iconLeft:T?(0,g.jsx)(cF.default,{}):(0,g.jsx)(sT.default,{}),loading:T,css:pl.listButtonLink}),children:[V?(0,g.jsx)(pn.MenuItem,{label:"From here (".concat(V.title,")"),isDisabled:T,onAction:function(){E({forkSource:"projectHeaderMenu",orgId:e.org.id,repl:V})}}):null,V&&A&&V.id!==A.id?(0,g.jsx)(pn.MenuItem,{label:"From main App (".concat(A.title,")"),isDisabled:!A||T,onAction:function(){A&&E({orgId:e.org.id,repl:A,forkSource:"projectHeaderMenu"})}}):null]}),b.isActive&&F?(0,g.jsx)("div",{css:pl.tourWrapper,children:(0,g.jsx)(pi.Tour,{content:F.content,title:F.title,onDismiss:b.next,onCurrentStepChange:b.goto,currentStepIndex:d6.projectsTour.steps.findIndex(function(e){return e.id===d6.StepIds.Forks}),totalSteps:d6.projectsTour.steps.length})}):null]})]})}),pd=e.i(782096),pp=(0,rl.cssRecord)({projectLinkTooltip:[i9.rcss.maxWidth(400),i9.rcss.flex.shrink(2)],projectLink:[i9.rcss.px(6),i9.rcss.noDragRegion,i9.rcss.flex.growAndShrink(1)],inheritanceChevron:[i9.rcss.color.outlineStrongest,{marginInline:-1}]});function pf(e){var n=e.repl,t=e.hideTitle,r=(0,U._)((0,N.useState)(!1),2),i=r[0],a=r[1];return n.project&&n.org?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(c6.Tooltip,{tooltip:"Project forks",css:pp.projectLinkTooltip,isOpen:!i&&void 0,children:(0,g.jsxs)(dt.PopoverTrigger,{label:"Project Menu",isOpen:i,onOpenChange:a,placement:"bottom start",children:[(0,g.jsx)(a4.Button,{iconLeft:(0,g.jsx)(c8,{replId:n.id,replIconUrl:n.iconUrl}),text:t?"":n.project.title,variant:"nofill",css:pp.projectLink}),(0,g.jsx)(pc,{org:n.org,projectId:n.project.id})]})}),(0,g.jsx)(pd.default,{size:12,css:pp.inheritanceChevron})]}):null}var ph=e.i(782672),pg=e.i(550801);function pm(e){var n=e.nixError,t=(0,U._)((0,N.useState)(!1),2),r=t[0],i=t[1],a=ll(),o=(0,N.useCallback)(function(e){a({type:"codeEditor",data:{path:e}})},[a]);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(ct.IconButton,{alt:"App is in recovery mode",onClick:function(){i(!0)},children:["error"===n.status?(0,g.jsx)(dm.default,{color:P.tokens.orangeStronger}):null,"rebuilding-after-error"===n.status?(0,g.jsx)(cF.default,{}):null]}),(0,g.jsx)(pg.NixIsBrokenModal,{isOpen:r,setIsOpen:i,nixError:n,openFile:o})]})}function pv(){var e=(0,x._)(["\n  query WorkspaceRunButton($id: String!) {\n    getRepl(id: $id) {\n      ... on Repl {\n        id\n        title\n        rootOriginReplUrl\n        source {\n          release {\n            id\n            repl {\n              id\n              title\n              owner {\n                ... on User {\n                  id\n                  username\n                }\n                ... on Team {\n                  id\n                  username\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n    currentUser {\n      id\n    }\n  }\n"]);return pv=function(){return e},e}var px={},py=(0,y.gql)(pv()),pw=e.i(353583),pb=(f={},(0,E._)(f,lC.RunState.IDLE,"Run"),(0,E._)(f,lC.RunState.RUNNING,"Stop"),(0,E._)(f,lC.RunState.STOPPING,"Stopping"),(0,E._)(f,lC.RunState.OFFLINE,"Working"),(0,E._)(f,lC.RunState.BEFORE_RUN,"Working"),f),p_=e.i(796817);function pj(e){var n=e.stop,t=e.cancel;return(0,g.jsxs)(D.View,{children:[(0,g.jsx)(a8.Text,{children:"Stopping your project while the agent is working can lead to unexpected interruptions that incur additional costs. Are you sure you want to stop?"}),(0,g.jsxs)(D.View,{pt:12,row:!0,gap:12,justify:"end",children:[(0,g.jsx)(a4.Button,{text:"Cancel",onClick:t}),(0,g.jsx)(a4.Button,{iconLeft:(0,g.jsx)(p_.default,{}),text:"Stop",onClick:function(){n(),t()},colorway:"negative"})]})]})}var pS=e.i(978669),pI=e.i(60166);function pC(e){var n,t={running:e.isAgentRunningWorkflow?(0,g.jsx)(l3.default,{color:P.tokens.blurpleDefault}):(0,g.jsx)(p_.default,{color:P.tokens.foregroundDimmest}),stopped:(0,g.jsx)(pS.default,{color:e.disabled?P.tokens.foregroundDimmest:P.tokens.accentPositiveStronger}),loading:(0,g.jsx)(cF.default,{color:P.tokens.foregroundDimmest})}[e.status];return(0,g.jsxs)(A.Surface,{elevated:e.elevated,clsx:[pI.default.root,(n={},(0,E._)(n,pI.default.running,"running"===e.status),(0,E._)(n,pI.default.agent,e.isAgentRunningWorkflow),n)],children:[(0,g.jsx)(ct.IconButton,{disabled:e.disabled,dataCy:"ws-run-btn",alt:"Run or stop the app",tooltipContents:e.tooltip,onClick:e.onClick,size:28,children:t}),e.isAgentRunningWorkflow?(0,g.jsx)(D.View,{clsx:pI.default.agentStatusIcon,align:"center",justify:"center",children:(0,g.jsx)(p_.default,{size:12,color:P.tokens.foregroundDimmest})}):null]})}function pk(){var e,n,t,r,i,a,o,s,l,u,c,d,p,f,h,m,x,y,b,_,j,S,I,C=(o=(null==(a=(r={variables:{id:(0,a2.default)()}},i=(0,v._)({},px,r),w.useQuery(py,i)).data)?void 0:a.getRepl.__typename)==="Repl"?a.getRepl:null,s=(n=null==(e=(0,dA.useTourStep)("workspace-desktop-tour-2024",dN.Run))?void 0:e.isActive,{tourRefs:e.tourRef,isAnyTourStepActive:n}).tourRefs,l=(0,aM.useKeyCombo)(lY.run.id),c=(u=(0,U._)((0,N.useState)(!1),2))[0],d=u[1],f=null!=(t=null==(p=(0,lF.useWorkflowsRunner)())?void 0:p.workflowId)?t:lC.PID1_RUNNER_NAME,m=(h=(0,lF.useRunInfo)()).isRunning,x=h.isAgentRunningWorkflow,y=h.isOffline,b=h.isWorkflowsLoading,_=h.isDisabled,j=(0,N.useMemo)(function(){return y||b},[y,b]),S=(0,pw.useIsAgentRunButtonNotConfigured)(),I=(0,lF.useOnToggleRun)(),(0,N.useEffect)(function(){x&&c&&d(!1)},[x,c]),{tourRefs:s,isAgentRunningWorkflow:x,isOffline:y,isOfflineOrLoading:j,isWorkflowsLoading:b,runButtonName:f,runShortcut:l,isRunning:m,isDisabled:_,handleRunButtonClick:(0,N.useCallback)(function(){if(o){var e,n,t,r,i,a,s;(0,el.track)(eu.events.PROJECT_RAN,{placement:"primary_btn",replId:o.id,replTitle:o.title,rootOriginReplUrl:o.rootOriginReplUrl,templateTitle:null==(t=o.source)||null==(n=t.release)||null==(e=n.repl)?void 0:e.title,templateOwner:null==(s=o.source)||null==(a=s.release)||null==(i=a.repl)||null==(r=i.owner)?void 0:r.username})}(0,el.track)(eu.events.WORKSPACE,{action:"run_button_used",usage:"clicked",source:"header",runner:"workflows"}),I()},[o,I]),dropdownEnabled:!j&&!S,isAgentRunButtonNotConfigured:S}),k=C.isOfflineOrLoading,E=C.isRunning,T=C.handleRunButtonClick,P=C.isAgentRunningWorkflow,R=C.isDisabled,A=C.runButtonName,V=C.runShortcut,O=C.isAgentRunButtonNotConfigured,F=(0,ph.useNixError)(),M=(0,U._)((0,N.useState)(!1),2),L=M[0],G=M[1],B=E?"running":"stopped";k&&(B="loading");var W=P?function(){return G(!0)}:T;return F?(0,g.jsx)(pm,{nixError:F}):(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(pC,{disabled:R||O,status:B,isAgentRunningWorkflow:P,onClick:W,tooltip:function(e){var n=e.isOffline,t=e.isAgentRunningWorkflow,r=e.isDisabled,i=e.isRunning,a=e.runButtonName,o=e.shortcut,s=e.isAgentRunButtonNotConfigured,l=e.isStatusButton;if(n)return"Connecting to the workspace";if(t)return l?"Stop App (Agent is running it)":"Agent is running your App";if(s)return"Agent hasn't configured the run button yet";if(r)return"Run button is not configured";var u=(0,lC.removeRunPrefix)(a);return(0,g.jsxs)(D.View,{px:4,gap:4,justify:"center",align:"center",children:[a?(0,g.jsx)(a8.Text,{color:"dimmer",variant:"small",children:i?pb[lC.RunState.RUNNING]+" all workflows":pb[lC.RunState.IDLE]+" ".concat(u)}):null,o?(0,g.jsx)(lu.KeyComboBlocks,{keyCombo:o,fontSize:12}):null]})}({isRunning:E,isAgentRunningWorkflow:P,isDisabled:R,isOffline:k,runButtonName:A,shortcut:V,isAgentRunButtonNotConfigured:O,isStatusButton:!0})}),(0,g.jsx)(az.Modal,{isOpen:L,onRequestClose:function(){return G(!1)},children:(0,g.jsx)(pj,{stop:T,cancel:function(){return G(!1)}})})]})}function pE(e){var n=e.shortcut,t=e.content;return(0,g.jsxs)(D.View,{row:!0,gap:8,align:"center",children:[(0,g.jsxs)(a8.Text,{multiline:!1,variant:"small",children:["Toggle ",t]}),n?(0,g.jsx)(lu.KeyComboBlocks,{fontSize:10,keyCombo:n}):null]})}var pT=e.i(537754),pP=e.i(700283);function pR(e){var n=e.flipped,t=aI(),r=(0,uv.default)(t.activeContent),i=(0,uv.default)(t.isOpen)&&"filetree"===r,a=(0,aM.useKeyCombo)(uQ.id);(0,aM.useCommandBinding)(function(){return[uQ.id,function(){return t.toggle()}]},[t]);var o=i?dU.default:pT.default;return(0,g.jsx)(ct.IconButton,{onClick:function(){return t.toggleContent("filetree")},alt:"Toggle files",dataCy:"toggle-files-sidebar",tooltipContents:(0,g.jsx)(pE,{shortcut:a,content:"files"}),size:28,children:(0,g.jsx)(o,{clsx:(0,E._)({},pP.default.flipped,n)})})}var pA=e.i(325990),pD=e.i(467716);function pV(){var e=(0,pA.useOrgFlag)({controlName:"flag-agent-inbox",default:!1}),n=aI(),t=(0,aM.useKeyCombo)(uQ.id);return e?(0,g.jsx)(ct.IconButton,{onClick:function(){return n.toggleContent("inbox")},alt:"Toggle inbox",dataCy:"toggle-inbox-sidebar",tooltipContents:(0,g.jsx)(pE,{shortcut:t,content:"inbox"}),size:28,children:(0,g.jsx)(pD.default,{})}):null}var pO=e.i(923893),pF=e.i(433788),pM=e.i(915598),pL=e.i(732947);function pG(){var e=(0,x._)(["\n  fragment ReplMultiplayerOrg on Org {\n    ...OrgMetadata\n    membersCount\n  }\n  ","\n"]);return pG=function(){return e},e}function pU(){var e=(0,x._)(["\n  fragment ReplMultiplayerOrgGroup on OrgGroup {\n    ...OrgGroupsOrgGroup\n  }\n  ","\n"]);return pU=function(){return e},e}function pN(){var e=(0,x._)(["\n  fragment ReplMultiplayerGroup on ReplMultiplayerGroupScope {\n    group {\n      __typename\n      ...ReplMultiplayerOrgGroup\n    }\n    options {\n      __typename\n      role\n      status\n    }\n  }\n  ","\n"]);return pN=function(){return e},e}function pB(){var e=(0,x._)(["\n  fragment ReplMultiplayerIndividual on ReplMultiplayerIndividualScope {\n    group {\n      __typename\n      ...ReplMultiplayerOrgGroup\n    }\n    user {\n      __typename\n      id\n      displayName\n      image\n      username\n    }\n    options {\n      __typename\n      role\n      status\n    }\n  }\n  ","\n"]);return pB=function(){return e},e}function pW(){var e=(0,x._)(["\n  fragment ReplMultiplayerStatus on Repl {\n    id\n    title\n    isPrivate\n    url\n    org {\n      ...ReplMultiplayerOrg\n    }\n    multiplayerStatus {\n      __typename\n      groups {\n        __typename\n        ...ReplMultiplayerGroup\n      }\n      individuals {\n        __typename\n        ...ReplMultiplayerIndividual\n      }\n    }\n    authorizations {\n      editPermissions {\n        isAuthorized\n        message\n      }\n      editVisibility {\n        isAuthorized\n        message\n      }\n      removeSelf {\n        isAuthorized\n        message\n      }\n      viewPermissions {\n        isAuthorized\n        message\n      }\n    }\n  }\n  ","\n  ","\n  ","\n"]);return pW=function(){return e},e}function pz(){var e=(0,x._)(["\n  query ReplMultiplayerStatus($replId: String!) {\n    getRepl(id: $replId) {\n      __typename\n      ... on Repl {\n        __typename\n        ...ReplMultiplayerStatus\n      }\n    }\n  }\n  ","\n"]);return pz=function(){return e},e}function pH(){var e=(0,x._)(["\n  mutation UpdateOrgReplVisibility($input: UpdateReplInput!) {\n    updateRepl(input: $input) {\n      repl {\n        id\n        ...ReplMultiplayerStatus\n      }\n    }\n  }\n  ","\n"]);return pH=function(){return e},e}var pq={},pK=(0,y.gql)(pG(),pL.OrgMetadataFragmentDoc),p$=(0,y.gql)(pU(),pM.OrgGroupsOrgGroupFragmentDoc),pQ=(0,y.gql)(pN(),p$),pY=(0,y.gql)(pB(),p$),pX=(0,y.gql)(pW(),pK,pQ,pY),pJ=(0,y.gql)(pz(),pX),pZ=(0,y.gql)(pH(),pX),p0=e.i(766774),p1=e.i(813479),p2=e.i(306694),p4=e.i(967667),p8=e.i(479420),p3=e.i(714165),p6=e.i(396776),p5=e.i(576073),p9=e.i(987154),p7=e.i(626729),fe=(0,rl.cssRecord)({section:[i9.rcss.colWithGap(12),i9.rcss.px(12)],sectionWithBorders:[i9.rcss.colWithGap(12),i9.rcss.p(12),i9.rcss.border({direction:"top"}),i9.rcss.border({direction:"bottom"}),{"&:last-of-type":{borderBottom:0,paddingBottom:0}}],sectionTitle:[i9.rcss.fontWeight.medium],subtitle:[i9.rcss.fontWeight.medium],item:[i9.rcss.rowWithGap(16),i9.rcss.align.center,i9.rcss.justify.spaceBetween],groupName:[i9.rcss.colWithGap(6),i9.rcss.justify.center],visibilitySelector:[i9.rcss.position.relative,i9.rcss.justify.start,i9.rcss.align.center]}),fn=function(e){var n,t,r,i,a,o,s,l,u,c,d,p=e.replId,f=(0,a1.useCurrentUserId)(),h=(0,Y.default)(),m=(n={variables:{replId:p}},t=(0,v._)({},pq,n),w.useQuery(pJ,t)),x=m.data,y=m.loading,b=m.error,_=m.refetch,j=(null==x||null==(r=x.getRepl)?void 0:r.__typename)==="Repl"?x.getRepl:void 0,S=(null!=(u=null==j||null==(i=j.multiplayerStatus)?void 0:i.groups)?u:[]).filter(function(e){return"custom"!==e.group.type}),I=(null!=(c=null==j||null==(a=j.multiplayerStatus)?void 0:a.groups)?c:[]).filter(function(e){return"custom"===e.group.type}),C=null!=(d=null==j||null==(o=j.multiplayerStatus)?void 0:o.individuals)?d:[],k=S.map(function(e){return e.group}).concat(I.map(function(e){return e.group})).concat(C.map(function(e){return e.group})),E=function(){return(0,ei._)(function(){return(0,ea._)(this,function(e){switch(e.label){case 0:return[4,_()];case 1:return e.sent(),[2]}})})()};return(null==b?void 0:b.message)?(0,g.jsx)(D.View,{gap:12,children:(0,g.jsx)(p6.StatusBanner,{colorway:"negative",text:b.message})}):y||!j?(0,g.jsx)(D.View,{px:12,align:"center",justify:"center",children:(0,g.jsx)(cF.default,{})}):(0,g.jsxs)(D.View,{gap:12,children:[(0,g.jsxs)(D.View,{tag:"header",px:12,gap:2,children:[(0,g.jsx)(a8.Text,{variant:"subheadDefault",children:"Share App"}),(0,g.jsxs)(D.View,{css:fe.subtitle,row:!0,gap:4,children:[j.org?(0,g.jsxs)(a8.Text,{variant:"small",color:"dimmer",children:[j.org.name," /"]}):null,(0,g.jsx)(a8.Text,{variant:"small",children:j.title})]})]}),(null==(s=j.org)?void 0:s.id)&&j.authorizations.editPermissions.isAuthorized?(0,g.jsx)(D.View,{css:fe.sectionWithBorders,children:(0,g.jsx)(fi,{orgId:j.org.id,selectedGroups:k,repl:j,onScopeChange:E})}):null,(0,g.jsxs)(D.View,{css:fe.section,children:[(0,g.jsx)(a8.Text,{variant:"small",css:fe.sectionTitle,children:"Roles with access"}),(0,g.jsx)(D.View,{gap:12,children:S.map(function(e){var n=e.group,t=e.options;return(0,g.jsx)(fr,{repl:j,group:n,options:t,onScopeChange:E},n.id)})}),I.length>0?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(a8.Text,{variant:"small",css:fe.sectionTitle,children:"Groups with access"}),(0,g.jsx)(D.View,{gap:12,children:I.map(function(e){var n=e.group,t=e.options;return(0,g.jsx)(fr,{repl:j,group:n,options:t,onScopeChange:E},n.id)})})]}):null]}),C.length>0?(0,g.jsxs)(D.View,{css:fe.section,children:[(0,g.jsx)(a8.Text,{variant:"small",css:fe.sectionTitle,children:"People with access"}),C.map(function(e){var n=e.group,t=e.user,r=e.options;return(0,g.jsx)(ft,{currentUserId:f,repl:j,group:n,user:t,options:r,onScopeChange:E},t.id)})]}):null,(0,g.jsx)(D.View,{css:fe.section,children:(0,g.jsx)(p4.OrgPermissionsInfoBanner,{type:"repl"})}),(null==(l=j.org)?void 0:l.id)?(0,g.jsx)(D.View,{css:fe.sectionWithBorders,children:(0,g.jsxs)(D.View,{row:!0,justify:"space-between",children:[(0,g.jsx)(fa,{repl:j,org:j.org}),h?null:(0,g.jsx)(d5.ButtonLink,(0,r$._)((0,v._)({prefetch:!1},(0,pa.replViewLinkProps)(j)),{iconRight:(0,g.jsx)(lZ.default,{}),variant:"outlined",text:"Cover page",target:"_blank",style:{pointerEvents:"auto"}}))]})}):null]})},ft=function(e){var n=e.user,t=e.currentUserId,r=e.repl,i=e.group,a=e.options,o=e.onScopeChange,s=t===n.id;return(0,g.jsxs)(D.View,{css:fe.item,children:[(0,g.jsxs)(D.View,{row:!0,gap:8,children:[(0,g.jsx)(p3.Avatar,{src:n.image,username:n.username,fullName:n.displayName,size:24}),(0,g.jsxs)(D.View,{css:fe.groupName,children:[(0,g.jsxs)(D.View,{row:!0,gap:8,children:[(0,g.jsx)(a8.Text,{height:"singleLine",children:n.username}),s?(0,g.jsx)(a8.Text,{height:"singleLine",color:"dimmest",children:"(You)"}):null]}),n.username!==n.displayName?(0,g.jsx)(a8.Text,{variant:"small",color:"dimmest",height:"singleLine",children:n.displayName}):null]})]}),(0,g.jsx)(D.View,{children:(0,g.jsx)(p8.default,{repl:r,group:i,options:a,onScopeChange:o})})]})},fr=function(e){var n=e.repl,t=e.group,r=e.options,i=e.onScopeChange;return(0,g.jsxs)(D.View,{css:fe.item,children:[(0,g.jsxs)(D.View,{row:!0,gap:8,children:[(0,g.jsx)(p1.default,{group:t}),(0,g.jsxs)(D.View,{css:fe.groupName,children:[(0,g.jsx)(a8.Text,{height:"singleLine",children:t.name}),(0,g.jsxs)(D.View,{row:!0,gap:8,children:[t.isMember?(0,g.jsx)(a8.Text,{variant:"small",color:"dimmest",height:"singleLine",children:"(you)"}):null,null!=t.memberCount?(0,g.jsx)(a8.Text,{variant:"small",color:"dimmest",height:"singleLine",children:(0,uE.default)("member",t.memberCount,!0)}):null]})]})]}),(0,g.jsx)(D.View,{children:(0,g.jsx)(p8.default,{repl:n,group:t,options:r,onScopeChange:i})})]})},fi=function(e){var n,t,r,i,a,o,s,l=e.orgId,u=e.selectedGroups,c=e.repl,d=e.onScopeChange,p="group-search-".concat((0,N.useId)()),f=(0,U._)((0,N.useState)(),2),h=f[0],m=f[1],v=(0,U._)((0,N.useState)(""),2),x=v[0],y=v[1],w=(0,U._)((0,p0.useOrgGroupReplScopeOptionsLazyQuery)(),2),b=w[0],_=w[1],j=_.data,S=_.error,I=_.loading,C=j&&(null==(t=j.currentUser)||null==(n=t.org)?void 0:n.__typename)==="Org"&&"OrgGroup"===j.currentUser.org.group.__typename&&(null==(r=j.currentUser.org.group.replScopeOptions)?void 0:r.__typename)==="OrgGroupReplScopeOptions"?j.currentUser.org.group.replScopeOptions.items[0].options:void 0,k=(null==j?void 0:j.currentUser)&&"Org"!==j.currentUser.org.__typename?j.currentUser.org.message:void 0,E=(null==j?void 0:j.currentUser)&&"Org"===j.currentUser.org.__typename&&"OrgGroup"!==j.currentUser.org.group.__typename?j.currentUser.org.group.message:void 0,T=(null==j?void 0:j.currentUser)&&"Org"===j.currentUser.org.__typename&&"OrgGroup"===j.currentUser.org.group.__typename&&(null==(i=j.currentUser.org.group.replScopeOptions)?void 0:i.__typename)!=="OrgGroupReplScopeOptions"?null==(a=j.currentUser.org.group.replScopeOptions)?void 0:a.message:void 0,P=null!=(s=null!=(o=null!=k?k:E)?o:T)?s:null==S?void 0:S.message;return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(D.View,{row:!0,gap:8,children:[(0,g.jsx)(D.View,{grow:!0,shrink:!0,children:(0,g.jsx)(p2.default,{inputId:p,orgId:l,types:[lQ.OrgGroupType.Custom,lQ.OrgGroupType.SystemIndividual],selectedGroups:u,value:x,setValue:y,onSelect:function(e){m(e),y(e.name),b({variables:{orgId:l,groupId:e.id,input:{replIds:[c.id]}}})},onClear:function(){return m(void 0)},placeholder:"Share with groups or other members"})}),h&&C||I?(0,g.jsxs)(D.View,{pl:24,row:!0,align:"center",children:[h&&C&&!I?(0,g.jsx)(p8.default,{group:h,repl:c,options:C,onScopeChange:function(){return(0,ei._)(function(){return(0,ea._)(this,function(e){switch(e.label){case 0:return[4,d()];case 1:return e.sent(),y(""),m(void 0),[2]}})})()}}):null,I?(0,g.jsx)(cF.default,{size:24}):null]}):null]}),P?(0,g.jsx)(p6.StatusBanner,{colorway:"negative",text:P}):null]})},fa=function(e){var n,t,r,i=e.repl,a=e.org,o=(0,U._)((0,N.useState)(),2),s=o[0],l=o[1],u=(0,U._)((0,N.useState)(),2),c=u[0],d=u[1],p=(0,U._)((n={variables:{input:{id:i.id}},onError:function(e){d(e.message)}},t=(0,v._)({},pq,n),B.useMutation(pZ,t)),2),f=p[0],h=p[1].loading,m="repl-visibility-".concat((0,N.useId)()),x=i.authorizations.editVisibility.isAuthorized,y=i.authorizations.editVisibility.message,w=[{id:"private",icon:(0,g.jsx)(p7.default,{}),name:"Internal to ".concat(a.name),selected:i.isPrivate,description:"Only selected organization members can view or edit."},{id:"public",icon:(0,g.jsx)(p9.default,{}),name:"Public on Replit",selected:!i.isPrivate,description:"Anyone on Replit can see or fork. You choose who can edit."}],b=w.find(function(e){return e.selected}),_=b?(0,g.jsxs)(D.View,{row:!0,gap:8,align:"center",children:[b.icon," ",b.name]}):void 0;return r=c?(0,g.jsx)(c6.Tooltip,{tooltip:c,children:(0,g.jsx)(dm.default,{size:24,color:P.tokens.accentNegativeDefault})}):h?(0,g.jsx)(cF.default,{size:24}):s?(0,g.jsx)(po.default,{size:24,color:P.tokens.accentPositiveDefault}):null,(0,g.jsxs)(D.View,{css:fe.visibilitySelector,grow:!0,shrink:!0,row:!0,gap:4,children:[(0,g.jsx)(c6.Tooltip,{tooltip:y,isDisabled:x,children:(0,g.jsx)(pn.PopupMenu,{id:m,trigger:(0,g.jsx)(a4.Button,{iconRight:(0,g.jsx)(p5.default,{}),text:null!=_?_:"Control Repl visibility",disabled:!x}),"aria-label":"Control ".concat(i.title," visibility"),onAction:function(e){var n="private"===e;n!==i.isPrivate&&(d(void 0),f({variables:{input:{id:i.id,isPrivate:n}},optimisticResponse:{__typename:"RootMutationType",updateRepl:{__typename:"UpdateReplPayload",repl:(0,r$._)((0,v._)({},i),{isPrivate:n})}},onCompleted:function(e){"UpdateReplPayload"===e.updateRepl.__typename&&(l(!0),setTimeout(function(){return l(!1)},2e3))}}))},items:w,disallowEmptySelection:!0,isDisabled:!x,children:function(e){return(0,g.jsx)(pn.MenuItem,{id:e.id,label:e.name,description:e.description,icon:e.icon},e.id)}})}),r?(0,g.jsx)(D.View,{children:r}):null]})},fo=e.i(84466),fs=e.i(635925);function fl(){var e=(0,x._)(["\n  query TeamMultiplayerManagerMultiplayers($replId: String!) {\n    currentUser {\n      id\n    }\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        isOwner\n        collaborators {\n          type\n          permission\n          user {\n            ...MultiplayerUser\n          }\n        }\n        authorizations {\n          editPermissions {\n            isAuthorized\n          }\n          inviteGuests {\n            isAuthorized\n          }\n        }\n        multiplayerInvites {\n          email\n          type\n        }\n        owner {\n          ... on User {\n            id\n          }\n          ... on Team {\n            id\n            username\n            displayName\n            capabilities {\n              isBusinessPlan\n              hasValidSubscription\n              availableSeats\n            }\n            members {\n              id\n              permissions\n              user {\n                id\n                ...MultiplayerUser\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return fl=function(){return e},e}var fu={},fc=(0,y.gql)(fl(),fs.MultiplayerUserFragmentDoc),fd=e.i(204070),fp=(0,rl.cssRecord)({root:[i9.rcss.color.foregroundDefault,i9.rcss.p(24),i9.rcss.display.grid,{gap:P.tokens.space24}],controls:[i9.rcss.display.grid,{gap:P.tokens.space8,gridAutoFlow:"column"}],message:[i9.rcss.pb(16)],textContainer:[i9.rcss.textAlign.center]});function ff(e){var n=e.email,t=e.onInvite,r=e.onCancel;return(0,g.jsxs)("div",{css:fp.root,children:[(0,g.jsx)(a8.Header,{level:3,textAlign:"center",variant:"subheadBig",children:"Are you sure?"}),(0,g.jsx)("div",{css:fp.textContainer,children:(0,g.jsxs)(a8.Text,{variant:"text",children:[(0,g.jsx)("p",{css:fp.message,children:"Adding an external user as a guest to this repl will give the user read and write access. Please confirm the below email address before inviting the user as a guest."}),(0,g.jsx)("p",{children:n})]})}),(0,g.jsxs)("div",{css:fp.controls,children:[(0,g.jsx)(a4.Button,{onClick:r,text:"Cancel"}),(0,g.jsx)(a4.Button,{colorway:"primary",onClick:t,text:"Invite"})]})]})}var fh=e.i(802482),fg=e.i(613349),fm=e.i(552144),fv=e.i(652219);function fx(e){var n,t,r,i,a,o,s,l,u,c,d,p,f=e.replId,h=(0,m.useRouter)(),x=(0,Z.isInBonsaiWebview)(h),y=(0,dl.useActiveUsers)(),b=(0,U._)((0,N.useState)(null),2),_=b[0],j=b[1],S=(n={variables:{replId:f}},t=(0,v._)({},fu,n),w.useQuery(fc,t)),I=S.data,C=S.loading,k=(null==I||null==(r=I.currentUser)?void 0:r.id)||null,E=(null==I?void 0:I.getRepl.__typename)==="Repl"?I.getRepl:null,T=(0,fd.default)({isMobileApp:x,isTeam:!0,replId:f}),R=T.addOrInviteReplMultiplayer,V=T.loadingAddMutation;if(E&&!E.owner)throw Error("Cannot manage members on anon repls");if((null==E?void 0:E.owner)&&(null==E?void 0:E.owner.__typename)!=="Team")throw Error("Expect repl owned by a team");var O=(null==E||null==(i=E.owner)?void 0:i.__typename)==="Team"?E.owner:null,F=!(null==O||null==(a=O.capabilities)?void 0:a.hasValidSubscription)&&!(null==O||null==(o=O.capabilities)?void 0:o.isBusinessPlan),M=(null!=(s=null==E?void 0:E.collaborators)?s:[]).reduce(function(e,n){var t=n.user.username;return -1===e.indexOf(t)&&e.push(),e},[]),L=null==E?void 0:E.multiplayerInvites,G=(null!=(l=null==E?void 0:E.collaborators)?l:[]).filter(function(e){return"guest"===e.type}).map(function(e){return e.user}),B=G.length,W=(null!=(u=null==E?void 0:E.collaborators)?u:[]).filter(function(e){return"member"===e.type}).map(function(e){return e.user}),z=(null!=(c=null==E?void 0:E.collaborators)?c:[]).filter(function(e){return"admin"===e.type}).map(function(e){return e.user}),H=z.some(function(e){return e.id===k}),q=W.filter(function(e){return y.some(function(n){return n.id===e.id})}),K=W.filter(function(e){return!y.some(function(n){return n.id===e.id})}),$=null!=(d=null==E?void 0:E.authorizations.editPermissions.isAuthorized)&&d,Q=null!=(p=null==E?void 0:E.authorizations.inviteGuests.isAuthorized)&&p;return C?(0,g.jsx)(A.Surface,{css:[pF.MultiplayerControlCSS.root],background:"default",children:(0,g.jsxs)(D.View,{css:pF.MultiplayerControlCSS.loading,children:[(0,g.jsx)(cF.default,{color:P.tokens.foregroundDimmer}),(0,g.jsx)(a8.Text,{color:"dimmer",multiline:!1,children:"Loading..."})]})}):(0,g.jsxs)(A.Surface,{css:pF.MultiplayerControlCSS.root,background:"default",children:[(0,g.jsx)(D.View,{css:[pF.MultiplayerControlCSS.header,x&&pF.MultiplayerControlCSS.header_mobile],children:(0,g.jsx)(D.View,{css:pF.MultiplayerControlCSS.titleContainer,children:(0,g.jsx)(a8.Text,{variant:"subheadDefault",multiline:!1,children:"Team Multiplayers"})})}),Q?(0,g.jsx)(D.View,{css:pF.MultiplayerControlCSS.searchContainer,children:(0,g.jsx)(fg.default,{existingUsernames:M,onSubmit:function(e){if(!V){if((0,fo.default)(e))return void j(e);R({variables:{input:{replId:f,target:{method:lQ.MultiplayerInviteMethod.Username,value:e},level:lQ.ReplPermissionLevel.Rw}}})}},isDisabled:C})}):null,!Q&&F?(0,g.jsx)(D.View,{px:16,children:(0,g.jsx)(fm.StatusBannerButton,{iconLeft:(0,g.jsx)(fv.default,{}),text:'You can add people to this App by inviting them to the "'.concat(null==O?void 0:O.displayName,'" Friends Team.'),href:"/teams/".concat(null==O?void 0:O.username),target:"_blank"})}):null,(0,g.jsx)(az.Modal,{isOpen:!!_,onRequestClose:function(){return j(null)},children:_?(0,g.jsx)(ff,{email:_,onInvite:function(){R({variables:{input:{replId:f,target:{method:lQ.MultiplayerInviteMethod.Email,value:_},level:lQ.ReplPermissionLevel.Rw}}}),j(null)},onCancel:function(){return j(null)}}):null}),(0,g.jsxs)(A.Surface,{css:pF.MultiplayerControlCSS.userList,children:[(null==L?void 0:L.length)?(0,g.jsxs)(D.View,{css:pF.MultiplayerControlCSS.userGroup.root,children:[(0,g.jsx)(pF.UserGroupTitle,{title:"Pending Invitations",color:P.tokens.outlineStrongest,count:B}),null==L?void 0:L.map(function(e){return(0,g.jsx)(fh.default,{canEditMultiplayers:H||!1,email:e.email,isPendingInvitation:!0,replId:f},e.email)})]}):null,G.length?(0,g.jsxs)(D.View,{css:pF.MultiplayerControlCSS.userGroup.root,children:[(0,g.jsx)(pF.UserGroupTitle,{title:"External Guests",color:P.tokens.outlineStrongest,count:null==G?void 0:G.length,tooltip:"External Guests are not members of your team and were invited via a Join Link or by username."}),G.map(function(e){return(0,g.jsx)(fh.default,{canEditMultiplayers:H||!1,isPendingInvitation:!1,replId:f,user:e},e.id)})]}):null,q.length?(0,g.jsxs)(D.View,{css:pF.MultiplayerControlCSS.userGroup.root,children:[(0,g.jsx)(pF.UserGroupTitle,{title:"Online Members",color:P.tokens.greenStrongest,count:null==q?void 0:q.length}),q.map(function(e){return(0,g.jsx)(fh.default,{isPendingInvitation:!1,canEditMultiplayers:!!H,replId:f,user:e},e.id)})]}):null,K.length?(0,g.jsxs)(D.View,{css:pF.MultiplayerControlCSS.userGroup.root,children:[(0,g.jsx)(pF.UserGroupTitle,{title:"Offline Members",color:P.tokens.outlineStrongest,count:null==K?void 0:K.length}),K.map(function(e){return(0,g.jsx)(fh.default,{isPendingInvitation:!1,canEditMultiplayers:!!H,replId:f,user:e},e.id)})]}):null,z.length?(0,g.jsxs)(D.View,{css:pF.MultiplayerControlCSS.userGroup.root,children:[(0,g.jsx)(pF.UserGroupTitle,{title:"Admins",color:P.tokens.accentPrimaryStronger,count:z.length}),z.map(function(e){return(0,g.jsx)(fh.default,{canEditMultiplayers:!1,isPendingInvitation:!1,user:e,replId:f},e.id)})]}):null,$||C?null:(0,g.jsx)(a8.Text,{color:"dimmer",variant:"small",multiline:!1,children:"Only admins can add and remove members to multiplayer"})]})]})}var fy=e.i(758386),fw=e.i(841691),fb=function(){var e=(0,fy.useUpsellContext)(),n=e.showPrivateUpsell,t=e.refetch,r=(0,s$.useGlobalModal)().show;return n?(0,g.jsx)(D.View,{px:12,children:(0,g.jsx)(D.View,{tag:"button",css:f_.bannerWrapper,onClick:function(){return(0,ei._)(function(){return(0,ea._)(this,function(e){switch(e.label){case 0:return[4,r("MembershipPurchaseModal",{headingText:"Upgrade for private Apps",subHeadingText:"Keep your code secure and private",analyticsContext:{upgrade:{context:"workspace_multiplayer_header"}},onPurchaseComplete:function(){return t()}})];case 1:return e.sent(),[2]}})})()},children:(0,g.jsx)(p6.StatusBanner,{icon:(0,g.jsx)(fw.default,{}),colorway:"yellow",text:"This App is publicly visible. Upgrade for unlimited private Apps, better AI, more storage, speed, and more."})})}):null},f_=(0,rl.cssRecord)({bannerWrapper:[i9.rcss.cursor.pointer,i9.rcss.borderRadius(),i9.rcss.textAlign.left]}),fj=(0,rl.cssRecord)({self:[i9.rcss.borderRadius(8),i9.rcss.align.stretch,i9.rcss.flex.growAndShrink(1),i9.rcss.maxHeight("calc(100vh - ".concat(V.HEADER_HEIGHT+12,"px)")),i9.rcss.backgroundColor.backgroundDefault]});let fS=function(e){var n,t=e.replId,r=e.handleUpgradeTriggered,i=e.isTeamRepl,a=e.org;return n=a?(0,g.jsx)(fn,{replId:t}):i?(0,g.jsx)(fx,{replId:t}):(0,g.jsx)(pF.default,{replId:t,handleUpgradeTriggered:r}),(0,g.jsxs)(D.View,{css:fj.self,py:12,gap:12,children:[n,a&&"personal"!==a.type?null:(0,g.jsx)(fb,{}),a?null:(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(d9.DividerH,{}),(0,g.jsx)(pO.default,{replId:t})]})]})};var fI=e.i(781478),fC=e.i(317941);function fk(e){var n,t,r,i=e.users,a=void 0===i?[]:i,o=e.onAvatarClick,s=e.repl,l=(null==(n=s.owner)?void 0:n.__typename)==="Team",u=(0,U._)((0,N.useState)(!1),2),c=u[0],d=u[1];return(0,g.jsxs)(D.View,{row:!0,align:"center",gap:4,children:[a.length?(0,g.jsx)(fE,{users:a,onAvatarClick:o}):null,(0,g.jsxs)(dt.PopoverTrigger,{isOpen:c,onOpenChange:d,label:"Home",placement:"bottom start",children:[(null==(t=s.org)?void 0:t.type)==="team"?(0,g.jsx)(a4.Button,{size:"small",iconLeft:(0,g.jsx)(fI.default,{}),text:"Access"}):(0,g.jsx)(ct.IconButton,{alt:"Invite collaborator",size:28,children:(0,g.jsx)(fI.default,{})}),(0,g.jsx)(D.View,{clsx:fC.default.inviteDialog,children:(0,g.jsx)(fS,{replId:s.id,isTeamRepl:l,org:null!=(r=s.org)?r:void 0,handleUpgradeTriggered:function(){}})})]})]})}function fE(e){var n=e.users,t=e.onAvatarClick,r=n.slice(0,2),i=n.length-2,a=(0,U._)((0,N.useState)(!1),2),o=a[0],s=a[1];return(0,g.jsxs)(D.View,{row:!0,gap:4,children:[r.map(function(e,n){return(0,g.jsx)(fT,{onClick:function(){return t(e)},user:e,stacked:n>0},e.username)}),i>0?(0,g.jsxs)(dt.PopoverTrigger,{isOpen:o,onOpenChange:s,label:"Home",placement:"bottom start",children:[(0,g.jsx)(a4.Button,{size:"small",text:"+".concat(i),clsx:[fC.default.stacked,fC.default.remainingCountButton]}),(0,g.jsxs)(pn.Menu,{children:[(0,g.jsx)(pn.MenuHeader,{text:"Observe..."}),n.slice(2).map(function(e){return(0,g.jsx)(pn.MenuItem,{onAction:function(){return t(e)},icon:(0,g.jsx)(p3.Avatar,{size:24,src:e.image||null,username:e.username,ringColor:e.color}),label:e.username},e.username)})]})]}):null]})}function fT(e){var n=e.user,t=e.stacked,r=e.onClick;return(0,g.jsx)(ct.IconButton,{alt:"Observe ".concat(n.username),onClick:r,clsx:[fC.default.avatar,(0,E._)({},fC.default.stacked,t)],children:(0,g.jsx)(p3.Avatar,{size:24,src:n.image||null,username:n.username,ringColor:n.color})})}var fP=e.i(625251),fR=e.i(183462),fA=e.i(987143),fD=e.i(825516);function fV(){var e=(0,x._)(["\n  fragment WorkspaceHeaderNavMenuRepl on Repl {\n    id\n    org {\n      id\n      slug\n    }\n    ...ReplEnvironmentHeaderInviteButtonRepl\n  }\n  ","\n"]);return fV=function(){return e},e}function fO(){var e=(0,x._)(["\n  fragment WorkspaceHeaderNavMenuCurrentUser on CurrentUser {\n    id\n    isMemberOfAnyOrg\n    image\n    username\n    ...UserLinkCurrentUser\n    ...OrgSwitcherCurrentUser\n  }\n  ","\n  ","\n"]);return fO=function(){return e},e}function fF(){var e=(0,x._)(["\n  query WorkspaceHeaderNavMenu($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        ...WorkspaceHeaderNavMenuRepl\n      }\n    }\n    currentUser {\n      ...WorkspaceHeaderNavMenuCurrentUser\n    }\n  }\n  ","\n  ","\n"]);return fF=function(){return e},e}var fM={},fL=(0,y.gql)(fV(),fD.ReplEnvironmentHeaderInviteButtonReplFragmentDoc),fG=(0,y.gql)(fO(),fA.UserLinkCurrentUserFragmentDoc,fR.OrgSwitcherCurrentUserFragmentDoc),fU=(0,y.gql)(fF(),fL,fG),fN=e.i(641555),fB=e.i(548733),fW=e.i(927196),fz=e.i(845411),fH=e.i(805518),fq=e.i(935267),fK=e.i(429878),f$=e.i(266899),fQ=e.i(273929),fY=e.i(495764),fX=e.i(531603),fJ=e.i(371816),fZ=e.i(995045),f0=e.i(344718),f1=e.i(841412),f2=e.i(988072),f4=e.i(346606),f8=e.i(144459),f3=e.i(384132);function f6(e){var n,t,r,i=(0,U._)((0,N.useState)(null),2),a=i[0],o=i[1],s=(0,fq.default)().count,l=(0,dw.useGetAgentFreeUsage)({skip:!e.showUpsell}).refetch,u=(0,db.useGetCloudFreeUsage)({skip:!e.showUpsell}).refetch,c=(0,Z.useIsInBonsaiWebview)(),d=(0,Z.useDoesBonsaiSupportFeature)("simplifiedTabletUI"),p=c&&d,f=(n={variables:{replId:e.replId},skip:p},t=(0,v._)({},fM,n),w.useQuery(fU,t)).data,h=(null==f?void 0:f.getRepl.__typename)==="Repl"?f.getRepl:null,m=null==f?void 0:f.currentUser,x=function(e){var n,t,r,i,a,o,s,l={ssr:!1,fetchPolicy:"cache-and-network",nextFetchPolicy:"cache-first"},u=fY.RECENT_REPLS_SIDEBAR_MENU_COUNT,c=(0,f$.useSidebarRecentReplsQuery)((0,v._)({variables:{count:u},skip:null===e||!!(null==(n=e.org)?void 0:n.id)},l)),d=(0,f$.useSidebarRecentOrgReplsQuery)((0,v._)({variables:{count:u,orgId:null==e||null==(t=e.org)?void 0:t.id},skip:null==e||!(null==e||null==(r=e.org)?void 0:r.id)},l));if(!e)return null;var p=[];return((null==(o=d.data)||null==(a=o.currentUser)||null==(i=a.org)?void 0:i.__typename)==="Org"?p=d.data.currentUser.org.recentRepls.items:(null==(s=c.data)?void 0:s.allRecentRepls)&&(p=c.data.allRecentRepls),(p=p.filter(function(n){return n.id!==e.id}).slice(0,fQ.RECENT_REPLS_DISPLAY_COUNT)).length)?p:null}(h);if(p)return(0,g.jsx)(D.View,{clsx:f3.default.emptySpacer});var y=null==h||null==(r=h.org)?void 0:r.slug,b=y?(0,d8.orgLinks)({slug:y}).home:{href:"/home",as:"/~"};return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(fW.AgentStatusProvider,{children:(0,g.jsx)(O.NavMenu,{onOpenChange:function(n){n&&e.showUpsell&&(l(),u())},children:m&&h?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(pn.Menu,{"aria-label":"Navigation menu",clsx:f3.default.menu,children:[(0,g.jsx)(pn.MenuItem,{icon:(0,g.jsx)(p7.default,{}),label:"Home",href:b.href,as:b.as}),x?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(f7,{repls:x}),(0,g.jsx)(pn.Separator,{})]}):null,m?(0,g.jsx)(fJ.AccountItems,{setActiveModal:function(e){return o({type:e})},currentUser:m,notificationCount:s}):null,(null==m?void 0:m.isMemberOfAnyOrg)?(0,g.jsx)(f2.TeamsItem,{currentUser:m}):null,(0,g.jsx)(f4.ThemeItem,{}),(0,g.jsx)(f0.HelpItem,{setActiveModal:function(e){return o({type:e})},children:(0,g.jsx)(hn,{setActiveModal:o})}),m?(0,g.jsx)(fZ.DevCopyUsernameItem,{currentUser:m}):null,(0,g.jsx)(pn.Separator,{}),(0,g.jsx)(f1.LogoutItem,{})]}),e.showUpsell?(0,g.jsx)(D.View,{pb:10,children:(0,g.jsx)(f9,{})}):null]}):(0,g.jsx)(cF.default,{})})}),(0,g.jsxs)(az.Modal,{isOpen:null!==a,onRequestClose:function(){return o(null)},children:[(null==a?void 0:a.type)==="support"?(0,g.jsx)(fX.default,{onRequestClose:function(){return o(null)}}):null,(null==a?void 0:a.type)==="notifications"?(0,g.jsx)(f5,{}):null,(null==a?void 0:a.type)==="referral"?(0,g.jsx)(fB.ReferralLinkModalContent,{trackingContext:"workspace-nav-menu"}):null,(null==a?void 0:a.type)==="feedback"?(0,g.jsx)(fK.AIFeedback,{session:a.session,onClose:function(){return o(null)}}):null]})]})}function f5(){return(0,g.jsxs)(D.View,{gap:12,children:[(0,g.jsx)(a8.Text,{variant:"subheadDefault",children:"Notifications"}),(0,g.jsx)(fH.default,{count:10,loadMore:!0,markAsSeen:!0})]})}function f9(){var e=(0,ds.useIsFreemiumStarterPlanUsersOwnRepl)().isFreemiumStarterPlanUsersOwnRepl,n=(0,dw.useGetAgentFreeUsage)(),t=n.agentUsage,r=n.agentUsageV2,i=(0,db.useGetCloudFreeUsage)().cloudUsage;return e?(0,g.jsx)(D.View,{gap:8,px:8,pt:12,clsx:f3.default.usage,children:(0,g.jsx)(dy,{agentLimit:r?r.limit:null==t?void 0:t.limit,agentUsage:r?r.usage:null==t?void 0:t.usage,cloudLimit:null==i?void 0:i.limit,cloudUsage:null==i?void 0:i.usage,agentNextCreditsAt:null==r?void 0:r.nextCreditsAt,cloudNextCreditsAt:null==i?void 0:i.nextCreditsAt,isUnderMonthlyQuota:null==r?void 0:r.isUnderMonthlyQuota})}):null}function f7(e){var n=e.repls;return(0,g.jsxs)(fP.MenuSection,{children:[(0,g.jsx)(pn.MenuHeader,{text:"Recent"}),n.map(function(e){return(0,g.jsx)(he,{repl:e},e.id)})]})}function he(e){var n=e.repl,t=(0,lL.useObservable)((0,fz.useReplAgentStatus)(n));return(0,g.jsxs)(pn.BaseMenuItem,(0,r$._)((0,v._)({textValue:n.title,clsx:f3.default.repl},(0,pa.replLinkProps)(n)),{children:[(0,g.jsxs)(D.View,{align:"center",row:!0,gap:6,grow:!0,shrink:!0,pl:0,children:[(0,g.jsx)(lr.default,{size:20,alt:n.title,iconUrl:n.iconUrl}),(0,g.jsx)(a8.Text,{translate:"no",children:n.title})]}),t&&"Paused"!==t.label?(0,g.jsx)(a8.Text,{variant:"small",color:"dimmer",children:t.label}):null]}),n.id)}function hn(e){var n=(0,ds.useIsFreemiumStarterPlanUsersOwnRepl)().isFreemiumStarterPlanUsersOwnRepl,t=(0,q.useSupportsAgent)(),r=(0,u4.useChatter)(),i=(0,fN.useObservableMemo)(function(){return t?r.sessions.agent.current:r.sessions.chat.open.latest},[r,t]);return!i||n?null:(0,g.jsx)(pn.MenuItem,{icon:(0,g.jsx)(f8.default,{}),label:"Submit feedback",onAction:function(){return e.setActiveModal({type:"feedback",session:i})}})}function ht(e){var n,t=(n=ri(it),(0,N.useMemo)(function(){return new ev.Multicast(function(e){return e.next(n.current),n.subscribe(function(n){return e.next(n)})})},[n])),r=(0,ex.useCreateObservableAtom)(r7,rt()),i=(0,ex.useCreateObservableAtom)(rC,rt());return(0,N.useMemo)(function(){var n,a,o;return n={headerWidth:u8.Observable.from(r).select(function(n){return n[e]}),tabHeaderWidth:t.select(function(n){return n[e]}),sidebarWidth:u8.Observable.from(i).select(function(n){return n[e]})},a=null,o=null,new ev.Multicast(function(e){return u8.Observable.combine(n.headerWidth,n.tabHeaderWidth,n.sidebarWidth).subscribe(function(n){var t=(0,U._)(n,3),r=t[0],i=t[1],s=t[2];if(null!==r){var l=null===o?null:o-r+10;if(null!==o&&s>o){"large"!==a&&(a="large",e.next("large"));return}if(i<=200&&"small"!==a){a="small",o=r,e.next("small");return}i>200&&"large"!==a&&(null===l||i>200+l)&&(a="large",e.next("large"))}})})},[t,r,i,e])}var hr=e.i(782514),hi=e.i(292642),ha=e.i(342571),ho=(0,P.cvarsFrom)("index.module.css",["--z-index","--height"]);function hs(e){var n=ra(ie),t=(0,Y.default)();return(0,cq.default)(function(r){t||n(e,r.width)})}function hl(){var e;return e={},(0,E._)(e,ho.zIndex,rs.zIndexLevels.tiledPane.toString()),(0,E._)(e,ho.height,V.APP_HEADER_HEIGHT+"px"),e}function hu(e){var n=e.repl,t=rr(nN),r=(0,Y.default)();return(0,g.jsxs)(hr.TrackingHierarchyProvider,{hierarchy:{surface:"workspace_header"},children:[r?(0,g.jsx)(D.View,{clsx:ha.default.desktopDragRegion}):null,(0,g.jsx)(hc,{repl:n}),(0,g.jsx)(hp,{repl:n}),t?(0,g.jsx)(hf,{repl:n}):null]})}function hc(e){var n=e.repl,t=aC(),r=(0,uv.default)(t.agentFiletreeOrder),i=hl(),a=ro(n6),o=hs("left"),s=(0,lL.useObservable)(ht("left")),l=(0,da.useIsAgentWebDesignMockup)().isWebDesignMockup,u=(0,u4.useChatter)(),c=(0,lL.useObservable)(u.sessions.agent.current),d=(0,X.useFlag)({controlName:"flag-hide-run-button-design-mode",default:!1});return(0,g.jsx)(D.View,{row:!0,align:"center",innerRef:o,style:i,clsx:ha.default.left,children:(0,g.jsxs)(D.View,{px:6,row:!0,align:"center",children:[(0,g.jsx)(T.default,{}),"agent-filetree"!==r?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(pR,{}),(0,g.jsx)(pV,{})]}):(0,g.jsx)(ca,{}),(0,g.jsx)(f6,{replId:n.id,showUpsell:"small"===s}),(0,g.jsx)(pf,{hideTitle:"small"===s,repl:n}),(0,g.jsxs)(D.View,{row:!0,gap:4,align:"center",children:[(0,g.jsx)(di,{repl:n,getDesktopLayoutState:a,hideTitle:"small"===s}),l?(0,g.jsx)(cQ.DesignMockupPill,{session:c}):null,l&&d?null:(0,g.jsx)(pk,{}),"small"===s?null:(0,g.jsx)(hd,{replUrl:n.url})]})]})})}function hd(e){var n=e.replUrl;return(0,ds.useIsFreemiumStarterPlanUsersOwnRepl)().isFreemiumStarterPlanUsersOwnRepl?(0,g.jsxs)(D.View,{row:!0,gap:4,align:"center",children:[(0,g.jsx)(dS,{}),(0,g.jsx)(c$.default,{text:"Upgrade",context:"agent_freemium_quota_v2",colorway:"primary",variant:"default",size:"small",redirectPath:n,modalHeadingText:"Compare Replit plans",modalSubHeadingText:"Autonomy for all. Choose the best plan for you."})]}):null}function hp(e){var n,t,r,i,a,o,s,l=e.repl,u=hs("right"),c=hl(),d=aC(),p=(0,uv.default)(d.agentFiletreeOrder),f=(0,lL.useObservable)(ht("right")),h=l.authorizations.viewPermissions.isAuthorized,m=null==(o=l.authorizations)||null==(a=o.viewDeploymentConfig)?void 0:a.isAuthorized,v=(null==(s=l.hostingDeployment)?void 0:s.__typename)==="HostingDeployment"?l.hostingDeployment:null,x=(0,cY.useIsAgentStackRepl)().isAgentStackRepl,y=(null==v?void 0:v.replitAppSubdomain)?"https://".concat(v.replitAppSubdomain,".replit.app"):null,w=(null==v?void 0:v.latestBuildStatus)==="running"||(null==v?void 0:v.latestBuildStatus)==="success",b=(0,dl.useActiveUsers)(),_=(n=aw(),t=(0,ot.default)().presence,r=(0,tb.useGetActiveFile)(),i=(0,i6.default)(n),(0,N.useCallback)(function(e){var n=e.username,a=e.id,o=t.getFollowedUser();if((null==o?void 0:o.username)===n)return void t.unfollowUser();t.followUser(n);var s=t.getActiveFileForUser(a),l=r();s&&s!==l&&i.current({path:s})},[i,r,t])),j=(0,a5.default)().showConfirm,S=(0,Y.default)(),I=(0,cK.useIsWindows)();return(0,g.jsx)(D.View,{row:!0,align:"center",style:c,clsx:ha.default.right,innerRef:u,children:(0,g.jsxs)(D.View,{px:6,row:!0,gap:4,align:"center",clsx:(0,E._)({},ha.default.desktopAppWindowsOs,I&&S),children:[(0,g.jsx)(dI,{}),h?(0,g.jsx)(fk,{repl:l,users:b,onAvatarClick:_}):null,m&&!x&&y&&w?(0,g.jsx)(a4.Button,{size:"small",text:"Share",iconLeft:(0,g.jsx)(hi.default,{}),colorway:"primary",onClick:function(){(0,sK.default)(y),j("App link copied to clipboard!")}}):null,m?(0,g.jsx)(dY,{iconOnly:"small"===f,isDesignMode:!!l.config.isWebDesignMockup}):null,"agent-filetree"===p?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(pV,{}),(0,g.jsx)(pR,{flipped:!0})]}):(0,g.jsx)(ca,{})]})})}function hf(e){var n=e.repl,t=hl();ra(i4);var r=(0,X.useFlag)({controlName:"flag-agent-debug-info-button"});return(0,g.jsxs)(A.Surface,{row:!0,clsx:ha.default.planningHeader,justify:"space-between",align:"center",px:6,style:t,children:[(0,g.jsxs)(D.View,{row:!0,align:"center",clsx:ha.default.planningHeaderLeft,children:[(0,g.jsx)(T.default,{}),(0,g.jsx)(f6,{showUpsell:!1,replId:n.id}),(0,g.jsx)(a8.Text,{translate:"no",children:n.title})]}),(0,g.jsx)(D.View,{align:"center",justify:"center",clsx:ha.default.planningTimeline,children:(0,g.jsx)(cX.PlanningTimeline,{onBuildClick:void 0})}),r?(0,g.jsx)(hh,{}):null]})}function hh(){var e=(0,u4.useChatter)(),n=(0,lL.useObservable)(e.sessions.agent.current);return n?(0,g.jsx)(cJ.AiSessionDebugInfoButton,{sessionId:n.id,sessionType:u2.SessionType.AGENT_SESSION}):null}var hg=e.i(848415);e.i(312917);var hm=e.i(675186),hv=e.i(387491);function hx(e,n){var t=(0,i6.default)(n);return(0,N.useMemo)(function(){var n,r;return n="current"in e?new ev.Multicast(function(n){return n.next(e.current),e.subscribe(function(e){return n.next(e)})}):e,r=function(){return t.current()},new ev.Multicast(function(e){var t=null,i=null,a=null,o=null,s=n.subscribe(function(n){null==t||t.stop(),i&&(clearTimeout(i),i=null);var s=r();if(!s&&o&&(s=o),!1===s){a=n,e.next(n);return}o=s;var l=!0===s?{}:s,u=l.snappiness,c=void 0===u?400:u,d=l.ramp,p=l.delay,f=void 0===p?0:p,h=0,g={};for(var m in n)g[m]=a&&m in a?a[m]:n[m];t=new hm.AnimationLoop(function(t,r){for(var i in h+=t,n){if("number"!=typeof g[i]||"number"!=typeof n[i]){g[i]=n[i];continue}var s=g[i],l=n[i],u=s>=0&&s<=1&&l>=0&&l<=1?.001:void 0;g[i]=(0,hv.damp)({current:s,target:l,elapsed:h,delta:t,snappiness:c,ramp:d,minStepSize:u})}e.next((0,v._)({},g)),(0,nc.default)(g,n)&&(o=null,a=n,r())}),f>0?i=setTimeout(function(){i=null,null==t||t.start()},f):t.start()});return function(){null==t||t.stop(),i&&clearTimeout(i),s()}})},[e,t])}var hy=e.i(802088),hw=e.i(516351),hb=e.i(375032),h_=(0,P.cvarsFrom)("Border.module.css",["--header-height","--border-color","--box-shadow","--y-offset"]);let hj=(0,N.memo)(function(e){var n,t=e.paneId,r=(0,uc._)(e,["paneId"]),i=aj(t),a=(0,uv.default)(i.paneType),o=(0,uv.default)(i.border),s=(0,uv.default)(i.isMaximized),l=(0,hw.default)(),u=P.tokens.outlineDefault,c="none",d=0,p=0;switch(o){case"dragging":case"floating":u=P.tokens.outlineDefault,c=P.tokens.shadow2,d=r.headerHeight,p=6}var f=rr((0,J.default)(function(){return(0,eo.atom)(function(e){return e(no)===t})},[t]));l&&f&&(u=l.color,c="0 0 0 3px ".concat(l.color));var h=(0,U._)((0,N.useState)(!1),2),m=h[0],v=h[1];return((0,hy.useObserver)((0,u7.useAgentIsWorking)(),{next:"webview"===a?v:void 0}),s)?null:(0,g.jsx)(D.View,{style:(n={},(0,E._)(n,h_.headerHeight,"".concat(d,"px")),(0,E._)(n,h_.borderColor,u),(0,E._)(n,h_.boxShadow,c),(0,E._)(n,h_.yOffset,p+"px"),n),clsx:[hb.default.root,(0,E._)({},hb.default.pulse,m)]})});var hS=e.i(31290),hI=D.SpecializedView.div,hC=(0,ur.css)([i9.rcss.width("100%"),i9.rcss.position.absolute,i9.rcss.left(0),{cursor:"ns-resize",zIndex:1,":hover":{transform:"scaleY(4)"}}]),hk=(0,ur.css)([i9.rcss.height("100%"),i9.rcss.position.absolute,i9.rcss.top(0),{cursor:"ew-resize",zIndex:1,":hover":{transform:"scaleX(4)"}}]),hE=(0,ur.css)([i9.rcss.position.absolute,{zIndex:2,transform:"scale(2)",":hover":{transform:"scale(4)"}}]);function hT(e){return{transformOrigin:"".concat("topLeft"===e||"bottomLeft"===e?"right":"left"," ").concat("topLeft"===e||"topRight"===e?"bottom":"top")}}var hP={topLeft:(0,ur.css)([i9.rcss.top(0),i9.rcss.left(0),hT("topLeft")]),topRight:(0,ur.css)([i9.rcss.top(0),i9.rcss.right(0),hT("topRight")]),bottomLeft:(0,ur.css)([i9.rcss.bottom(0),i9.rcss.left(0),hT("bottomLeft")]),bottomRight:(0,ur.css)([i9.rcss.bottom(0),i9.rcss.right(0),hT("bottomRight")])};function hR(e){var n=e.edge,t=e.size,r=e.onPointerDown;if("top"===n||"bottom"===n)return(0,g.jsx)(hI,{onPointerDown:r,style:(0,E._)({height:t},n,-t),css:hC});if("right"===n||"left"===n)return(0,g.jsx)(hI,{onPointerDown:r,style:(0,E._)({width:t},n,-t),css:hk});var i="topLeft"===n||"bottomRight"===n?"nwse-resize":"nesw-resize";return(0,g.jsx)(hI,{onPointerDown:r,style:{height:t,width:t,cursor:i},css:[hE,hP[n]]})}var hA=["bottom","right","left","bottomRight","bottomLeft"],hD=(0,N.memo)(function(e){var n=ra(iL);return(0,g.jsx)(g.Fragment,{children:hA.map(function(t){return(0,g.jsx)(hR,{size:8,edge:t,onPointerDown:function(r){(0,hS.measureMouseMove)(r,{start:function(){n({type:"start",paneId:e.paneId,edge:t})},move:function(e){n({type:"update",moveDelta:e.delta})},end:function(){n({type:"end"})}})}},t)})})}),hV=["top","right","left","topRight","topLeft"],hO=(0,N.memo)(function(e){var n=ra(iL);return(0,g.jsx)(g.Fragment,{children:hV.map(function(t){return(0,g.jsx)(hR,{size:8,edge:t,onPointerDown:function(r){(0,hS.measureMouseMove)(r,{start:function(){n({type:"start",paneId:e.paneId,edge:t})},move:function(e){n({type:"update",moveDelta:e.delta})},end:function(){n({type:"end"})}})}},t)})})}),hF={isConnecting:!0,channel:null,context:null};function hM(e){var n=e.container,t=e.service,r=e.name,i=e.skip,a=void 0!==i&&i,o=(0,U._)((0,N.useState)(hF),2),s=o[0],l=o[1];return(0,N.useEffect)(function(){l(hF);var e=!1,i=n.openChannel({service:t,name:r,skip:function(){return a}},function(n){if(!e)return l({context:n.context,channel:n.channel,isConnecting:!1}),function(n){e||l({isConnecting:n.willReconnect,channel:null,context:null})}});return function(){e=!0,i()}},[n,t,r,a]),s}var hL=e.i(259475),hG=e.i(57613),hU=e.i(231927),hN=(0,P.cvarsFrom)("index.module.css",["--transform-x","--transform-y","--scale","--transform-origin-x","--width","--height","--opacity","--interaction-blanket-display","--pointer-events","--user-select","--border-top-left-radius","--border-top-right-radius","--border-gap","--iframe-pointer-events"]),hB=(0,N.memo)(function(e){var n,t,r,i,a,o,s=e.paneId,l=(0,aP.usePaneUIContext)().Content,u=aj(s),c=(0,uv.default)(u.isHidden),d=(0,uv.default)(u.data),p=(0,uv.default)(u.isActive),f=(0,uv.default)(u.isCommitted);(0,tb.usePaneSession)(s,d);var h=(n=a9(),t=ra(rU),r=ra(tB),i=ra(nl),a=ra(th),(0,J.default)(function(){return function(e){switch(e.operation){case"commit":i(s);return;case"open":if(e.floating)return void t(e.pane,{commit:!0,location:"center"});n({pane:e.pane,activate:!0,placement:{type:"after",paneId:s}});return;case"replace":r({paneId:s,pane:e.pane});return;case"remove":a(e.pane.id);return;case"openPip":return;default:(0,cw.default)(e)}}},[i,s,r,a,n,t])),m=(o=hM({container:(0,ot.default)().container,service:"panetracker"}).channel,(0,N.useCallback)(function(e,n){o&&o.send({paneMetricsTracker:{pane:e,flow:n}})},[o]));return(0,g.jsx)(l,{pane:d,options:{paneId:s,isHidden:c,performPaneOperation:h,isActive:p,isCommitted:f,emitPaneMetrics:m}})});let hW=(0,N.memo)(function(e){var n=e.paneId,t=av(),r=function(e){var n,t=e.paneId,r=(0,U._)((0,hg.useDrop)({accept:[tN.FileType.File,hL.DragItems.Pane,hL.DragItems.NewPane],collect:function(e){return{isOver:e.isOver()}},hover:function(e,n){var r=n.getClientOffset();r&&o.drag({pageX:r.x,pageY:r.y,over:t})},drop:function(e,n){var r=n.getClientOffset();if(r){if(e.type===hL.DragItems.Pane)return void o.drop({type:"pane",paneId:e.paneId,pageX:r.x,pageY:r.y,over:t});if("nodes"===e.type){var i=(0,na.fsNodeToPanes)(e.nodes);i.length>0&&o.drop({type:"newPaneGroup",panes:i,pageX:r.x,pageY:r.y,over:t})}if(e.type===hL.DragItems.NewPane){var a=e.pane;o.drop({type:"newPaneGroup",panes:[a],pageX:r.x,pageY:r.y,over:t})}}}}),2),i=r[0].isOver,a=r[1],o=(n=ra(rc),(0,N.useEffect)(function(){i||n(null)},[i,n]),{drag:ra(iv),drop:ra(ix)});return a}({paneId:n}),i=aj(n),a=(0,uv.default)(i.isActive),o=(0,uv.default)(i.isFloating),s=(0,uv.default)(i.isModal),l=(0,uv.default)(i.paneType),u=(0,Y.default)(),c=(0,cK.useIsMac)(),d=(0,cK.useIsWindows)(),p=(c||d)&&u?V.HEADER_HEIGHT:0,f=(0,N.useRef)(null);(0,nQ.useStyleSet)(f,hx(i.properties,i.getTransitionEnabled),function(e){var n,t=e.width,r=e.height,i=e.x,a=e.y,o=e.scale,s=e.opacity;return n={},(0,E._)(n,hN.width,t+"px"),(0,E._)(n,hN.height,r+"px"),(0,E._)(n,hN.transformX,i+"px"),(0,E._)(n,hN.transformY,a+"px"),(0,E._)(n,hN.scale,o.toString()),(0,E._)(n,hN.opacity,s.toString()),n}),(0,nQ.useStyleSet)(f,i.transformOriginXAtom,function(e){return(0,E._)({},hN.transformOriginX,e)}),(0,nQ.useStyleSet)(f,i.viewportInset,function(e){return{"--fixed-position-offset-x":-e.x+"px","--fixed-position-offset-y":-e.y-p+"px"}}),(0,nQ.useStyleSet)(f,i.isHidden,function(e){return(0,E._)({},hN.pointerEvents,e?"none":"auto")}),(0,nQ.useStyleSet)(f,i.zIndex,function(e){return{"z-index":e.toString()}}),(0,nQ.useStyleSet)(f,i.disableInteractions,function(e){var n;return n={},(0,E._)(n,hN.interactionBlanketDisplay,e?"block":"none"),(0,E._)(n,hN.userSelect,e?"none":"auto"),(0,E._)(n,hN.iframePointerEvents,e?"none":"auto"),n});var h=a?void 0:function(){t(n,{commit:"codeEditor"!==l})},m=(0,aR.useSetPaneElement)(),v=(0,E._)({},hN.borderGap,"".concat(4,"px"));o||(v[hN.borderTopLeftRadius]="".concat(8,"px"),v[hN.borderTopRightRadius]="".concat(8,"px"));var x=(0,ou.useMergeRefs)([f,o?void 0:r],{breadcrumb:"client/replEnvironmentDesktop/Pane/index.tsx:324"}),y=ra(ah),w=(0,uv.default)(i.headerHeight);return(0,g.jsx)(hr.TrackingHierarchyProvider,{hierarchy:{surface:"".concat(l,"_pane")},children:(0,g.jsx)(aR.PaneIdProvider,{value:n,children:(0,g.jsx)(A.Surface,{role:"tabpanel",id:n,"aria-labelledby":"tab-".concat(n),innerRef:x,clsx:hU.default.root,style:v,onMouseEnter:function(){return y(n)},onMouseLeave:function(){return y(null)},children:(0,g.jsxs)(hG.default,{origin:"ErrorBoundary: PaneContainer",bsod:!0,tags:(0,J.default)(function(){return{paneType:l}},[l]),children:[(0,g.jsxs)(D.View,{clsx:hU.default.container,onMouseDown:h,onContextMenu:h,innerRef:function(e){return m(n,e)},style:"agentChat"===l?{overflowX:"hidden"}:void 0,children:[(0,g.jsx)(D.View,{tabIndex:-1}),(0,g.jsx)(hB,{paneId:n})]}),(0,g.jsx)(hj,{headerHeight:w,paneId:n}),o&&!s?(0,g.jsx)(hD,{paneId:n}):null,(0,g.jsx)(D.View,{clsx:hU.default.interactionBlanket})]},n)})})})});var hz=e.i(822243),hH=e.i(429225),hq=e.i(59380);(0,rl.cssRecord)({handle:[i9.rcss.minWidth(16),i9.rcss.height("100%")]});var hK=e.i(112077),h$=e.i(33171),hQ=(0,P.cvarsFrom)("Tab.module.css",["--width","--x","--color","--bg","--font-style"]);function hY(e){var n;return n={},(0,E._)(n,hQ.width,e.width+"px"),(0,E._)(n,hQ.x,e.x+"px"),(0,E._)(n,hQ.bg,e.active?P.tokens.surfaceBackground:""),(0,E._)(n,hQ.color,e.active?P.tokens.foregroundDefault:""),n}function hX(e){var n=e.layout,t=e.paneId,r=e.paneGroupId,i=ag(t),a=(0,N.useMemo)(function(){return n.tab(t)},[n,t]),o=(0,N.useRef)(null),s=aj(e.paneId),l=(0,lL.useObservable)(s.isCommitted),u=(0,tb.useUniquePath)((0,na.isFilePane)(i)?i.data.path:null),c=(V=(R={paneId:t,paneGroupId:r}).paneId,O=R.paneGroupId,F=(0,aR.useGetPaneBindings)(),M=am(),L=uR({paneId:V}),G=ug({paneId:V,paneGroupId:O}),B=um(),W=(0,aP.usePaneUIContext)(),(0,N.useCallback)(function(){var e=M(V).pane,n=F(V),t=function(e){return!!e&&(void 0===e?"undefined":(0,eO._)(e))==="object"&&"data"in e};return{data:{type:"context",label:"Search actions",icon:(0,g.jsx)(W.Icon,{pane:e})},commands:function(){return[{data:{type:"group",key:"pane-actions"},commands:function(){var e,r;return(null!=(r=null==n||null==(e=n.commands)?void 0:e.flatMap(function(e){return e.commands}))?r:[]).filter(t)}},{data:{type:"group",key:"secondary"},commands:function(){return[B(V),L].concat((0,er._)(G)).filter(t)}}]}}},[F,W,M,V,L,G,B])),d=(0,hq.useContextMenu)().onContextMenu;(0,nQ.useStyleSet)(o,hx(a,function(){return!0}),hY);var p=ra(th),f=ra(tH),h=(0,aP.usePaneUIContext)(),m=h.getTitle(i),x=h.Icon({pane:i,size:16}),y=function(){var e=(0,N.useRef)(null),n=(0,N.useRef)(!1),t=(0,hK.useCreateObservable)(!1);function r(){var r=e.current;if(r){var i=r.scrollWidth>r.clientWidth;t.set(i),n.current=!1}}var i=(0,cq.default)(function(){n.current||(n.current=!0,requestAnimationFrame(r))});return{state:t,ref:(0,ou.useMergeRefs)([e,i])}}(),w=(0,lL.useObservable)(y.state),b=void 0;(0,na.isFilePane)(i)&&i.data.path?b=i.data.path:w&&(b=m);var _=!l&&"commands"!==i.type,j=ra(nl),S=(0,u1.useObservableRef)(s.isActive),I=function(){S.current&&!l?j(t):f(t)},C=(z=e.paneId,H=e.layout,K=(q=(0,U._)((0,hz.useDrag)({type:hL.DragItems.Pane,item:function(){return{type:hL.DragItems.Pane,paneId:z,width:80}},end:function(){H.dragState.set(null)},collect:function(e){var n=e.getItem();return{isActive:(null==n?void 0:n.paneId)===z,isDragging:e.isDragging()}}}),2))[0],$=q[1],Q=ra(tY),Y=K.isDragging,X=K.isActive,(0,N.useEffect)(function(){Q(Y)},[Q,Y]),(0,N.useEffect)(function(){H.dragState.set(X?{id:z}:null)},[H,X,z]),{dragRef:$}).dragRef,k=(0,ou.useMergeRefs)([o,e.isOnlyTab?void 0:C]),T=(0,u1.useObservableRef)(n.state),P=(0,N.useRef)(null);if(null===P.current){var R,V,O,F,M,L,G,B,W,z,H,q,K,$,Q,Y,X,J,Z=null==(J=T.current)?void 0:J.tabs.get(t);Z&&(P.current=hY((0,r$._)((0,v._)({},Z),{active:!0})))}return(0,g.jsxs)(A.Surface,{style:(0,v._)((0,E._)({},hQ.fontStyle,_?"italic":"inherit"),P.current),onMouseUp:function(e){1===e.button&&(e.preventDefault(),e.stopPropagation(),p(t))},elevated:!0,innerRef:k,align:"center",justify:"center",row:!0,clsx:h$.default.tab,onContextMenu:function(e){return d(e,{command:c()})},children:[(0,g.jsx)(c6.Tooltip,{tooltip:b,delay:"long",placement:"bottom",isDisabled:!b,children:function(e,n){return(0,g.jsxs)(D.View,(0,r$._)((0,v._)({},e),{innerRef:n,pl:6,tag:"button",clsx:h$.default.tabButton,row:!0,grow:!0,shrink:!0,align:"center",gap:6,onClick:I,children:[x,(0,g.jsx)(a8.Text,{ref:u?void 0:y.ref,multiline:!1,clsx:h$.default.title,children:m}),u?(0,g.jsx)(a8.Text,{variant:"small",clsx:h$.default.title,color:"dimmest",multiline:!1,children:u}):null]}))}}),(0,g.jsx)(ct.IconButton,{alt:"Close tab",clsx:h$.default.closeButton,size:28,onClick:function(){return p(t)},children:(0,g.jsx)(ud.default,{size:12})})]})}var hJ=e.i(904851),hZ=e.i(90659),h0=e.i(790164),h1={newTabButtonWidth:28,defaultTabWidth:160,gap:4},h2=function(){function e(n){var t=this;(0,hJ._)(this,e),(0,E._)(this,"containerWidth",new h0.ObservableState(0)),(0,E._)(this,"isHovered",new h0.ObservableState(!1)),(0,E._)(this,"dragState",new h0.ObservableState(null)),(0,E._)(this,"dropState",new h0.ObservableState(null)),(0,E._)(this,"activeId",void 0),(0,E._)(this,"paneIds",void 0),(0,E._)(this,"state",new ev.Multicast(function(e){var n=null;return u8.Observable.combine(t.paneIds,t.containerWidth,t.isHovered,t.dragState,t.dropState).subscribe(function(t){var r=(0,U._)(t,5),i=r[0],a=r[1],o=r[2],s=r[3],l=r[4];if(l){var u,c,d=l.item.type===hL.DragItems.Pane?l.item:null,p=d?null==n||null==(c=n.tabs)?void 0:c.get(d.paneId):null;u={xOffset:l.pointer.x,width:p?p.width:h1.defaultTabWidth,id:d?d.paneId:void 0}}var f=function(e){var n,t,r=e.ids,i=e.gap,a=e.containerWidth,o=e.defaultTabWidth,s=e.newTabButtonWidth,l=e.matchWidths,u=e.dropArea,c=e.dragState,d=new Map;if(0===r.length||0===a)return{tabs:d};c?_="own-tab":(null==u?void 0:u.id)&&(_="external");var p=a-s-i,f=r.length;"external"===_&&(f+=1);var h=f-1,g=f*o+h*i<=p?o:(p-h*i)/f,m=l&&r.length<l.size,v=0,x=!0,y=!1,w=void 0;try{for(var b,_,j,S=r[Symbol.iterator]();!(x=(j=S.next()).done);x=!0){var I,C,k=j.value,E=m&&null!=(C=null==l||null==(I=l.get(k))?void 0:I.width)?C:g,T=v+E+i/2;u&&u.xOffset>=v&&u.xOffset<T&&(b={preview:{x:v,width:E},index:d.size},v+=E+i);var P=(null==c?void 0:c.id)===k;d.set(k,{x:v,width:P?0:E}),P||(v+=E+i)}}catch(e){y=!0,w=e}finally{try{x||null==S.return||S.return()}finally{if(y)throw w}}return u&&!b&&(b={preview:{x:v,width:m&&null!=(t=null==l||null==(n=l.get(r[r.length-1]))?void 0:n.width)?t:g},index:d.size}),{tabs:d,dropData:b}}((0,r$._)((0,v._)({containerWidth:a,ids:i,matchWidths:o&&n?n.tabs:void 0},h1),{dropArea:u,dragState:s||void 0}));(0,nc.default)(n,f)||(n=f,e.next(f))})})),(0,E._)(this,"dropIndex",new ev.Multicast(function(e){var n=null;return t.state.subscribe(function(t){var r,i,a=null!=(i=null==(r=t.dropData)?void 0:r.index)?i:null;a!==n&&(n=a,e.next(a))})})),(0,E._)(this,"setContainerWidth",function(e){t.containerWidth.set(e)}),(0,E._)(this,"tabs",new ev.Multicast(function(e){return t.state.select(function(e){return e?Array.from(e.tabs.keys()):[]}).subscribe(e)})),(0,E._)(this,"newTab",new ev.Multicast(function(e){var n=null;return t.state.subscribe(function(t){var r,i=Array.from(t.tabs.keys()).pop(),a=i?t.tabs.get(i):null;if(a){var o={x:a.x+a.width+4,width:28,visible:!t.dropData};t.dropData&&(null==(r=t.dropData)?void 0:r.index)>=t.tabs.size&&(o.x+=t.dropData.preview.width+4),(0,nc.default)(n,o)||(n=o,e.next(o))}})})),(0,E._)(this,"dropPreview",new ev.Multicast(function(e){var n=null;return t.state.subscribe(function(t){var r,i,a=null!=(i=null==(r=t.dropData)?void 0:r.preview)?i:null;(0,nc.default)(n,a)||(n=a,e.next(a))})})),(0,E._)(this,"width",new ev.Multicast(function(e){return t.containerWidth.subscribe(e)})),this.paneIds=n.paneIds,this.activeId=n.activeId}return(0,hZ._)(e,[{key:"tab",value:function(e){var n=this;return new ev.Multicast(function(t){var r=null;return u8.Observable.combine(n.state,n.activeId,n.dropState).subscribe(function(n){var i,a,o=(0,U._)(n,3),s=o[0],l=o[1],u=o[2],c=s.tabs.get(e);if(c){var d=(0,r$._)((0,v._)({},c),{active:l===e,isBeingDragged:(null==u||null==(i=u.item)?void 0:i.type)===hL.DragItems.Pane&&(null==u||null==(a=u.item)?void 0:a.paneId)===e});(0,nc.default)(r,d)||(r=d,t.next(d))}})})}}]),e}(),h4=e.i(13891),h8=(0,P.cvarsFrom)("index.module.css",["--new-tab-width","--new-tab-x","--drop-preview-width","--drop-preview-x","--drop-preview-opacity"]),h3=(0,N.memo)(function(e){var n,t,r,i,a,o,s,l,u,c,d,p,f,h,m,v,x,y,w,b,_,j=a_(e.headerId),S=(0,N.useMemo)(function(){return new h2({paneIds:u8.Observable.from(j.panes),activeId:u8.Observable.from(j.activeTabPaneId)})},[j.panes,j.activeTabPaneId]),I=(0,lL.useObservable)(S.tabs),C=(0,cq.default)(function(e){return S.setContainerWidth(e.width)},{type:"debounce",wait:100}),k=ra(tG),P=(null==I?void 0:I.length)===1,R=(0,uv.default)(j.activeTabPaneId),A=(t=(n={paneGroupId:e.headerId,activeTabPaneId:R}).paneGroupId,r=n.activeTabPaneId,a=(i=function(e){var n=e.paneGroupId,t=ra(r0),r=ra(r1),i=ra(r8),a=(0,J.default)(function(){return{start:function(e){t({paneGroupId:n,mouse:e.mouse})},update:function(e){r(e)},end:function(e){i(e)}}},[n,t,r,i]);return{isDragging:rr((0,J.default)(function(){return(0,eo.atom)(function(e){var t;return n===(null==(t=e(rX))?void 0:t.paneGroupId)})},[n])),dnd:a}}({paneGroupId:t})).isDragging,o=i.dnd,s=ab().toggleMaximizedPaneGroup,l=aS(t),u=(0,uv.default)(l.isMaximized),c=av(),{dnd:o,cursor:a?"grabbing":"grab",onPointerDown:function(e){c(r),!u&&"button"in e&&0===e.button&&(0,hS.measureMouseMove)(e,{start:o.start,move:o.update,end:o.end})},toggleMaximizedPaneGroup:s,isMaximized:u}),V=A.cursor,O=A.onPointerDown,F=A.toggleMaximizedPaneGroup,M=A.isMaximized,L=(0,N.useRef)(null),G=(d=e.headerId,p=(0,N.useRef)(null),f=(0,u1.useObservableRef)(S.dropIndex),h=ra(tG),m=ra(t$),v=a_(d),x=(0,uv.default)(v.panes),y=(0,N.useCallback)(function(e,n){var t=(null==n?void 0:n.index)!==null?null==n?void 0:n.index:x.length;if("nodes"===e.type){var r=(0,na.fsNodeToPanes)(e.nodes);r.length>0&&h({activate:!0,commit:!0,paneGroupId:d,index:t,panes:r});return}if(e.type===hL.DragItems.NewPane)return void h({activate:!0,paneGroupId:d,index:t,panes:[e.pane]});if("paneId"in e){var i=x.includes(e.paneId)?x.length-1:x.length;m({paneId:e.paneId,index:void 0!==t&&t<i?t:i,toPaneGroupId:d})}},[h,m,d,x]),b=(w=(0,U._)((0,hg.useDrop)({accept:[tN.FileType.File,hL.DragItems.Pane,hL.DragItems.NewPane],hover:function(e,n){var t=n.getClientOffset(),r=t&&p.current?{x:t.x-p.current.x,y:t.y-p.current.y}:{x:0,y:0};S.dropState.set({item:e,pointer:r})},collect:function(e){var n,t;return p.current=null!=(t=null==(n=L.current)?void 0:n.getBoundingClientRect())?t:null,{isOver:e.isOver()}},drop:function(e,n){var t,r=null!=(t=f.current)?t:null;S.dropState.set(null),n.didDrop()||y(e,null!==r?{index:r}:null)}}),2))[0].isOver,_=w[1],(0,N.useEffect)(function(){b||S.dropState.set(null)},[b,S]),{dropRef:_}).dropRef,B=(0,ou.useMergeRefs)([C,L,G]),W=(0,Y.default)(),z=(0,cK.useIsWindows)();return(0,g.jsxs)(D.View,{row:!0,grow:!0,shrink:!0,align:"start",clsx:h4.default.tabBar,children:[M?(0,g.jsx)(T.default,{}):null,(0,g.jsxs)(D.View,{grow:!0,shrink:!0,row:!0,clsx:h4.default.tabs,innerRef:B,onMouseEnter:function(){return S.isHovered.set(!0)},onMouseLeave:function(){return S.isHovered.set(!1)},onPointerDown:P&&!M?O:void 0,children:[(0,g.jsx)(h6,{paneGroupId:e.headerId,activeTabPaneId:R,isMaximized:M,toggleMaximizedPaneGroup:F,cursor:V,onPointerDown:P?void 0:O}),(0,g.jsx)(h9,{layout:S}),null==I?void 0:I.map(function(n){return(0,g.jsx)(hX,{paneGroupId:e.headerId,paneId:n,layout:S,isOnlyTab:P},n)}),(0,g.jsx)(h5,{layout:S,onClick:function(){return k({paneGroupId:e.headerId,activate:!0,panes:[{type:"commands",data:{autoFocus:!0}}]})}})]}),M?(0,g.jsx)(ct.IconButton,{clsx:(0,E._)({},h4.default.desktopAppWindowsOs,z&&W),size:28,alt:"Minimize",onClick:function(){return F({paneGroupId:e.headerId})},children:(0,g.jsx)(uI.default,{})}):null]})});function h6(e){var n=e.paneGroupId,t=e.activeTabPaneId,r=e.toggleMaximizedPaneGroup,i=e.isMaximized,a=e.cursor,o=e.onPointerDown,s=uk({paneId:t,paneGroupId:n}),l=(0,hq.useContextMenu)().onContextMenu;return(0,g.jsx)(D.View,{onContextMenu:function(e){return l(e,{command:s})},onDoubleClick:function(){r({paneGroupId:n})},title:i?"Double click to restore.":"Double click to maximize. Drag to move.",clsx:h4.default.dragArea,style:{cursor:i?void 0:a},onPointerDown:o})}function h5(e){var n,t=e.layout,r=(0,N.useRef)(null),i=rr(ak),a=(0,dA.useSetTourStepTarget)(dB,dN.NewTab);(0,nQ.useStyleSet)(r,t.newTab,function(e){var n;return n={},(0,E._)(n,h8.newTabWidth,e.width+"px"),(0,E._)(n,h8.newTabX,e.x+"px"),(0,E._)(n,"opacity",e.visible?"1":"0"),n});var o={isDragging:(n=(0,U._)((0,hz.useDrag)({type:hL.DragItems.NewPane,item:function(){return{type:hL.DragItems.NewPane,pane:{type:"commands",data:{autoFocus:!0}},width:80}},collect:function(e){return{isDragging:e.isDragging()}}}),2))[0].isDragging,dragRef:n[1]},s=o.dragRef,l=o.isDragging,u=(0,ou.useMergeRefs)([r,a,s]),c=(0,fN.useObservableMemo)(function(){return t.width.select(function(e){return e>320})},[t]),d="Tools & files";return(0,g.jsx)(D.View,{innerRef:u,clsx:h4.default.newTab,children:l?null:(0,g.jsx)(g.Fragment,{children:i&&c?(0,g.jsx)(a4.Button,{clsx:h4.default.newTabTextButton,onClick:e.onClick,variant:"nofill",iconLeft:(0,g.jsx)(sT.default,{}),text:d,style:{width:160}}):(0,g.jsx)(ct.IconButton,{clsx:h4.default.newTabIconButton,size:28,alt:d,onClick:e.onClick,children:(0,g.jsx)(sT.default,{})})})})}function h9(e){var n=e.layout,t=(0,N.useRef)(null);return(0,nQ.useStyleSet)(t,n.dropPreview,function(e){var n;return n={},(0,E._)(n,h8.dropPreviewWidth,(e?e.width:80)+"px"),(0,E._)(n,h8.dropPreviewX,(e?e.x:"50%")+"px"),(0,E._)(n,h8.dropPreviewOpacity,e?"1":"0"),n}),(0,g.jsx)(D.View,{innerRef:t,clsx:h4.default.dropPreview})}var h7=e.i(248611),ge=(0,P.cvarsFrom)("index.module.css",["--left","--top","--scale","--transform-origin-x","--width","--height","--z-index","--transform-x","--transform-y","--border-radius","--controls-opacity","--opacity","--padding-left","--padding-top"]);let gn=(0,N.memo)(function(e){var n,t=e.headerId,r=a_(t),i=(0,uv.default)(r.activeTabPaneId),a=aS(t),o=(0,uv.default)(a.isFloating),s=(0,uv.default)(a.isBeingDragged),l=(0,uv.default)(a.isModal),u=(0,uv.default)(a.isMaximized),c=(0,N.useRef)(null);(0,nQ.useStyleSet)(c,hx(a.properties,a.getTransitionEnabled),function(e){var n,t,r,i=e.width,a=e.height,o=e.x,s=e.y,l=e.scale,u=e.opacity,c=e.positioning;return(0,v._)((n={},(0,E._)(n,ge.width,i+"px"),(0,E._)(n,ge.height,a+"px"),(0,E._)(n,ge.scale,l.toString()),(0,E._)(n,ge.opacity,u.toString()),n),"transform"===c?(t={},(0,E._)(t,ge.transformX,Math.round(o)+"px"),(0,E._)(t,ge.transformY,Math.round(s)+"px"),(0,E._)(t,ge.top,"0px"),(0,E._)(t,ge.left,"0px"),t):(r={},(0,E._)(r,ge.transformX,"0px"),(0,E._)(r,ge.transformY,"0px"),(0,E._)(r,ge.top,Math.round(s)+"px"),(0,E._)(r,ge.left,Math.round(o)+"px"),r))}),(0,nQ.useStyleSet)(c,a.transformOriginX,function(e){return(0,E._)({},ge.transformOriginX,e)}),(0,nQ.useStyleSet)(c,a.zIndex,function(e){return{"z-index":e.toString()}});var d=ra(ah);return(0,nQ.useStyleSet)(c,ri((0,N.useMemo)(function(){return(0,eo.atom)(function(e){return e(ah)===i})},[i])),function(e){return(0,E._)({},ge.controlsOpacity,e?"1":"0")}),(0,g.jsxs)(A.Surface,{innerRef:c,clsx:h7.default.surface,row:!0,align:"center",style:(n={},(0,E._)(n,ge.borderRadius,"8px"),(0,E._)(n,ge.paddingTop,(!u&&o?6:0)+"px"),(0,E._)(n,ge.paddingLeft,(u||s||o?6:0)+"px"),n),onMouseEnter:function(){return d(i)},onMouseLeave:function(){return d(null)},children:[(0,g.jsx)(h3,{headerId:t}),o&&!l?(0,g.jsx)(hO,{paneId:i}):null]})});function gt(){var e=ax(),n=(0,N.useCallback)(function(n){return e({pane:n})},[e]),t=ro(nI),r=ra(th);return(0,N.useCallback)(function(e){var i=na.STACK_TO_OUTPUT_PANE_MAP[e];i&&(n({type:i}),t().forEach(function(e){var n=(0,U._)(e,2),t=n[0],a=n[1];"agentChat"!==a.type&&a.type!==i&&r(t)}))},[n,t,r])}var gr=e.i(391119),gi=e.i(700966),ga=e.i(716636),go=e.i(398014),gs={Content:function(e){var n,t=(0,U._)((0,N.useState)(null),2),r=t[0],i=t[1];(0,aR.useSetFocusTarget)(function(){return r},[r]),(0,aR.useSetPaneBindings)(function(){return{type:"agentChat",focusInput:function(){return null==r?void 0:r.focus()}}},[r]);var a=e.options.performPaneOperation,o=(0,N.useCallback)(function(e){return a({operation:"open",pane:e,secondary:"ghostwriterChat"!==e.type})},[a]),s=gt(),l=(0,N.useCallback)(function(e){a({operation:"openPip",data:e})},[a]),u=(0,gr.useCurrentSession)(null==(n=e.pane.data)?void 0:n.sessionId),c=u.session,d=u.setSession,p=(0,N.useCallback)(function(e){a({operation:"replace",pane:{type:"agentChat",data:{sessionId:e.id}}}),d(e)},[a,d]),f=rr(nN),h=ra(i4),m=rr(i8),v=(0,ot.default)(),x=v.secrets,y=v.fs;return(0,g.jsx)(gi.AgentMain,{secrets:x,readFile:y.readFile,session:c,setSession:p,inputRef:i,openPane:o,onPlanApproval:function(e){e&&s(e),h("sidebar")},isDesktopOrTabletAgentPresentationCentered:f,isDesktopLayoutAgentPresentationTransitionInProgress:m,openPip:l})},Icon:function(e){var n=e.size;return(0,g.jsx)(ce.AgentAvatar,{size:n})},getTitle:function(){return"Agent"},description:dM.AGENT_DESCRIPTION,category:ga.PaneCategory.WorkspaceFeatures,decode:function(e){return so.Value.Decode(go.AgentChatPaneSchema,e)}},gl=e.i(795564),gu={Content:function(e){var n=e.options,t=n.performPaneOperation,r=n.paneId,i=e.pane.data.autoFocus,a=ra(nl),o=(0,N.useRef)(null);(0,aR.useSetFocusTarget)(function(){return{focus:function(){var e;return null==(e=o.current)?void 0:e.call(o)}}},[]);var s=(0,N.useCallback)(function(e){t({operation:"replace",pane:e.pane}),a(r),(0,el.track)(eu.events.TOOL_OPENED,{source:"New Tab",tool:e.pane.type})},[t,r,a]),l=lH({currentPaneId:r,openPane:s});return(0,g.jsx)(D.View,{pt:16,grow:!0,shrink:!0,children:(0,g.jsx)(aH.CommandBar,{autoFocus:i,command:l,focusRef:o,showToolDescriptions:!0})})},Icon:function(){return null},getTitle:function(){return"New tab"},category:ga.PaneCategory.Other,decode:gl.decode},gc=e.i(827836),gd=e.i(818283),gp=e.i(999519),gf={Content:function(e){var n=e.options,t=n.paneId,r=n.performPaneOperation,i=e.pane.flow,a=aI(),o=(0,uv.default)(a.activeContent),s=(0,N.useCallback)(function(){"filetree"!==o&&a.toggleContent("filetree")},[a,o]);return(0,g.jsx)(gd.default,{flow:i,closeConfigPane:function(){return r({operation:"remove",pane:{id:t}})},useReadFile:gc.default,openSidebar:s,onNewPaneSelected:function(e){return r({operation:"open",pane:e})},openConsole:function(){return r({operation:"open",pane:{type:"runnerOutput"}})}})},Icon:function(){return(0,g.jsx)(lS.default,{})},getTitle:function(){return"Configure Repl"},category:ga.PaneCategory.WorkspaceFeatures,decode:gp.decode},gh=e.i(746382),gg=(0,ur.css)([i9.rcss.backgroundColor.backgroundDefault,i9.rcss.height("100%"),i9.rcss.borderRadius(4),{overflow:"hidden"}]),gm=(0,ur.css)([i9.rcss.width("100%"),i9.rcss.height("100%"),i9.rcss.justify.center,i9.rcss.align.center,i9.rcss.display.flex]);function gv(e){var n=e.paneId,t=e.extensionPaneData,r=e.environmentAPIs,i=(0,or.useExtensionByInstallationId)(t.installationId),a=(0,or.useExtensionStateAtom)(t.installationId),o=sS({extension:i,environmentAPIs:r,sandboxTitle:t.name,sandboxUrl:(0,oo.getAssetUrl)(t.baseUrl,t.path),paneId:n,filePath:t.filePath||null}),s=o.didConnectOnce,l=o.isValidExtensionPaneUrl,u=o.getIframeProps,c=o.reloadSandbox;return(0,aR.useSetPaneBindings)(function(){return{type:"extension",commands:[{name:"Actions",commands:[{match:aE.matchLabel,data:{icon:(0,g.jsx)(l4.default,{}),label:"Refresh",type:"action",description:"Refresh extension",key:"refresh",run:function(){c()}}}]}]}},[c]),(0,g.jsx)(D.View,{className:"extension-pane",css:gg,children:a&&s?(0,g.jsx)(g.Fragment,{children:l()?(0,g.jsx)("iframe",(0,v._)({},u({css:{width:"100%",height:"100%",border:"none"}}))):(0,g.jsx)(D.View,{p:12,children:(0,g.jsxs)(a8.Text,{children:["Invalid url:"," ",(0,g.jsx)(gh.InlineCode,{children:t.baseUrl+t.path}),". Please contact the extension author, or Replit support."]})})}):(0,g.jsx)(D.View,{css:gm,children:(0,g.jsx)(cF.default,{})})})}var gx=ey.Type.Object({extensionId:ey.Type.Unsafe(ey.Type.String()),installationId:ey.Type.Unsafe(ey.Type.String()),baseUrl:ey.Type.String(),path:ey.Type.String(),name:ey.Type.String(),filePath:ey.Type.Optional(ey.Type.Union([ey.Type.String(),ey.Type.Null(),ey.Type.Undefined()])),icon:ey.Type.Optional(ey.Type.Union([ey.Type.String(),ey.Type.Null(),ey.Type.Undefined()]))}),gy=ey.Type.Object({type:ey.Type.Literal("extension"),data:gx}),gw=e.i(211397),gb={Content:function(e){var n=e.pane,t=e.options,r=oe();return(0,g.jsx)(gv,{extensionPaneData:n.data,paneId:t.paneId,environmentAPIs:r})},Icon:function(e){var n=e.pane,t=e.size;return n.data.icon?(0,g.jsx)(D.View,{style:{width:t,height:t,position:"relative"},children:(0,g.jsx)(gw.default,{src:(0,oo.getAssetUrl)(n.data.baseUrl,n.data.icon),layout:"fill",alt:""})}):(0,g.jsx)(sP.default,{size:t})},getTitle:function(e){return e.data.filePath?e.data.filePath+"  "+e.data.name:e.data.name},category:ga.PaneCategory.WorkspaceExtensions,decode:function(e){return so.Value.Decode(gy,e)}},g_=e.i(144494),gj=e.i(915793),gS=e.i(328751),gI=e.i(198769),gC=e.i(904678);function gk(){var e=(0,x._)(["\n  query ExtensionOwnerDetails($extensionId: String!) {\n    extension(id: $extensionId) {\n      ... on Extension {\n        id\n        isListed\n        user {\n          id\n          username\n        }\n      }\n      ... on NotFoundError {\n        message\n      }\n    }\n  }\n"]);return gk=function(){return e},e}function gE(){var e=(0,x._)(["\n  query currentExtensionStatus($id: String!) {\n    extension(id: $id) {\n      ... on Extension {\n        id\n        isListed\n        user {\n          id\n        }\n      }\n    }\n  }\n"]);return gE=function(){return e},e}var gT={};(0,y.gql)(gk());var gP=(0,y.gql)(gE()),gR=e.i(888136),gA=e.i(619319),gD=e.i(428596),gV=e.i(607278),gO=e.i(363201),gF=(0,rl.cssRecord)({codeBlock:[i9.rcss.borderRadius(8),i9.rcss.position.relative],codeBlockCopyButton:[i9.rcss.position.absolute,i9.rcss.top(4),i9.rcss.right(4)],selectionContainer:[i9.rcss.maxHeight(400),i9.rcss.overflowY("scroll")],fsNode:[i9.rcss.flex.row,i9.rcss.rowWithGap(8),i9.rcss.align.center,i9.rcss.px(4),i9.rcss.py(2),i9.rcss.borderRadius(8),i9.rcss.cursor.pointer],fsNodeActive:[i9.rcss.backgroundColor.backgroundHigher]});function gM(e){var n=e.content,t=(0,a5.default)().showConfirm;return(0,g.jsxs)(A.Surface,{tag:"code",elevated:!0,css:gF.codeBlock,p:8,children:[n,(0,g.jsx)(ct.IconButton,{alt:"Copy",tooltipBehavior:"hidden",css:gF.codeBlockCopyButton,onClick:function(){return navigator.clipboard.writeText(n).then(function(){return t("Copied")})},children:(0,g.jsx)(lJ.default,{})})]})}function gL(e){var n,t=e.glob,r=e.openFile,i=e.children,a=(0,U._)((0,N.useState)([]),2),o=a[0],s=a[1],l=(0,U._)((0,N.useState)(""),2),u=l[0],c=l[1],d=(0,gD.useIdSeed)(),p=(0,ot.default)().fs,f=(0,sC.useStaticDirectoryPath)(),h=(0,N.useMemo)(function(){return(0,gA.globToRegExp)(t)},[t]);return((0,N.useEffect)(function(){h&&p.listFiles().then(function(e){e.files&&s(e.files.filter(function(e){return e.match(h)}).map(function(e){var n=e.split("/");return{path:e,dir:n.slice(0,n.length-1).join("/"),filename:n[n.length-1]||""}}))})},[h,f]),h)?(0,g.jsxs)(D.View,{css:gF.selectionContainer,gap:16,children:[(0,g.jsx)(a8.Text,{variant:"subheadDefault",children:(0,g.jsxs)(D.View,{gap:12,children:[(0,g.jsx)(a8.Text,{variant:"subheadDefault",children:"Choose an image"}),f?(0,g.jsx)(p6.StatusBanner,{icon:(0,g.jsx)(gO.default,{}),colorway:"primary",text:(0,g.jsxs)(D.View,{gap:2,children:[(0,g.jsxs)(a8.Text,{children:["Images must be served from"," ",(0,g.jsx)("span",{css:[i9.rcss.font.code,i9.rcss.backgroundColor.accentPrimaryDimmer,i9.rcss.borderRadius(4),i9.rcss.px(4),i9.rcss.py(2),i9.rcss.mr(2),i9.rcss.border({color:P.tokens.accentPrimaryDefault})],children:f.path}),"."]}),(0,g.jsx)(a8.Text,{css:[i9.rcss.fontWeight.normal],children:"You can change your extension's static directory in the .replit file."})]})}):null,(0,g.jsxs)(a8.Text,{css:[i9.rcss.fontWeight.normal],color:"dimmer",children:["Supported file types:"," ",(0,g.jsx)("span",{css:[i9.rcss.font.code,i9.rcss.fontSize("small"),i9.rcss.backgroundColor.backgroundHigher,i9.rcss.borderRadius(4),i9.rcss.px(4),i9.rcss.py(2),i9.rcss.mr(2),i9.rcss.border({color:P.tokens.outlineDefault})],children:null==(n=t.match(/\{(.*)\}/))?void 0:n[1].split(",").map(function(e){return e.replace(".","")}).join(", ")})]})]})}),i,(0,g.jsx)(gR.default,{onChange:function(e){return r(e.path)},initialHighlightedIndex:0,defaultHighlightedIndex:0,itemToString:function(e){return(null==e?void 0:e.path)||""},children:function(e){var n=e.getInputProps,r=e.getItemProps,i=e.highlightedIndex,a=e.getRootProps,s=e.getMenuProps;return(0,g.jsxs)(D.View,(0,r$._)((0,v._)({},a({refKey:"innerRef"})),{gap:16,children:[(0,g.jsx)(D.View,{css:[i9.rcss.position.relative],children:(0,g.jsx)(gV.Input,(0,v._)({id:d("file-search")},n({ref:null,value:u,onChange:function(e){return c(e.currentTarget.value)},placeholder:"Find a file",autoComplete:"off",autoFocus:!0})))}),(0,g.jsx)(D.View,{children:o&&o.length?(0,g.jsx)(D.View,(0,r$._)((0,v._)({elevated:!0,tag:"ul",css:(i9.rcss.pt(8),i9.rcss.colWithGap(8))},s({refKey:"innerRef"})),{children:o.filter(function(e){return e.path.includes(u)}).filter(function(e){return!f||e.path.startsWith(f.relativePath)||e.path.startsWith("public")}).map(function(e,n){return(0,g.jsxs)(D.View,(0,r$._)((0,v._)({tag:"li",css:[gF.fsNode,n===i&&gF.fsNodeActive]},r({item:e,index:n,disabled:!!f&&!e.path.startsWith(f.relativePath)})),{children:[(0,g.jsx)(lW.default,{path:e.path,size:16}),(0,g.jsx)(a8.Text,{children:e.filename}),(0,g.jsx)(a8.Text,{variant:"small",color:"dimmest",children:e.dir})]}),n)})})):(0,g.jsx)(D.View,{pt:8,children:(0,g.jsx)(a8.Text,{color:"dimmer",children:(0,g.jsxs)("em",{children:["No files found matching ",(0,g.jsx)("code",{children:t})]})})})})]}))}})]}):(0,g.jsxs)(D.View,{css:[i9.rcss.flex.column,i9.rcss.colWithGap(16)],children:[(0,g.jsx)(a8.Text,{variant:"subheadDefault",children:"Invalid Glob Pattern"}),(0,g.jsxs)(a8.Text,{children:["The glob pattern ",(0,g.jsx)("code",{children:t})," could not be parsed."]}),(0,g.jsx)(D.View,{css:i9.rcss.border({direction:"bottom",color:P.tokens.backgroundHigher})}),(0,g.jsxs)(D.View,{gap:8,children:[(0,g.jsx)(a8.Text,{children:(0,g.jsx)("strong",{children:"Match all Javascript Files"})}),(0,g.jsx)(gM,{content:"**/*.js"})]}),(0,g.jsxs)(D.View,{gap:8,children:[(0,g.jsx)(a8.Text,{children:(0,g.jsx)("strong",{children:"Match JSON files at root level"})}),(0,g.jsx)(gM,{content:"*.json"})]}),(0,g.jsxs)(D.View,{gap:8,children:[(0,g.jsx)(a8.Text,{children:(0,g.jsx)("strong",{children:"Match specified file extensions"})}),(0,g.jsx)(gM,{content:"**/*.{js,ts,jsx,tsx}"})]})]})}var gG=e.i(549762),gU=e.i(658975),gN=((a=gN||{}).Installing="Installing",a.Loading="Loading",a.Failed="Failed",a.Success="Success",a),gB={Installing:"Installing Extension...",Loading:"Loading Asset...",Failed:"Failed to load asset from Extension URL",Success:"Asset loaded successfully"};function gW(e){var n=e.isOpen,t=e.close,r=e.onSubmit,i=(0,oi.useInstallCurrentReplAsExtension)(),a=(0,oi.useCurrentReplExtension)(),o=(0,U._)((0,N.useState)(null),2),s=o[0],l=o[1],u=(0,U._)((0,N.useState)(!0),2),c=u[0],d=u[1],p=(0,U._)((0,N.useState)(null),2),f=p[0],h=p[1],m=(0,U._)((0,N.useState)(null),2),v=m[0],x=m[1],y=(0,N.useRef)(null),w=(0,U._)((0,N.useState)(null),2),b=w[0],_=w[1],j=(0,U._)((0,N.useState)(null),2),S=j[0],I=j[1],C=(v||S||"").startsWith("/")?v||S:"/"+(v||S),k=(0,U._)((0,N.useState)(null),2),E=k[0],T=k[1],P=function(){I(null),l(null),x(null),_(null),T(null),h(null)},R=function(){d(!0),l(null)};(0,N.useEffect)(function(){x(S)},[S]);var A=(0,N.useCallback)(function(e){return(0,ei._)(function(){var n,t,r,o;return(0,ea._)(this,function(u){switch(u.label){case 0:if(!C||!c||"Success"===s||"Failed"===s)return[2];if(n=function(e,n){return(0,ei._)(function(){var t;return(0,ea._)(this,function(r){switch(r.label){case 0:return l("Loading"),h(t=(0,oo.getAssetUrl)(e.baseUrl,n)),[4,fetch(t)];case 1:if(r.sent().ok)return T(n),l("Success"),d(!1),[2,!0];return[2,!1]}})})()},t=e||a)return[3,8];l("Installing"),u.label=1;case 1:return u.trys.push([1,5,,8]),[4,i()];case 2:if(!(r=u.sent()))return[3,4];return[4,A(r)];case 3:case 6:return u.sent(),[2];case 4:case 7:return[3,8];case 5:if(u.sent(),!a)return[3,7];return[4,A(a)];case 8:if(!t)return[3,11];return o=C.replace(/^(\/public|\/static)/,""),[4,n(t,o.slice(1))];case 9:if(u.sent())return[3,11];return[4,n(t,C)];case 10:u.sent(),u.label=11;case 11:return[2]}})})()},[a,C,i,s,c]);(0,N.useEffect)(function(){if(b){var e=b.split("/"),n=e.pop(),t=e.findIndex(function(e){return["public","static"].includes(e)});I((-1!==t?"/".concat(b):"/".concat(e.slice(t+1).join("/"),"/").concat(n))||b),d(!0),A()}},[A,b]);var V=b?b.split("/"):[],O=V[V.length-1];return(0,g.jsx)(az.Modal,{isOpen:n,onRequestClose:t,children:b?(0,g.jsxs)(D.View,{css:[i9.rcss.flex.column,i9.rcss.colWithGap(16)],children:[(0,g.jsxs)(D.View,{row:!0,gap:8,align:"center",children:[(0,g.jsx)(a4.Button,{text:"Back",size:"small",iconLeft:(0,g.jsx)(gG.default,{}),onClick:function(){_(null),P()}}),(0,g.jsxs)(D.View,{row:!0,gap:4,align:"center",children:[(0,g.jsx)(gU.default,{}),(0,g.jsx)(a8.Text,{color:"dimmer",children:O||""})]})]}),(0,g.jsx)(a8.Text,{multiline:!0,children:"Extension assets should be stored in the public asset directory. Move the image or modify the file path, or try again."}),(0,g.jsxs)(D.View,{gap:4,children:[(0,g.jsx)(gV.Input,{defaultValue:v||"",ref:y,placeholder:"/icon.png",onChange:function(e){return x(e.target.value)},autoFocus:!0,disabled:"Loading"===s||"Installing"===s||"Success"===s}),f&&("Loading"===s||"Success"===s||"Failed"===s)?(0,g.jsx)("a",{href:f,target:"_blank",children:(0,g.jsxs)(a8.Text,{color:"dimmer",variant:"small",css:[i9.rcss.rowWithGap(4),i9.rcss.display.flex,{fontStyle:"italic"}],children:[(0,g.jsxs)("span",{css:[i9.rcss.truncate],children:["Loading"===s?"Checking ":null,"Success"===s?"Found at ":null,"Failed"===s?"Failed to load ":null,f]}),(0,g.jsx)(D.View,{css:[i9.rcss.display.inlineBlock],children:(0,g.jsx)(lZ.default,{})})]})}):null]}),(0,g.jsxs)(D.View,{row:!0,justify:"space-between",align:"center",children:[(0,g.jsx)(D.View,{row:!0,gap:4,align:"center",children:s?(0,g.jsx)(g.Fragment,{children:"Loading"===s?(0,g.jsx)(cF.default,{}):(0,g.jsx)(p6.StatusBanner,{text:gB[s],colorway:"Failed"===s?"negative":"positive",icon:"Failed"===s?(0,g.jsx)(dm.default,{}):(0,g.jsx)(po.default,{})})}):null}),"Failed"===s?(0,g.jsxs)(D.View,{row:!0,gap:8,children:[(0,g.jsx)(a4.Button,{text:"Add Anyways",onClick:function(){var e=S||b;null!==e&&r(e),P(),t()},size:"small"}),(0,g.jsx)(a4.Button,{text:"Try Again",onClick:function(){R()},size:"small"})]}):null,E&&"Success"===s?(0,g.jsx)(a4.Button,{text:"Continue",iconLeft:(0,g.jsx)(po.default,{}),colorway:"primary",onClick:function(){r(E),P(),t()}}):null]})]}):(0,g.jsx)(gL,{openFile:_,glob:"**/*.{png,jpg,jpeg,webp,svg,gif}"})})}var gz=e.i(283023),gH=e.i(883002),gq=e.i(703505),gK=(0,rl.cssRecord)({centerRowGap8:[i9.rcss.rowWithGap(8),i9.rcss.align.center],featureContainer:[i9.rcss.flex.column,i9.rcss.borderRadius(8),{overflow:"hidden"}],noFeaturesPlaceholder:[i9.rcss.border({style:"dashed"}),i9.rcss.borderRadius(8),i9.rcss.p(16),i9.rcss.colWithGap(8),i9.rcss.center],featureDetails:[i9.rcss.flex.column,i9.rcss.colWithGap(4),i9.rcss.flex.growAndShrink(1)],newFeatureFieldWrapper:[i9.rcss.border({direction:"bottom",color:P.tokens.backgroundHighest})],inputCounterFlex:[i9.rcss.flex.row,i9.rcss.justify.spaceBetween,i9.rcss.align.center]});function g$(e){var n=e.features,t=e.onCreate,r=e.onUpdate,i=e.onDelete,a=(0,U._)((0,N.useState)([]),2),o=a[0],s=a[1],l=(0,U._)((0,N.useState)(!1),2),u=l[0],c=l[1];return(0,g.jsxs)(D.View,{children:[(0,g.jsxs)(D.View,{pb:12,children:[(0,g.jsxs)(D.View,{css:gK.centerRowGap8,children:[(0,g.jsxs)(D.View,{css:gK.centerRowGap8,children:[(0,g.jsx)(gH.default,{}),(0,g.jsx)(a8.Text,{variant:"subheadDefault",children:"Feature Descriptions"})]}),(0,g.jsx)(ct.IconButton,{onClick:function(){c(!u)},alt:"Add a new Feature",tooltipBehavior:u?"hidden":"default",disabled:u,children:(0,g.jsx)(sT.default,{})})]}),(0,g.jsx)(a8.Text,{color:"dimmer",variant:"small",multiline:!0,children:"Describe what your extension can do. Descriptions will appear on the store listing page."})]}),(0,g.jsxs)(D.View,{gap:8,children:[u?(0,g.jsx)(gY,{onSubmit:function(e){t(e),c(!1)},onCancel:function(){return c(!1)}}):null,(0,g.jsx)(D.View,{css:gK.featureContainer,children:n.length>0?n.map(function(e,t){return o.includes(t)?(0,g.jsx)(gY,{feature:e,isLast:t===n.length-1,onSubmit:function(e){r(e,t),s(function(e){return e.filter(function(e){return e!==t})})},onCancel:function(){return s(function(e){return e.filter(function(e){return e!==t})})}},t):(0,g.jsx)(gQ,{isLast:t===n.length-1,feature:e,onEdit:function(){return s(function(e){return(0,er._)(e).concat([t])})},onDelete:function(){i(t)}},t)}):(0,g.jsx)(g.Fragment,{children:u?null:(0,g.jsxs)(D.View,{css:gK.noFeaturesPlaceholder,children:[(0,g.jsx)(a8.Text,{color:"dimmest",multiline:!0,children:"You haven't added any features yet"}),(0,g.jsx)(a4.Button,{variant:"outlined",text:"New Feature",iconLeft:(0,g.jsx)(sT.default,{}),onClick:function(){return c(!0)}})]})})})]})]})}function gQ(e){var n=e.feature,t=e.onEdit,r=e.onDelete,i=e.isLast;return(0,g.jsxs)(A.Surface,{elevated:!0,css:[i9.rcss.flex.row,i9.rcss.rowWithGap(8),i9.rcss.align.center,i9.rcss.p(8),i?null:i9.rcss.border({direction:"bottom",color:P.tokens.backgroundHighest})],children:[(0,g.jsx)(gX,{size:64,icon:n.image}),(0,g.jsxs)(D.View,{css:gK.featureDetails,children:[(0,g.jsxs)(D.View,{row:!0,gap:8,align:"center",justify:"space-between",children:[(0,g.jsx)(a8.Text,{children:n.title}),(0,g.jsxs)(D.View,{row:!0,gap:8,children:[(0,g.jsx)(ct.IconButton,{alt:"Delete",tooltipBehavior:"hidden",onClick:r,children:(0,g.jsx)(gq.default,{color:P.tokens.accentNegativeStronger})}),(0,g.jsx)(ct.IconButton,{alt:"Edit",tooltipBehavior:"hidden",onClick:t,children:(0,g.jsx)(gz.default,{})})]})]}),(0,g.jsx)(a8.Text,{color:"dimmest",multiline:!0,maxLines:1,children:n.body})]})]})}function gY(e){var n=e.onSubmit,t=e.onCancel,r=e.feature,i=e.isLast,a=(0,U._)((0,N.useState)((null==r?void 0:r.title)||""),2),o=a[0],s=a[1],l=(0,U._)((0,N.useState)((null==r?void 0:r.body)||""),2),u=l[0],c=l[1],d=(0,U._)((0,N.useState)((null==r?void 0:r.image)||null),2),p=d[0],f=d[1],h=o.length>=3&&u.length>=16;return(0,g.jsxs)(A.Surface,{css:[i9.rcss.flex.column,i||r?null:i9.rcss.borderRadius(8),r?i9.rcss.border({color:P.tokens.outlineDefault}):[i?null:i9.rcss.border({direction:"bottom",color:P.tokens.backgroundHighest})]],elevated:!0,children:[(0,g.jsxs)(D.View,{css:gK.newFeatureFieldWrapper,p:8,row:!0,gap:8,align:"center",justify:"space-between",children:[(0,g.jsx)(a8.Text,{children:o||"New Feature"}),(0,g.jsxs)(D.View,{row:!0,gap:8,children:[(0,g.jsx)(a4.Button,{text:"Cancel",onClick:t}),(0,g.jsx)(a4.Button,{text:r?"Save":"Create",colorway:"primary",onClick:function(){return n({title:o,body:u,image:p})},disabled:!h})]})]}),(0,g.jsxs)(D.View,{p:8,gap:8,children:[(0,g.jsxs)(D.View,{gap:4,children:[(0,g.jsxs)(D.View,{css:gK.inputCounterFlex,children:[(0,g.jsx)(a8.Text,{color:"dimmer",children:"Title"}),(0,g.jsx)(gJ,{value:o.length,min:3})]}),(0,g.jsx)(gV.Input,{value:o,onChange:function(e){return s(e.target.value)},placeholder:"Seamless Editing",maxLength:60})]}),(0,g.jsxs)(D.View,{gap:4,children:[(0,g.jsxs)(D.View,{css:gK.inputCounterFlex,children:[(0,g.jsx)(a8.Text,{color:"dimmer",children:"Body"}),(0,g.jsx)(gJ,{value:u.length,min:16})]}),(0,g.jsx)(gV.MultiLineInput,{value:u,onChange:function(e){return c(e.target.value)},placeholder:"Describe what this feature does and how to use it (Markdown supported)",autoSize:!0,maxLength:2e3})]}),(0,g.jsxs)(D.View,{row:!0,gap:8,children:[(0,g.jsxs)(D.View,{gap:4,grow:!0,shrink:!0,children:[(0,g.jsx)(a8.Text,{color:"dimmer",children:"Image (Recommended)"}),(0,g.jsx)(a8.Text,{color:"dimmest",multiline:!0,children:"Choose a statically-served image from your App. The Recommended aspect ratio for a cover image is 800x600."})]}),(0,g.jsx)(gX,{size:100,icon:p,editable:!0,onSubmit:function(e){f(e)}})]})]})]})}function gX(e){var n=e.size,t=e.icon,r=e.editable,i=void 0!==r&&r,a=e.onSubmit,o=(0,ot.default)().container,s=(0,on.default)(o).url,l=s&&t?(0,oo.getAssetUrl)(s,t):null,u=(0,U._)((0,N.useState)(!1),2),c=u[0],d=u[1];return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(A.Surface,{background:"default",css:[i?dn.interactive.filledAndOutlined:null,i9.rcss.flex.row,i9.rcss.center,i9.rcss.width(n),i9.rcss.height(.75*n),i9.rcss.maxWidth(n),i9.rcss.maxHeight(.75*n),i9.rcss.borderRadius(4),i9.rcss.border({color:P.tokens.backgroundHighest}),i9.rcss.flex.grow(1),{background:l?"".concat(P.tokens.backgroundDefault," url(").concat(l,") no-repeat center center / cover"):P.tokens.backgroundDefault}],onClick:function(){return d(!0)},children:l?null:(0,g.jsx)(gU.default,{color:P.tokens.foregroundDimmest,size:24})}),i?(0,g.jsx)(gW,{isOpen:c,close:function(){return d(!1)},onSubmit:function(e){null==a||a(e)}}):null]})}function gJ(e){var n=e.value,t=e.min;return(0,g.jsxs)(a8.Text,{css:{color:n>=t?P.tokens.accentPositiveStronger:P.tokens.foregroundDimmest},children:[n,"/",t]})}var gZ=e.i(316953),g0="Failed to read manifest file, please try again",g1="No extension.json found",g2=function(){var e=(0,U._)((0,N.useState)(null),2),n=e[0],t=e[1],r=(0,N.useCallback)(function(e){t(function(n){if(!n)throw Error("State should be defined");return(0,r$._)((0,v._)({},n),{manifestStr:e})})},[]);return{state:n,setState:t,updateString:r}},g4=function(){var e=(0,ot.default)(),n=e.fs,t=e.dotReplit,r=g2(),i=r.state,a=r.setState,o=r.updateString,s=(0,U._)((0,N.useState)(0),2),l=s[0],u=s[1],c=(0,U._)((0,N.useState)(!1),2),d=c[0],p=c[1],f=(0,N.useCallback)(function(){return(0,ei._)(function(){return(0,ea._)(this,function(e){switch(e.label){case 0:return[4,(0,ei._)(function(){return(0,ea._)(this,function(e){switch(e.label){case 0:return[4,n.writeFile("extension.json",JSON.stringify({name:"My Extension",description:"My Extension Description",version:"0"},null,2))];case 1:return e.sent(),[2]}})})()];case 1:return e.sent(),[2]}})})()},[n]);(0,N.useEffect)(function(){a(null);var e=!1,r=function(){};return(0,ei._)(function(){var i,s,l,u,c,d,p;return(0,ea._)(this,function(f){switch(f.label){case 0:return[4,Promise.all([n.listFiles(),t.getConfig()])];case 1:var h,g,m,v;if(l=(s=U._.apply(void 0,[f.sent(),2]))[0],u=s[1],e)return[2];if(!l.files||u.error)return a({fileReadError:g0}),[2];if(d=(0,sm.asDir)((g="/"===(h=null!=(c=null==(i=u.config.extension)?void 0:i.outputDirectory)?c:"dist").charAt(0),m="/"===h.slice(-1),(v=(function(e,n){for(var t=0,r=e.length-1;r>=0;r--){var i=e[r];"."===i?e.splice(r,1):".."===i?(e.splice(r,1),t++):t&&(e.splice(r,1),t--)}if(n)for(;t--;)e.unshift("..");return e})(h.split("/").filter(function(e){return!!e}),!g).join("/"))||g||(v="."),v&&m&&(v+="/"),(g?"/":"")+v)),!(p=function(e){var n,t=e.filePaths,r=e.outputDir,i=[],a=!0,o=!1,s=void 0;try{for(var l,u=t[Symbol.iterator]();!(a=(l=u.next()).done);a=!0){var c=l.value;if("extension.json"===c)return c;c.endsWith("/extension.json")&&i.push(c)}}catch(e){o=!0,s=e}finally{try{a||null==u.return||u.return()}finally{if(o)throw s}}var d=!0,p=!1,f=void 0;try{for(var h,g=i[Symbol.iterator]();!(d=(h=g.next()).done);d=!0){var m=h.value;if(!m.startsWith(r))return m}}catch(e){p=!0,f=e}finally{try{d||null==g.return||g.return()}finally{if(p)throw f}}return null!=(n=i[0])?n:null}({filePaths:l.files,outputDir:d})))return a({fileReadError:g1}),[2];return r=n.watchTextFile(p,{onReady:function(e){a({fileReadError:null,writeChange:e.writeChange,manifestStr:e.initialContent,manifestPath:p})},onChange:function(e){o(e.latestContent)},onMoveOrDelete:function(){a({fileReadError:"extension.json was moved or deleted, please re-create it in your static directory"})},onError:function(){a({fileReadError:g0})}}),[2]}})})(),function(){r(),e=!0}},[n,o,t,l,a]);var h=(0,N.useMemo)(function(){if(!i||null!==i.fileReadError)return null;try{var e=gj.evaluate(i.manifestStr);return(0,gZ.parseManifestOrError)(e)}catch(e){return{error:e,manifest:null}}},[i]),g=(0,N.useCallback)(function(e){if(!i||(null==h?void 0:h.error)||null!==i.fileReadError)throw Error("Failed to parse manifest file");var n=gj.patch(i.manifestStr,e);i.writeChange((0,gS.changeSetFromDiff)(i.manifestStr,n)),o(n)},[i,h,o]),m={retry:function(){u(function(e){return e+1})},creatingExtensionJson:d,setCreatingExtensionJson:p,createExtensionJson:f,updateString:o,updateManifest:g};return i?"string"==typeof i.fileReadError?(0,r$._)((0,v._)({},m),{__status:"fileReadError",state:{fileReadError:i.fileReadError},parsed:null}):h?h.manifest?(0,r$._)((0,v._)({},m),{__status:"success",state:{fileReadError:null,writeChange:i.writeChange,manifestStr:i.manifestStr,manifestPath:i.manifestPath},parsed:h}):(0,r$._)((0,v._)({},m),{__status:"fileParseError",state:i,parsed:{manifest:null,error:h.error}}):(0,r$._)((0,v._)({},m),{__status:"fileReadError",state:{fileReadError:g1},parsed:null}):(0,r$._)((0,v._)({},m),{__status:"loading",state:null,parsed:null})},g8=((o={}).loading="loading",o.fileReadError="fileReadError",o.fileParseError="fileParseError",o.success="success",o),g3=function(){return(0,g.jsx)(D.View,{css:[i9.rcss.display.flex,i9.rcss.width("100%"),i9.rcss.height("100%")],justify:"center",align:"center",children:(0,g.jsx)(cF.default,{})})},g6=e.i(837399);function g5(e){var n=e.children;return(0,g.jsx)(D.View,{gap:12,p:16,children:(0,g.jsx)(A.Surface,{elevated:!0,css:[i9.rcss.borderRadius(8),i9.rcss.colWithGap(8)],p:16,children:n})})}var g9=e.i(959406),g7=e.i(442060),me=function(e){var n=e.error,t=e.performPaneOperation,r=e.manifestPath;return(0,g.jsx)(g5,{children:(0,g.jsxs)(D.View,{gap:16,p:8,children:[(0,g.jsxs)(D.View,{row:!0,gap:8,css:[i9.rcss.display.flex,i9.rcss.align.center],children:[(0,g.jsx)(dm.default,{}),(0,g.jsx)(a8.Text,{variant:"headerDefault",children:"Error parsing extension.json"})]}),(0,g.jsx)(a8.Text,{variant:"subheadDefault",children:"Details:"}),(0,g.jsx)(D.View,{gap:8,children:(0,op._)(n,g6.TypeboxError)?n.issues.map(function(e,n){var t=e.path,r=e.message;return(0,g.jsxs)(D.View,{css:[i9.rcss.display.flex,i9.rcss.flex.row,i9.rcss.rowWithGap(4)],children:[(0,g.jsx)(a8.Text,{css:[i9.rcss.font.code,i9.rcss.color.orangeStrongest,i9.rcss.backgroundColor.orangeDimmest],children:t}),(0,g.jsx)(a8.Text,{children:r})]},n)}):(0,g.jsx)(D.View,{tag:"pre",children:n.message})}),(0,g.jsxs)(D.View,{row:!0,gap:8,children:[(0,g.jsx)(a4.Button,{colorway:"primary",text:"Open extension.json",onClick:function(){t({operation:"open",secondary:!0,pane:(0,g9.getPaneForFile)(r)})}}),(0,g.jsx)(a4.Button,{iconLeft:(0,g.jsx)(g7.default,{}),text:"Read extension.json docs",onClick:function(){window.open("https://docs.replit.com/extensions/api/manifest","_blank")}})]})]})})},mn=function(e){var n=e.message,t=g4(),r=t.createExtensionJson,i=t.creatingExtensionJson,a=t.retry,o=t.setCreatingExtensionJson;return(0,g.jsxs)(g5,{children:[(0,g.jsxs)(D.View,{row:!0,gap:8,css:[i9.rcss.display.flex,i9.rcss.align.center],children:[(0,g.jsx)(dm.default,{}),(0,g.jsx)(a8.Text,{variant:"subheadDefault",children:n})]}),(0,g.jsxs)(D.View,{row:!0,gap:8,children:[(0,g.jsx)(a4.Button,{colorway:"primary",text:"Create extension.json",loading:i,iconLeft:i?(0,g.jsx)(cF.default,{}):(0,g.jsx)(sT.default,{}),onClick:function(){return(0,ei._)(function(){return(0,ea._)(this,function(e){switch(e.label){case 0:return o(!0),[4,r()];case 1:return e.sent(),a(),o(!1),[2]}})})()}}),(0,g.jsx)(a4.Button,{text:"Retry",iconLeft:(0,g.jsx)(l4.default,{}),onClick:function(){a()}})]})]})},mt=e.i(734882),mr=e.i(818660),mi=e.i(964269),ma=e.i(757390),mo=e.i(641536),ms=e.i(783437),ml=e.i(545124),mu=(0,rl.cssRecord)({iconContainer:[i9.rcss.position.relative,i9.rcss.width(64),i9.rcss.height(64),{"&:hover .edit-overlay":{opacity:1}}],iconWrapper:[i9.rcss.flex.column,i9.rcss.position.absolute,i9.rcss.top(0),i9.rcss.left(0)],iconOverlay:[i9.rcss.flex.column,i9.rcss.colWithGap(4),i9.rcss.center,i9.rcss.position.absolute,i9.rcss.top(0),i9.rcss.left(0),i9.rcss.width("100%"),i9.rcss.height("100%"),i9.rcss.backgroundColor.backgroundOverlay,i9.rcss.borderRadius(12),{transition:"0.25s",opacity:0,cursor:"pointer"}]});function mc(e){var n=e.performPaneOperation,t=e.setSelectedTab,r=(0,oi.useCurrentReplExtension)(),i=(0,oi.useInstallCurrentReplAsExtension)(),a=(0,oi.useReloadExtension)(),o=(0,oi.useUnloadExtension)(),s=(0,sC.useReplExtensionId)(),l=(0,U._)((0,N.useState)(!1),2),u=l[0],c=l[1],d=(0,U._)((0,N.useState)(!1),2),p=d[0],f=d[1];return(0,g.jsx)(D.View,{css:[i9.rcss.flex.wrap,{rowGap:8}],row:!0,gap:8,children:(0,g.jsxs)(D.View,{row:!0,gap:8,children:[r||p?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(a4.Button,{size:"small",text:"Reload",iconLeft:p?(0,g.jsx)(cF.default,{}):(0,g.jsx)(l4.default,{}),disabled:p,onClick:function(){return(0,ei._)(function(){return(0,ea._)(this,function(e){switch(e.label){case 0:if(!r)return[2];return f(!0),[4,a(r.installationId)];case 1:return e.sent(),f(!1),[2]}})})()}}),(0,g.jsx)(a4.Button,{size:"small",text:"Unload",iconLeft:(0,g.jsx)(ms.default,{}),disabled:!r,onClick:function(){r&&o(r.installationId)}})]}):(0,g.jsx)(a4.Button,{size:"small",text:"Load locally",colorway:"primary",iconLeft:u?(0,g.jsx)(cF.default,{}):(0,g.jsx)(ma.default,{}),loading:u,onClick:function(){return(0,ei._)(function(){return(0,ea._)(this,function(e){switch(e.label){case 0:return c(!0),[4,i()];case 1:return e.sent(),c(!1),[2]}})})()}}),s?(0,g.jsx)(a4.Button,{size:"small",text:"View on Store",iconLeft:(0,g.jsx)(ml.default,{}),onClick:function(){return n({operation:"open",pane:{type:"extensionStore",data:{page:"cover",coverPageExtensionId:s}}})}}):null,(0,g.jsx)(a4.Button,{size:"small",text:"Edit Store Listing",onClick:function(){t("releases")},iconLeft:(0,g.jsx)(gz.default,{})})]})})}function md(e){var n=e.performPaneOperation,t=e.setSelectedTab,r=(0,ot.default)().container,i=(0,on.default)(r).url,a=g4(),o=a.parsed,s=a.state,l=a.__status;if(l===g8.loading)return(0,g.jsx)(g3,{});if(l===g8.fileReadError)return(0,g.jsx)(mn,{message:s.fileReadError});var u=o.manifest,c=o.error;return c?(0,g.jsx)(me,{performPaneOperation:n,manifestPath:s.manifestPath,error:c}):(0,g.jsx)(D.View,{gap:16,css:[i9.rcss.width("100%")],children:(0,g.jsxs)(A.Surface,{elevated:!0,css:[i9.rcss.borderRadius(8),i9.rcss.colWithGap(8)],p:12,children:[(0,g.jsxs)(D.View,{row:!0,gap:16,align:"center",children:[(0,g.jsx)(D.View,{css:[i9.rcss.display.flex,i9.rcss.flex.row],grow:0,children:(0,g.jsx)(mr.ExtensionIcon,{size:64,baseUrl:null!=i?i:null,icon:u.icon})}),(0,g.jsxs)(D.View,{grow:!0,shrink:!0,children:[(0,g.jsx)(mi.HStack,{align:"center",justify:"space-between",children:(0,g.jsx)(a8.Text,{variant:"subheadDefault",children:u.name})}),(0,g.jsx)(a8.Text,{variant:"text",color:"dimmest",children:u.description})]})]}),(0,g.jsx)(mc,{setSelectedTab:t,performPaneOperation:n})]})})}function mp(e){var n,t,r,i,a,o,s,l,u,c,d=e.manifest,p=e.onSubmit,f=e.updateManifest,h=(0,sC.useReplExtensionId)(),m=(0,a1.useCurrentUserId)(),x=(0,gD.useIdSeed)(),y=(0,U._)((0,N.useState)(null!=(s=d.name)?s:""),2),b=y[0],_=y[1],j=(0,U._)((0,N.useState)(null!=(l=d.description)?l:""),2),S=j[0],I=j[1],C=(0,U._)((0,N.useState)(null!=(u=d.longDescription)?u:void 0),2),k=C[0],E=C[1],T=(0,U._)((0,N.useState)(!1),2),P=T[0],R=T[1],A=(0,ot.default)().container,V=(0,on.default)(A).url,O=(n={variables:{id:h||""},skip:!h},t=(0,v._)({},gT,n),w.useQuery(gP,t)),F=O.data,M=O.loading,L=O.refetch,G=(0,U._)((0,gC.useSetExtensionListedMutation)(),2),B=G[0],W=G[1].loading,z=(null==F||null==(r=F.extension)?void 0:r.__typename)==="Extension"&&(null==F||null==(i=F.extension)?void 0:i.user.id)===m,H=(null==F||null==(a=F.extension)?void 0:a.__typename)==="Extension"&&(null==F||null==(o=F.extension)?void 0:o.isListed);return(0,g.jsxs)(D.View,{tag:"form",gap:16,onSubmit:function(e){e.preventDefault(),p({name:b,description:S,longDescription:k})},children:[(0,g.jsxs)(D.View,{grow:!0,shrink:!0,gap:4,children:[(0,g.jsx)(a8.Text,{css:[i9.rcss.fontWeight.medium],children:"Do you want to publish your extension on the store?"}),M||W?(0,g.jsx)(cF.default,{}):(0,g.jsxs)(mt.RadioGroup,{css:i9.rcss.colWithGap(8),name:"extensionListingStatus",value:H?"listed":"unlisted",disabled:!z,onChange:function(e){B({variables:{extensionId:h||"",isListed:"listed"===e.target.value}}).then(function(){return L()})},children:[z?null:(0,g.jsx)(D.View,{css:[i9.rcss.width("fit-content")],children:(0,g.jsx)(p6.StatusBanner,{text:"You need to release this extension before listing it.",icon:(0,g.jsx)(gO.default,{}),colorway:"yellow"})}),(0,g.jsxs)(D.View,{row:!0,gap:8,children:[(0,g.jsx)(mt.Radio,{id:x("listed"),value:"listed"}),(0,g.jsx)("label",{htmlFor:x("listed"),children:"Yes, list my extension publicly on the Store"})]},"listed"),(0,g.jsxs)(D.View,{row:!0,gap:8,children:[(0,g.jsx)(mt.Radio,{id:x("unlisted"),value:"unlisted"}),(0,g.jsx)("label",{htmlFor:x("unlisted"),children:"No, I want to keep my listing page private"})]},"unlisted")]})]}),(0,g.jsx)(d9.DividerH,{}),(0,g.jsxs)(D.View,{grow:!0,shrink:!0,gap:4,tag:"label",htmlFor:x("name"),children:[(0,g.jsx)(a8.Text,{children:"Extension Name"}),(0,g.jsx)(gV.Input,{id:x("name"),placeholder:"Give your extension a name",value:b,onChange:function(e){_(e.currentTarget.value)},required:!0})]}),(0,g.jsxs)(D.View,{grow:!0,shrink:!0,gap:4,children:[(0,g.jsx)(a8.Text,{children:"Extension Icon"}),(0,g.jsxs)(D.View,{row:!0,gap:12,align:"center",children:[(0,g.jsxs)(D.View,{css:mu.iconContainer,children:[(0,g.jsx)(D.View,{css:mu.iconWrapper,children:(0,g.jsx)(mr.ExtensionIcon,{size:64,baseUrl:null!=V?V:null,icon:d.icon})}),(0,g.jsxs)(D.View,{css:mu.iconOverlay,className:"edit-overlay",tag:"label",onClick:function(){return R(!0)},children:[(0,g.jsx)(gz.default,{}),(0,g.jsx)(a8.Text,{variant:"small",children:"Edit"})]})]}),(0,g.jsx)(a4.Button,{text:"Choose from file system",iconLeft:(0,g.jsx)(mo.default,{}),onClick:function(){return R(!0)}})]})]}),(0,g.jsxs)(D.View,{grow:!0,shrink:!0,gap:4,tag:"label",htmlFor:x("tagline"),children:[(0,g.jsxs)(D.View,{gap:0,children:[(0,g.jsx)(a8.Text,{children:"Tagline"}),(0,g.jsx)(a8.Text,{color:"dimmer",variant:"small",multiline:!0,children:"Provide a short description of what your Extension is for."})]}),(0,g.jsx)(gV.Input,{id:x("tagline"),placeholder:"Give your extension a short tagline",value:S,onChange:function(e){I(e.currentTarget.value)},required:!0})]}),(0,g.jsxs)(D.View,{grow:!0,shrink:!0,gap:4,tag:"label",htmlFor:x("longDescription"),children:[(0,g.jsxs)(D.View,{gap:0,children:[(0,g.jsx)(a8.Text,{children:"Description"}),(0,g.jsx)(a8.Text,{color:"dimmer",variant:"small",multiline:!0,children:"Add more detail about the usage of your extension."})]}),(0,g.jsx)(gV.MultiLineInput,{id:x("longDescription"),placeholder:"Give your extension a long description, markdown formatting is supported",value:null!=k?k:"",onChange:function(e){E(e.currentTarget.value||void 0)},css:{resize:"vertical"},autoSize:!0})]}),(0,g.jsx)(d9.DividerH,{}),(0,g.jsx)(g$,{features:null!=(c=d.features)?c:[],onDelete:function(e){if((null==(n=d.features)?void 0:n.length)===1&&0===e){var n,t,r=(0,v._)({},d);delete r.features,f(r)}else f((0,r$._)((0,v._)({},d),{features:null==(t=d.features)?void 0:t.filter(function(n,t){return t!==e})}))},onUpdate:function(e,n){var t,r,i,a;f((0,r$._)((0,v._)({},d),{features:(0,er._)(null!=(i=null==(t=d.features)?void 0:t.slice(0,n))?i:[]).concat([e],(0,er._)(null!=(a=null==(r=d.features)?void 0:r.slice(n+1))?a:[]))}))},onCreate:function(e){var n;f((0,r$._)((0,v._)({},d),{features:(0,er._)(null!=(n=d.features)?n:[]).concat([e])}))}}),(0,g.jsx)(D.View,{row:!0,gap:12,css:[{alignSelf:"end"},i9.rcss.pt(8)],children:(0,g.jsx)(a4.Button,{text:"Continue",iconRight:(0,g.jsx)(l_.default,{}),colorway:"primary",type:"submit",disabled:!b||!S||!k})}),(0,g.jsx)(gW,{isOpen:P,close:function(){return R(!1)},onSubmit:function(e){f((0,r$._)((0,v._)({},d),{icon:e}))}})]})}function mf(e){var n=e.fileHandlers,t=e.onCreate,r=e.onUpdate,i=e.onOpen,a=e.onDelete,o=(0,U._)((0,N.useState)([]),2),s=o[0],l=o[1],u=(0,U._)((0,N.useState)(!1),2),c=u[0],d=u[1];return(0,g.jsxs)(D.View,{children:[(0,g.jsxs)(D.View,{pb:12,children:[(0,g.jsxs)(D.View,{row:!0,gap:8,align:"center",children:[(0,g.jsxs)(D.View,{row:!0,gap:8,align:"center",children:[(0,g.jsx)(sV.default,{}),(0,g.jsx)(a8.Text,{variant:"subheadDefault",multiline:!1,children:"File Handlers"})]}),(0,g.jsx)(ct.IconButton,{onClick:function(){return d(!c)},alt:"Add a new File Handler",tooltipBehavior:c?"hidden":"default",disabled:c,children:(0,g.jsx)(sT.default,{})})]}),(0,g.jsx)(a8.Text,{color:"dimmer",variant:"small",multiline:!1,children:"Custom file viewers and editors"})]}),(0,g.jsxs)(D.View,{gap:8,children:[c?(0,g.jsx)(mh,{onSubmit:function(e){t(e),d(!1)},onCancel:function(){d(!1)}}):null,n.length?n.map(function(e,n){var t;return s.includes(n)?(0,g.jsx)(mh,{initialFileHandler:e,onSubmit:function(e){r(e,n),l(function(e){return e.filter(function(e){return e!==n})})},onCancel:function(){l(function(e){return e.filter(function(e){return e!==n})})}},n):(0,g.jsxs)(A.Surface,{css:[i9.rcss.borderRadius(8),i9.rcss.flex.wrap,{rowGap:8}],p:8,row:!0,justify:"space-between",align:"center",elevated:!0,children:[(0,g.jsx)(a8.Text,{multiline:!1,children:null!=(t=e.name)?t:"Unnamed"}),(0,g.jsxs)(D.View,{row:!0,gap:12,align:"center",children:[(0,g.jsx)(ct.IconButton,{alt:"Remove ".concat(e.name||"this file handler"),colorway:"red",onClick:function(){a(n)},children:(0,g.jsx)(gq.default,{})}),(0,g.jsx)(ct.IconButton,{alt:"Edit ".concat(e.name||"this file handler"),onClick:function(){l(function(e){return(0,er._)(e).concat([n])})},children:(0,g.jsx)(gz.default,{})}),(0,g.jsx)(a4.Button,{iconLeft:(0,g.jsx)(mo.default,{}),variant:"outlined",text:"Preview",onClick:function(){i(e)}})]})]},n)}):(0,g.jsx)(g.Fragment,{children:c?null:(0,g.jsxs)(D.View,{css:[i9.rcss.border({style:"dashed"}),i9.rcss.borderRadius(8),i9.rcss.p(16),i9.rcss.colWithGap(8),i9.rcss.center],children:[(0,g.jsx)(a8.Text,{color:"dimmest",children:"You haven't added a file handler yet"}),(0,g.jsx)(a4.Button,{variant:"outlined",text:"New File Handler",iconLeft:(0,g.jsx)(sT.default,{}),onClick:function(){return d(!0)}})]})})]})]})}function mh(e){var n,t,r,i,a=e.onSubmit,o=e.onCancel,s=e.initialFileHandler,l=(0,U._)((0,N.useState)(null!=(n=null==s?void 0:s.name)?n:""),2),u=l[0],c=l[1],d=(0,U._)((0,N.useState)(null!=(t=null==s?void 0:s.icon)?t:""),2),p=d[0],f=d[1],h=(0,U._)((0,N.useState)(null!=(r=null==s?void 0:s.handler)?r:""),2),m=h[0],v=h[1],x=(0,U._)((0,N.useState)(null!=(i=null==s?void 0:s.glob)?i:""),2),y=x[0],w=x[1],b=(0,gD.useIdSeed)();return(0,g.jsxs)(A.Surface,{css:[i9.rcss.borderRadius(8),i9.rcss.border({color:P.tokens.outlineDimmest}),i9.rcss.p(8),i9.rcss.colWithGap(8)],tag:"form",onSubmit:function(e){e.preventDefault(),a({name:u,icon:p,handler:m,glob:y})},elevated:!0,children:[(0,g.jsxs)(D.View,{css:[i9.rcss.border({color:P.tokens.outlineDimmest,direction:"bottom"}),i9.rcss.align.center,i9.rcss.flex.wrap,{rowGap:8}],row:!0,gap:2,justify:"space-between",children:[(0,g.jsx)(a8.Text,{multiline:!1,children:u||"New File Viewer"}),(0,g.jsxs)(D.View,{row:!0,gap:8,children:[(0,g.jsx)(a4.Button,{text:"Cancel",onClick:function(){o()}}),(0,g.jsx)(a4.Button,{colorway:"primary",iconLeft:(0,g.jsx)(po.default,{}),text:"Save Changes",type:"submit"})]})]}),(0,g.jsxs)(D.View,{gap:8,children:[(0,g.jsxs)(D.View,{grow:!0,shrink:!0,gap:2,tag:"label",htmlFor:b("name"),children:[(0,g.jsx)(a8.Text,{color:"dimmer",multiline:!1,children:"Name"}),(0,g.jsx)(gV.Input,{id:b("name"),placeholder:"SVG Editor",value:u,onChange:function(e){c(e.currentTarget.value)},required:!0})]}),(0,g.jsxs)(D.View,{grow:!0,shrink:!0,gap:2,tag:"label",htmlFor:b("handler"),children:[(0,g.jsx)(a8.Text,{color:"dimmer",multiline:!1,children:"URL Path"}),(0,g.jsx)(gV.Input,{id:b("handler"),placeholder:"/svg-editor",value:m,onChange:function(e){v(e.currentTarget.value)},required:!0})]}),(0,g.jsxs)(D.View,{grow:!0,shrink:!0,gap:2,tag:"label",htmlFor:b("glob"),children:[(0,g.jsx)(a8.Text,{color:"dimmer",multiline:!1,children:"Glob Pattern"}),(0,g.jsx)(gV.Input,{id:b("glob"),placeholder:"*.svg",value:y,onChange:function(e){w(e.currentTarget.value)},required:!0})]}),(0,g.jsxs)(D.View,{grow:!0,shrink:!0,gap:2,tag:"label",htmlFor:b("icon"),children:[(0,g.jsx)(a8.Text,{color:"dimmer",multiline:!1,children:"Icon (path)"}),(0,g.jsx)(gV.Input,{id:b("icon"),placeholder:"/svg-editor-logo.png",value:p,onChange:function(e){f(e.currentTarget.value)},required:!0})]})]})]})}function mg(e){var n=e.tools,t=e.onCreate,r=e.onUpdate,i=e.onOpen,a=e.onDelete,o=(0,U._)((0,N.useState)([]),2),s=o[0],l=o[1],u=(0,U._)((0,N.useState)(!1),2),c=u[0],d=u[1];return(0,g.jsxs)(D.View,{children:[(0,g.jsxs)(D.View,{pb:12,children:[(0,g.jsxs)(D.View,{row:!0,gap:8,align:"center",children:[(0,g.jsxs)(D.View,{row:!0,gap:8,align:"center",children:[(0,g.jsx)(aU.default,{}),(0,g.jsx)(a8.Text,{variant:"subheadDefault",multiline:!1,children:"Tools"})]}),(0,g.jsx)(ct.IconButton,{onClick:function(){return d(!c)},alt:"Add a new tool",disabled:c,tooltipBehavior:c?"hidden":"default",children:(0,g.jsx)(sT.default,{})})]}),(0,g.jsx)(a8.Text,{color:"dimmer",variant:"small",multiline:!1,children:"Custom user interfaces as a Pane"})]}),(0,g.jsxs)(D.View,{gap:8,children:[c?(0,g.jsx)(mm,{onSubmit:function(e){t(e),d(!1)},onCancel:function(){d(!1)}}):null,n.length?n.map(function(e,n){var t;return s.includes(n)?(0,g.jsx)(mm,{initialTool:e,onSubmit:function(e){r(e,n),l(function(e){return e.filter(function(e){return e!==n})})},onCancel:function(){l(function(e){return e.filter(function(e){return e!==n})})}},n):(0,g.jsxs)(A.Surface,{css:[i9.rcss.borderRadius(8),i9.rcss.flex.wrap,{rowGap:8}],p:8,row:!0,justify:"space-between",align:"center",elevated:!0,children:[(0,g.jsx)(a8.Text,{multiline:!1,children:null!=(t=e.name)?t:"Unnamed"}),(0,g.jsxs)(D.View,{row:!0,gap:12,align:"center",children:[(0,g.jsx)(ct.IconButton,{alt:"Remove ".concat(e.name||"this tool"),colorway:"red",onClick:function(){a(n)},children:(0,g.jsx)(gq.default,{})}),(0,g.jsx)(ct.IconButton,{alt:"Remove ".concat(e.name||"this tool"),onClick:function(){l(function(e){return(0,er._)(e).concat([n])})},children:(0,g.jsx)(gz.default,{})}),(0,g.jsx)(a4.Button,{iconLeft:(0,g.jsx)(uw.default,{}),variant:"outlined",text:"Preview",onClick:function(){i(e)}})]})]},n)}):(0,g.jsx)(g.Fragment,{children:c?null:(0,g.jsxs)(D.View,{css:[i9.rcss.border({style:"dashed"}),i9.rcss.borderRadius(8),i9.rcss.p(16),i9.rcss.colWithGap(8),i9.rcss.center],children:[(0,g.jsx)(a8.Text,{color:"dimmest",children:"You haven't added any tools"}),(0,g.jsx)(a4.Button,{variant:"outlined",text:"New Tool",iconLeft:(0,g.jsx)(sT.default,{}),onClick:function(){return d(!0)}})]})})]})]})}function mm(e){var n,t,r,i=e.onSubmit,a=e.onCancel,o=e.initialTool,s=(0,U._)((0,N.useState)(null!=(n=null==o?void 0:o.name)?n:""),2),l=s[0],u=s[1],c=(0,U._)((0,N.useState)(null!=(t=null==o?void 0:o.icon)?t:null),2),d=c[0],p=c[1],f=(0,U._)((0,N.useState)(null!=(r=null==o?void 0:o.handler)?r:""),2),h=f[0],m=f[1],v=(0,gD.useIdSeed)();return(0,g.jsxs)(A.Surface,{tag:"form",css:[i9.rcss.borderRadius(8),i9.rcss.border({color:P.tokens.outlineDimmest}),i9.rcss.p(8)],elevated:!0,onSubmit:function(e){e.preventDefault(),i({name:l,icon:d,handler:h})},children:[(0,g.jsxs)(D.View,{css:[i9.rcss.border({color:P.tokens.outlineDimmest,direction:"bottom"}),i9.rcss.align.center,i9.rcss.flex.wrap,{rowGap:8}],row:!0,gap:2,justify:"space-between",children:[(0,g.jsx)(a8.Text,{multiline:!1,children:l||"New Tool"}),(0,g.jsxs)(D.View,{row:!0,gap:8,children:[(0,g.jsx)(a4.Button,{text:"Cancel",onClick:function(){a()}}),(0,g.jsx)(a4.Button,{colorway:"primary",iconLeft:(0,g.jsx)(po.default,{}),text:"Save Changes",type:"submit"})]})]}),(0,g.jsxs)(D.View,{gap:8,children:[(0,g.jsxs)(D.View,{grow:!0,shrink:!0,gap:2,tag:"label",htmlFor:v("name"),children:[(0,g.jsx)(a8.Text,{color:"dimmer",multiline:!1,children:"Name"}),(0,g.jsx)(gV.Input,{id:v("name"),placeholder:"SQL Viewer",value:l,onChange:function(e){u(e.currentTarget.value)},required:!0})]}),(0,g.jsxs)(D.View,{grow:!0,shrink:!0,gap:2,tag:"label",htmlFor:v("handler"),children:[(0,g.jsx)(a8.Text,{color:"dimmer",multiline:!1,children:"URL Path"}),(0,g.jsx)(gV.Input,{id:v("handler"),placeholder:"/sql",value:h,onChange:function(e){m(e.currentTarget.value)},required:!0})]}),(0,g.jsxs)(D.View,{grow:!0,shrink:!0,gap:2,tag:"label",htmlFor:v("icon"),children:[(0,g.jsx)(a8.Text,{color:"dimmer",multiline:!1,children:"Icon (path)"}),(0,g.jsx)(gV.Input,{id:v("icon"),placeholder:"/sql-logo.png",value:null!=d?d:"",onChange:function(e){p(e.currentTarget.value||null)},required:!0})]})]})]})}function mv(e){var n,t,r=e.manifest,i=e.performPaneOperation,a=e.update,o=(0,oi.useCurrentReplExtension)(),s=(0,oi.useInstallCurrentReplAsExtension)(),l=(0,U._)((0,N.useState)(null),2),u=l[0],c=l[1];return(0,g.jsxs)(D.View,{gap:24,css:[i9.rcss.width("100%")],children:[(0,g.jsx)(mf,{onOpen:function(e){return(0,ei._)(function(){return(0,ea._)(this,function(n){return c(e),[2]})})()},onDelete:function(e){var n;a((0,r$._)((0,v._)({},r),{fileHandlers:null==(n=r.fileHandlers)?void 0:n.filter(function(n,t){return t!==e})}))},onUpdate:function(e,n){var t,i,o,s;a((0,r$._)((0,v._)({},r),{fileHandlers:(0,er._)(null!=(o=null==(t=r.fileHandlers)?void 0:t.slice(0,n))?o:[]).concat([e],(0,er._)(null!=(s=null==(i=r.fileHandlers)?void 0:i.slice(n+1))?s:[]))}))},onCreate:function(e){var n;a((0,r$._)((0,v._)({},r),{fileHandlers:(0,er._)(null!=(n=r.fileHandlers)?n:[]).concat([e])}))},fileHandlers:null!=(n=r.fileHandlers)?n:[]}),(0,g.jsx)(mg,{onOpen:function(e){return(0,ei._)(function(){var n,t;return(0,ea._)(this,function(r){switch(r.label){case 0:if(n=o)return[3,2];return[4,s()];case 1:n=r.sent(),r.label=2;case 2:if(!n)throw Error("Expected current repl to be installed as an extension");return i({operation:"open",pane:{type:"extension",data:{extensionId:n.extensionId,installationId:n.installationId,name:null!=(t=e.name)?t:n.manifest.name,baseUrl:n.baseUrl,icon:e.icon,path:e.handler}}}),[2]}})})()},onDelete:function(e){var n;a((0,r$._)((0,v._)({},r),{tools:null==(n=r.tools)?void 0:n.filter(function(n,t){return t!==e})}))},onUpdate:function(e,n){var t,i,o,s;a((0,r$._)((0,v._)({},r),{tools:(0,er._)(null!=(o=null==(t=r.tools)?void 0:t.slice(0,n))?o:[]).concat([e],(0,er._)(null!=(s=null==(i=r.tools)?void 0:i.slice(n+1))?s:[]))}))},onCreate:function(e){var n;a((0,r$._)((0,v._)({},r),{tools:(0,er._)(null!=(n=r.tools)?n:[]).concat([e])}))},tools:null!=(t=r.tools)?t:[]}),(0,g.jsx)(az.Modal,{isOpen:!!u,onRequestClose:function(){return c(null)},children:u?(0,g.jsx)(gL,{glob:u.glob,openFile:function(e){return(0,ei._)(function(){var n,t;return(0,ea._)(this,function(r){switch(r.label){case 0:if(!u)throw Error("Expected pending file handler");if(n=o)return[3,2];return[4,s()];case 1:n=r.sent(),r.label=2;case 2:if(!n)throw Error("Expected current repl to be installed as an extension");return i({operation:"open",pane:{type:"extension",data:{extensionId:n.extensionId,installationId:n.installationId,name:null!=(t=u.name)?t:n.manifest.name,baseUrl:n.baseUrl,path:(0,oo.getAssetUrl)(n.baseUrl,u.handler),filePath:e}}}),c(null),[2]}})})()}}):null})]})}var mx=e.i(952521),my=e.i(903283),mw=e.i(452814),mb=(0,ur.css)(dn.interactive.filled,i9.rcss.position.relative,i9.rcss.p(4),i9.rcss.border({color:P.tokens.outlineDimmer}),i9.rcss.backgroundColor.backgroundHigher,{"&[data-complete]":[i9.rcss.backgroundColor.backgroundDefault,{pointerEvents:"none"}],button:{overflow:"hidden",margin:-1,borderWidth:0,padding:0,width:1,height:1,background:"none",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",cursor:"pointer","&::after":{content:'""',position:"absolute",top:0,right:0,bottom:0,left:0,display:"block",cursor:"pointer",zIndex:1}}}),m_=function(e){var n=e.complete,t=e.onClick,r=e.description,i=e.title,a=e.icon;return(0,g.jsx)(D.View,{tag:"li",css:mb,"data-complete":n,children:(0,g.jsxs)(D.View,{p:4,children:[(0,g.jsxs)(D.View,{row:!0,gap:6,align:"center",children:[n?(0,g.jsx)(po.default,{color:P.tokens.accentPositiveStrongest,size:16,css:[i9.rcss.mr(4)]}):null!=a?a:null,(0,g.jsx)(a8.Text,{variant:"small",color:n?"dimmer":"default",css:[i9.rcss.fontWeight.medium],children:i})]}),r?(0,g.jsx)(a8.Text,{color:"dimmer",variant:"small",children:r}):null,(0,g.jsx)(D.View,{children:(0,g.jsx)("button",{onClick:function(){t&&"function"==typeof t&&t()},type:"button",children:"Start"})})]})})};let mj=function(e){var n=e.setSelectedTab,t=(0,mx.useDismissibleElement)("extensions-onboarding-checklist"),r=t.isDone,i=t.setAsDone,a=(0,mx.useDismissibleElement)("extensions-onboarding-checklist-create"),o=a.isDone,s=a.setAsDone,l=(0,mx.useDismissibleElement)("extensions-onboarding-checklist-concepts"),u=l.isDone,c=l.setAsDone,d=(0,mx.useDismissibleElement)("extensions-onboarding-checklist-api"),p=d.isDone,f=d.setAsDone,h=(0,mx.useDismissibleElement)("extensions-onboarding-checklist-publish").isDone;if((0,N.useEffect)(function(){s()},[]),void 0===r||!0===r)return null;var m=[o,u,p,h].filter(Boolean).length,x=[{name:"create",title:"Create an Extension",complete:!!o,icon:(0,g.jsx)(sP.default,{})},{name:"concepts",title:"Learn key concepts",complete:!!u,onClick:function(){window.open(aZ.LINKS_DOCS.EXTENSIONS,"_blank","noopener"),(0,el.track)(eu.events.EXTENSION_USED,{action:"developer_onboarding_completed",step:"concepts"}),c()},icon:(0,g.jsx)(my.default,{})},{name:"learn",title:"Use the API",complete:!!p,onClick:function(){window.open(aZ.LINKS_DOCS.EXTENSIONS,"_blank","noopener"),(0,el.track)(eu.events.EXTENSION_USED,{action:"developer_onboarding_completed",step:"learn"}),f()},icon:(0,g.jsx)(lD.default,{})},{name:"publish",title:"Publish your Extension",complete:!!h,onClick:function(){n("releases")},icon:(0,g.jsx)(mw.default,{})}];return(0,g.jsx)("section",{css:[i9.rcss.width("100%")],children:(0,g.jsxs)(D.View,{gap:12,children:[(0,g.jsx)(D.View,{gap:2,children:(0,g.jsxs)(D.View,{row:!0,gap:12,css:[i9.rcss.flex.wrap],align:"center",children:[(0,g.jsx)(a8.Text,{variant:"subheadDefault",children:"Get started with Extensions"}),(0,g.jsxs)(D.View,{row:!0,gap:12,align:"center",children:[(0,g.jsx)(D.View,{row:!0,gap:2,align:"center",justify:"center",children:Array.from({length:x.length}).map(function(e,n){return(0,g.jsx)(D.View,{css:[i9.rcss.borderRadius(8),i9.rcss.width(12),i9.rcss.height(4),n<m?i9.rcss.backgroundColor.accentPositiveDefault:i9.rcss.backgroundColor.backgroundHighest]},n)})}),(0,g.jsx)(a8.Text,{multiline:!1,variant:"small",color:"dimmer",children:"".concat(m,"/").concat(x.length)}),(0,g.jsx)(ct.IconButton,{alt:"Hide section",onClick:i,children:(0,g.jsx)(ud.default,{})})]})]})}),(0,g.jsx)(D.View,{tag:"ul",css:[i9.rcss.flex.wrap,{listStyleType:"none",gap:P.tokens.space8}],row:!0,children:x.map(function(e,n){return(0,g.jsx)(m_,(0,v._)({},e),n)})})]})})};var mS=e.i(530310);function mI(e){var n=e.performPaneOperation,t=e.setSelectedTab,r=g4(),i=r.__status,a=r.parsed,o=r.state,s=r.updateString;if("loading"===i)return(0,g.jsx)(g3,{});if("fileReadError"===i)return(0,g.jsx)(mn,{message:(null==o?void 0:o.fileReadError)||"Unknown error"});if("fileParseError"===i){var l=a.error;return(0,g.jsx)(me,{performPaneOperation:n,manifestPath:o.manifestPath,error:l})}var u=a.manifest;return"success"===i&&u?(0,g.jsxs)(D.View,{css:[i9.rcss.width("100%")],pt:12,gap:24,align:"center",children:[(0,g.jsx)(md,{performPaneOperation:n,setSelectedTab:t}),(0,g.jsx)(mj,{setSelectedTab:t}),(0,g.jsx)(D.View,{css:[i9.rcss.border({direction:"bottom",width:4,color:P.tokens.outlineDimmest}),i9.rcss.width("100%")]}),(0,g.jsxs)(D.View,{gap:8,css:[i9.rcss.width("100%")],children:[(0,g.jsxs)(D.View,{gap:2,children:[(0,g.jsxs)(D.View,{row:!0,gap:8,align:"center",children:[(0,g.jsx)(mS.default,{}),(0,g.jsx)(a8.Text,{variant:"subheadDefault",multiline:!1,children:"Permission Scopes"})]}),(0,g.jsxs)(a8.Text,{variant:"small",color:"dimmer",children:["Let users know what your Extension can do with their data. For more information,"," ",(0,g.jsx)("a",{href:aZ.LINKS_DOCS.EXTENSIONS+"/api/manifest#scopetype",target:"_blank",rel:"noopener",children:"read the docs"}),"."]})]}),(0,g.jsx)(D.View,{css:[i9.rcss.borderRadius(4),i9.rcss.border({color:P.tokens.outlineDimmest,width:1}),i9.rcss.flex.row,i9.rcss.align.center,i9.rcss.p(8),i9.rcss.flex.wrap,{gap:12},i9.rcss.width("fit-content")],children:gI.scopes.map(function(e){var n;return(0,g.jsxs)(D.View,{row:!0,gap:6,align:"center",children:[(0,g.jsx)(sA.Checkbox,{id:e.key,checked:null==(n=u.scopes)?void 0:n.some(function(n){return n.name===e.key}),onChange:function(n){var t,r,i,a=(null==(t=u.scopes)?void 0:t.some(function(n){return n.name===e.key}))&&!n?gj.patch(o.manifestStr,(0,r$._)((0,v._)({},u),{scopes:null==(r=u.scopes)?void 0:r.filter(function(n){return n.name!==e.key})})):gj.patch(o.manifestStr,(0,r$._)((0,v._)({},u),{scopes:(0,er._)(null!=(i=u.scopes)?i:[]).concat([{name:e.key,reason:e.description}])}));o.writeChange((0,gS.changeSetFromDiff)(o.manifestStr,a)),s(a)}}),(0,g.jsx)("label",{htmlFor:e.key,css:[i9.rcss.fontSize(12),i9.rcss.cursor.pointer],children:(0,g.jsx)("abbr",{title:e.description,css:[{textDecorationColor:P.tokens.foregroundDimmest}],children:e.friendlyName})})]},e.key)})})]}),(0,g.jsx)(mv,{performPaneOperation:n,manifest:u,update:function(e){var n=gj.patch(o.manifestStr,e);o.writeChange((0,gS.changeSetFromDiff)(o.manifestStr,n)),s(n)}})]}):(0,g.jsx)("div",{children:"unknown state"})}var mC=e.i(221250),mk=e.i(542101),mE=e.i(109853),mT=e.i(410793),mP=e.i(598160),mR=(0,rl.cssRecord)({logViewerTopLevel:[i9.rcss.height("100%")],logsContainer:[i9.rcss.scrollbar.thin,i9.rcss.backgroundColor.backgroundDefault,i9.rcss.overflowY("scroll"),i9.rcss.flex.growAndShrink(1)],logViewerHeader:[i9.rcss.border({direction:"bottom",width:P.tokens.borderWidthDefault}),i9.rcss.display.flex,i9.rcss.flex.row,i9.rcss.rowWithGap(8),i9.rcss.align.center],logViewerHeaderControl:[i9.rcss.flex.row,i9.rcss.rowWithGap(4),i9.rcss.align.center],logLine:[i9.rcss.font.code,dn.interactive.listItem,i9.rcss.rowWithGap(2),i9.rcss.align.center],logLineIcon:[{alignSelf:"flex-start"}],logMessage:{flex:"1 1 0"}});function mA(e){var n=e.log,t=e.prevLevel,r=e.isLast,i=e.isFirst,a=(0,U._)((0,N.useState)(!1),2),o=a[0],s=a[1],l=(0,mk.default)().ref;return(0,g.jsxs)(D.View,{css:[i9.rcss.flex.column,function(e){if(e===mT.LogLevel.warn)return{color:P.tokens.yellowStronger,background:"rgba(150, 125, 0, 0.2)",borderTop:i?void 0:"1px solid rgba(150, 125, 0, 0.5)",borderBottom:r?"1px solid rgba(150, 125, 0, 0.5)":void 0,"& .cm-gutter":{backgroundColor:"rgba(150, 125, 0, 0.2)"}};if(e===mT.LogLevel.error)return{color:P.tokens.accentNegativeStronger,backgroundColor:"rgba(229, 34, 34, 0.2)",borderTop:i?void 0:"1px solid rgba(229, 34, 34, 0.5)",borderBottom:r?"1px solid rgba(229, 34, 34, 0.5)":void 0,"& .cm-gutter":{backgroundColor:"rgba(229, 34, 34, 0.2)"}};var n=P.tokens.backgroundHigher;return t===mT.LogLevel.warn?n="rgba(150, 125, 0, 0.5)":t===mT.LogLevel.error&&(n="rgba(229, 34, 34, 0.5)"),{color:P.tokens.foregroundDefault,borderTop:i?void 0:"1px solid ".concat(n),borderBottom:r?"1px solid ".concat(n):void 0}}(n.logLevel)],children:[(0,g.jsxs)(D.View,{css:mR.logLine,p:2,onClick:function(){return s(function(e){return!e})},children:[(0,g.jsx)(D.View,{css:mR.logLineIcon,p:4,children:(0,g.jsx)(function(){return n.logLevel===mT.LogLevel.warn?(0,g.jsx)(dm.default,{size:16}):n.logLevel===mT.LogLevel.error?(0,g.jsx)(mP.default,{size:16}):(0,g.jsx)(gO.default,{size:16,css:{opacity:0}})},{})}),(0,g.jsx)(a8.Text,{maxLines:10,css:mR.logMessage,variant:"small",children:n.message}),o?(0,g.jsx)(p5.default,{size:16}):(0,g.jsx)(pd.default,{size:16})]}),o?(0,g.jsx)(D.View,{children:(0,g.jsx)(mC.default,{ref:l,css:mE.CodeMirrorEditorStyleEditorContainer,noHistory:!0,readOnly:!0,lineWrapping:!0,language:"json",fontSize:12,initialDoc:JSON.stringify(n,null,2)})}):null]})}let mD=function(){var e=(0,s_.useExtAtomValue)(or.filteredLogsAtom),n=(0,s_.useSetExtAtom)(or.clearLogsAtom),t=(0,U._)((0,s_.useExtAtom)(or.logFilterQueryAtom),2),r=t[0],i=t[1],a=(0,N.useRef)(null);return(0,N.useEffect)(function(){var e,n=a.current;n&&(null==(e=n.children[n.children.length-1])||e.scrollIntoView({behavior:"smooth"}))},[e]),(0,g.jsxs)(D.View,{css:mR.logViewerTopLevel,children:[(0,g.jsxs)(D.View,{className:"log-viewer-header",css:mR.logViewerHeader,p:8,children:[(0,g.jsx)(D.View,{css:mR.logViewerHeaderControl,style:{flexGrow:1},children:(0,g.jsx)(gV.Input,{type:"search",placeholder:"Filter logs",value:null!=r?r:"",onChange:function(e){return i(e.target.value)}})}),(0,g.jsxs)(D.View,{css:mR.logViewerHeaderControl,children:[(0,g.jsx)(ct.IconButton,{alt:"Clear logs",onClick:function(){return n()},children:(0,g.jsx)(ud.default,{id:"clear-logs"})}),(0,g.jsx)("label",{htmlFor:"clear-logs",children:"Clear logs"})]})]}),(0,g.jsx)(D.View,{css:mR.logsContainer,innerRef:a,children:e.map(function(n,t){var r;return(0,g.jsx)(mA,{log:n,prevLevel:null==(r=e[t-1])?void 0:r.logLevel,isFirst:0===t,isLast:t===e.length-1},n.index)})})]})};var mV=e.i(613141);function mO(){var e=(0,x._)(["\n  subscription ExtensionBuildLogs($extensionId: String!) {\n    extensionBuildDeployActionUpdates(input: { extensionId: $extensionId }) {\n      ... on ExtensionBuildDeployLogAction {\n        log\n      }\n      ... on ExtensionBuildDeployStatusAction {\n        status\n        message\n        build {\n          id\n        }\n      }\n    }\n  }\n"]);return mO=function(){return e},e}function mF(){var e=(0,x._)(["\n  mutation DeployExtension2(\n    $extensionId: String!\n    $replId: String!\n    $outputDirectory: String!\n    $buildCommand: String!\n  ) {\n    deployExtension2(\n      extensionId: $extensionId\n      replId: $replId\n      outputDirectory: $outputDirectory\n      buildCommand: $buildCommand\n    ) {\n      ... on Extension {\n        ...TopLevelExtension\n      }\n      ... on TooManyRequestsError {\n        message\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return mF=function(){return e},e}function mM(){var e=(0,x._)(["\n  query Publish2Extension($extensionId: String!) {\n    extension(id: $extensionId) {\n      ... on Extension {\n        id\n        user {\n          id\n          username\n        }\n        name\n        description\n        canDeployExtension\n      }\n      ... on NotFoundError {\n        message\n      }\n    }\n  }\n"]);return mM=function(){return e},e}function mL(){var e=(0,x._)(["\n  mutation CreateExtension($name: String!, $description: String!) {\n    createExtension(name: $name, description: $description) {\n      ... on Extension {\n        id\n        url\n      }\n      ... on UserError {\n        message\n      }\n      ... on TooManyRequestsError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n    }\n  }\n"]);return mL=function(){return e},e}function mG(){var e=(0,x._)(["\n  mutation UpdateExtension(\n    $extensionId: String!\n    $name: String\n    $description: String\n  ) {\n    updateExtension(\n      extensionId: $extensionId\n      name: $name\n      description: $description\n    ) {\n      ... on Extension {\n        id\n        name\n        description\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n"]);return mG=function(){return e},e}var mU={},mN=(0,y.gql)(mO()),mB=(0,y.gql)(mF(),aY.TopLevelExtensionFragmentDoc),mW=(0,y.gql)(mM()),mz=(0,y.gql)(mL()),mH=(0,y.gql)(mG()),mq=e.i(322823);e.i(713984);var mK=e.i(966036),m$=e.i(883021),mQ=D.SpecializedView.button,mY=((s={}).Pending="pending",s.Active="active",s.Complete="complete",s.Error="error",s),mX=function(){return(0,g.jsx)(D.View,{css:[i9.rcss.border({color:P.tokens.outlineDimmest,direction:"top"})],grow:!0,row:!0})},mJ=function(e){var n=e.text,t=e.size,r=void 0===t?"default":t,i=e.state,a=e.onClick,o=e.disabled,s=e.hideLoadingIcon,l=(0,a4.getTextVariant)(r),u=(0,a4.getIconSize)(r);return(0,g.jsx)(mQ,{type:"button",css:[i9.rcss.reset.button,i9.rcss.position.relative,a&&dn.interactive.nofill,i9.rcss.px(8),i9.rcss.py(2),i9.rcss.borderRadius(4),i9.rcss.rowWithGap(4),i9.rcss.align.center,{borderRadius:P.tokens.borderRadiusRound}].concat((0,er._)("error"===i?[i9.rcss.color.accentNegativeStronger]:"active"===i?[i9.rcss.backgroundColor.accentPrimaryDimmer,i9.rcss.color.accentPrimaryStrongest]:"complete"===i?[i9.rcss.color.accentPositiveStronger]:[i9.rcss.color.foregroundDimmest])),onClick:a,disabled:o,children:(0,g.jsx)(a4.ButtonContent,{text:n,iconSize:u,textVariant:l,iconRight:function(){if("error"===i)return(0,g.jsx)(dm.default,{});if("active"===i){if(s)return;return(0,g.jsx)(cF.default,{})}return"complete"===i?(0,g.jsx)(po.default,{}):(0,g.jsx)(mS.default,{})}()})})},mZ=e.i(210481),m0=e.i(818976),m1=e.i(972882),m2=e.i(525212),m4=((l=m4||{}).Details="Details",l.Init="Init",l.CreatingExtension="CreatingExtension",l.CreatingExtensionError="CreatingExtensionError",l.Queued="Queued",l.Deploying="Deploying",l.DeployError="DeployError",l.Success="Success",l),m8=["CreatingExtension","Deploying"],m3=((u=m3||{}).Details="Details",u.Init="Configure",u.Create="Create",u.Deploy="Deploy",u),m6=["Details","Configure","Deploy"];function m5(e){var n,t,r,i,a,o=e.performPaneOperation,s=(0,ot.default)(),l=s.container,u=s.fs,c=s.dotReplit,d=(0,U._)((n=(0,v._)({},mU,void 0),b.useLazyQuery(mW,n)),1)[0],p=(0,mx.useDismissibleElement)("extensions-onboarding-checklist-".concat("publish")).setAsDone,f=(0,U._)((0,N.useState)(null),2),h=f[0],m=f[1],x=(0,U._)((0,N.useState)("Details"),2),y=x[0],w=x[1],_=(0,U._)((0,N.useState)(null),2),j=_[0],S=_[1],I=g4(),C=I.__status,k=I.parsed,E=I.state,T=I.updateManifest,R=(0,mq.useFormField)("",function(e){return e?e.startsWith("/")?{message:'Folder must be relative to the root of your project (e.g. "extension" or "./extension")',severity:"error"}:null:{message:"Output folder is required",severity:"error"}}),V=R.value,O=R.setValue,F=R.error,M=R.validate,L=(0,U._)((0,N.useState)([]),2),G=L[0],W=L[1],z=(0,N.useCallback)(function(e){return o({operation:"open",secondary:!0,pane:{type:(0,na.getPaneTypeForFile)(e),data:e}})},[o]),H=(0,U._)((0,mZ.default)({openFile:z,listFiles:u.listFiles}),2),q=H[0],K=H[1],$=(0,m0.useTerminalTheme)();t=(0,v._)({},mU,{variables:{extensionId:null!=h?h:""},onData:function(e){var n=e.data;if(n.data&&!n.error){var t=n.data.extensionBuildDeployActionUpdates;"ExtensionBuildDeployLogAction"===t.__typename&&W(function(e){return(0,er._)(e).concat((0,er._)(t.log))}),"ExtensionBuildDeployStatusAction"===t.__typename&&(t.status===lQ.HostingBuildStatus.Success?w("Success"):t.status===lQ.HostingBuildStatus.Failed&&w("DeployError"))}},skip:"Deploying"!==y||!h}),mV.useSubscription(mN,t),(0,N.useEffect)(function(){q&&(q.clear(),G.forEach(function(e){q.write(e.replaceAll("\n","\r\n"))}))},[G,q]);var Q=(0,N.useCallback)(function(e){if(null==e?void 0:e.config){var n=e.config.extension;if(!n||!1===n.isExtension){m(null),S(null),O(null);return}n.buildCommand&&S(n.buildCommand),n.outputDirectory&&O(n.outputDirectory),n.extensionID&&m(n.extensionID)}},[O]);(0,N.useEffect)(function(){var e=!1;return(0,ei._)(function(){var n;return(0,ea._)(this,function(t){switch(t.label){case 0:return[4,c.getConfig()];case 1:if(n=t.sent(),e)return[2];return Q(n),[2]}})})(),function(){e=!0}},[c,Q]);var Y=(0,N.useCallback)(function(e){return(0,ei._)(function(){return(0,ea._)(this,function(n){switch(n.label){case 0:return m(e),[4,c.updateDotReplit([{op:"add",path:"extension/extensionID",value:JSON.stringify(e)},{op:"add",path:"extension/isExtension",value:JSON.stringify(!0)}])];case 1:return n.sent(),[2]}})})()},[c]),X=(0,N.useCallback)(function(e){return(0,ei._)(function(){return(0,ea._)(this,function(n){switch(n.label){case 0:return S(e),[4,c.updateDotReplit([{op:"add",path:"extension/buildCommand",value:JSON.stringify(e)},{op:"add",path:"extension/isExtension",value:JSON.stringify(!0)}])];case 1:return n.sent(),[2]}})})()},[c]),J=(0,U._)((0,N.useState)(null),2),Z=J[0],ee=J[1],en=(0,U._)((0,N.useState)(null),2),et=en[0],eo=en[1],es=(0,U._)((0,N.useState)(null),2),ec=es[0],ed=es[1],ep=(0,U._)((0,N.useState)(null),2),ef=ep[0],eh=ep[1],eg=(0,U._)((0,N.useState)(null),2),em=eg[0],ev=eg[1],ex=(0,U._)((r=(0,v._)({},mU,void 0),B.useMutation(mB,r)),1)[0],ey=(0,a2.default)(),ew=(0,U._)((i=(0,v._)({},mU,void 0),B.useMutation(mz,i)),1)[0],eb=(0,U._)((0,N.useState)(null),2),e_=eb[0],ej=eb[1],eS=(0,N.useCallback)(function(e){var n=e.name,t=e.description;return(0,ei._)(function(){var e,r,i;return(0,ea._)(this,function(a){switch(a.label){case 0:return[4,ew({variables:{name:n,description:t}})];case 1:if((r=a.sent()).errors)return[2,{error:r.errors.map(function(e){return e.message}).join(", "),result:null}];if(!(i=null==(e=r.data)?void 0:e.createExtension))return[2,{error:"Failed to create extension",result:null}];if("TooManyRequestsError"===i.__typename||"UserError"===i.__typename||"UnauthorizedError"===i.__typename)return[2,{error:"Failed to create extension: "+i.message,result:null}];if("Extension"===i.__typename)return[2,{error:null,result:i}];throw Error("Unexpected response from createExtension mutation")}})})()},[ew]),eI=(0,U._)((a=(0,v._)({},mU,void 0),B.useMutation(mH,a)),1)[0],eC=(0,N.useCallback)(function(){return(0,ei._)(function(){var e,n,t,r,i,a,o,s,c,f,g,m,v,x,y,b,_,S;return(0,ea._)(this,function(I){switch(I.label){case 0:return e=h,[4,M()];case 1:if(null==(n=I.sent())?void 0:n.message)return ed(null==n?void 0:n.message),[2];if(!V)throw Error("expected output folder");return t=(0,sm.normalizePath)(V),(r=function(){w("Init"),W([]),ev(null),ed(null),eo(null),ee(null)})(),[4,u.flush()];case 2:if(I.sent(),!e)return[3,11];return[4,d({variables:{extensionId:e}})];case 3:if((i=I.sent()).error||!i.data)throw Error("Encountered an unknown error. Please contact support.");if((null==(a=i.data.extension)?void 0:a.__typename)!=="NotFoundError")return[3,5];return[4,new Promise(function(n){ej({message:"The extension referenced in .replit (".concat(e,") does not exist. Would you like to create a new extension?"),callback:function(e){ej(null),n(e)}})})];case 4:case 6:if(!I.sent())return r(),[2];return e=null,[3,11];case 5:if(!((null==a?void 0:a.__typename)==="Extension"&&!a.canDeployExtension))return[3,7];return[4,new Promise(function(n){ej({message:"You do not have the permissions to deploy the extension referenced in .replit (".concat(e,"). Would you like to create a new extension?"),callback:function(e){ej(null),n(e)}})})];case 7:if(!((null==a?void 0:a.__typename)==="Extension"&&a.canDeployExtension))return[3,10];if(c=null==k||null==(o=k.manifest)?void 0:o.name,f=null==k||null==(s=k.manifest)?void 0:s.description,!(c&&c!==a.name||f&&f!==a.description))return[3,9];return[4,eI({variables:{extensionId:e,description:null!=f?f:void 0,name:null!=c?c:void 0}})];case 8:I.sent(),I.label=9;case 9:return[3,11];case 10:throw Error("Encountered an unknown error. Please contact support.");case 11:if(e)return[3,13];return w("CreatingExtension"),[4,eS({name:null!=(v=null==k||null==(g=k.manifest)?void 0:g.name)?v:"My extension",description:null!=(x=null==k||null==(m=k.manifest)?void 0:m.description)?x:"My extension's description"})];case 12:if(null!==(y=I.sent()).error)return w("CreatingExtensionError"),eh(y.error),[2];Y(e=y.result.id),I.label=13;case 13:var C;if(!e)throw Error("expected extension id to be set");return[4,(C=t,new Promise(function(e){var n=l.openChannel({service:"gcsfiles"},function(t){return t.channel.request({persistMirror:{path:C}}).then(function(t){t.ok,n(),e()}),function(e){e.willReconnect&&n()}})}))];case 14:I.sent(),w("Queued"),I.label=15;case 15:return I.trys.push([15,17,,18]),[4,ex({variables:{extensionId:e,replId:ey,outputDirectory:t,buildCommand:null!=j?j:""}})];case 16:return b=I.sent(),[3,18];case 17:if(_=I.sent(),w("DeployError"),_.message.includes("received message larger than max"))return ev("Your extension's size is too large. Please compress assets or remove files, and try again."),[2];return ev(_.message),[2];case 18:if(b.errors)return w("DeployError"),ev("Internal error. Please contact support: "+b.errors.map(function(e){return e.message}).join(", ")),[2];if(!b.data)return w("DeployError"),ev("Encountered an unknown error. Please contact support."),[2];if("Extension"===(S=b.data.deployExtension2).__typename)return w("Deploying"),p(),(0,el.track)(eu.events.EXTENSION_USED,{action:"developer_onboarding_completed",step:"publish"}),ee(S),[2];if("message"in S)return w("DeployError"),ev(S.message),[2];return w("DeployError"),ev("Encountered an unknown error. Please contact support."),[2]}})})()},[j,l,V,M,ey,u,w,ex,d,eI,h,eS,Y,p,k]),ek=function(e){switch(e){case"Details":default:return"Details";case"Init":return"Configure";case"CreatingExtension":case"CreatingExtensionError":return"Create";case"Queued":case"Deploying":case"DeployError":return"Deploy"}}(y),eE=m6.indexOf(ek);function eT(){return et?"Build error: ".concat(et):ec?"Validation error: ".concat(ec):ec?"Create extension error: ".concat(ef):em?"Deploy error: ".concat(em):void 0}var eP=(0,or.useExtensions)().find(function(e){return e.extensionId===h}),eR=(0,U._)((0,N.useState)(!1),2),eA=eR[0],eD=eR[1],eV=(0,oi.useInstallExtension)(),eO=(0,N.useMemo)(function(){return eA?(0,g.jsx)(cF.default,{}):eP?(0,g.jsx)(po.default,{}):(0,g.jsx)(ma.default,{})},[eA,eP]),eF=(0,sj.useTheme)().values.global,eM=(0,m$.useConfetti)().fireBurst,eL=(0,U._)((0,N.useState)(!1),2),eG=eL[0],eU=eL[1],eN=(0,N.useRef)(null);if((0,N.useEffect)(function(){eN.current&&!eG&&"Success"===y&&(eM({x:eN.current.getBoundingClientRect().left,y:eN.current.getBoundingClientRect().top,heading:-45,numParticles:160,lifetime:1,spread:80,velocity:function(){return(0,mK.randNum)(300,5e3)},size:function(){return{width:(0,mK.randNum)(8,16),height:(0,mK.randNum)(8,16)}},color:[eF.tealStronger,eF.blurpleStronger,eF.yellowStronger]}),eM({x:eN.current.getBoundingClientRect().right,y:eN.current.getBoundingClientRect().top,heading:225,numParticles:160,lifetime:1,velocity:function(){return(0,mK.randNum)(300,5e3)},size:function(){return{width:(0,mK.randNum)(8,16),height:(0,mK.randNum)(8,16)}},color:[eF.blueStronger,eF.greenStronger,eF.pinkStronger]}),eU(!0))},[y,eF,eM,eG]),C===g8.loading)return(0,g.jsx)(g3,{});if(C===g8.fileReadError)return(0,g.jsx)(mn,{message:E.fileReadError});var eB=k.manifest,eW=k.error;return eW?(0,g.jsx)(me,{performPaneOperation:o,manifestPath:E.manifestPath,error:eW}):(0,g.jsxs)(D.View,{css:[i9.rcss.flex.column,i9.rcss.display.flex,i9.rcss.height("100%"),i9.rcss.justify.center,i9.rcss.align.center,i9.rcss.position.relative],children:[(0,g.jsx)(D.View,{css:[i9.rcss.position.absolute,i9.rcss.top(0),i9.rcss.left(0),i9.rcss.right(0)],className:"Confetti",innerRef:eN}),(0,g.jsxs)(D.View,{css:[i9.rcss.width("100%"),i9.rcss.maxWidth(g_.PANE_CONTENT_MAX_WIDTH)],grow:!0,shrink:!0,p:12,pt:16,gap:24,children:["Success"!==y?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(D.View,{gap:16,children:[(0,g.jsx)(a8.Text,{variant:"subheadBig",multiline:!0,children:"Create a new release"}),(0,g.jsx)(D.View,{row:!0,gap:4,align:"center",children:m6.map(function(e,n){var t;return(0,g.jsxs)(N.Fragment,{children:[0!==n&&(0,g.jsx)(mX,{}),(0,g.jsx)(mJ,{state:(t=n)<eE?mY.Complete:t!==eE?mY.Pending:["CreatingExtensionError","DeployError"].includes(y)?mY.Error:mY.Active,text:e,hideLoadingIcon:"Configure"===e||"Details"===e})]},e)})})]}),"Details"===y?(0,g.jsx)(D.View,{css:[i9.rcss.flex.column,i9.rcss.colWithGap(8),i9.rcss.width("100%")],children:(0,g.jsx)(mp,{manifest:eB,updateManifest:T,onSubmit:function(e){T((0,v._)({},eB,e)),w("Init")}})}):null,"Details"!==y?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(D.View,{gap:16,children:[(0,g.jsxs)(D.View,{row:!0,gap:8,align:"center",children:[(0,g.jsx)(dG.default,{}),(0,g.jsx)(a8.Text,{variant:"subheadDefault",children:"Build settings"}),(0,g.jsx)(D.View,{css:[i9.rcss.border({color:P.tokens.backgroundHighest,direction:"y"})],grow:!0})]}),(0,g.jsxs)(D.View,{gap:4,children:[(0,g.jsxs)("label",{htmlFor:"buildCommand",css:[i9.rcss.display.flex,i9.rcss.rowWithGap(4),i9.rcss.align.center],children:[(0,g.jsx)(a8.Text,{color:"dimmer",variant:"small",children:"Build command (optional)"}),(0,g.jsx)(c6.Tooltip,{tooltip:"This is the command that compiles your app at build time. Leave it blank if you don't need to build your app.",children:(0,g.jsx)(gO.default,{size:12})})]}),(0,g.jsx)(gV.Input,{value:null!=j?j:"",onChange:function(e){return X(e.target.value)},placeholder:"Example: npm run build",disabled:"Init"!==y&&m8.includes(y)})]}),(0,g.jsxs)(D.View,{gap:4,children:[(0,g.jsxs)("label",{htmlFor:"outputFolder",css:[i9.rcss.display.flex,i9.rcss.rowWithGap(4),i9.rcss.align.center],children:[(0,g.jsx)(a8.Text,{color:"dimmer",variant:"small",children:"Output folder"}),(0,g.jsx)(c6.Tooltip,{tooltip:"This is where your build will live. There must be an extension.json file in this folder.",children:(0,g.jsx)(gO.default,{size:12})})]}),(0,g.jsx)(gV.Input,{id:"outputFolder",value:null!=V?V:"",disabled:"Init"!==y&&m8.includes(y),onChange:function(e){O(e.currentTarget.value),c.updateDotReplit([{op:"add",path:"extension/outputDirectory",value:JSON.stringify(e.currentTarget.value)},{op:"add",path:"extension/isExtension",value:JSON.stringify(!0)}])},placeholder:"./extension"}),F?(0,g.jsx)(a8.Text,{css:[i9.rcss.color.accentNegativeStronger],children:F.message}):null]}),(0,g.jsx)(a4.Button,{text:"Init"===y||y.endsWith("Error")?"Deploy and Release":"Deploying",iconLeft:"Init"===y||y.endsWith("Error")?(0,g.jsx)(dL.default,{}):(0,g.jsx)(cF.default,{}),onClick:eC,disabled:"Init"!==y&&m8.includes(y),colorway:"primary"}),(0,g.jsxs)(a8.Text,{multiline:!0,variant:"small",color:"dimmer",children:["By releasing an Extension, you agree to the"," ",(0,g.jsx)("a",{href:aZ.LINKS_LEGAL.EXTENSIONS_DEVELOPER_TERMS,children:"Developer Terms"})]})]}),G.length>0?(0,g.jsxs)(D.View,{gap:8,children:[(0,g.jsxs)(D.View,{row:!0,gap:8,align:"center",children:[(0,g.jsx)(m2.default,{}),(0,g.jsx)(a8.Text,{variant:"subheadDefault",children:"Build logs"}),(0,g.jsx)(D.View,{css:[i9.rcss.border({color:P.tokens.backgroundHighest,direction:"y"})],grow:!0})]}),eT()?(0,g.jsx)(p6.StatusBanner,{text:eT(),colorway:"red",icon:(0,g.jsx)(mP.default,{})}):null,(0,g.jsx)(D.View,{css:[i9.rcss.display.flex,i9.rcss.py(12),i9.rcss.pl(16),i9.rcss.borderRadius(8),i9.rcss.overflow("hidden"),{border:"1px solid ".concat(P.tokens.outlineDimmest),backgroundColor:null==$?void 0:$.background}],children:(0,g.jsx)(D.SpecializedView.div,{css:[i9.rcss.width("100%"),i9.rcss.maxWidth("100%")],ref:K})})]}):null,e_?(0,g.jsxs)(A.Surface,{elevated:!0,css:[i9.rcss.borderRadius(8)],p:8,gap:8,children:[(0,g.jsx)(a8.Text,{variant:"text",multiline:!0,maxLines:3,children:e_.message}),(0,g.jsxs)(D.View,{row:!0,gap:4,align:"center",children:[(0,g.jsx)(a4.Button,{text:"No",css:[i9.rcss.flex.grow(1)],onClick:function(){return e_.callback(!1)}}),(0,g.jsx)(a4.Button,{text:"Yes",colorway:"primary",css:[i9.rcss.flex.grow(1)],onClick:function(){return e_.callback(!0)}})]})]}):null]}):null]}):null,Z&&"Success"===y?(0,g.jsxs)(D.View,{gap:16,children:[(0,g.jsxs)(D.View,{gap:4,children:[(0,g.jsx)(a8.Text,{variant:"subheadBig",multiline:!1,children:"Congratulations!"}),(0,g.jsx)(a8.Text,{color:"dimmer",multiline:!1,children:"You just published a new release to the Extensions Store."})]}),(0,g.jsx)(D.View,{py:8,children:(0,g.jsx)(m1.ExtensionCard,{showMetadata:!1,extension:Z,onClick:function(){o({operation:"open",pane:{type:"extensionStore",data:{page:"cover",coverPageExtensionId:(0,a0.asExtensionId)(Z.id)}}})}})}),(0,g.jsxs)(D.View,{row:!0,gap:8,align:"center",children:[(0,g.jsx)(my.default,{}),(0,g.jsx)(a8.Text,{variant:"subheadDefault",multiline:!1,children:"Next steps"}),(0,g.jsx)(D.View,{css:[i9.rcss.border({color:P.tokens.backgroundHighest,direction:"y"})],grow:!0})]}),(0,g.jsxs)(D.View,{css:[i9.rcss.border({color:P.tokens.outlineDimmest}),i9.rcss.borderRadius(8)],p:12,gap:8,children:[(0,g.jsx)(a8.Text,{variant:"subheadDefault",children:"Install your Extension"}),(0,g.jsx)(a8.Text,{color:"dimmer",children:"Once installed, you can use the extension in any of your Apps."}),(0,g.jsx)(a4.Button,{text:eP?"Already installed":"Install Extension",colorway:eP?"green":"primary",disabled:eA||!!eP,iconLeft:eO,loading:eA,onClick:function(){return(0,ei._)(function(){return(0,ea._)(this,function(e){switch(e.label){case 0:return eD(!0),[4,eV({extensionId:(0,a0.asExtensionId)(Z.id),replId:null})];case 1:return e.sent(),eD(!1),[2]}})})()}})]})]}):null]})]})}var m9=e.i(628796),m7=e.i(618497);function ve(e){var n=e.performPaneOperation,t=(0,U._)((0,N.useState)("home"),2),r=t[0],i=t[1];return(0,g.jsx)(D.View,{css:[i9.rcss.flex.column,i9.rcss.height("100%"),i9.rcss.position.relative],children:(0,g.jsx)("div",{css:[i9.rcss.flex.grow(1),i9.rcss.flex.column,i9.rcss.align.center,i9.rcss.display.flex,i9.rcss.overflow("hidden")],children:(0,g.jsxs)(m9.Tabs,{selectedKey:r,onSelectionChange:function(e){return i(e)},children:[(0,g.jsx)(A.Surface,{css:[i9.rcss.top(0),i9.rcss.width("100%"),i9.rcss.zIndex(1)],align:"center",children:(0,g.jsxs)(m9.TabList,{css:[i9.rcss.align.center,i9.rcss.width("100%"),i9.rcss.pb(0),i9.rcss.maxWidth(g_.PANE_CONTENT_MAX_WIDTH)],children:[(0,g.jsx)(m9.Tab,{id:"home",css:[i9.rcss.p(12),i9.rcss.height("100%"),i9.rcss.borderRadius(0)],iconLeft:(0,g.jsx)(p7.default,{}),children:"Home"}),(0,g.jsx)(m9.Tab,{id:"releases",css:[i9.rcss.p(12),i9.rcss.height("100%"),i9.rcss.borderRadius(0)],iconLeft:(0,g.jsx)(m7.default,{}),children:"Releases"}),(0,g.jsx)(m9.Tab,{id:"logs",css:[i9.rcss.p(12),i9.rcss.height("100%"),i9.rcss.borderRadius(0)],iconLeft:(0,g.jsx)(mP.default,{}),children:"Logs"}),(0,g.jsx)(D.View,{grow:!0}),(0,g.jsx)(A.Surface,{css:[{boxShadow:"inset 0 -1px 0 ".concat(P.tokens.outlineDimmest)}],p:8,children:(0,g.jsx)(d5.ButtonLink,{text:"Docs",href:aZ.LINKS_DOCS.EXTENSIONS,target:"_blank",rel:"noopener",variant:"outlined",size:"small",iconLeft:(0,g.jsx)(g7.default,{}),css:[i9.rcss.display.inlineFlex]})})]})}),(0,g.jsx)("div",{css:[i9.rcss.flex.grow(1),i9.rcss.align.center,i9.rcss.justify.center,i9.rcss.width("100%"),i9.rcss.display.flex,i9.rcss.overflow("hidden")],children:(0,g.jsxs)(m9.TabPanels,{children:[(0,g.jsx)(m9.TabPanel,{id:"home",css:[i9.rcss.height("100%"),i9.rcss.p(12),i9.rcss.maxWidth(g_.PANE_CONTENT_MAX_WIDTH),i9.rcss.display.flex,i9.rcss.width("100%"),i9.rcss.justify.center,i9.rcss.overflowY("scroll")],children:(0,g.jsx)(mI,{performPaneOperation:n,setSelectedTab:i})}),(0,g.jsx)(m9.TabPanel,{id:"releases",css:[i9.rcss.height("100%"),i9.rcss.width("100%"),i9.rcss.overflowY("scroll")],children:(0,g.jsx)(m5,{performPaneOperation:n})}),(0,g.jsx)(m9.TabPanel,{id:"logs",css:[i9.rcss.height("100%"),i9.rcss.width("100%")],children:(0,g.jsx)(mD,{})})]})})]})})})}var vn=ey.Type.Object({type:ey.Type.Literal("extensionDevtools")}),vt={Content:function(e){var n=e.options.performPaneOperation;return(0,g.jsx)(ve,{performPaneOperation:n})},Icon:function(e){var n=e.size;return(0,g.jsx)(sP.default,{size:n})},getTitle:function(){return"Extensions Devtools"},description:"Manage and debug workspace extensions",category:ga.PaneCategory.WorkspaceExtensions,decode:function(e){return so.Value.Decode(vn,e)}},vr=e.i(678486),vi=e.i(495954);function va(e){var n=ra(tB),t=(0,oi.useInstallExtension)(),r=(0,oi.useUninstallExtension)(),i=(0,or.useExtensions)(),a=(0,N.useCallback)(function(t,r){if("cover"===t){if(null===r)return void a("store",null);n({paneId:e.paneId,pane:{type:"extensionStore",data:{coverPageExtensionId:null!=r?r:null,page:"cover"}}})}else n({paneId:e.paneId,pane:{type:"extensionStore",data:{page:t}}})},[n,e.paneId]);if("cover"===e.page){var o,s,l=null!=(s=null==(o=i.find(function(n){return n.extensionId===e.coverPageExtensionId}))?void 0:o.installationId)?s:null;return(0,g.jsx)(vr.ExtensionCoverPage,{existingInstallationId:l,extensionId:e.coverPageExtensionId,goBackToStore:function(){return a("store",null)},installExtension:function(){return(0,ei._)(function(){var n;return(0,ea._)(this,function(r){switch(r.label){case 0:return[4,t({extensionId:e.coverPageExtensionId,replId:null})];case 1:if(!(n=r.sent()))throw Error("Failed to install extension");return[2,(0,a0.asInstallationId)(n.id)]}})})()},uninstallExtension:function(e){return(0,ei._)(function(){return(0,ea._)(this,function(n){switch(n.label){case 0:return[4,r({installationId:e,replId:null})];case 1:return n.sent(),[2]}})})()}})}return(0,g.jsx)(vi.default,{storeMode:"pane",openExtensionCover:function(e){return a("cover",e)},setPage:function(e){return a(e,null)},page:e.page})}var vo=ey.Type.Union([ey.Type.Object({page:ey.Type.Union([ey.Type.Literal("store"),ey.Type.Literal("manage")])}),ey.Type.Object({page:ey.Type.Literal("cover"),coverPageExtensionId:ey.Type.Unsafe(ey.Type.String())})]),vs=ey.Type.Object({type:ey.Type.Literal("extensionStore"),data:vo}),vl={Content:function(e){return(0,g.jsx)(va,(0,r$._)((0,v._)({},e.pane.data),{paneId:e.options.paneId}))},Icon:function(e){var n=e.size;return(0,g.jsx)(ps.IconContext.Provider,{value:{color:P.tokens.yellowStronger,size:n},children:(0,g.jsx)(sP.default,{})})},getTitle:function(){return"Extension Store"},description:"Find and install workspace extensions",category:ga.PaneCategory.WorkspaceExtensions,decode:function(e){return so.Value.Decode(vs,e)}},vu=e.i(257042),vc=ey.Type.Object({type:ey.Type.Literal("replAuth")}),vd=e.i(353384),vp={Content:vu.default,Icon:function(e){var n=e.size;return(0,g.jsx)(ps.IconContext.Provider,{value:{color:P.tokens.orangeStrongest,size:n},children:(0,g.jsx)(vd.default,{})})},getTitle:function(){return"Authentication"},description:"Let users log in to your App using a prebuilt login page or customize your own button",category:ga.PaneCategory.CloudServices,decode:function(e){return so.Value.Decode(vc,e)}},vf=function(e){var n;null==(n=e.focus)||n.call(e)};function vh(e){var n=e.isValid,t=e.move,r=e.focus,i=void 0===r?vf:r,a=e.wrap,o=void 0!==a&&a,s=e.selector,l=e.boundary,u=(0,N.useRef)(null);return(0,N.useEffect)(function(){if(u.current){var e=u.current,r=function(r){if(!n(r))return;if(s)p=(0,er._)(e.querySelectorAll(s));else{var a;a=e.querySelectorAll('a[href],button,input,textarea,select,details,[tabindex]:not([tabindex="-1"])'),p=(0,er._)(a)}if(0!==p.length){var u=document.activeElement;if(e.contains(u)){if(s)if(l){var c=null==u?void 0:u.closest(l),d=null==u?void 0:u.closest(s);u=d||(null==c?void 0:c.querySelector(s))}else u=null==u?void 0:u.closest(s);if(s&&(!u||!e.contains(document.activeElement))){r.preventDefault(),r.stopPropagation();var p,f,h=null==(f=document.activeElement)?void 0:f.querySelector(s);h?i(h):i(p[0]);return}if(!u){r.preventDefault(),r.stopPropagation(),i(p[0]);return}var g=p.findIndex(function(e){return e===u});if(-1===g){r.preventDefault(),r.stopPropagation(),i(p[0]);return}var m=t({event:r,children:p,activeIndex:g,activeElement:u});!o&&(m<0||m>p.length-1)||(i(m<0?p[p.length-1]:m>p.length-1?p[0]:p[m]),r.stopPropagation(),r.preventDefault())}}};return e.addEventListener("keydown",r),function(){e.removeEventListener("keydown",r)}}},[l,n,t,i,u,s,o]),u}var vg=e.i(712516),vm=e.i(624782),vv=e.i(752723),vx=(0,rl.cssRecord)({queryPill:[i9.rcss.display.inline,i9.rcss.fontSize(P.tokens.fontSizeDefault)],popover:[{"& > .popover-control-container":i9.rcss.mr(0)}]});function vy(e){var n=e.text;return(0,g.jsx)(vm.Pill,{css:vx.queryPill,text:0===n.length?"":n})}function vw(e){var n=e.query,t=e.replacement,r=e.numMatches,i=e.onCancel,a=e.onConfirm;return(0,g.jsxs)(D.View,{gap:8,p:12,children:[(0,g.jsxs)(D.View,{children:[(0,g.jsxs)(a8.Text,{children:["Replace ",(0,g.jsx)(vy,{text:n})," with"," ",(0,g.jsx)(vy,{text:t})," in"," ",(0,uE.default)("match",r,!0),"?"]}),(0,g.jsx)(a8.Text,{children:"This operation cannot be undone!"})]}),(0,g.jsxs)(D.View,{row:!0,gap:12,justify:"end",children:[(0,g.jsx)(a4.Button,{onClick:function(){return i()},text:"Cancel"}),(0,g.jsx)(a4.Button,{colorway:"negative",onClick:function(){return a()},text:"Yes, replace ".concat((0,uE.default)("match",r,!0)),iconLeft:(0,g.jsx)(vv.default,{})})]})]})}function vb(e){var n=e.disabled,t=e.loading,r=e.query,i=e.replacement,a=e.results,o=e.replace,s=e.onReplace,l=e.buttonProps,u=(0,U._)((0,N.useState)(!1),2),c=u[0],d=u[1],p=(0,N.useMemo)(function(){return a.reduce(function(e,n){return e+n.lines.reduce(function(e,n){return e+n.matches.length},0)},0)},[a]);return(0,g.jsx)(D.View,{css:vx.popover,children:(0,g.jsxs)(dt.PopoverTrigger,{onOpenChange:d,label:"Confirm replace all",isOpen:c,children:[(0,g.jsx)(a4.Button,(0,r$._)((0,v._)({},l),{text:"Replace all",disabled:n||t,onClick:function(){d(function(e){return!e})}})),(0,g.jsx)(vw,{query:r,replacement:i,numMatches:p,onCancel:function(){return d(!1)},onConfirm:function(){return(0,ei._)(function(){return(0,ea._)(this,function(e){switch(e.label){case 0:return d(!1),(0,el.track)(eu.events.SEARCH_PANE_USED,{action:"replace"}),[4,o()];case 1:return e.sent().success&&s(),[2]}})})()}})]})})}var v_=e.i(551959),vj=(0,rl.cssRecord)({self:[i9.rcss.position.relative,i9.rcss.flex.shrink(1),i9.rcss.width("100%")],iconWrapper:[i9.rcss.position.absolute,i9.rcss.top(0),i9.rcss.right(0),i9.rcss.height("100%"),i9.rcss.p(4)]}),vS=(0,N.forwardRef)(function(e,n){var t,r=e.onClear,i=(0,uc._)(e,["onClear"]);return(0,g.jsxs)(D.View,{css:vj.self,children:[(0,g.jsx)(v_.MultiLineInputWithHistory,(0,v._)({ref:n},i)),((null==(t=i.value)?void 0:t.length)||0)>0?(0,g.jsx)(D.View,{css:vj.iconWrapper,children:(0,g.jsx)(ct.IconButton,{alt:"Clear search query",tooltipBehavior:"hidden",onClick:r,css:{"&:hover":{backgroundColor:"".concat(P.tokens.backgroundHighest," !important")}},children:(0,g.jsx)(ud.default,{})})}):null]})});vS.displayName="SearchInput";var vI=e.i(294751),vC=e.i(163793),vk=e.i(790486),vE=(0,rl.cssRecord)({self:[i9.rcss.width("fit-content"),i9.rcss.display.inlineBlock,i9.rcss.color.accentNegativeDefault,i9.rcss.fontWeight.bold]});function vT(e){var n=e.content;return(0,g.jsx)(g.Fragment,{children:n.split("\n").reduce(function(e,n,t){return null===e?[n]:(0,er._)(e).concat([(0,g.jsx)(D.SpecializedView.span,{css:vE.self,children:"\\n"},"".concat(n,"-").concat(t)),n])},null)})}var vP=e.i(352701),vR=D.SpecializedView.span,vA="SearchMatch",vD=((c=vD||{}).HIGHLIGHT="highlight",c.REMOVE="remove",c.ADD="add",c.TEXT="text",c);function vV(e){return{outlineColor:e,outlineWidth:"1px",outlineStyle:"solid"}}var vO=(0,rl.cssRecord)((h={self:[i9.rcss.width("fit-content"),i9.rcss.display.inline,i9.rcss.cursor.pointer,{"&:focus-visible":[i9.rcss.focusRing]},i9.rcss.mx(1),i9.rcss.px(2),i9.rcss.borderRadius(4)]},(0,E._)(h,"highlight",[i9.rcss.backgroundColor.accentPrimaryDimmest,vV(P.tokens.accentPrimaryDimmer)]),(0,E._)(h,"remove",[i9.rcss.backgroundColor.accentNegativeDimmest,vV(P.tokens.accentNegativeDimmer),{textDecoration:"line-through"}]),(0,E._)(h,"add",[i9.rcss.backgroundColor.accentPositiveDimmest,vV(P.tokens.accentPositiveDimmer)]),(0,E._)(h,"hiddenTextWrapper",[i9.rcss.display.inlineBlock,i9.rcss.mx(2),{"& > div":[i9.rcss.display.inlineBlock],transform:"translateY(12.5%)"}]),(0,E._)(h,"firstHiddenTextWrapper",[i9.rcss.ml(0)]),(0,E._)(h,"lastHiddenTextWrapper",[i9.rcss.mr(0)]),h));function vF(e){var n=e.content,t=e.matches,r=e.dedentBy,i=e.replacement,a=e.isRegex,o=e.query,s=e.onOpenAtPosition;return(0,g.jsx)(g.Fragment,{children:(function(e){for(var n=e.content,t=e.matches,r=e.dedentBy,i=e.replacement,a=[],o=r,s=0;s<t.length;s++){var l=t[s],u=l.start+l.length;a.push({start:o,end:l.start,type:"text"});var c=n.substring(l.start,u);i.length>0&&i!==c?(a.push({start:l.start,end:u,type:"remove"}),a.push({start:-1,end:u,type:"add"})):a.push({start:l.start,end:u,type:"highlight",matchIndex:s}),o=u}return a.push({start:o,end:n.length,type:"text"}),a})({content:n,matches:t,dedentBy:r,replacement:i}).map(function(e,t,r){var l=e.start,u=e.end,c=e.type,d="".concat(l,"-").concat(u),p=u-l;if("text"===c){var f=r[t+1];if(0===t&&p>50)return(0,g.jsxs)(N.Fragment,{children:[(0,g.jsx)(vR,{css:[vO.hiddenTextWrapper,vO.firstHiddenTextWrapper],children:(0,g.jsx)(ct.IconButton,{size:18,alt:"Jump to hidden text",onClick:function(){s(u-50)},children:(0,g.jsx)(vP.default,{})})},d),(0,g.jsx)("span",{children:n.substring(u-50,u)})]},d);if(t===r.length-1&&p>50)return(0,g.jsxs)(N.Fragment,{children:[(0,g.jsx)("span",{children:n.substring(l,l+50)}),(0,g.jsx)(vR,{css:[vO.hiddenTextWrapper,vO.lastHiddenTextWrapper],children:(0,g.jsx)(ct.IconButton,{size:18,alt:"Jump to hidden text",onClick:function(){s(l+50)},children:(0,g.jsx)(vP.default,{})})},d)]},d);if(f&&p>100)return(0,g.jsxs)(N.Fragment,{children:[(0,g.jsx)("span",{children:n.substring(l,l+50)}),(0,g.jsx)(vR,{css:vO.hiddenTextWrapper,children:(0,g.jsx)(ct.IconButton,{size:18,alt:"Jump to hidden text",onClick:function(){s(l+50)},children:(0,g.jsx)(vP.default,{})})},d),(0,g.jsx)("span",{children:n.substring(u-50,u)})]},d)}var h=-1===l?i:n.substring(l,u);if("text"===c)return(0,g.jsx)(N.Fragment,{children:h},d);var m=null,v=r[t-1];return"add"===c&&(null==v?void 0:v.type)==="remove"&&(m=n.substring(v.start,v.end)),(0,g.jsx)(vM,{content:h,type:c,isRegex:a,query:o,replacement:i,removedText:m,onClick:function(e){e.stopPropagation(),s(u)}},d)})})}function vM(e){var n=e.content,t=e.type,r=e.isRegex,i=e.replacement,a=e.query,o=e.removedText,s=(0,uc._)(e,["content","type","isRegex","replacement","query","removedText"]),l=n,u=void 0;switch(t){case"highlight":u="Matched text ".concat(l);break;case"remove":u="Removed text ".concat(l);break;case"add":if(u="Added text ".concat(l),r&&null!==o)try{l=o.replace(new RegExp(a),i.replaceAll(/\$[&`']/g,"$$$&"))}catch(e){}}return(0,g.jsx)(D.SpecializedView.span,(0,r$._)((0,v._)({css:[vO.self,vO[t]],tabIndex:0,"aria-label":u,role:"button","data-nav":vA},s),{children:"add"===t?(0,g.jsx)(vT,{content:l}):l}))}var vL=(0,rl.cssRecord)({self:[i9.rcss.width("100%"),i9.rcss.flex.wrap],text:[i9.rcss.display.block,i9.rcss.textAlign.center,{overflow:"visible",whiteSpace:"normal"}]});function vG(e){var n=e.error;return(0,g.jsxs)(D.View,{css:vL.self,pt:8,pb:8,row:!0,gap:4,align:"center",justify:"center",children:[(0,g.jsx)(dm.default,{}),(0,g.jsx)(a8.Text,{css:vL.text,multiline:!1,children:n})]})}var vU=e.i(8412),vN=e.i(717639),vB="SearchLine",vW="--search-line-number-width",vz=(0,rl.cssRecord)({self:[i9.rcss.overflow("hidden"),i9.rcss.cursor.pointer,i9.rcss.borderRadius(4),{"&:focus-visible":[i9.rcss.focusRing],"&:hover, &:focus-visible":[i9.rcss.backgroundColor.backgroundHighest]}],content:[i9.rcss.font.code,i9.rcss.maxWidth("100%"),i9.rcss.width("fit-content"),{whiteSpace:"pre-wrap",overflowWrap:"break-word"}],lineNumberWrapper:[i9.rcss.display.inlineBlock,i9.rcss.color.foregroundDimmest,i9.rcss.mr(8),i9.rcss.pl(8)],lineNumber:[i9.rcss.display.inlineBlock,i9.rcss.textAlign.right,{width:"var(".concat(vW,")")}]});function vH(e){var n=e.lineNumber,t=e.content,r=e.matches,i=e.path,a=e.dedentBy,o=e.onFileLineClicked,s=(0,uc._)(e,["lineNumber","content","matches","path","dedentBy","onFileLineClicked"]),l=(0,J.default)(function(){return function(e){(0,el.track)(eu.events.SEARCH_PANE_USED,(0,v._)({action:"result_clicked"},s)),o({path:i,lineNumber:n,columnNumber:e})}},[n,s,i,o]),u=(0,J.default)(function(){return function(){var e=r.length>0?r[0]:null;l(e?e.start+e.length:0)}},[r,l]);return(0,g.jsxs)(D.View,{tabIndex:0,css:vz.self,row:!0,gap:8,align:"stretch","data-nav":vB,onKeyDown:function(e){"Enter"===e.key&&(e.preventDefault(),e.stopPropagation(),u())},onClick:u,children:[(0,g.jsx)(D.View,{css:vz.lineNumberWrapper,children:(0,g.jsx)(D.View,{tag:"span",css:vz.lineNumber,"aria-label":"Line ".concat(n),children:n})}),(0,g.jsx)("pre",{css:vz.content,children:(0,g.jsx)(vF,{isRegex:s.isRegex,content:t,matches:r,dedentBy:a,query:s.query,replacement:s.replacement,onOpenAtPosition:l})})]})}var vq=e.i(965153),vK="SearchFileNav",v$="SearchFileHeaderNav",vQ="SearchQueryNav",vY="SearchQueryTogglesNav",vX=parseInt(P.values.space24,10)+10,vJ=(0,rl.cssRecord)({header:[i9.rcss.rowWithGap(4),i9.rcss.align.center,i9.rcss.rowWithGap(6),i9.rcss.flex.growAndShrink(1),i9.rcss.overflow("hidden")],headerParentPathText:[i9.rcss.flex.shrink(1e7)],headerFileNameText:[i9.rcss.flex.shrink(1)],headerMatchesCountPill:[i9.rcss.height(20),i9.rcss.flex.shrink(0)],accordionWrapper:[i9.rcss.mx(4),i9.rcss.border({direction:"top",color:P.tokens.outlineDimmest})],accordionChildren:[i9.rcss.p(4)],linesWrapper:[i9.rcss.overflow("hidden"),i9.rcss.borderRadius(4),i9.rcss.font.code]});function vZ(e){var n=e.path,t=e.lines,r=e.dedentBy,i=e.isFirst,a=e.expanded,o=e.onClick,s=e.scrollOffset,l=e.onFileLineClicked,u=e.searchResultBackgroundColor,c=(0,uc._)(e,["path","lines","dedentBy","isFirst","expanded","onClick","scrollOffset","onFileLineClicked","searchResultBackgroundColor"]),d=(0,lw.usePreferences)("fontSize").preferences.fontSize,p=(0,N.useRef)(null),f=(0,J.default)(function(){return t.reduce(function(e,n){return e+n.matches.length},0)},[t]),h=(0,J.default)(function(){var e=t[t.length-1];if(!e)return{};var n=(0,vN.getDigits)(e.lineNumber),r=(0,vU.lineHeightFromFontSize)(d);return(0,E._)({fontSize:d,lineHeight:r},vW,"".concat(n,"ch"))},[t,d]);return(0,g.jsx)(A.Surface,{css:vJ.accordionWrapper,style:h,"data-nav":vK,innerRef:p,children:(0,g.jsx)(vq.AccordionItem,{expanded:void 0===a||a,onClick:function(){o(p.current)},headerProps:{"data-nav":"".concat(v$," ").concat(vB," ").concat(i?"".concat(vQ," ").concat(vY):""),style:{position:"sticky",zIndex:1,insetBlockStart:"-".concat(void 0===s?0:s,"px"),borderRadius:0,backgroundColor:u}},headerContent:(0,g.jsxs)(D.View,{css:vJ.header,children:[(0,g.jsx)(lW.default,{path:n,size:16}),(0,g.jsx)(a8.Text,{css:vJ.headerFileNameText,multiline:!1,children:(0,ic.getFileName)(n)}),(0,g.jsx)(a8.Text,{color:"dimmest",css:vJ.headerParentPathText,multiline:!1,children:(0,ic.getParentPath)(n).replace(/^\.\//,"")}),(0,g.jsx)(vm.Pill,{variant:"muted",text:"".concat(f," ").concat((0,uE.default)("match",f)),css:vJ.headerMatchesCountPill})]}),children:(0,g.jsx)(D.View,{css:vJ.accordionChildren,children:(0,g.jsx)(D.View,{css:vJ.linesWrapper,children:t.map(function(e){return(0,g.jsx)(vH,(0,r$._)((0,v._)({},e,c),{path:n,dedentBy:r,onFileLineClicked:l}),e.lineNumber)})})})})})}var v0=e.i(254806),v1=e.i(15260),v2=e.i(419735),v4=(0,rl.cssRecord)({container:[i9.rcss.border({direction:"bottom",color:P.tokens.outlineDimmest})],actions:[i9.rcss.display.flex,i9.rcss.rowWithGap(4)]});function v8(e){var n="collapse"===e.collapseExpandAllState;return(0,g.jsxs)(D.View,{css:v4.container,p:4,row:!0,align:"center",justify:"space-between",children:[(0,g.jsxs)(a8.Text,{color:"dimmer",children:[e.totalCount," results in ",(0,uE.default)("file",e.fileCount,!0)]}),(0,g.jsxs)(D.View,{css:v4.actions,children:[(0,g.jsx)(ct.IconButton,{alt:"Open New Search",onClick:e.onStartNewSearch,children:(0,g.jsx)(v2.default,{})}),(0,g.jsx)(ct.IconButton,{alt:n?"Collapse All":"Expand All",onClick:e.onToggleCollapseExpandAll,children:n?(0,g.jsx)(v0.default,{}):(0,g.jsx)(v1.default,{})})]})]})}var v3=e.i(189920),v6=(0,ur.keyframes)({from:{opacity:0},to:{opacity:1}}),v5=(0,rl.cssRecord)({listWrapper:[i9.rcss.overflowY("auto"),i9.rcss.flex.grow(1),{contain:"strict"}],list:[i9.rcss.width("100%"),i9.rcss.position.relative],listItem:[i9.rcss.position.absolute,i9.rcss.top(0),i9.rcss.left(0),i9.rcss.width("100%")],resultRow:[{animation:"".concat(v6," 120ms linear forwards")}]});function v9(e){var n,t,r,i,a,o,s,l,u,c,d=e.results,p=e.error,f=e.paneRef,h=e.onFileLineClicked,m=e.onOpenSearchPane,x=e.searchResultBackgroundColor,y=(0,uc._)(e,["results","error","paneRef","onFileLineClicked","onOpenSearchPane","searchResultBackgroundColor"]),w=(0,J.default)(function(){return d.filter(function(e){return e.lines.length>0})},[d]),b=(0,J.default)(function(){return w.reduce(function(e,n){return e+n.lines.reduce(function(e,n){return e+n.matches.length},0)},0)},[w]),_=(0,U._)((0,N.useState)({}),2),j=_[0],S=_[1],I=(0,N.useRef)(null),C=(0,vk.useVirtualizer)({count:w.length,getScrollElement:function(){return I.current},estimateSize:function(e){var n;return function(e,n){var t=e.length;if(n)for(var r=n-24,i=0;i<e.length;i++){var a=e[i],o=9*(0,vN.getDigits)(i)+9*a.content.length+4*a.matches.length;o>r&&(t+=Math.floor(r/o)+1)}return vX+20+24.39*t+2*t}(w[e].lines,null==f||null==(n=f.current)?void 0:n.offsetWidth)},overscan:3}),k=C.getVirtualItems(),T=(0,N.useRef)(null),P=(0,N.useCallback)(function(e){var n=I.current;if(n&&T.current!==e){if(e.matches('[data-nav*="'.concat(v$,'"]')))return void e.focus();var t=e.closest('[data-nav="'.concat(vK,'"]')),r=null==t?void 0:t.querySelector('[data-nav*="'.concat(v$,'"]'));if(!r)return void e.focus();var i=r.getBoundingClientRect();if(r.offsetTop+i.height>e.offsetTop){var a=e.offsetTop-i.height;T.current=e;var o=function(){n.scrollTop===a&&(n.removeEventListener("scroll",o),T.current===e&&(e.focus(),T.current=null))};n.addEventListener("scroll",o),n.scrollTo({top:a})}else e.focus()}},[]),R=(n={selector:'[data-nav*="'.concat(v$,'"]'),boundary:'[data-nav*="'.concat(vK,'"]')},t=(0,N.useCallback)(function(e){return"Tab"===e.key},[]),r=(0,N.useCallback)(function(e){var n=e.event,t=e.activeIndex;return n.shiftKey?t-1:t+1},[]),vh((0,r$._)((0,v._)({},n),{isValid:t,move:r}))),A=(i={selector:'[data-nav*="'.concat(vB,'"]'),focus:P},a=(0,N.useCallback)(function(e){return"ArrowUp"===e.key||"ArrowDown"===e.key},[]),o=(0,N.useCallback)(function(e){var n=e.event,t=e.activeIndex;return"ArrowUp"===n.key?t-1:t+1},[]),vh((0,r$._)((0,v._)({},i),{isValid:a,move:o}))),V=(s={selector:'[data-nav*="'.concat(vA,'"]'),focus:P},l=(0,N.useCallback)(function(e){return"ArrowLeft"===e.key||"ArrowRight"===e.key},[]),u=(0,N.useCallback)(function(e){var n=e.event,t=e.activeIndex;return"ArrowLeft"===n.key?t-1:t+1},[]),vh((0,r$._)((0,v._)({},s),{isValid:l,move:u}))),O=(0,vC.mergeRefs)(R,A,V),F=(0,J.default)(function(){return w.length===Object.keys(j).length&&Object.values(j).every(Boolean)},[j,w.length]),M=null;return w.length>0?M=(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(v8,{fileCount:w.length,totalCount:b,collapseExpandAllState:F?"expand":"collapse",onToggleCollapseExpandAll:function(){F?S({}):S(w.reduce(function(e,n){return(0,r$._)((0,v._)({},e),(0,E._)({},n.path,!0))},{}))},onStartNewSearch:m}),(0,g.jsx)(D.SpecializedView.div,{ref:I,css:v5.listWrapper,children:(0,g.jsx)(D.View,{css:v5.list,style:{height:C.getTotalSize()},children:(0,g.jsx)(D.View,{css:v5.listItem,style:{transform:"translateY(".concat(null==(c=k[0])?void 0:c.start,"px)")},innerRef:O,children:k.map(function(e){var n,t=w[e.index],r=t.path;return(0,g.jsx)(D.SpecializedView.div,{"data-index":e.index,ref:C.measureElement,css:v5.resultRow,children:(0,g.jsx)(vZ,(0,r$._)((0,v._)({},t,y),{scrollOffset:null==(n=k[0])?void 0:n.start,onFileLineClicked:h,isFirst:0===e.index,expanded:!0!==j[r],searchResultBackgroundColor:x,onClick:function(e){if(S(function(e){return(0,r$._)((0,v._)({},e),(0,E._)({},r,!(r in e)||!e[r]))}),I.current&&e){var n,t,i=Math.floor(null!=(t=null==(n=k[0])?void 0:n.start)?t:0),a=Math.floor(I.current.scrollTop),o=e.offsetTop+i;o>a||I.current.scrollTo({top:o-1})}}}))},e.key.toString())})})})})]}):p===v3.SearchError.EMPTY_RESULTS&&(M=(0,g.jsx)(vg.default,{pane:{type:"searchReplace"},headerText:p})),(0,g.jsxs)(g.Fragment,{children:[p&&p!==v3.SearchError.EMPTY_RESULTS?(0,g.jsx)(vG,{error:p}):null,M]})}var v7=e.i(316346);function xe(e){return(0,N.useMemo)(function(){return(0,er._)((0,v7.splitGlobAware)(e,",")).map(function(e){return e.trim()}).filter(function(e){return e.length>0})},[e])}var xn=((d={}).QUERY_EMPTY="The query is empty",d.QUERY_SAME="The query is the same as replacement",d.NO_MATCHES="No matches were found to replace",d.RG_EMPTY="Ripgrep didn't return a response",d.NOT_MOUNTED="Component wasn't mounted",d),xt=e.i(431544);e.i(694906);var xr=e.i(55449),xi=e.i(406393),xa=e.i(606296),xo=e.i(542932),xs=e.i(597512),xl=e.i(874721),xu="SearchQueryControlsNav",xc="SearchQueryExcludeNav",xd="SearchQueryControlsColumnNav",xp=(0,ur.keyframes)({from:{transform:"scaleX(0)"},to:{transform:"scaleX(0.9)"}}),xf=i9.container.min(360),xh=(0,rl.cssRecord)({self:[i9.rcss.height("100%"),i9.rcss.width("100%"),i9.rcss.overflow("hidden"),i9.rcss.px(4),i9.rcss.container()],filesIncludeExcludeWrapper:[i9.rcss.mt(6),i9.rcss.border({direction:"top",color:P.tokens.outlineDimmest}),(0,E._)({},xf,[i9.rcss.rowWithGap(6),i9.rcss.align.start,i9.rcss.mt(0),{border:"none"}])],inputWithLabel:[i9.rcss.flex.growAndShrink(1),i9.rcss.colWithGap(1)],inputLabelText:[{userSelect:"none"},i9.rcss.color.foregroundDimmest,i9.rcss.truncate,{fontSize:P.tokens.fontSizeSmall}],inputLabel:[i9.rcss.flex.shrink(1),i9.rcss.m(0),{lineHeight:1}],input:[i9.rcss.viewStyle,i9.rcss.border(),{blockSize:P.tokens.space32,"::placeholder":{color:P.tokens.foregroundDimmest},"&:hover::placeholder":{color:P.tokens.foregroundDimmer},"&:focus::placeholder, &:hover:focus::placeholder":{color:P.tokens.foregroundDimmest},":not([disabled])":{cursor:"text",":focus":{boxShadow:"none"}}}],optionsWrapper:[i9.rcss.rowWithGap(2),i9.rcss.align.center,(0,E._)({order:2},xf,[{order:1," > *":i9.rcss.height("100%")}])],closeWrapper:[(0,E._)({order:1},xf,{order:2," > *":i9.rcss.height("100%")})],results:[i9.rcss.position.relative,{flex:"1 1 auto"}],searchWrapper:[{flex:"0 1 auto"}],expandCollapseButton:[i9.rcss.height(32)],searchInputAndOptionsWrapper:(0,E._)({flex:1,display:"grid",gap:4,gridTemplateColumns:"1fr max-content"},xf,{gridTemplateColumns:"1fr max-content max-content"}),replacementWrapper:[i9.rcss.ml(24),i9.rcss.pl(4),i9.rcss.pb(6)],replaceInputWrapper:[i9.rcss.border({direction:"top",color:P.tokens.outlineDimmest}),(0,E._)({},xf,[i9.rcss.rowWithGap(4),i9.rcss.pt(0),i9.rcss.align.center,{border:"none"}])],loadingBar:[i9.rcss.position.absolute,i9.rcss.mt(2),i9.rcss.height(1),i9.rcss.borderRadius(2),i9.rcss.width("100%"),i9.rcss.backgroundColor.accentPrimaryDimmer,{animation:"".concat(xp," 20s 1s ease forwards"),transformOrigin:"center left",transform:"scaleX(0)"}]});function xg(e){var n=e.updateData,t=e.query,r=e.setQuery,i=e.isRegex,a=e.setIsRegex,o=e.isCaseSensitive,s=e.setIsCaseSensitive,l=e.isMatchingWholeWords,u=e.setIsMatchingWholeWords,c=e.isCollapsed,d=e.setIsCollapsed,p=e.executeSearch,f=e.searchInputRef,h=e.onCloseRequested;return(0,g.jsxs)(D.View,{css:xh.searchWrapper,pb:4,row:!0,gap:4,children:[(0,g.jsx)(ct.IconButton,{onClick:function(){return d(function(e){return!e})},alt:c?"Show replacement options":"Hide replacement options",css:xh.expandCollapseButton,children:c?(0,g.jsx)(pd.default,{}):(0,g.jsx)(p5.default,{})}),(0,g.jsxs)(D.View,{css:xh.searchInputAndOptionsWrapper,children:[(0,g.jsx)(vS,{"data-nav":"".concat(vQ," ").concat(xu),ref:f,autoSize:!0,placeholder:"Search",value:t,css:xh.input,onChange:function(e){r(e),n({initialQuery:e})},onClear:function(){r(""),n({initialQuery:""})},onKeyDown:function(e){"Enter"!==e.key||(0,un.getCmdOrCtrl)(e)||e.shiftKey||(e.preventDefault(),e.stopPropagation(),p())}}),(0,g.jsxs)(D.View,{css:xh.optionsWrapper,children:[(0,g.jsx)(vI.default,{alt:"case sensitive","data-nav":"".concat(xu," ").concat(xd),icon:(0,g.jsx)(xo.default,{}),checked:o,onClick:function(){return s(function(e){return!e})}}),(0,g.jsx)(vI.default,{alt:"regular expressions","data-nav":"".concat(xu," ").concat(xd),icon:(0,g.jsx)(xs.default,{}),checked:i,onClick:function(){return a(function(e){return!e})}}),(0,g.jsx)(vI.default,{alt:"whole words","data-nav":"".concat(xu," ").concat(xd),icon:(0,g.jsx)(xl.default,{}),checked:l,onClick:function(){return u(function(e){return!e})}})]}),(0,g.jsx)(D.View,{css:xh.closeWrapper,row:!0,gap:2,align:"center",children:h?(0,g.jsx)(ct.IconButton,{onClick:h,alt:"Close",children:(0,g.jsx)(ud.default,{})}):null})]})]})}function xm(e){var n=e.updateData,t=e.replacement,r=e.setReplacement,i=e.query,a=e.replaceLoading,o=e.search,s=e.includeGlob,l=e.setIncludeGlob,u=e.excludeGlob,c=e.setExcludeGlob,d=e.replace,p=e.results;return(0,g.jsxs)(D.View,{css:xh.replacementWrapper,children:[(0,g.jsxs)(D.View,{css:xh.replaceInputWrapper,pt:8,gap:6,children:[(0,g.jsx)(vS,{"data-nav":"".concat(vQ," ").concat(xu," ").concat(xc),autoSize:!0,placeholder:"Replacement",value:t,css:xh.input,onChange:function(e){r(e),n({initialReplacement:e})},onClear:function(){r(""),n({initialReplacement:""})}}),(0,g.jsx)(D.View,{css:xh.optionsWrapper,children:(0,g.jsx)(vb,{query:i,replacement:t,results:p,disabled:0===i.length,loading:a,replace:d,onReplace:o,buttonProps:{"data-nav":"".concat(xu," ").concat(vY," ").concat(xd)}})})]}),(0,g.jsxs)(D.View,{css:xh.filesIncludeExcludeWrapper,pt:8,gap:8,children:[(0,g.jsxs)(D.View,{css:xh.inputWithLabel,id:"filesToInclude",children:[(0,g.jsx)("label",{htmlFor:"filesToIncludeInput",css:xh.inputLabel,children:(0,g.jsx)(a8.Text,{css:xh.inputLabelText,color:"dimmer",multiline:!1,children:"Files to include"})}),(0,g.jsx)(vS,{id:"filesToIncludeInput","data-nav":"".concat(vQ," ").concat(xu),autoSize:!0,value:s,css:xh.input,placeholder:"e.g. **.js, src/**, app/",onChange:function(e){l(e),n({initialIncludeGlob:e})},onClear:function(){l(""),n({initialIncludeGlob:""})}})]}),(0,g.jsxs)(D.View,{css:xh.inputWithLabel,id:"filesToExclude",children:[(0,g.jsx)("label",{htmlFor:"filesToExcludeInput",css:xh.inputLabel,children:(0,g.jsx)(a8.Text,{css:xh.inputLabelText,color:"dimmer",multiline:!1,children:"Files to exclude"})}),(0,g.jsx)(vS,{id:"filesToExcludeInput","data-nav":"".concat(xu," ").concat(xc),autoSize:!0,value:u,css:xh.input,onChange:function(e){c(e),n({initialExcludeGlob:e})},onClear:function(){c(""),n({initialExcludeGlob:""})}})]})]})]})}function xv(e){var n,t,r,i,a,o,s,l,u,c,d,p,f,h,m,x,y,w,b,_,j,S,I,C,k,E,T,P,R,A,V,O,F,M,L,G,B,W,z,H,q,K=e.isActive,$=e.initialQuery,Q=void 0===$?"":$,Y=e.initialReplacement,Z=void 0===Y?"":Y,ee=e.initialIncludeGlob,en=void 0===ee?"":ee,et=e.initialExcludeGlob,eo=void 0===et?"":et,es=e.searchInputRef,ec=e.onDataChanged,ed=e.onFileLineClicked,ep=e.onOpenSearchPane,ef=e.onCloseRequested,eh=e.searchResultBackgroundColor,eg=(0,U._)((0,N.useState)(Q),2),em=eg[0],ev=eg[1],ex=(0,U._)((0,N.useState)(Z),2),ey=ex[0],ew=ex[1],eb=(0,U._)((0,N.useState)(!1),2),e_=eb[0],ej=eb[1],eS=(0,U._)((0,N.useState)(!1),2),eI=eS[0],eC=eS[1],ek=(0,U._)((0,N.useState)(!1),2),eE=ek[0],eT=ek[1],eP=(0,U._)((0,N.useState)(!0),2),eR=eP[0],eA=eP[1],eD=(0,U._)((0,N.useState)(eo),2),eV=eD[0],eO=eD[1],eF=(0,U._)((0,N.useState)(en),2),eM=eF[0],eL=eF[1],eG=xe(eV),eU=xe(eM),eN=(0,N.useRef)(null),eB=(t=(n={query:em,isRegex:e_,isCaseSensitive:eI,isMatchingWholeWords:eE,excludeGlobs:eG,includeGlobs:eU}).query,r=n.isRegex,i=n.isCaseSensitive,a=n.isMatchingWholeWords,s=void 0===(o=n.includeGlobs)?[]:o,u=void 0===(l=n.excludeGlobs)?[]:l,d=(c=(0,ot.default)()).container,p=c.dotReplit,f=(0,xi.useHiddenFilesGlobPatterns)(p),h=(0,X.useFlag)({controlName:"flag-code-search-latency-metrics",logFlagToAnalytics:!1}),x=(m=(0,U._)((0,N.useState)([]),2))[0],y=m[1],b=(w=(0,U._)((0,N.useState)(null),2))[0],_=w[1],S=(j=(0,U._)((0,N.useState)(t.length>0),2))[0],I=j[1],C=(0,J.default)(function(){return(0,er._)(u).concat((0,er._)(f||[]),(0,er._)(xr.ignoredDirs))},[u,f]),k=d.getConnectionState(),E=(0,N.useMemo)(function(){return(0,xa.default)({container:d,onError:function(e){return _(e)},onUpdate:function(e){return y(e)},onLoadingStateChange:function(e){return I(e)},isStreaming:!0,trackLatency:h})},[]),(0,N.useEffect)(function(){k===os.ConnectionState.CONNECTED&&E({query:t,isRegex:r,isCaseSensitive:i,isMatchingWholeWords:a,includeGlobs:s,excludeGlobs:C})},[k,E,t,r,i,a,s,C,f]),{loading:S,error:b,data:x,search:function(){return E({query:t,isRegex:r,isCaseSensitive:i,isMatchingWholeWords:a,includeGlobs:s,excludeGlobs:C})}}),eW=eB.loading,ez=eB.error,eH=eB.data,eq=eB.search;(0,d2.default)(function(){""!==em&&(0,el.track)(eu.events.SEARCH_PANE_USED,{action:"search",isRegex:e_,isCaseSensitive:eI,hasIncludes:eU.length>0,hasExcludes:eG.length>0})},[em,eU,eG,e_,eI],1e3);var eK=(P=(T={replacement:ey,query:em,isRegex:e_,isCaseSensitive:eI,isMatchingWholeWords:eE,excludeGlobs:eG,includeGlobs:eU,fileList:ez?void 0:eH}).query,R=T.replacement,A=T.fileList,V=(0,uc._)(T,["query","replacement","fileList"]),O=(0,ot.default)().container,M=(F=(0,U._)((0,N.useState)(!1),2))[0],L=F[1],B=(G=(0,U._)((0,N.useState)(null),2))[0],W=G[1],H=(z=(0,U._)((0,N.useState)(!1),2))[0],q=z[1],{replace:(0,N.useCallback)(function(){return(0,ei._)(function(){var e;return(0,ea._)(this,function(n){switch(n.label){case 0:var t;return q(!0),W(null),[4,(t=(0,v._)({container:O,query:P,replacement:R,fileList:null==A?void 0:A.map(function(e){return e.path})},V),(0,ei._)(function(){var e,n,r,i,a,o,s,l,u;return(0,ea._)(this,function(c){switch(c.label){case 0:if(n=t.container,r=t.fileList,0===(i=(0,uc._)(t,["container","fileList"])).query.length)return[2,{success:!1,errorOn:"exit",errorMessage:xn.QUERY_EMPTY}];if(i.query===i.replacement)return[2,{success:!1,errorOn:"exit",errorMessage:xn.QUERY_SAME}];if(!(r&&r.length>0))return[3,1];return a=r,[3,3];case 1:return[4,(o=n).exec.apply(o,(0,er._)((0,xt.createSearchCommand)((0,r$._)((0,v._)({},i),{context:1,mode:"files"}))))];case 2:if((l=c.sent()).error)return[2,{success:!1,errorOn:"rg",errorMessage:"exit status 1"===l.error?xn.NO_MATCHES:l.error}];a=(null==(s=l.output)?void 0:s.split("\n").filter(function(e){return e.trim().length>0}))||[],c.label=3;case 3:var d,p,f,h,g,m,x,y;if(0===a.length)return[2,{success:!1,errorOn:"rg",errorMessage:xn.NO_MATCHES}];return[4,(e=n).exec.apply(e,(0,er._)((p=(d=i).replacement,f=d.query,h=d.isRegex,g=d.isCaseSensitive,m=d.isMatchingWholeWords,x=["sd"],y=[f.indexOf("\n")>=0?"m":"e",g?"c":"i"],m&&y.push("w"),x.push("--flags",y.join("")),!h&&x.push("--string-mode"),f.startsWith("-")&&(f="\\"+f),x.push(f,p),x)).concat((0,er._)(a)))];case 4:if((u=c.sent()).error)return[2,{success:!1,errorOn:"sd",errorMessage:u.error}];return[2,{success:!0}]}})})())];case 1:return(e=n.sent()).success||W(e.errorMessage),q(!1),L(e.success),[2,e]}})})()},[O,P,R,A,V]),loading:H,error:B,data:M}),e$=eK.loading,eQ=eK.replace,eY=(0,N.useCallback)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};null==ec||ec({initialQuery:em,initialReplacement:ey,initialIncludeGlob:eM,initialExcludeGlob:eV},e)},[ec,em,ey,eV,eM]);(0,N.useLayoutEffect)(function(){ev(Q),ew(Z),eL(en),eO(eo)},[Q,Z,en,eo]);var eX=vh({selector:'[data-nav*="'.concat(vQ,'"]'),isValid:function(e){var n="ArrowUp"===e.key||"ArrowDown"===e.key,t=e.target.matches('[data-nav*="'.concat(vQ,'"]')),r=e.target.matches("[data-nav*=".concat(v$,"]"));return n&&t&&(e.altKey||r)},move:function(e){var n=e.event,t=e.activeIndex;return n.preventDefault(),n.stopPropagation(),"ArrowUp"===n.key?t-1:t+1}}),eJ=vh({selector:'[data-nav*="'.concat(vY,'"]'),isValid:function(e){var n="ArrowUp"===e.key||"ArrowDown"===e.key,t=e.target.matches('[data-nav*="'.concat(vY,'"]')),r=e.target.matches("[data-nav*=".concat(v$,"]"));return n&&t&&!r},move:function(e){var n=e.event,t=e.activeIndex;return n.preventDefault(),n.stopPropagation(),"ArrowUp"===n.key?t-1:t+1}}),eZ=vh({selector:'[data-nav*="'.concat(xd,'"]'),isValid:function(e){var n="ArrowUp"===e.key||"ArrowDown"===e.key;if(e.target.matches('[data-nav*="'.concat(vY,'"]'))&&"ArrowDown"===e.key)return!1;var t=e.target.matches('[data-nav*="'.concat(xd,'"]'));return n&&t},move:function(e){var n=e.event,t=e.activeIndex,r=e.children,i=n.target.matches('[data-nav*="'.concat(vY,'"]'));return(n.preventDefault(),n.stopPropagation(),i)?0:0===t&&"ArrowUp"===n.key?-1:r.length-1}}),e0=vh({selector:'[data-nav*="'.concat(xc,'"]'),isValid:function(e){var n="ArrowUp"===e.key||"ArrowDown"===e.key,t=e.target.matches('[data-nav*="'.concat(xc,'"]')),r=e.target.matches("[data-nav*=".concat(vQ,"]"));return n&&e.altKey&&t&&!r},move:function(e){var n=e.event,t=e.activeIndex;return n.preventDefault(),n.stopPropagation(),"ArrowUp"===n.key?t-1:t+1}}),e1=vh({selector:'[data-nav*="'.concat(xu,'"]'),isValid:function(e){var n="ArrowLeft"===e.key||"ArrowRight"===e.key,t=e.target.matches('[data-nav*="'.concat(xd,'"]'));return n&&(e.altKey||t)},move:function(e){var n=e.event,t=e.activeIndex;return n.preventDefault(),n.stopPropagation(),"ArrowLeft"===n.key?t-1:t+1}}),e2=(0,ou.useMergeRefs)([eX,eJ,eZ,e0,e1],{breadcrumb:"client/workspace/components/SearchReplace/index.tsx:661"}),e4=(0,N.useCallback)(function(e){"Escape"===e.key&&(null==ef||ef())},[ef]);return(0,g.jsxs)(D.View,{css:xh.self,innerRef:e2,onKeyDown:e4,children:[(0,g.jsx)(xg,{isActive:K,query:em,setQuery:ev,updateData:eY,isRegex:e_,isCaseSensitive:eI,isMatchingWholeWords:eE,setIsRegex:ej,setIsCaseSensitive:eC,setIsMatchingWholeWords:eT,isCollapsed:eR,setIsCollapsed:eA,executeSearch:eq,searchInputRef:es,onCloseRequested:ef}),eR?null:(0,g.jsx)(xm,{replacement:ey,setReplacement:ew,updateData:eY,query:em,replaceLoading:e$,search:eq,includeGlob:eM,setIncludeGlob:eL,excludeGlob:eV,setExcludeGlob:eO,replace:eQ,results:eH}),(0,g.jsxs)(D.View,{css:xh.results,children:[eW?(0,g.jsx)(D.View,{css:xh.loadingBar},em):null,0===em.length&&0===eH.length?(0,g.jsx)(vg.default,{pane:{type:"searchReplace"},bodyText:"Enter a search query above to see results."}):(0,g.jsx)(v9,{isRegex:e_,query:em,replacement:ey,include:eM,exclude:eV,results:eH,error:ez,paneRef:eN,onOpenSearchPane:ep,onFileLineClicked:ed,searchResultBackgroundColor:eh})]})]})}var xx=ey.Type.Object({type:ey.Type.Literal("searchReplace"),data:ey.Type.Optional(ey.Type.Object({initialQuery:ey.Type.Optional(ey.Type.String()),initialReplacement:ey.Type.Optional(ey.Type.String()),initialIncludeGlob:ey.Type.Optional(ey.Type.String()),initialExcludeGlob:ey.Type.Optional(ey.Type.String())}))}),xy={Content:function(e){var n=e.pane,t=e.options;return(0,g.jsx)(xb,{paneData:(null==n?void 0:n.data)||{},isActive:t.isActive,performPaneOperation:t.performPaneOperation})},Icon:function(e){var n=e.size;return(0,g.jsx)(s8.default,{size:n})},getTitle:function(e){var n,t=null==e||null==(n=e.data)?void 0:n.initialQuery;return t&&t.length>0?"Code Search: ".concat(t):"Code Search"},description:"Search through the text contents of your App",category:ga.PaneCategory.WorkspaceFeatures,decode:function(e){return so.Value.Decode(xx,e)}},xw=(0,rl.cssRecord)({wrapper:[i9.rcss.height("100%"),i9.rcss.width("100%")]});function xb(e){var n=e.paneData,t=e.isActive,r=e.performPaneOperation,i=(0,N.useRef)(null),a=(0,N.useCallback)(function(){var e,n;null==(e=i.current)||e.select(),null==(n=i.current)||n.focus()},[]);(0,aR.useSetPaneBindings)(function(){return{type:"searchReplace",focusSearchInput:a}},[a]),(0,aR.useSetFocusTarget)(function(){return{focus:a}},[a]);var o=(0,N.useCallback)(function(e){r({operation:"open",pane:{type:"codeEditor",data:{path:e.path,line:e.lineNumber,col:e.columnNumber}},secondary:!0})},[r]),s=(0,N.useCallback)(function(){r({operation:"commit"}),r({operation:"open",pane:{type:"searchReplace"}})},[r]),l=(0,N.useCallback)(function(e,n){r({operation:"replace",pane:{type:"searchReplace",data:(0,v._)({},e,n)}})},[r]);return(0,g.jsx)(D.View,{css:xw.wrapper,pt:6,children:(0,g.jsx)(xv,(0,r$._)((0,v._)({},n),{isActive:t,searchInputRef:i,onFileLineClicked:o,onOpenSearchPane:s,onDataChanged:l,searchResultBackgroundColor:P.tokens.backgroundDefault}))})}var x_=e.i(446692),xj=e.i(180703),xS=e.i(917375),xI=e.i(411928),xC=e.i(952685),xk=e.i(49416),xE=e.i(91442),xT=(0,er._)(["workspace-guided-tour-data-app","workspace-guided-tour-portfolio-website"]).concat(["100-days-of-python","100-days-of-python-promo","add-guest-new-user","agent-banner","agent-disclaimer","ai-image-generation-banner","apps-announcement","appsOnboardingForkRepl","appsOnboardingRunRepl","appsOnboardingSelectRepl","april_2019_hiring","archive-cta","assignment_markdown","boosts-modal","bounties-home-module","bounties-services-tab","changelog-banner","classroom-repl-talk-ask-on-error","cleanup-popover-dismissed","codemirror-explorers-banner","create-model-solution","credit-packs-banner","createWebsite","curriculum-launch-modal","custom-themes-banner","custom-domain-purchase-announcement","cycles-release","cycles-survey","dashboard_new_folder","dashboard_search","dashboard_templates","debugger_start","dec172020maintenance","deployment-analytics-dot","deployments-banner","deployments-mobile-download","deployments-synced-secrets","desktop-app-banner","desktop-app-nav-menu","devtools-intro","discount_hacker_18","discount_holiday_19","discount_newyear_19","downtime-073118","draw-new-user-cta","edfest-announcement","enveditorintro","expo-qr-preview-pane","expo-go-mobile-preview-nudge","file_tree","flexible-spend-announcement","follow-cursor-avatar-click","ghostwriter-banner","ghostwriter-chat-banner","ghostwriter-repl-resources-cta","ghostwriter-trial-repl-resources-cta","ghostwriter-trial-3-day-left-modal","ghostwriter-trial-banner","ghostwriter-trial-expired-modal","ghostwriter-post-purchase-tour","ghostwriter-existing-user-chat-beta-tour","grid_click","hacker_upgrade","hacker-gift","header-layout-tooltip","home","home-feed","home-onboarding-checklist","home-onboarding-checklist-apps","home-onboarding-checklist-learn","home-onboarding-checklist-repl","home-page-modules-tooltip","home-page-demo-repl-tour-suggestion","hosting_url","introduceYourself","js-4-day-challenge-day-1","js-4-day-challenge-day-2","js-4-day-challenge-day-3","js-4-day-challenge-day-4","js-4-day-challenge-day-end","july_2019_music_jam","july18_irl","landing","languagesInterestedIn","launch-modal","learn-onboarding","legacy-cycles-grant-notice","make_website","march_2019_game_jam","migrate-to-deployments-banner","migrated_unnamed_repls","mobile-app-banner","mobile-app-banner-web-update","mobile-announcement","mobile-new-workspace-banner","mobile-survey-banner-11042021","move_unnamed_repls","repricing-announcement","multiplayer","multiplayer_invite","multiplayer_welcome","new_in_repls","new_share","nft-world-2022","onboarding_connection_toast","onboarding_run","onboarding-simplify-experiment","onboarding-upsell-seen","packager-shell-hint","packman","prettier-formatter","product_hunt","profile-refresh-beta","profile2","projects-overview-cta","projects-overview-tests-disclaimer","publish-guidelines","repl_stars","repl-con-2022","repl-talk-update-2021","repl-talk-update-2022","replit-teams-onboarding-tour","resources-upgrade-modal","revisions_history","run_on_replit","saw_unnamed_folders","search","self-grouping-projects-cta","series-b-announcement","share_classroom","share_repl_to_talk","show_packager_about_tooltip","show_packager_import_tooltip","show_test_update_tooltip","stack-create-cta","stack-migration-cta","summer_hacker","summer-2021-pd-survey","teams_pro_module","teams-grading-survey","teams-pro-2022","template-jam-announcement","threads-2-announcement","upgrade_module","usage-migration-reserved-vms","usage-migration-power-ups-free-user","usage-migration-power-ups-core-user","workspace-always-on-user-reserved-deployments-announcement","workspace-assistant-auto-apply-changes","workspace-assistant-auto-restart-repl","workspace-assistant-intro-video","workspace-deployments-webview-banner","workspace-desktop-tour","workspace-desktop-tour19","workspace-experience-task-completion-survey-06022022","workspace-experience-task-completion-survey-nudge-06022022","workspace-guided-tour-data-app","workspace-guided-tour-portfolio-website","workspace-history-announcement","workspace-ssh-connect-to-vscode-config-tour","workspace-tools-databases-postgres-tour","workspace-repo-projects-tour","youtube-in-the-ws","themes-announcement","extensions-onboarding-checklist","extensions-onboarding-checklist-create","extensions-onboarding-checklist-concepts","extensions-onboarding-checklist-api","extensions-onboarding-checklist-publish","extensions-store-info","external-claim-privacy-warning","gcp-docs-landing-screen","trending-home-module","following-home-module","storage-announcement","pro-onboarding-tour","pro-trial-expired","pro-trial-hcaptcha-fail","pro-trial-enrollment","ai-code-completion","replit-ai-chat-onbording-10-2023","workspace-desktop-new-user-tour","workspace-desktop-tour-2024","workspace-desktop-tour-2025","workspace-bonsai-tour-2025","workspace-desktop-sidebar-tour","replit-core-banner","hosting-deployments-announcement-7-2023","teams-for-education-deprecation-12-2023","teams-for-education-verification-prompt","usage-based-billing-announcement-1-2024","port-nudges","mobileApp-themes-announcement","mobileApp-server-change-CTA","mobileApp-purchase-subscription-announcement","mobileApp-onboarding-education-announcement","mobileApp-teams-coming-soon-announcement","incident-20240219-action-required-banner","incident-20250711-refund-banner","scheduled-deployments-banner","quick-start-guides","teams-projects-onboarding-card","onboarding-purchase-seen","replit-teams-banner","integrations-toast","starter-changes-announcement-aug-2024","private-deployments-banner","editors-have-secret-access-warning","workspace-right-sidebar-cta","assistant-now-defaulting-to-claude-3-5","org-roles-and-permissions-info-banner","onboarding-seen","teams-sponsorships-onboarding-card","agent-billing-notification-usage-page","agent-billing-notification-creation-entrypoint","agent-billing-creation-disclaimer","agent-billing-workspace-disclaimer","agent-billing-threshold-reached-warning","agent-billing-workspace-flex-credits-almost-reached","agent-billing-announcement","agent-billing-announcement-banner","drizzle-studio-announcement","freemium-agent-access-announcement","referral-program-banner","referral-pending-banner","post-verification-educational-upsell","invoice-threshold-change-announcement","agent-v2-welcome-modal","agent-v2-homepage-modal","agent-mobile-notification-nudge","visual-editor-callout","deterministic-edits-callout","image-gen-awareness-callout","bonsai-ws-agent-onboarding","queue-drawer-callout","viewer-seats-announcement","apps-private-by-default-announcement","agent-billing-v2-announcement","agent-billing-v2-home-banner","agent-chat-mode-intro-callout","effort-based-pricing-announcement","dynamic-intelligence-modal","expert-mode-acknowledged","agent-3-announcement-banner","workspace-deployment-pane-production-database-banner","workspace-database-pane-toggle-tour","max-autonomy-warning-acknowledged","design-mode-announcement-banner","free-fast-mode-announcement-banner","connectors-announcement-banner","agent-quick-edit-chat-footer-banner","agent-quick-edit-settings-banner","agent-chat-upsell-with-free-quick-edits-option","promo-high-power-model-announcement-tour","fast-promo-ended-tour","agent-high-power-model-toggle-info","agent-home-chat-mode-tour","agent-starter-fast-mode-enabled-banner"]),xP=function(e,n){var t,r=JSON.parse(nZ.default.get("".concat(e,"-tutorialChallenge-").concat(n),"string")||"{}");if("string"==typeof r.tourName&&"string"==typeof r.url&&(t=r.tourName,xT.includes(t)))return r},xR=function(e){var n=e.challenge,t=xT.find(function(e){return e.toString()===n.tourName})||"js-4-day-challenge-day-1",r=(0,mx.useDismissibleElement)(t),i=r.isDone,a=r.isLoading,o=r.setAsDone,s=(0,m.useRouter)();return a?null:(0,g.jsx)(a4.Button,{colorway:i?"primary":"positive",onClick:function(){o(),(0,el.track)(eu.events.TUTORIAL_DONE_BUTTON_COMPLETED),s.push("/~")},disabled:i,iconLeft:(0,g.jsx)(po.default,{}),size:"big",text:i?"Challenge completed!":"Complete Challenge"})},xA=((p=xA||{}).Ready="READY",p.Loading="LOADING",p.Error="ERROR",p),xD=function(e){var n=e.progress;return(0,g.jsx)(c6.Tooltip,{tooltip:"Progress: ".concat(Math.round(100*n*10)/10,"%"),children:(0,g.jsx)(D.View,{css:[i9.rcss.width("100%"),i9.rcss.height(4),i9.rcss.backgroundColor.backgroundHigher],children:(0,g.jsx)(D.View,{css:[i9.rcss.width("".concat(100*n,"%")),i9.rcss.height("100%"),i9.rcss.backgroundColor.purpleDefault]})})})},xV=ey.Type.Object({type:ey.Type.Literal("tutorial")}),xO={Content:function(){var e,n,t,r,i=(0,ot.default)().fs,a=(e=rr(i$),n=rr(iY),t=ra(iJ),n||!e?null:t),o=(0,dA.useSetTourStepTarget)(xS.newUserTour.id,xS.TourStepIds.Sidepane),s=(0,U._)((0,N.useState)([]),2),l=s[0],u=s[1],c=(0,U._)((0,N.useState)("LOADING"),2),d=c[0],p=c[1],f=(0,a2.default)(),h=(0,U._)((0,xj.default)("tutorialProgress--".concat(f),0),2),m=h[0],v=h[1],x=(0,U._)((0,N.useState)(!1),2),y=x[0],w=x[1],b=(0,N.useRef)(null),_=(0,a1.useCurrentUserId)(),j=_?_.toString():"",S=(0,xE.useGetCursorState)(),I=(0,xE.useCursorFilepath)(),C=(0,xC.default)(I),k=(0,J.default)(function(){return C?function(e){var n,t;return C({code:e,insertAt:null!=(t=null==(n=S())?void 0:n.position.offset)?t:"end"})}:void 0},[C,S]),E=xP(j,f),T=E?(0,g.jsx)(xR,{challenge:E}):null,R=(0,N.useCallback)(function(){b.current&&(b.current.scrollTop=0)},[b]);return((0,N.useEffect)(function(){var e=!1;return(0,ei._)(function(){var n,t,r,a,o,s,l,c,d,f,h,g,m,v;return(0,ea._)(this,function(x){switch(x.label){case 0:return p("LOADING"),[4,i.readDir(xk.TUTORIAL_DIR)];case 1:if(n=x.sent(),e)return[2];if(n.error)return p("ERROR"),[2];return t=[],[4,Promise.all(n.children.filter(function(e){var n;return e.type===tN.FileType.File&&(null==(n=x_.FileTypeRepository.from(e.filename))?void 0:n.id)==="markdown"}).map(function(e){var n="".concat(xk.TUTORIAL_DIR,"/").concat(e.filename);return Promise.all([n,i.readFile(n)])}))];case 2:if(r=x.sent(),e)return[2];a=!0,o=!1,s=void 0;try{for(l=r[Symbol.iterator]();!(a=(c=l.next()).done);a=!0)f=(d=(0,U._)(c.value,2))[0],(h=d[1]).error?p("ERROR"):(m=h.content.toString(),v=RegExp("^#\\s(?<title>.*)").exec(m),t.push({title:null==v||null==(g=v.groups)?void 0:g.title,content:m,path:f}))}catch(e){o=!0,s=e}finally{try{a||null==l.return||l.return()}finally{if(o)throw s}}return u(t),p("READY"),[2]}})})(),function(){e=!0}},[i]),(0,N.useEffect)(function(){l[m]||v(0)},[m,v,l]),"LOADING"===d)?(0,g.jsx)(D.View,{css:[i9.rcss.center],grow:!0,shrink:!0,children:(0,g.jsx)(cF.default,{})}):"ERROR"===d?(0,g.jsx)(D.View,{css:[i9.rcss.center],grow:!0,shrink:!0,children:(0,g.jsxs)(D.View,{css:[i9.rcss.center,i9.rcss.colWithGap(4)],children:[(0,g.jsx)(ud.default,{color:P.tokens.accentNegativeDefault}),(0,g.jsx)(a8.Text,{color:"dimmer",multiline:!1,children:"Failed to load tutorial"})]})}):0===l.length?(0,g.jsx)(D.View,{css:[i9.rcss.center],grow:!0,shrink:!0,children:(0,g.jsxs)(D.View,{css:[i9.rcss.center,i9.rcss.colWithGap(4)],children:[(0,g.jsx)(ud.default,{color:P.tokens.accentNegativeDefault}),(0,g.jsx)(a8.Text,{color:"dimmer",multiline:!1,children:"No tutorials found!"})]})}):y?(0,g.jsxs)(D.View,{css:[i9.rcss.overflowY("scroll"),i9.rcss.flex.growAndShrink(1),i9.rcss.p(8),i9.rcss.colWithGap(16)],children:[(0,g.jsx)(a8.Text,{variant:"headerDefault",multiline:!1,children:"Table of Contents"}),(0,g.jsx)(D.View,{grow:!0,shrink:!0,gap:8,children:l.map(function(e,n){return(0,g.jsxs)(D.View,{css:[m===n?i9.rcss.backgroundColor.backgroundHighest:i9.rcss.backgroundColor.backgroundHigher,i9.rcss.borderRadius(4),i9.rcss.rowWithGap(8),i9.rcss.align.center,i9.rcss.cursor.pointer,m===n?{outline:"solid 2px ".concat(P.tokens.outlineDimmest)}:{},{":hover":{outline:"solid 2px ".concat(P.tokens.outlineDimmest)}}],p:8,onClick:function(){v(n),w(!1)},children:[(0,g.jsx)(D.View,{css:[i9.rcss.backgroundColor.backgroundHighest,i9.rcss.width(20),i9.rcss.height(20),i9.rcss.borderRadius("full"),i9.rcss.center,{outline:"solid 1px ".concat(P.tokens.outlineDimmest)}],children:(0,g.jsx)(a8.Text,{variant:"small",color:"dimmest",multiline:!1,children:n+1})}),(0,g.jsx)(a8.Text,{css:[i9.rcss.maxWidth("80%")],multiline:!1,children:e.title})]},e.title)})})]}):(0,g.jsx)(D.View,{innerRef:o,css:[i9.rcss.height("100%")],children:(0,g.jsxs)(D.View,{dataCy:"tutorial-viewer-content",innerRef:b,css:[i9.rcss.overflowY("scroll"),i9.rcss.flex.growAndShrink(1),i9.rcss.p(16),i9.rcss.pb(48),i9.rcss.colWithGap(16)],children:[a?(0,g.jsx)(a4.Button,{text:"Show tutorial video",iconLeft:(0,g.jsx)(l2.default,{}),onClick:function(){return a()}}):null,T,l.length>1&&(0,g.jsx)(a4.Button,{text:"Table of Contents",iconLeft:(0,g.jsx)(m2.default,{}),onClick:function(){return w(!0)}}),(0,g.jsx)(xI.default,{fs:i,path:l[m].path,source:l[m].content,sourcePos:!1,onCodeInsert:k}),l.length>1&&(0,g.jsxs)(D.View,{css:[i9.rcss.position.absolute,i9.rcss.width("100%"),i9.rcss.left(0),i9.rcss.bottom(0),i9.rcss.overflow("hidden")],children:[(0,g.jsx)(xD,{progress:(m+1)/l.length}),(0,g.jsxs)(D.View,{css:[i9.rcss.width("100%"),i9.rcss.height(40),i9.rcss.align.center,i9.rcss.flex.row],children:[(0,g.jsx)(D.View,{tag:"button",css:[i9.rcss.backgroundColor.backgroundHigher,i9.rcss.cursor.pointer,i9.rcss.width(40),i9.rcss.height("100%")],p:8,justify:"center",onClick:function(){m>0&&(v(function(e){return e-1}),R())},children:m>0&&(0,g.jsx)(gG.default,{size:24})}),(0,g.jsx)(D.View,{tag:"button",css:[i9.rcss.height("100%"),i9.rcss.justify.spaceBetween,i9.rcss.backgroundColor.backgroundHighest,i9.rcss.align.center,i9.rcss.p(8),i9.rcss.cursor.pointer,{userSelect:"none"}],grow:!0,shrink:!0,row:!0,gap:8,onClick:function(){m<l.length-1&&(v(function(e){return e+1}),R())},children:m<l.length-1&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(a8.Text,{multiline:!1,css:[i9.rcss.flex.growAndShrink(1),i9.rcss.textAlign.left,i9.rcss.fontSize(P.tokens.fontSizeSubheadDefault)],children:[(0,g.jsxs)("span",{css:[i9.rcss.color.foregroundDimmer],children:["Next",l[m+1].title?": ":" page"]}),(0,g.jsx)("b",{children:null!=(r=l[m+1].title)?r:""})]}),(0,g.jsx)(pd.default,{size:24})]})})]})]})]})})},Icon:function(e){var n=e.size;return(0,g.jsx)(g7.default,{size:n})},getTitle:function(){return"Tutorial"},category:ga.PaneCategory.Other,decode:function(e){return so.Value.Decode(xV,e)}},xF=e.i(909478),xM=e.i(561132),xL=e.i(137218),xG=e.i(134405),xU=e.i(417120),xN=e.i(378042),xB=e.i(401135),xW=e.i(813453),xz=e.i(942314),xH=e.i(548364),xq=e.i(236906),xK=e.i(759967),x$={Content:function(e){var n,t,r=e.pane.data,i=e.options,a=i.performPaneOperation,o=i.paneId,s=(0,N.useRef)(null),l=(0,q.useSupportsAgent)(),u=(0,xK.useIsExpertMode)(),c=(0,cY.useIsAgentStackRepl)().isAgentStackRepl,d=(0,ot.default)(),p=d.ports,f=d.container,h=(0,xF.useOpenedAndForwardedPorts)(p),m=(0,N.useMemo)(function(){var e;return null!=(e=(0,xN.getInitialPort)(r,h))?e:80},[r,h]),x=(0,xB.useShowEmptyState)(m),y=(0,c3.default)(),w=y.didConnectOnce,b=y.didDisconnect,_=(0,N.useCallback)(function(e){a({operation:"open",secondary:!1,pane:e})},[a]),j=(0,N.useCallback)(function(){return _({type:"developer",data:{tab:["networking"]}})},[_]),S=(0,N.useCallback)(function(){return _({type:"deployments"})},[_]),I=null==r?void 0:r.previewScreenSize,C=(0,N.useCallback)(function(e){a({operation:"replace",pane:{type:"webview",data:(0,r$._)((0,v._)({},null!=r?r:{}),{previewScreenSize:e})}})},[r,a]),k=null==r||!r.expoPreviewGuide||r.expoPreviewGuide.shown,E=(0,N.useCallback)(function(e){a({operation:"replace",pane:{type:"webview",data:(0,r$._)((0,v._)({},null!=r?r:{}),{expoPreviewGuide:{shown:e}})}})},[r,a]),T=(0,xH.useDeploymentCommands)({openDeploymentsPane:S,includeSharing:!0}).getCommandGroups;return((0,aR.useSetPaneBindings)(function(){var e={type:"webview",refresh:function(){var e;null==(e=s.current)||e.refresh()},navigate:function(e,n){var t;null==(t=s.current)||t.navigateTo(e,n)}},n=T();return n.length>0?(0,r$._)((0,v._)({},e),{commands:n}):e},[T]),c)?(0,g.jsx)(xW.WebviewDisabledForAgentStack,{openPane:_}):!l||u||c?x?(0,g.jsx)(xz.default,{openNetworkingTool:j,didConnectOnce:w,didDisconnect:b}):(0,g.jsx)(xN.WebviewBrowser,{ref:s,initialPort:m,initialPath:null==r||null==(n=r.ports)?void 0:n.path,openPane:_,ports:p,container:f,previewScreenSize:I,setPreviewScreenSize:C,expoPreviewGuideShown:k,setExpoPreviewGuideShown:E,paneId:o}):(0,g.jsx)(xQ,{ref:s,initialPort:m,initialPath:null==r||null==(t=r.ports)?void 0:t.path,openPane:_,previewScreenSize:I,setPreviewScreenSize:C,expoPreviewGuideShown:k,setExpoPreviewGuideShown:E,paneId:o})},Icon:function(e){var n=e.size;return(0,g.jsx)(ps.IconContext.Provider,{value:{size:n},children:(0,g.jsx)(l0.default,{})})},getTitle:function(){return"Preview"},description:"Preview your App",category:ga.PaneCategory.WorkspaceFeatures,decode:xq.decode},xQ=(0,N.forwardRef)(function(e,n){var t=e.initialPort,r=e.initialPath,i=e.openPane,a=e.previewScreenSize,o=e.setPreviewScreenSize,s=e.expoPreviewGuideShown,l=e.setExpoPreviewGuideShown,u=e.paneId,c=(0,xG.useAgentAwareWebviewState)(),d=(0,ot.default)(),p=d.ports,f=d.container,h=(0,X.useFlag)({controlName:"flag-free-plan",default:!1}),m=(0,ds.useIsFreemiumStarterPlanUsersOwnRepl)().isFreemiumStarterPlanUsersOwnRepl,v=(0,dw.useGetAgentFreeUsage)(),x=v.agentUsage,y=v.agentUsageV2,w=v.loading,b=v.error,_=y?y.isUnderQuota:null==x?void 0:x.isUnderQuota,j=h&&!w&&!b&&m&&!1===_,S=c.state===xG.WebviewState.READY||c.state===xG.WebviewState.LAST_RESORT_READY,I=(0,da.useIsAgentWebDesignMockup)().isWebDesignMockup,C=(0,U._)((0,N.useState)(!1),2),k=C[0],E=C[1],T=(0,xU.useIsAgentOptimisticallyWorking)(),P=k&&(I||j);if(!S)return(0,g.jsx)(xL.AgentAwareWebviewNonReadyStates,{webviewState:c,openPane:i,isFreemiumUserOutOfAgentCredits:j});var R=c.state===xG.WebviewState.READY?c.presentPort:c.externalPort,A=c.state===xG.WebviewState.READY?c.presentRoute:r,D=function(){return E(!1)};return(0,g.jsxs)(g.Fragment,{children:[P&&T&&(0,g.jsx)(xM.AgentAwareWebviewPreviewSoonEmptyStateV2,{canDismiss:!0,onDismiss:D,isFreemiumUserOutOfAgentCredits:j}),P&&!T&&(0,g.jsx)(xM.AgentAwareWebviewRuntimeErrorCrashedEmptyState,{openPane:i,canDismiss:!0,onDismiss:D,isFreemiumUserOutOfAgentCredits:j}),(0,g.jsx)(xN.WebviewBrowser,{ref:n,initialPort:null!=R?R:t,initialPath:null!=A?A:r,ports:p,container:f,openPane:i,previewScreenSize:a,setPreviewScreenSize:o,expoPreviewGuideShown:s,setExpoPreviewGuideShown:l,paneId:u,onUnhandledExceptionChange:E})]})}),xY=e.i(835109),xX=e.i(676702),xJ=e.i(544880),xZ=e.i(637972),x0=e.i(643041);function x1(){var e=(0,x._)(["\n  query NotificationModalCheckMultiplayers($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        multiplayers {\n          id\n        }\n      }\n    }\n  }\n"]);return x1=function(){return e},e}var x2={},x4=(0,y.gql)(x1());function x8(){var e=(0,x._)(["\n  query BrowserNotifications($username: String!) {\n    user: userByUsername(username: $username) {\n      id\n      image\n    }\n  }\n"]);return x8=function(){return e},e}var x3=(0,y.gql)(x8()),x6=!1;function x5(){return"Notification"in window?"true"===nZ.default.get(x9,"string")?"dismissed":window.Notification.permission:"denied"}var x9="notifications/dismissedModal";function x7(e){nZ.default.set(x9,String(e))}var ye={};function yn(e){return(0,ei._)(function(e){var n,t,r,i,a,o,s,l,u,c,d;return(0,ea._)(this,function(p){switch(p.label){case 0:if(n=e.title,t=e.body,r=e.badge,i=e.icon,a=e.iconByUsername,o=e.tag,s=e.onClick,u=void 0===(l=e.cacheDuration)?0:l,!document.hidden&&document.hasFocus()||"granted"!==x5()||(c=Date.now(),o in ye&&ye[o]+u>c))return[2];if(!a)return[3,2];return[4,(0,ei._)(function(){var e,n;return(0,ea._)(this,function(t){switch(t.label){case 0:if(null===nJ.apolloClient)return[2];return[4,nJ.apolloClient.query({query:x3,variables:{username:a}})];case 1:return[2,null==(n=t.sent().data)||null==(e=n.user)?void 0:e.image]}})})()];case 1:i=p.sent(),p.label=2;case 2:return d=new window.Notification(n,{body:t,badge:r||"/public/images/logo-grayscale.png",icon:i||"/public/images/icon-square.png",tag:o}),setTimeout(function(){d.close()},1e4),d.addEventListener("click",function(){window.focus(),d.close()}),s&&d.addEventListener("click",s),ye[o]=c,[2]}})}).apply(this,arguments)}function yt(e){try{new Audio(e).play().catch(function(){})}catch(e){}}function yr(e){var n,t,r,i=e.replId,a=(0,U._)((0,N.useState)(!1),2),o=a[0],s=a[1],l=(0,dA.useIsTouring)(),u=(n={variables:{replId:i}},t=(0,v._)({},x2,n),w.useQuery(x4,t)).data,c=(null==u||null==(r=u.getRepl)?void 0:r.__typename)==="Repl"&&u.getRepl.multiplayers.length>0;(0,N.useEffect)(function(){l||!c||"default"===x5()&&s(!0)},[c,l]);var d=(0,N.useCallback)(function(){x7(!0),s(!1)},[]),p=(0,N.useCallback)(function(){return(0,ei._)(function(){return(0,ea._)(this,function(e){switch(e.label){case 0:return[4,(0,ei._)(function(){return(0,ea._)(this,function(e){switch(e.label){case 0:return[4,(0,ei._)(function(){return(0,ea._)(this,function(e){try{window.Notification.requestPermission().then()}catch(e){return[2,new Promise(function(e){window.Notification.requestPermission(function(n){e(n)})})]}return[2,window.Notification.requestPermission()]})})()];case 1:return e.sent(),x7(!1),[2]}})})()];case 1:return e.sent(),s(!1),[2]}})})()},[]);return o?(0,g.jsx)(az.Modal,{preventClose:!0,isOpen:!0,onRequestClose:d,children:(0,g.jsxs)(D.View,{gap:24,children:[(0,g.jsx)(a8.Header,{variant:"headerDefault",level:2,children:"Replit needs your permission to enable notifications."}),(0,g.jsx)(a8.Text,{children:"Never miss messages from your collaborators if you're in another tab or window."}),(0,g.jsxs)(D.View,{row:!0,gap:12,justify:"end",children:[(0,g.jsx)(a4.Button,{onClick:d,text:"Deny",iconLeft:(0,g.jsx)(ud.default,{})}),(0,g.jsx)(a4.Button,{text:"Allow notifications",colorway:"positive",iconLeft:(0,g.jsx)(po.default,{}),onClick:p})]})]})}):null}var yi=e.i(644826),ya=e.i(357210),yo=(0,P.cvarsFrom)("ResizeHandle.module.css",["--width","--height","--transform-x","--transform-y","--rotation","--z-index","--cursor"]),ys=(0,N.memo)(function(e){var n,t=function(e){var n,t,r,i,a,o,s,l,u,c=rz(e),d=rH(e),p=nV(d),f=nO(d),h=rq(e),g=(n=rz(e),(0,J.default)(function(){return(0,eg.selectAtom)(n,function(e){return!!e.snapped})},[n])),m=rK(e),v=(t=nV(rH(e)),r=rK(e),(0,J.default)(function(){return(0,eo.atom)(function(e){var n=e(t),i=n.width,a=n.height;return e(r)?i:a})},[t,r])),x=(i=rz(e),(0,J.default)(function(){return(0,eo.atom)(function(e){var n=e(i),t=n.snapped,r=n.stacked;return"right"===t?r?180:90:"left"===t?270*!r:0})},[i])),y=(a=rK(e),o=rq(e),s=nV(rH(e)),(0,J.default)(function(){return(0,eo.atom)(function(e){var n=e(s),t=n.width,r=n.height,i=e(o),l=e(a),u=e(nv);return l?{width:i?t:24,height:u?6:2}:{height:i?r:24,width:u?6:2}})},[s,a,o])),w=(l=nV(rH(e)),u=rK(e),(0,J.default)(function(){return(0,eo.atom)(function(e){var n=e(l),t=n.width,r=n.height;return(e(u)?t:r)<24})},[l,u]));return{handle:ri(c),size:ri(p),position:ri(f),isActive:ri(h),isSnapped:ri(g),isStacked:ri(m),length:ri(v),rotation:ri(x),gripSize:ri(y),gripIsHidden:ri(w)}}(e.handleId),r=(n=(0,N.useRef)(null),(0,nQ.useStyleSet)(n,t.size,function(e){var n,t=e.width,r=e.height;return n={},(0,E._)(n,yo.width,t+"px"),(0,E._)(n,yo.height,r+"px"),n}),(0,nQ.useStyleSet)(n,t.position,function(e){var n,t=e.x,r=e.y;return n={},(0,E._)(n,yo.transformX,Math.round(t)+"px"),(0,E._)(n,yo.transformY,Math.round(r)+"px"),n}),(0,nQ.useStyleSet)(n,t.isStacked,function(e){return(0,E._)({},yo.cursor,e?"row-resize":"col-resize")}),(0,nQ.useStyleSet)(n,t.isActive,function(e){return(0,E._)({},yo.zIndex,(e?rs.zIndexLevels.gutterActive:rs.zIndexLevels.gutter).toString())}),n),i=ra(rW),a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=(0,N.useRef)(e),t=ra(tw),r=ro(nx);return(0,N.useCallback)(function(i){i.snapped?t({leftPath:i.leftPath,percent:n.current}):Promise.resolve(r()).then(function(r){var a=eF(r,i.leftPath);if(!a||!eD(a))throw Error("Expected split or paneGroup");n.current=a.percent,t({leftPath:i.leftPath,percent:e})})},[e,t,r])}(),o=(0,N.useRef)(null),s=(0,uv.default)(t.isSnapped),l=(0,uv.default)(t.isStacked);return(0,g.jsx)(D.View,{align:"center",justify:"center",innerRef:r,clsx:[ya.default.root,(0,E._)({},ya.default.stacked,l)],onDoubleClick:function(){a(t.handle.current)},onPointerDown:function(e){(0,hS.measureMouseMove)(e,{start:function(){var e=t.handle.current;o.current=document.activeElement,i({type:"start",leftPath:e.leftPath,stacked:e.stacked})},move:function(e){i({type:"update",moveDelta:e.delta})},end:function(){var e,n;i({type:"end"}),null==(n=o.current)||null==(e=n.focus)||e.call(n)}})},onContextMenu:function(e){e.preventDefault(),e.stopPropagation()},children:s?(0,g.jsx)(yi.default,{className:"icon"}):(0,g.jsx)(D.View,{clsx:ya.default.grip})})}),yl=e.i(387948),yu=e.i(123111),yc=e.i(736451),yd=e.i(94366),yp=e.i(924748),yf=e.i(825606),yh=e.i(241939),yg=e.i(145864),ym=e.i(231346),yv=e.i(916438),yx="video.json",yy=(0,yv.join)(xk.TUTORIAL_DIR,yx);e.i(792e3);var yw=e.i(8808);function yb(){var e=(0,x._)(["\n  mutation HandlePortOpenedUpdateReplConfig($input: UpdateReplInput!) {\n    updateRepl(input: $input) {\n      repl {\n        id\n        config {\n          isVnc\n          isServer\n        }\n      }\n    }\n  }\n"]);return yb=function(){return e},e}var y_={},yj=(0,y.gql)(yb()),yS=e.i(801127),yI=e.i(37292),yC=e.i(374106),yk=e.i(986194),yE=e.i(19379),yT=e.i(584647),yP=e.i(943565),yR="/public/sounds/Achievement_Bell_Replit.wav",yA={direction:"reverse",state:{isExecutingPlan:!1},reducer:function(e,n){if(e.sender.type!==u2.UserType.AI)return!1;var t=e.contents.contents;switch(null==t?void 0:t.$kind){case"agentPlanEventContents":var r=t.agentPlanEventContents;if(!r)break;if(!0===r.requiresApproval)return n.notification={id:r.planId,text:"Plan is waiting for approval"},n.isExecutingPlan=!0,!1;if(n.isExecutingPlan&&r.step.subSteps.every(function(e){return e.status===u2.AgentPlanStepStatus.STEP_COMPLETE}))return n.notification={id:r.planId,text:"Plan has been completed!"},n.isExecutingPlan=!1,!1;break;case"agentAskUserForActionRequest":var i=t.agentAskUserForActionRequest.request;if((null==i?void 0:i.$kind)==="userSecretsRequest")return n.notification={id:e.id,text:"Agent needs secrets to proceed"},!1;return n.notification={id:e.id,text:"Agent has an update for you"},!1;case"agentTimelineEventContents":var a,o=t.agentTimelineEventContents,s=o.toolData,l=o.toolName;if((null==s?void 0:s.$kind)==="messageData"){switch(null==(a=s.messageData.agentAction.optionType)?void 0:a.$kind){case"messageButtonAction":return n.notification={id:e.id,text:"Agent has a question for you"},!1;case"secretRequestAction":return n.notification={id:e.id,text:"Agent needs secrets to proceed"},!1;case"deployRequestAction":return n.notification={id:e.id,text:"Agent needs your permission to publish the application"},!1}if("user_response"===l)return n.notification={id:e.id,text:"Agent has a question for you"},!1}}n.notification=void 0}};function yD(){var e=(0,x._)(["\n  query ReplEnvironmentNotifyUserJoin($id: String!) {\n    getRepl(id: $id) {\n      ... on Repl {\n        id\n        title\n      }\n    }\n  }\n"]);return yD=function(){return e},e}var yV=(0,y.gql)(yD()),yO=e.i(389320),yF=e.i(803542);function yM(){var e=(0,x._)(["\n  query TrackMultiplayer($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        multiplayers {\n          id\n        }\n        owner {\n          ... on Team {\n            id\n          }\n          ... on User {\n            id\n          }\n        }\n      }\n    }\n  }\n"]);return yM=function(){return e},e}var yL={},yG=(0,y.gql)(yM());function yU(){var e=ax(),n=(0,sC.useIsExtensionRepl)(),t=ro(nI),r=ra(tC);return(0,N.useCallback)(function(i){var a=!!i&&i.reveal;if(n)return void e({pane:{type:"runnerOutput"},activate:!1,commit:!0});var o=t().find(function(e){var n=(0,U._)(e,2);return"runnerOutput"===(n[0],n[1]).type});o||e({pane:{type:"runnerOutput"},activate:!1,reveal:!1}),a&&o&&r({paneId:o[0],activate:!0})},[n,t,e,r])}function yN(e,n,t){var r=rr(nP),i=ra(tU),a=ra(tC),o=ro(nI);(0,aM.useCommandBinding)(function(){if(r)return[e,function(){var e=o().find(function(e){return(0,U._)(e,2)[1].type===n.type});e?a({paneId:e[0],activate:!0}):i((0,r$._)((0,v._)({},t),{pane:n,activate:!0,placement:{type:"secondary"}}))}]},[r,i,a])}var yB=e.i(391542),yW=e.i(984826),yz=e.i(563209),yH=e.i(708648),yq=e.i(596378),yK=e.i(143480),y$=e.i(905890),yQ=e.i(681850),yY=e.i(349467),yX=e.i(402434),yJ=e.i(326333),yZ=e.i(8812),y0=e.i(239296),y1=e.i(829960),y2=e.i(387524),y4=e.i(104375);function y8(){var e=(0,x._)(["\n  query WorkspaceShowHiddenFiles($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        templateInfo {\n          label\n        }\n      }\n    }\n  }\n"]);return y8=function(){return e},e}var y3={},y6=(0,y.gql)(y8()),y5=e.i(423111),y9=e.i(646325),y7=e.i(416406),we=e.i(440560),wn=e.i(985430),wt=e.i(752310),wr=e.i(741740),wi=e.i(927938),wa=e.i(551544),wo=e.i(136780),ws=e.i(604026),wl=e.i(154488);function wu(e){var n,t,r,i,a,o,s,l,u,c,d,p,f,h,m,x,y,b,_,j,S,I,C,E,T,R,A,D,V,O,F,M,L,G,W,z,H,K,$,Q,Y,ee,en,et,er,eo,es,ec,ed,ep,ef,eh,eg,ev,ex,ey,ew,eb,e_,ej,eS,eI,eC,ek,eE,eT,eP,eR,eA,eD,eV,eF,eM,eL,eG,eU,eN,eB,eW,ez,eH,eq,eK,e$,eQ,eY,eX,eJ,eZ,e0,e1,e2,e4,e8,e3,e6,e5,e9,e7,ne,nn,nt,nr,ni,na,ns,nl,nc,nd,np,nf,nh,ng,ny,nw,nb,nj,nS,nI,nC,nk,nT,nR,nA,nD,nV,nO,nF,nM,nL,nG,nU,nB,nW,nz,nH,nq,nK,n$,nQ,nY,nX,nZ,n0,n1,n2=e.repl,n4=e.currentUser,n8=(0,ot.default)(),n3=n8.replspaceApi,n6=n8.dotReplit,n5=n8.container,n9=n8.ports;n=(0,ot.default)().lspnix,t=(0,lw.usePreferences)("codeIntelligence").preferences.codeIntelligence,r=(0,tb.useOpenFiles)().length>0,(0,N.useEffect)(function(){r&&t?n.enable():n.disable()},[n,t,r]),i=(0,U._)((0,yI.useBsod)(),1)[0],a=ra(te),o=(0,J.default)(function(){return(0,em.default)(a,1e3)},[a]),s=(0,dA.useIsTouring)(),l=(0,a2.default)(),u=s||i,(0,N.useEffect)(function(){var e=function(){o({replId:l,force:!1}),o.flush()};if(!u)return window.addEventListener("beforeunload",e),function(){window.removeEventListener("beforeunload",e)}},[o,l,u]),(0,N.useEffect)(function(){var e=function(){"hidden"===document.visibilityState&&o({replId:l,force:!1})};if(!u)return document.addEventListener("visibilitychange",e),function(){document.removeEventListener("visibilitychange",e)}},[o,l,u]),(0,N.useEffect)(function(){if(!u){var e=null;return function n(){e=setTimeout(function(){o({replId:l,force:!1}),n()},6e4)}(),function(){e&&clearTimeout(e)}}},[o,l,u]),(0,N.useEffect)(function(){if(!u)return function(){o({replId:l,force:!1}),o.flush()}},[o,l,u]),(0,yd.default)(),(0,wr.default)(),(0,wa.default)({workspaceType:"desktop"}),(0,N.useEffect)(function(){var e=function(e){"s"===e.key&&(0,un.getCmdOrCtrl)(e)&&e.preventDefault()};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}},[]),(0,wt.default)(),d=(c=(0,ot.default)()).container,p=c.presence,(0,N.useEffect)(function(){var e=p.onUserJoin(function(n){var t,r=null==(t=d.getContext())?void 0:t.repl;if(r){var i,a=n.username;return(i=r.id,(0,ei._)(function(){var e;return(0,ea._)(this,function(n){switch(n.label){case 0:if(!nJ.apolloClient)throw Error("Expected Apollo client");return[4,nJ.apolloClient.query({query:yV,variables:{id:i}})];case 1:return[2,(null==(e=n.sent().data)?void 0:e.getRepl.__typename)==="Repl"?e.getRepl.title:null]}})})()).then(function(e){e&&yn({title:"",body:"".concat(a," joined ").concat(e),tag:"".concat(r.id,"-").concat(a,"-joined"),iconByUsername:a,cacheDuration:9e5})}),function(){e()}}})},[p,d]),m=(0,lw.usePreferences)("agentAudioNotification").preferences.agentAudioNotification,x=(0,yE.usePageVisibility)(),_="control"!==(b=null!=(f=null==(y=(0,yP.useGetExperiment)("sound-on_v2")())?void 0:y.get("treatmentName"))?f:"control"),j="soundAndNoti"===b,S=(0,a2.default)(),I=(0,Z.useIsInMobileWorkspace)(),C=(0,lw.usePreferences)("agentAudioNotification").preferences.agentAudioNotification,(0,N.useEffect)(function(){var e,n;I||(e=["click","keydown","touchstart"],n=function(){if(!x6)try{new Audio("data:audio/mpeg;base64,SUQzBAAAAAABEVRYWFgAAAAtAAADY29tbWVudABCaWdTb3VuZEJhbmsuY29tIC8gTGFTb25vdGhlcXVlLm9yZwBURU5DAAAAHQAAA1N3aXRjaCBQbHVzIMKpIE5DSCBTb2Z0d2FyZQBUSVQyAAAABgAAAzIyMzUAVFNTRQAAAA8AAANMYXZmNTcuODMuMTAwAAAAAAAAAAAAAAD/80DEAAAAA0gAAAAATEFNRTMuMTAwVVVVVVVVVVVVVUxBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/zQsRbAAADSAAAAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/zQMSkAAADSAAAAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV").play().catch(function(){}),x6=!0}catch(e){}e.forEach(function(e){document.removeEventListener(e,n)})},e.forEach(function(e){document.addEventListener(e,n,{once:!0,passive:!0})}))},[I]),E=(0,N.useCallback)(function(e,n){C&&document.hidden&&!I&&yt(yR),j&&yn({title:"Replit",body:n,tag:"".concat(S,"-").concat(e),icon:"/public/icons/icon-maskable-512x512.png",cacheDuration:3e5})},[C,S,I,j]),T=(0,Z.useIsInMobileWorkspace)(),R=(0,u4.useChatter)(),A=(0,lL.useObservable)(R.sessions.agent.current),D=(0,N.useMemo)(function(){return null==A?void 0:A.reduce(yA,1)},[A]),V=null==A?void 0:A.agent.state,O=(0,N.useMemo)(function(){return V&&D?u8.Observable.combine(V,D):null},[V,D]),F=(0,N.useRef)(null),M=(0,N.useRef)(0),(0,hy.useObserver)(V,{next:function(e){if(e){var n=e.state,t=F.current;if(_&&m&&!x&&t===u2.AgentRunState.AGENT_STATE_RUNNING&&n===u2.AgentRunState.AGENT_STATE_PAUSED&&!T){var r=Date.now();r-M.current>=15e3&&(yt(yR),E("agent-paused-".concat(r),"Replit Agent finished working. Come back to check your results."),M.current=r)}F.current=n}}}),(0,hy.useObserver)(O,{next:function(e){var n=(0,U._)(e,2),t=n[0],r=n[1].notification;r&&(null==t?void 0:t.state)===u2.AgentRunState.AGENT_STATE_PAUSED&&E(r.id,r.text)}}),L=(0,yT.useCurrentAgentTestingTakeover)({sessionId:null!=(h=null==A?void 0:A.id)?h:null}),(0,N.useEffect)(function(){(null==L?void 0:L.request.status)==="pending"&&E(L.request.sessionId,"Agent needs your help with testing")},[L,E]),(0,u4.useChatHook)("received-completed-event",function(e){var n=e.event;if(_&&m&&!x&&(0,yC.isEventContentsKind)(n,"agentPlanEventContents")&&!T){var t=n.contents.contents,r=(0,yk.unkind)(t);if(n.sender.type===u2.UserType.AI&&r.requiresApproval){var i=Date.now();i-M.current>=5e3&&(yt(yR),E("agent-plan-ready-".concat(i),"Your Replit Agent needs your approval to continue."),M.current=i)}}}),(0,y0.default)(),(0,yJ.useLiveViewReplConnection)(),G=(0,ot.default)().presence,(0,N.useEffect)(function(){return G.onFollowingUsersChanged(function(e){var n=e.followingUsers,t=e.type,r=n.length;"follow"===t?(0,el.track)(eu.events.REMOTE_USER_CURSOR_FOLLOWED,{numFollowers:r}):(0,el.track)(eu.events.REMOTE_USER_CURSOR_UNFOLLOWED,{numFollowers:r})})},[G]),(0,wo.default)(),W=(0,ot.default)().presence,z=rr(nu),(0,N.useEffect)(function(){W.updateOpenFile(z)},[W,z]),K=(H=(0,a5.default)()).showConfirm,$=H.showNotice,Q=H.hideMessage,Y=H.showError,ee=(0,ot.default)().container,en=(0,N.useRef)(!1),(0,N.useEffect)(function(){var e=ee.onToast(function(e){e.startsWith("PANIC")||$(e,Math.max(1e4,e.length/.025+1e3))}),n=null,t=!1,r=ee.onConnectionStateChanged(function(e){if(n&&(Q(n),n=null),e===yw.ConnectionState.CONNECTED){t&&en.current&&(n=K("Connected",1500),en.current=!1),t=!0;return}if(t){if(e===yw.ConnectionState.CONNECTING){n=$("Reconnecting");return}if(e===yw.ConnectionState.DISCONNECTED){n=Y("Disconnected"),en.current=!0;return}}});return function(){n&&Q(n),e(),r()}},[ee,K,$,Y,Q]),et=(0,a5.default)().showConfirm,er=(0,ot.default)().fs,(0,N.useEffect)(function(){var e=er.registerOnFlushSuccess(function(e,n){if(n===tN.FlushSource.MANUAL_SAVE){var t="Saved ".concat(e);et(t,Math.max(1e4,t.length/.025+1e3))}});return function(){e()}},[er,et]),es=(eo=(0,a5.default)()).showNotice,ec=eo.showError,(0,cR.usePid2)(function(e,n){var t=n.signal;return(0,ei._)(function(){var n,r;return(0,ea._)(this,function(i){switch(i.label){case 0:return[4,e.pythonMigration.detectLegacyPython.rpc({},{signal:t})];case 1:if(!(n=i.sent()).ok||!n.payload.oldVenvDetected)return[2];return[4,e.pythonMigration.migratePython.rpc({},{signal:t})];case 2:if(!(r=i.sent()).ok)return"NOP"!==r.payload.code&&ec((0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("div",{children:"Failed to migrate legacy Python configuration."}),(0,g.jsx)("div",{children:"You may need to reinstall your Python packages, or contact support."})]}),1e4),[2];return es((0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("div",{children:"This Repl contained legacy Python configuration"}),(0,g.jsx)("div",{children:"and has been automatically migrated."})]}),1e4),[2]}})})()},[ec,es]),ed=rr(nP),ep=yU(),ef=(0,dA.useTourStep)(xS.newUserTour.id,xS.TourStepIds.Output),(0,N.useEffect)(function(){if(ed&&(null==ef?void 0:ef.isActive)){var e=setInterval(function(){ep()},200);return function(){clearInterval(e)}}},[null==ef?void 0:ef.isActive,ep,ed]),yN(lY.showShell.id,{type:"shell"}),yN(lY.showGit.id,{type:"git"}),yN(lY.showSettings.id,{type:"preferences"}),yN(lY.showConsole.id,{type:"runnerOutput"}),yN(lY.showReplitAi.id,{type:"ghostwriterChat"},{commit:!0}),(0,yW.default)(),eh=(0,ot.default)().presence,eg=aw(),(0,N.useEffect)(function(){return eh.onUserOpenedFile(function(e){var n=e.user,t=e.file,r=eh.getFollowedUser();!r||r.id!==n.id||t&&eg({path:t})})},[eh,eg]),ex=(ev=(0,U._)((0,N.useState)(null),2))[0],ey=ev[1],(0,N.useEffect)(function(){return eh.onFollowedUserChanged(ey)},[eh]),(0,N.useEffect)(function(){if(ex){var e=setTimeout(function(){document.addEventListener("click",n)},0);return function(){clearTimeout(e),document.removeEventListener("click",n)}}function n(){eh.unfollowUser()}},[ex]),ew=(0,y5.useSetAreHiddenFilesVisible)(),eS=(null==(ej=(eb={variables:{replId:(0,a2.default)()}},e_=(0,v._)({},y3,eb),w.useQuery(y6,e_)).data)?void 0:ej.getRepl.__typename)==="Repl"?ej.getRepl:null,(0,N.useEffect)(function(){var e;!eS||(null==(e=eS.templateInfo)?void 0:e.label.includes("Blank Repl"))&&ew(!0)},[ew,eS]),eI=ra(iX),eC=(0,ot.default)().fs,ek=(0,xk.default)().isTutorial,eE=(0,i6.default)(eI),(0,N.useEffect)(function(){if(ek){var e=!1,n=eC.watchDir(xk.TUTORIAL_DIR,{onChange:function(n){(0,ei._)(function(){var e;return(0,ea._)(this,function(t){switch(t.label){case 0:if(!n.find(function(e){return e.type===tN.FileType.File&&e.filename===yx}))return[2,null];return[4,eC.readFile(yy)];case 1:if((e=t.sent()).error)return[2,null];return[2,e.content.toString()]}})})().then(function(n){if(!e){if(!n)return void eE.current(null);var t=null;try{t=gj.evaluate(n)}catch(e){}var r=(void 0===t?"undefined":(0,eO._)(t))==="object"&&"string"==typeof t.embedUrl?t.embedUrl:null;eE.current(r?{embedUrl:r}:null)}})},onMoveOrDelete:function(){eE.current(null)},onError:function(){eE.current(null)}});return function(){e=!0,n()}}},[eC,ek,eE]),eT=(0,xk.default)().isTutorial,eP=ra(i0),(0,N.useEffect)(function(){eT&&eP()},[eP,eT]),eR=(0,yO.default)(),eA=(0,yF.useSetPaneIndicator)(),(0,N.useEffect)(function(){eA({paneType:"envEditor",indicatorType:eR?P.tokens.redStronger:void 0})},[eR,eA]),(0,yZ.useMissingSecretToast)({onOpenEnvEditor:function(){n7({pane:{type:"envEditor"},activate:!0,placement:{type:"secondary"}})}}),eD=rr(no),eV=(0,tb.useActivatePane)(),eF=(0,tb.useClearActivePane)(),(0,N.useEffect)(function(){eD?eV(eD):eF()},[eV,eF,eD]),eM=(0,aR.useFocusPane)(),eL=ri(i5),eG=ro(no),eU=(0,i6.default)(eM),(0,N.useEffect)(function(){var e=function(e){e&&(null!==n&&clearTimeout(n),n=setTimeout(function(){var e=eG();e&&eU.current(e)}))},n=null;e(eL.current);var t=eL.subscribe(e);return function(){null!==n&&clearTimeout(n),t()}},[eL,eU,eG]),eN=rr(tY),eB=ra(ay),(0,N.useEffect)(function(){var e=function(){eB()};if(eN)return document.addEventListener("dragend",e),function(){document.removeEventListener("dragend",e)}},[eN,eB]),(0,yX.default)(),eW=rr(nP),ez=(0,aR.useGetPaneBindings)(),eH=ro(n_),(0,aM.useCommandBinding)(function(){if(eW)return[lY.webviewRefresh.id,function(){var e=eH().filter(function(e){return"webview"===(0,U._)(e,2)[1].type}),n=!0,t=!1,r=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var o=(0,U._)(i.value,1)[0],s=ez(o);s&&"webview"===s.type&&s.refresh()}}catch(e){t=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(t)throw r}}}]},[eW,ez,eH]),(0,y1.default)(),(0,yf.useOrgReplPresenceSession)(!(null==(nZ=n2.org)?void 0:nZ.id));var n7=a9(),tn=(0,q.useSupportsAgent)();(0,N.useEffect)(function(){return cE.setTag("replId",n2.id),function(){cE.setTag("replId",void 0)}},[n2.id]),(0,N.useEffect)(function(){return cE.setTag("agent",tn),(0,sw.addAgentTag)(tn),function(){cE.setTag("agent",void 0),(0,sw.removeAgentTag)()}},[tn]),(0,yB.default)({repl:n2,currentUser:n4,container:n5}),eq=(0,a2.default)(),e$=(eK=(0,ot.default)()).container,eQ=eK.ports,eX=(0,U._)((eY=(0,v._)({},y_,void 0),B.useMutation(yj,eY)),1)[0],eJ=(0,lw.usePreferences)("webviewAutoOpenOnPortOpened").preferences.webviewAutoOpenOnPortOpened,eZ=(0,sC.useIsExtensionRepl)(),e0=(0,q.useSupportsAgent)(),e1=ax(),e2=(0,N.useCallback)(function(e){e.isForwarded&&!e0&&(eZ||e1({pane:{type:"vnc"}}),eX({variables:{input:{id:eq,isVnc:!0}}}))},[e0,eZ,eX,eq,e1]),e4=(0,N.useCallback)(function(e){var n=e.isForwarded,t=e.isOpen,r=e.data;n&&(void 0===t||t)&&!e0&&(eJ&&!eZ&&e1({pane:{type:"webview",data:r}}),eX({variables:{input:{id:eq,isServer:!0}}}))},[eZ,e0,eq,eX,eJ,e1]),(0,N.useEffect)(function(){return eQ.portsState.subscribe((0,em.default)(function(e){if(e){var n=!0,t=!1,r=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var o=i.value,s=o.configuration,l=o.isOpen;if(s.isVnc)return void e2({isForwarded:l});var u=s.type===yS.PortConfigurationType.FORWARDED;e4({isForwarded:u,isOpen:l,data:{ports:function(e){var n=e.configuration;if(n.localPort)return{type:"local",path:"/",port:n.localPort};var t=(0,yS.getExternalPort)(n);if(t)return{type:"external",path:"/",port:t}}(o)}})}}catch(e){t=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(t)throw r}}}},500,{leading:!0}))},[e$,eQ.portsState,e4,e2]),(0,wi.default)(),(0,y9.default)(),e8=(0,X.useFlag)({controlName:"flag-open-telemetry-tracing"}),na=(e6=(e3=(0,U._)((0,N.useState)(!1),2))[0],e5=e3[1],e7=(e9=(0,U._)((0,N.useState)(Date.now()),2))[0],ne=e9[1],nt=(nn=(0,U._)((0,N.useState)(Date.now()),2))[0],nr=nn[1],(0,N.useEffect)(function(){var e=function(){e5(!document.hidden),document.hidden?nr(Date.now()):ne(Date.now())};return document.addEventListener("visibilitychange",e),e(),function(){document.removeEventListener("visibilitychange",e)}},[]),ni={visibility:e6,visibleTime:e7,hiddenTime:nt}).visibility,ns=ni.visibleTime,nl=ni.hiddenTime,(0,N.useEffect)(function(){e8&&na&&(ns-nl)/1e3>60&&(0,k.pruneSpans)(y4.tracerName)},[e8,na,nl,ns]),nc=(0,ot.default)().ports,nd=(0,lw.usePreferences)("forwardPortsAutomatically").preferences,(0,N.useEffect)(function(){nc.setForwardPortsAutomatically(nd.forwardPortsAutomatically)},[nd.forwardPortsAutomatically,nc]),(0,yp.default)(n2);var tt=ra(nm),tr=(0,yc.usePrefersReducedMotion)();(0,N.useEffect)(function(){tt(!tr)},[tr,tt]);var ti=ra(nv),ta=(0,yu.default)();(0,N.useEffect)(function(){ti(ta)},[ta,ti]),nf=(0,ot.default)().presence,nh=(0,a2.default)(),ng=(0,N.useRef)(!1),nj=(ny={variables:{replId:nh}},nw=(0,v._)({},yL,ny),nb=w.useQuery(yG,nw)).data,nS=nb.loading,nI=0,(null==nj?void 0:nj.getRepl.__typename)==="Repl"&&(nI=nj.getRepl.multiplayers.length,(null==(np=nj.getRepl.owner)?void 0:np.__typename)==="User"&&(nI+=1)),(0,N.useEffect)(function(){if(!nS&&!ng.current){var e=nf.onActiveUsersChange(function(){ng.current=!0,e(),(0,el.track)(eu.events.MULTIPLAYER_REPL_OPENED,{replId:nh,participantsCount:nI,usersOnlineCount:nf.getActiveUsers().length})});return e}},[nh,nS,nI,nf]);var to=(0,tb.useWaitForFileClose)();(0,N.useEffect)(function(){n3.setWaitForFileClose(to)},[n3,to]);var ts=(0,yI.useThrowBsod)(),tl=rr(nE);(0,N.useEffect)(function(){tl&&ts(tl)},[ts,tl]),nk=(nC=(0,ot.default)()).packager,nT=nC.toolchain,(0,N.useEffect)(function(){var e=setTimeout(function(){(0,ei._)(function(){var e,n,t,r,i,a,o,s,l,u;return(0,ea._)(this,function(c){switch(c.label){case 0:if(!nT.configs.current||!nk)return[2];e=nT.configs.current.packagers,n=!0,t=!1,r=void 0,c.label=1;case 1:c.trys.push([1,7,8,9]),i=e[Symbol.iterator](),c.label=2;case 2:if(n=(a=i.next()).done)return[3,6];return o=a.value,[4,nk.listSpecfile(o.id)];case 3:var d;return(s=c.sent()).packages&&s.packages.length>0&&(l=s.packages.map(function(e){return e.name||""})||[],sw.logger.info("packager installed packages",{packagerId:o.id,language:o.language,packages:l}),(0,el.track)(eu.events.PACKAGER_PACKAGES_INSTALLED,{packages:l})),[4,(d=(5+5*Math.random())*1e3,(0,ei._)(function(){return(0,ea._)(this,function(e){switch(e.label){case 0:return[4,new Promise(function(e){return setTimeout(function(){return e()},d)})];case 1:return e.sent(),[2]}})})())];case 4:c.sent(),c.label=5;case 5:return n=!0,[3,2];case 6:return[3,9];case 7:return u=c.sent(),t=!0,r=u,[3,9];case 8:try{n||null==i.return||i.return()}finally{if(t)throw r}return[7];case 9:return[2]}})})()},(10+5*Math.random())*1e3);return function(){clearTimeout(e)}},[nk,nT.configs.current]),nR=(0,tb.useGetActivePaneId)(),nA=(0,aR.useFocusPane)(),(0,N.useEffect)(function(){var e=function(){var e=nR();e&&nA(e)},n=function(){"visible"===document.visibilityState&&document.activeElement===document.body&&e()};return window.addEventListener("focus",e),document.addEventListener("visibilitychange",n),function(){window.removeEventListener("focus",e),document.removeEventListener("visibilitychange",n)}},[nA,nR]),(0,yq.default)();var tu=ra(ig),tc=ra(im),td=(0,ot.default)().fs;(0,y2.default)({fs:td,openMultipleFiles:tu,openMultipleURLs:tc,waitForFileClose:to,isMobileWorkspace:!1}),(0,aO.useSetToolPanes)(),(0,lF.useInitWorkflows)({dotReplit:n6}),(0,wl.useInitResouceMonitoring)();var tp=ax();(0,dA.useTourStep)(d6.projectsTour.id,d6.StepIds.ProjectPane,{onEnter:function(){return tp({pane:{type:"project"},commit:!0,activate:!0})}}),(0,ws.default)(n9),nD=yU(),nV=(0,N.useCallback)(function(){nD({reveal:!1})},[nD]),(0,lF.useOnLocalRun)(nV,[nV]),(0,yH.useAgentTracking)(),(0,y7.useSyncAgentFreemiumUsage)(),(0,y$.useChatterSentryBreadcrumbs)(),(0,yQ.useDebugPreviewStateTracking)(),(0,yz.useQueueAutoPlay)(),(0,yK.useAutoSetExpertMode)({isAgentReplInConfig:!!(null==(n0=n2.config)?void 0:n0.isAgentRepl),isExpertModeInConfig:!!(null==(n1=n2.config)?void 0:n1.isExpertMode)});var tf=ax(),th=(0,N.useCallback)(function(e){tf({pane:{type:e},activate:!1,reveal:!1,commit:!0})},[tf]);return(0,yl.default)({handleOpenPane:th}),(0,yY.default)(),nO=aC().setAgentPosition,nF=(0,lw.usePreferences)("agentPosition").preferences.agentPosition,nM=(0,N.useRef)(nF),(0,N.useEffect)(function(){nF!==nM.current&&(nM.current=nF,nO(nF))},[nO,nF]),(0,yT.useTrackAgentTestingTakeoverRequests)(),nL=ro(nx),nG=ax(),nU=function(e){var n,t=nL();(null==(n=t.tiling)?void 0:n.type)==="paneGroup"&&1===t.tiling.panes.length&&nG({pane:e,activate:!1})},(0,u4.useChatHook)("received-completed-event",function(e){var n=e.event.contents.contents;if((0,yk.isKind)(n,"agentTimelineEventContents")){var t=n.agentTimelineEventContents.toolData;(null==t?void 0:t.$kind)==="createPostgresqlDatabaseData"&&nU({type:"neon"})}}),nW=(0,a2.default)(),nz=rr(nN),nH=ra(i4),nq=(0,yg.useAgentPlanApprovalState)(),nK=(0,ym.useIsCurrentSessionInitialAgentSession)(),n$=(0,N.useRef)(!1),nQ=(0,U._)((0,yh.useUpdateReplConfigMutation)(),1)[0],nY=n2.config,nX=!!(null==(nB=n2.origin)?void 0:nB.id),(0,N.useEffect)(function(){if(nX){(null==nY?void 0:nY.isInPlanningPhase)!==!1&&nQ({variables:{input:{id:nW,isInPlanningPhase:!1}}});return}(null==nY?void 0:nY.isAgentRepl)&&nK&&null!=nq&&!n$.current&&("approved"===nq?(nz&&nH("sidebar"),(null==nY?void 0:nY.isInPlanningPhase)!==!1&&nQ({variables:{input:{id:nW,isInPlanningPhase:!1}}})):(nz||nH("centered"),(null==nY?void 0:nY.isInPlanningPhase)!==!0&&nQ({variables:{input:{id:nW,isInPlanningPhase:!0}}})),n$.current=!0)},[nz,nW,nH,nQ,nq,nK,nY,nX]),(0,we.useSyncAgentInitialPlanningState)(),(0,wn.useSyncAgentWebDesignMockupState)(),null}var wc=e.i(425188);function wd(e){var n=e.children,t=e.tour,r=e.userId;if(!t)return(0,g.jsx)(g.Fragment,{children:n});var i="workspace-desktop-new-user-tour"===t.id||"workspace-desktop-tour-2024"===t.id;function a(e){i&&t&&(0,el.identify)({id:r.toString(),workspaceTourId:t.id,workspaceTourStatus:e===t.steps[t.steps.length-1].id?"completed":e.toLowerCase()})}return(0,g.jsx)(wc.TourRoot,{tour:t,onStep:function(e){t&&((0,el.track)(eu.events.WORKSPACE_TOUR_STEP_VIEWED,{tour:t.id,stepId:e.toLowerCase()}),a(e))},onDone:function(e){(0,el.track)(eu.events.WORKSPACE_TOUR_DISMISSED,{tour:t.id,stepId:e.toLowerCase(),didComplete:e===t.steps[t.steps.length-1].id}),a(e)},children:n})}var wp=e.i(508545),wf=e.i(911489),wh=e.i(263649),wg=e.i(607824),wm=e.i(384444);function wv(){var e=(0,lL.useObservable)((0,u7.useAgentIsWorking)()),n=(0,lL.useObservable)(u5()),t=(0,U._)((0,N.useState)(!0),2),r=t[0],i=t[1],a=(0,yP.useGetExperiment)("sound-on_v2")(),o="control"!==(null==a?void 0:a.get("treatmentName","control")),s=(0,N.useRef)(!1),l=(0,U._)((0,N.useState)(!1),2),u=l[0],c=l[1],d=(0,N.useRef)(null);(0,N.useEffect)(function(){var e=function(){var e=!document.hidden;i(e),e&&(c(!1),d.current&&(document.title=d.current))};return e(),document.addEventListener("visibilitychange",e),function(){document.removeEventListener("visibilitychange",e)}},[]),(0,N.useEffect)(function(){if(o){var t=e||n;t?s.current=!0:s.current&&!t&&(r||c(!0),s.current=!1)}},[e,n,r,o]),(0,N.useEffect)(function(){return u?(null===d.current&&(d.current=document.title),document.title.startsWith("(1) ")||(document.title="(1) ".concat(document.title))):d.current&&(document.title=d.current,d.current=null),function(){d.current&&(document.title=d.current,d.current=null)}},[u]);var p=wm.favicons.prompt;return e?p=wm.favicons.agentWorking:n?p=wm.favicons.agentWaiting:o&&u&&!r&&(p=wm.favicons.agentWaiting),p?(0,g.jsx)(wg.default,{children:(0,g.jsx)("link",{rel:"shortcut icon",href:p,sizes:"192x192",type:"image/png"})}):null}var wx=e.i(169566),wy=e.i(468448),ww=e.i(748965),wb=e.i(764586),w_=e.i(968263);function wj(){var e=(0,x._)(["\n  query PublishedAs($id: String!) {\n    getRepl(id: $id) {\n      ... on Repl {\n        id\n        publishedAs\n      }\n    }\n  }\n"]);return wj=function(){return e},e}var wS={},wI=(0,y.gql)(wj()),wC=e.i(671901),wk=".replit-dynamic-template",wE=e.i(169932),wT=e.i(420309),wP=e.i(833387);function wR(){var e,n,t,r,i,a,o,s,l,u,c,d,p,f,h,m,x,y,b,_=(0,U._)((0,N.useState)(!1),2),j=_[0],S=_[1],I=(0,N.useCallback)(function(e){switch(e){case"starting":return void S(!0);case"none":return void S(!1);case"running":if(!j)throw Error("expected repl not to need dynamic template initialization")}},[S,j]),C=(0,U._)((0,N.useState)([]),2),k=C[0],E=C[1],T=(0,gD.useIdSeed)();n=(e={handleRPC:(0,N.useCallback)(function(e){switch(e.type){case"progress":case"failed":return E(function(n){return(0,er._)(n).concat([(0,v._)({key:T(n.length)},e)])}),null;case"query":case"prompt":case"confirm":var n=(0,w_.default)();return E(function(t){return(0,er._)(t).concat([(0,v._)({respond:n,key:T(t.length)},e)])}),n.promise;default:throw Error("unhandled request type: "+JSON.stringify(e))}},[T]),onConnStateChange:I}).handleRPC,t=e.onConnStateChange,r=(0,X.useFlag)({controlName:"octopus-smokescreen"}),s=(i={variables:{id:(0,a2.default)()}},a=(0,v._)({},wS,i),o=w.useQuery(wI,a)).loading,l=o.data,u=(0,J.default)(function(){if(s)return!1;var e=null==l?void 0:l.getRepl;return(null==e?void 0:e.__typename)==="Repl"&&e.publishedAs===lQ.PublishedReplKind.Template},[s,l]),d=(c=(0,ot.default)()).container,p=c.fs,h=(f=(0,U._)((0,N.useState)(!1),2))[0],m=f[1],y=(x=hM({container:d,service:"exec",skip:!h})).channel,b=x.isConnecting,(0,N.useEffect)(function(){!r||u||s||(0,ei._)(function(){return(0,ea._)(this,function(e){switch(e.label){case 0:return[4,p.stat(wk)];case 1:return m(e.sent().exists),[2]}})})()},[p,r,u,s,m]),(0,N.useEffect)(function(){if(!b){if(!y)throw Error("exec channel is not open");var e=(0,w_.default)();e.promise.then(function(){return(0,ei._)(function(){var e;return(0,ea._)(this,function(n){switch(n.label){case 0:return[4,y.request({input:JSON.stringify({type:"start"})+"\n"})];case 1:if(!(e=n.sent()).ok)throw Error(": "+e.error);return[2]}})})()});var r=y.onCommand(function(r){switch(r.body){case"state":r.state===wC.api.State.Running?(t("starting"),e.resolve()):t("none");return;case"output":var i,a,o=r.output;if(!o)return;try{a=JSON.parse(o)}catch(e){throw Error("failed to parse dynamic template output: ".concat(e))}null==(i=n(a))||i.then(function(e){return y.send({input:JSON.stringify(e)+"\n"})});return;case"stderr":console.warn("got dynamic template generator stderr:",r.stderr);return;case"error":console.error("got dynamic template generator error:",r.error);return;case"ok":return;default:throw Error("unhandled exec channel body: ".concat(r.body))}});return y.send({exec:{args:["sh",wk],lifecycle:wC.api.Exec.Lifecycle.STDIN}}),function(){r()}}},[y,n,b,t,h]);var P=k.map(function(e){switch(e.type){case"progress":return(0,g.jsx)(wA,(0,v._)({},e));case"failed":return(0,g.jsx)(wD,(0,v._)({},e));case"query":return(0,g.jsx)(wV,(0,v._)({},e));case"prompt":return(0,g.jsx)(wO,(0,v._)({},e));case"confirm":return(0,g.jsx)(wF,(0,v._)({},e))}});return(0,g.jsx)(az.Modal,{isOpen:j,onRequestClose:function(){return S(!1)},children:(0,g.jsx)(D.View,{gap:8,children:P})})}function wA(e){var n=e.progress,t=(0,uc._)(e,["progress"]);return(0,g.jsxs)(D.View,(0,r$._)((0,v._)({},t),{children:["progress: ",n]}))}function wD(e){var n=e.error,t=(0,uc._)(e,["error"]);return(0,g.jsxs)(D.View,(0,r$._)((0,v._)({},t),{children:["error: ",n]}))}function wV(e){var n=e.query,t=e.options,r=e.respond,i=(0,uc._)(e,["query","options","respond"]),a=(0,U._)((0,N.useState)(null),2),o=a[0],s=a[1],l=(0,U._)((0,N.useState)(!1),2),u=l[0],c=l[1],d=(0,gD.useIdSeed)(),p=(0,N.useCallback)(function(){null!==o&&(c(!0),r.resolve({type:"answer",answer:t[o]}))},[o,t,r]);return(0,g.jsxs)(D.View,(0,r$._)((0,v._)({},i),{children:["query: ",n,t.map(function(e,t){return(0,g.jsxs)("label",{children:[(0,g.jsx)("input",{type:"radio",name:n,value:t,checked:o===t,onChange:function(){u||s(t)}}),e]},d(t))}),(0,g.jsx)(a4.Button,{text:"submit",onClick:p})]}))}function wO(e){var n=e.prompt,t=e.respond,r=(0,uc._)(e,["prompt","respond"]),i=(0,U._)((0,N.useState)(""),2),a=i[0],o=i[1],s=(0,U._)((0,N.useState)(!1),2),l=s[0],u=s[1],c=(0,N.useCallback)(function(){u(!0),t.resolve({type:"answer",answer:a})},[a,t]);return(0,g.jsxs)(D.View,(0,r$._)((0,v._)({},r),{children:["prompt: ",n,(0,g.jsx)(gV.Input,{disabled:l,inputMode:"text",title:n,onChange:function(e){return o(e.currentTarget.value)}}),(0,g.jsx)(a4.Button,{text:"submit",onClick:c})]}))}function wF(e){var n=e.confirm,t=e.dataConfirmation,r=e.respond,i=(0,uc._)(e,["confirm","dataConfirmation","respond"]),a=Object.keys(t),o=Object.values(t);return(0,g.jsxs)(D.View,(0,r$._)((0,v._)({},i),{children:["confirm: ",n,(0,g.jsxs)(wE.default,{"aria-label":"the data to be used to generate your App",children:[(0,g.jsx)(wP.TableHeader,{children:a.map(function(e){return(0,g.jsx)(wb.Column,{isRowHeader:!0,children:e},e)})}),(0,g.jsx)(wT.default,{children:(0,g.jsx)(wb.Row,{children:o.map(function(e,n){return(0,g.jsx)(wb.Cell,{children:e},a[n])})})})]}),(0,g.jsx)(a4.Button,{text:"yes",onClick:function(){return r.resolve({type:"answer",answer:"yes"})}}),(0,g.jsx)(a4.Button,{text:"no",onClick:function(){return r.resolve({type:"answer",answer:"no"})}})]}))}var wM=e.i(982243),wL=e.i(376847),wG=e.i(678814),wU=e.i(268999),wN=e.i(660081),wB=e.i(224373),wW=(0,P.cvarsFrom)("ResizeHandle.module.css",["--width"]),wz=(0,N.memo)(function(){var e=(0,N.useRef)(null),n=aC(),t=(0,uv.default)(n.agentFiletreeOrder);return(0,g.jsx)(wH,{gutter:n.gutter,side:"filetree-agent"===t?"left":"right",onDoubleClick:function(){n.toggle("collapsed"===n.displayState.current)},onPointerDown:function(t){(0,hS.measureMouseMove)(t,{start:function(){e.current=document.activeElement,n.resizeSidebar({type:"start"})},move:function(e){var t=e.delta;n.resizeSidebar({type:"update",moveDelta:t})},end:function(){var t,r;n.resizeSidebar({type:"end"}),null==(r=e.current)||null==(t=r.focus)||t.call(r)}})}})});function wH(e){var n=e.gutter,t=e.side,r=(0,uc._)(e,["gutter","side"]),i=(0,N.useRef)(null);return(0,nQ.useStyleSet)(i,n,function(e){return(0,E._)({},wW.width,e+"px")}),(0,g.jsx)(D.View,(0,r$._)((0,v._)({clsx:[wB.default.root,wB.default[t]],align:"center",justify:"center",innerRef:i},r),{children:(0,g.jsx)(D.View,{clsx:wB.default.grip})}))}var wq=e.i(861781),wK=(0,P.cvarsFrom)("index.module.css",["--x","--y","--width","--height","--z-index"]);function w$(){}function wQ(){var e=rr(nN),n=ra(i4),t=rr(i8),r=(0,ot.default)(),i=r.secrets,a=r.fs,o=ax(),s=(0,N.useCallback)(function(e){(0,el.track)(eu.events.TOOL_OPENED,{source:"Agent Sidebar",tool:e.type}),o({pane:e})},[o]),l=gt(),u=(0,gr.useCurrentSession)(),c=u.session,d=u.setSession,p=u.setSessionId,f=aC(),h=(0,N.useRef)(null);(0,nQ.useStyleSet)(h,hx(f.rect,f.getTransitionEnabled),function(e){var n;return n={},(0,E._)(n,wK.x,e.x+"px"),(0,E._)(n,wK.y,e.y+"px"),(0,E._)(n,wK.width,e.width+"px"),(0,E._)(n,wK.height,e.height+"px"),n});var m=(0,U._)((0,N.useState)(null),2),v=m[0],x=m[1],y=f.setChatRef;(0,N.useEffect)(function(){return v?(y({setSessionId:p,focusInput:function(){return v.focus()}}),function(){y(null)}):void y({setSessionId:p,focusInput:function(){}})},[v,y,p]);var w=(0,dA.useSetTourStepTarget)(dB,dN.Agent),b=(0,N.useCallback)(function(e){e&&l(e),n("sidebar")},[l,n]);return(0,g.jsxs)(A.Surface,{innerRef:h,clsx:wq.default.root,style:(0,E._)({},wK.zIndex,rs.zIndexLevels.tiledPane.toString()),children:[(0,g.jsx)(gi.AgentMain,{secrets:i,readFile:a.readFile,session:c,setSession:d,openPane:s,onPlanApproval:b,isDesktopOrTabletAgentPresentationCentered:e,isDesktopLayoutAgentPresentationTransitionInProgress:t,openPip:w$,inputRef:x,workspaceTourStepRef:w}),(0,g.jsx)(wz,{})]})}var wY=(0,rl.cssRecord)({root:[i9.rcss.position.absolute,i9.rcss.borderRadius(8),i9.rcss.pt(16),i9.rcss.align.center,{border:"1px solid",borderColor:P.tokens.outlineDimmest}],content:[i9.rcss.width("100%"),i9.rcss.flex.growAndShrink(1)]});function wX(){var e=rr(rT),n=rr(n2),t=ra(tS),r=function(){var e,n=(0,U._)((0,hg.useDrop)({accept:[tN.FileType.File,hL.DragItems.NewPane],collect:function(e){return{isOver:e.isOver()}},hover:function(e){i.drag()},drop:function(e){if("nodes"===e.type){var n=(0,na.fsNodeToPanes)(e.nodes);n.length>0&&i.drop({panes:n})}}}),2),t=n[0].isOver,r=n[1],i=(e=ra(rc),(0,N.useEffect)(function(){t||e(null)},[t,e]),{drag:ra(rk),drop:ra(rE)});return r}(),i=lH({openPane:(0,N.useCallback)(function(e){(0,el.track)(eu.events.TOOL_OPENED,{source:"Empty Layout",tool:e.pane.type}),t({pane:e.pane,edge:"left"})},[t])});return(0,g.jsx)(D.View,{style:{width:e.width,height:e.height,transform:"translate(".concat(e.x,"px, ").concat(e.y,"px)"),zIndex:n?100:void 0},css:wY.root,innerRef:r,children:(0,g.jsx)(D.View,{css:wY.content,children:(0,g.jsx)(aH.CommandBar,{autoFocus:!0,command:i,showToolDescriptions:!0})})})}var wJ=ey.Type.Object({width:ey.Type.Number({minimum:0})}),wZ=ey.Type.Object({width:ey.Type.Number({minimum:0})}),w0=ey.Type.Object({layout:eE,data:ey.Type.Record(ey.Type.String(),ey.Type.Object({type:ey.Type.String()})),agent:ey.Type.Optional(wZ),filetree:ey.Type.Optional(wJ)});function w1(e,n,t){var r=t.hasAssistant,i=null;try{i=so.Value.Decode(w0,e)}catch(e){}if(null===i)return null;var a={layout:i.layout,data:{},type:"saved",agent:i.agent,filetree:i.filetree},o=new Set,s=function(e){var n=new Set,t=!0,r=!1,i=void 0;try{for(var a,o=e.floating[Symbol.iterator]();!(t=(a=o.next()).done);t=!0){var s=a.value,l=!0,u=!1,c=void 0;try{for(var d,p=s.panes[Symbol.iterator]();!(l=(d=p.next()).done);l=!0){var f=d.value;n.add(f)}}catch(e){u=!0,c=e}finally{try{l||null==p.return||p.return()}finally{if(u)throw c}}}}catch(e){r=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(r)throw i}}return e.tiling&&function e(t){if("paneGroup"!==t.type)return t.children.forEach(e);var r=!0,i=!1,a=void 0;try{for(var o,s=t.panes[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var l=o.value;n.add(l)}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}}(e.tiling),n}(a.layout),l=!0,u=!1,c=void 0;try{for(var d,p=Object.entries(i.data)[Symbol.iterator]();!(l=(d=p.next()).done);l=!0){var f=(0,U._)(d.value,2),h=f[0],g=f[1];if(s.has(h)){var m=n(g.type,g);if(!m){o.add(h);continue}a.data[h]=m}}}catch(e){u=!0,c=e}finally{try{l||null==p.return||p.return()}finally{if(u)throw c}}return(0,e0.produce)(a,function(e){var n=function(n){if(s.has(n))return void eQ(e.layout,n)},t=!0,i=!1,a=void 0;try{for(var l,u=o[Symbol.iterator]();!(t=(l=u.next()).done);t=!0){var c=l.value;n(c)}}catch(e){i=!0,a=e}finally{try{t||null==u.return||u.return()}finally{if(i)throw a}}var d=!0,p=!1,f=void 0;try{for(var h,g=Object.entries(e.data)[Symbol.iterator]();!(d=(h=g.next()).done);d=!0){var m=(0,U._)(h.value,2),v=m[0],x=m[1];"commands"!==x.type&&("codeEditor"!==x.type||x.data.path)&&"agentProgress"!==x.type&&"agentChat"!==x.type&&("ghostwriterChat"!==x.type||r)||(delete e.data[v],n(v))}}catch(e){p=!0,f=e}finally{try{d||null==g.return||g.return()}finally{if(p)throw f}}})}var w2=e.i(779830),w4=e.i(160290),w8=e.i(710078),w3=e.i(939040),w6=e.i(491694),w5=(0,P.cvarsFrom)("Search.module.css",["--input-height"]),w9={type:"context",icon:(0,g.jsx)(s8.default,{}),label:"",description:"Search"};function w7(e){var n=(0,ot.default)().fs,t=(0,tb.useGetRecentFiles)(),r=aw(),i=(0,lO.useShouldHideFileInWorkspace)(),a=(0,N.useMemo)(function(){var e=(0,lP.createFindOrCreateFileCommand)({openFile:r,fs:n,shouldHideFile:i,getRecentFiles:t});return e.data=w9,delete e.match,e},[r,n,i,t]);return(0,g.jsx)(D.View,{onContextMenu:e.onContextMenu,clsx:w6.default.root,style:(0,E._)({},w5.inputHeight,"32px"),children:(0,g.jsx)(aH.CommandBar,{fullWidth:!0,command:a,openOnInput:!0,compact:!0})})}var be=e.i(483570),bn=e.i(312421),bt=e.i(714312),br=e.i(240913),bi=e.i(133294),ba=e.i(185511),bo=e.i(274526),bs=e.i(714603),bl=e.i(90102),bu=e.i(342574);function bc(e){var n=e.size,t=e.iconUrl,r=e.name;return(0,g.jsx)(gw.default,{src:t,width:n,height:n,alt:"Icon for file opener: ".concat(r)})}var bd=/[*]{2}\/[*]\.([a-z0-9.]+)/,bp=e.i(842435),bf=e.i(943124);function bh(e){var n,t,r,i,a,o,s,l,u,c,d,p,f,h,m,x,y,w,b,_,j,S,I,C,k,E,T,P,R,A,V,O,F,M,L,G,B,W,z,H,K,$,Q,Y,J,Z=e.onClose,ee=(n=(0,a2.default)(),r=(t=(0,U._)((0,N.useState)(null),2))[0],i=t[1],a=aw(),o=(0,bn.useTrackOpenFile)(),s=(0,lO.useShouldHideFileInWorkspace)(!0),l=(0,N.useCallback)(function(e){return!s(e.filename)},[s]),u=(0,ot.default)().fs,c=(0,lw.usePreferences)("multiselectModifierKey").preferences,d=ra(nT),p="cmdOrCtrlKey"===c.multiselectModifierKey?"cmdOrCtrlKey":"altKey",f=(0,tb.useGetRecentFiles)(),h=(0,N.useCallback)(function(e){return(0,bt.getFileExtensionSuggestions)(e,f)},[f]),m=(0,hq.useContextMenu)().onContextMenu,x=(0,a2.default)(),y=(0,ot.default)().fs,w=aw(),b=ra(tS),_=rr(nj),j=(0,or.useExtensionCommands)(oP.ContributionType.FiletreeContextMenu),S=rr(rO),I=ra(rL),C=(0,X.useFlag)({controlName:"flag-folder-downloads"}),k=(0,X.useFlag)({controlName:"flag-direct-file-downloads"}),E=ra(rF),T=(0,N.useCallback)(function(e){var n=e.extensionId,t=e.fileExtension,r=e.fileHandlerId,i=S[t];i&&i.extensionId===n&&i.fileHandlerId===r||E(e)},[E,S]),P=(0,N.useCallback)(function(e,n){var t=e.path,r=[{data:{type:"group",key:"rename"},commands:function(){return[(0,bo.getRenameCommand)(function(){return n.rename(t)})]}}];(0,ic.isOTFile)(t)&&r.push({data:{type:"group",key:"saveFile"},commands:function(){return[(0,bo.getSaveCommand)(function(){return(0,ei._)(function(){return(0,ea._)(this,function(e){switch(e.label){case 0:return[4,y.flush(new Set([t]),tN.FlushSource.MANUAL_SAVE)];case 1:return e.sent(),[2]}})})()})]}}),r.push({data:{type:"group",key:"open"},commands:function(){return function(e){var n=e.path,t=e.getSelectedNodes,r=e.openFile,i=[{type:tN.FileType.File,path:n}],a=!0,o=!1,s=void 0;try{for(var l,u=t()[Symbol.iterator]();!(a=(l=u.next()).done);a=!0){var c=(0,U._)(l.value,2),d=c[0],p=c[1];p!==tN.FileType.Directory&&d!==n&&i.push({path:d,type:p})}}catch(e){o=!0,s=e}finally{try{a||null==u.return||u.return()}finally{if(o)throw s}}var f=i.length,h=1===f?"Open":"Open ".concat(f," files");return[{label:h,icon:(0,g.jsx)(fw.default,{}),run:function(){var e=!0,n=!1,t=void 0;try{for(var a,o=i[Symbol.iterator]();!(e=(a=o.next()).done);e=!0){var s=a.value;r({path:s.path,newTab:!0})}}catch(e){n=!0,t=e}finally{try{e||null==o.return||o.return()}finally{if(n)throw t}}}},{label:h+" in split",icon:(0,g.jsx)(an.default,{}),run:function(){var e=(0,eV._)(i),n=e[0],t=e.slice(1);r({path:n.path,newPane:!0});var a=!0,o=!1,s=void 0;try{for(var l,u=t[Symbol.iterator]();!(a=(l=u.next()).done);a=!0){var c=l.value;r({path:c.path,newTab:!0})}}catch(e){o=!0,s=e}finally{try{a||null==u.return||u.return()}finally{if(o)throw s}}}}].map(function(e){var n=e.label,t=e.icon,r=e.run;return{match:aE.matchLabel,data:{type:"action",label:n,icon:t,run:r}}})}({path:t,getSelectedNodes:n.getSelectedNodes,openFile:w})}});var i=function(e){var n=function(e){var n=r[e],i=(0,gA.globToRegExp)(n.glob);if(!i||!i.exec(t))return"continue";var s=bd.exec(n.glob),l=n.icon?n.icon:n.extension.manifest.icon,u=n.name?n.name:n.extension.manifest.name,d=l?(0,oo.getAssetUrl)(n.extension.baseUrl,l):null;c.push({match:aE.matchLabel,data:{type:"action",icon:d?(0,g.jsx)(bc,{size:16,name:u,iconUrl:d}):(0,g.jsx)(fw.default,{}),label:"Open with "+u,run:function(){s&&o({extensionId:n.extension.extensionId,fileHandlerId:e,fileExtension:s[1]}),a({path:t,opener:{paneType:"extension",supports:function(){return!0},extensionFileHandler:n}})}}})},t=e.path,r=e.handlers,i=e.filetypeAssociations,a=e.openFile,o=e.requestAssociateFiletype,s=e.associateFiletype,l=(0,id.getFileExtension)(t),u=l?i[l]:null,c=[];for(var d in r)n(d);return u&&l&&c.length&&c.push({match:aE.matchLabel,data:{icon:(0,g.jsx)(gq.default,{}),type:"action",label:"Use default opener",run:function(){s({fileExtension:l,newAssociation:null})}}}),c}({path:t,handlers:_,filetypeAssociations:S,requestAssociateFiletype:T,associateFiletype:I,openFile:w});return i.length&&r.push({data:{type:"group",key:"extensions"},commands:function(){return i}}),r.push({data:{type:"group",key:"copy"},commands:function(){return(0,bo.getCopyCommands)(t)}}),r.push((0,bo.getDuplicateCommand)(function(){return(0,ei._)(function(){var e;return(0,ea._)(this,function(r){switch(r.label){case 0:e=null,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,(0,bi.default)(t,y)];case 2:return e=r.sent(),[3,4];case 3:return r.sent(),[2,{type:"error",message:"Error duplicating file"}];case 4:return(0,bs.default)({replId:x,action:"duplicated",fileType:tN.FileType.File}),n.rename(e),[2]}})})()})),r.push((0,ba.createDownloadCommand)(t,y,k)),r.push({data:{type:"group",key:"deleteFile"},commands:function(){return[(0,bo.getDeleteCommand)(function(){return n.deleteNodes(e)})]}}),r.push({data:{type:"group",key:"extensions"},commands:function(){return(0,ei._)(function(){var e;return(0,ea._)(this,function(n){switch(n.label){case 0:return e=[{data:{filePath:t,fileType:tN.FileType.File}}],[4,Promise.all(j.map(function(n){return(0,ei._)(function(){var t;return(0,ea._)(this,function(r){switch(r.label){case 0:return[4,n.create({path:e})];case 1:if(!(t=r.sent()))return[2,null];return[2,(0,oa.wrapExtensionCommand)(t,{path:e})]}})})()}))];case 1:return[2,n.sent().filter(Boolean)]}})})()}}),r},[_,S,T,I,w,y,k,x,j]),R=(0,y5.useSetAreHiddenFilesVisible)(),A=(0,y5.useAreHiddenFilesVisible)(),V=(0,q.useSupportsAgent)(),F=(O=(0,lw.usePreferences)("agentPosition")).preferences.agentPosition,M=O.update,L=(0,N.useCallback)(function(e,n){var t=e.path,r=t===br.ROOT_PATH,i=r?[]:[{data:{type:"group",key:"rename"},commands:function(){return[(0,bo.getRenameCommand)(function(){return n.rename(e.path)})]}}];if(i.push({data:{type:"group",key:"search"},commands:function(){var n;return[(n=e.path,{match:aE.matchLabel,data:{type:"action",icon:(0,g.jsx)(s8.default,{}),label:"Search this directory",run:function(){b({pane:{type:"searchReplace",data:{initialIncludeGlob:"".concat(n,"/**")}},edge:"right"})}}})]}}),i.push.apply(i,(0,er._)((0,bo.getCreateCommands)(function(t){return n.create(t,e.path)}))),i.push({data:{type:"group",key:"openShell"},commands:function(){return[{match:aE.matchLabel,data:{type:"action",label:"Open shell here",icon:(0,g.jsx)(bu.default,{}),run:function(){b({pane:{type:"shell",data:{initialPwd:t}},edge:"left"})}}}]}}),r||i.push({data:{type:"group",key:"copy"},commands:function(){return(0,bo.getCopyCommands)(t)}}),n.getExpandedDirs()&&i.push({match:aE.matchLabel,data:{icon:(0,g.jsx)(v0.default,{}),type:"action",label:"Collapse "+(r?"all":"child folders"),run:function(){var e=n.getExpandedDirs(t);e&&n.collapse((0,er._)(e))}}}),!r&&C&&i.push({data:{type:"group",key:"downloadFolder"},commands:function(){return[(0,ba.createDownloadFolderCommand)(t)]}}),r||i.push({data:{type:"group",key:"deleteFile"},commands:function(){return[(0,bo.getDeleteCommand)(function(){return n.deleteNodes(e)})]}}),r&&i.push({data:{type:"group",key:"hiddenFiles"},commands:function(){return[{match:aE.matchLabel,data:{type:"action",label:(A?"Hide":"Show")+" hidden files",icon:A?(0,g.jsx)(bl.default,{}):(0,g.jsx)(fw.default,{}),run:function(){R(!A)}}}]}}),i.push({data:{type:"group",key:"extensions"},commands:function(){return(0,ei._)(function(){var e;return(0,ea._)(this,function(n){switch(n.label){case 0:return e=[{data:{dirPath:t,fileType:tN.FileType.Directory}}],[4,Promise.all(j.map(function(n){return(0,ei._)(function(){var t;return(0,ea._)(this,function(r){switch(r.label){case 0:return[4,n.create({path:e})];case 1:if(!(t=r.sent()))return[2,null];return[2,(0,oa.wrapExtensionCommand)(t,{path:e})]}})})()}))];case 1:return[2,n.sent().filter(Boolean)]}})})()}}),r&&V){var a={type:"action",label:"Move sidebar to the "+("leftSidebar"===F?"left":"right"),icon:"leftSidebar"===F?(0,g.jsx)(an.default,{}):(0,g.jsx)(at.default,{}),run:function(){M({agentPosition:"leftSidebar"===F?"rightSidebar":"leftSidebar"})}};i.push({data:{type:"group",key:"move"},commands:function(){return[{match:aE.matchLabel,data:a}]}})}return i},[A,R,j,b,C,V,M,F]),G=(0,N.useCallback)(function(e,n){return{data:{type:"context",label:"Search actions",icon:(0,g.jsx)(s8.default,{})},commands:function(){return e.type===tN.FileType.Directory?L(e,n):P(e,n)}}},[P,L]),B=(0,y5.useSetFileRenameInProgress)(),W=(0,w4.useFiletree)({fs:u,filter:l,fontSize:13,onFileDoubleClick:function(e,n){d(n)},onFileSelect:function(e){var n=e.path,t=e.type,r=e.event,i="click"===t&&"altKey"===p?(0,un.getCmdOrCtrl)(r):r.altKey;a({path:n,newTab:i}),o(n,{newTab:i})},onCreate:function(e){e.type===tN.FileType.File&&a({opener:{paneType:(0,na.getPaneTypeForFile)({path:e.path})},path:e.path})},multiselectModifierKey:p,onConflicts:function(e){return i({type:"conflicts",data:e})},onDeleteNodes:function(e){return i({type:"deleteNode",data:e})},onContextMenu:function(e,n){return m(e,{command:G(n,W)})},autocomplete:h,localCacheKey:n+":sidebar",onFileRenameStart:B,onFileRenameEnd:function(){return B(null)}}),z=(0,be.useFileTreeGitStatus)(),(0,N.useEffect)(function(){return W.setFileStatus(z)},[W,z]),H=(0,tb.useObservableActiveFile)(),(0,N.useEffect)(function(){var e=function(e){return(0,ei._)(function(){return(0,ea._)(this,function(n){switch(n.label){case 0:if(null===e)return W.select(null),[2];return[4,W.select({path:e,type:tN.FileType.File})];case 1:if(n.sent(),H.current!==e)return[2];return W.scrollToPath(e),[2]}})})()};return e(H.current),H.subscribe(e)},[H,W]),K=aI(),$=(0,uv.default)(K.activeContent),Q=(0,tb.useObservableRevealFile)(),Y=(0,tb.useSetRevealFile)(),(0,N.useEffect)(function(){var e=function(e){return(0,ei._)(function(){return(0,ea._)(this,function(n){switch(n.label){case 0:if(null===e)return[2];return"filetree"!==$&&K.toggleContent("filetree"),[4,W.select({path:e,type:tN.FileType.File})];case 1:return n.sent(),W.scrollToPath(e),Y(null),[2]}})})()};return e(Q.current),Q.subscribe(e)},[Q,Y,W,K,$]),J=(0,N.useCallback)(function(e){return m(e,{command:G({type:tN.FileType.Directory,path:"."},W)})},[W,G,m]),{filetree:W,activeModal:r,closeModal:function(){return i(null)},onRootContextMenu:J}),en=ee.filetree,et=ee.activeModal,eo=ee.closeModal,es=ee.onRootContextMenu;return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(D.View,{clsx:bf.default.header,row:!0,gap:4,align:"center",pl:6,pr:4,children:[(0,g.jsx)(D.View,{grow:!0,shrink:!0,row:!0,gap:4,align:"center",children:(0,g.jsx)(a8.Text,{css:bf.default.title,children:"Files"})}),(0,g.jsxs)(D.View,{row:!0,gap:0,align:"center",children:[(0,g.jsx)(ct.IconButton,{dataCy:"filetree-add-file",alt:"New file",onClick:function(){en.create(tN.FileType.File)},children:(0,g.jsx)(v2.default,{})}),(0,g.jsx)(ct.IconButton,{alt:"New folder",onClick:function(){en.create(tN.FileType.Directory)},children:(0,g.jsx)(bp.default,{})}),(0,g.jsx)(w2.RootActions,{closeFiletree:Z,filetree:en})]})]}),(0,g.jsxs)(D.View,{clsx:bf.default.content,grow:!0,shrink:!0,children:[(0,g.jsx)(w7,{onContextMenu:es}),(0,g.jsx)(D.View,{grow:!0,shrink:!0,dataCy:"sidebar-filetree-section",children:(0,g.jsx)(w4.Filetree,{store:en.store})})]}),(0,g.jsxs)(az.Modal,{isOpen:!!et,onRequestClose:eo,children:[(null==et?void 0:et.type)==="conflicts"?(0,g.jsx)(w8.default,{paths:et.data.conflicts.map(function(e){return e.path}),onCancel:eo,onConfirm:function(){var e=et.data;"move"===e.type?en.move({nodes:e.nodes,to:e.to,overwrite:!0}):en.upload({files:e.files,parentPath:e.to,overwrite:!0}),eo()}}):null,(null==et?void 0:et.type)==="deleteNode"?(0,g.jsx)(cx.default,(0,r$._)((0,v._)({},(0,w3.getDeleteText)(et.data.nodes)),{delete:function(){return et.data.confirm()},hideModal:eo})):null]})]})}function bg(){var e=(0,x._)(["\n  fragment AgentFeedbackItem on AgentFeedback {\n    id\n    topic\n    feedbackText\n    currentPage\n    status\n    timeCreated\n    user {\n      id\n      username\n      fullName\n      displayName\n      image\n    }\n  }\n"]);return bg=function(){return e},e}function bm(){var e=(0,x._)(["\n  query InboxContentAgentFeedback($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        agentFeedback {\n          ... on ReplAgentFeedback {\n            items {\n              ...AgentFeedbackItem\n            }\n          }\n          ... on Error {\n            message\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return bm=function(){return e},e}var bv={},bx=(0,y.gql)(bg()),by=(0,y.gql)(bm(),bx);function bw(e){var n=(0,v._)({},bv,e);return w.useQuery(by,n)}var bb=e.i(173703),b_={bug_report:{label:"Bug report",colorway:"red"},feature_request:{label:"Feature request",colorway:"purple"},design:{label:"Design",colorway:"blue"},content:{label:"Content",colorway:"lime"},other:{label:"Other",colorway:"grey"}};function bj(e){var n,t,r,i,a=e.item,o=a.topic&&b_[a.topic]?b_[a.topic]:b_.other,s=null!=(n=a.user.displayName)?n:a.user.username;return(0,g.jsxs)(bb.ShadesSurface,{border:"regular",br:8,gap:8,p:8,children:[(0,g.jsxs)(D.View,{row:!0,align:"center",justify:"space-between",children:[(0,g.jsx)(vm.Pill,{text:null!=(t=null==o?void 0:o.label)?t:"Other",colorway:null!=(r=null==o?void 0:o.colorway)?r:"grey",variant:"muted",compact:!0}),(0,g.jsxs)(D.View,{row:!0,gap:4,children:[(0,g.jsx)(ct.IconButton,{alt:"Add to chat",onClick:function(){},children:(0,g.jsx)(sT.default,{})}),(0,g.jsx)(ct.IconButton,{alt:"Send to agent",onClick:function(){},children:(0,g.jsx)(lz.default,{size:12})}),(0,g.jsx)(ct.IconButton,{alt:"Dismiss",onClick:function(){},children:(0,g.jsx)(gq.default,{})})]})]}),(0,g.jsxs)(D.View,{row:!0,gap:8,align:"center",children:[(0,g.jsx)(p3.Avatar,{src:a.user.image,username:a.user.username,fullName:null!=(i=a.user.fullName)?i:void 0,size:16}),(0,g.jsxs)(D.View,{row:!0,gap:8,align:"baseline",children:[(0,g.jsx)(a8.Text,{color:"dimmer",children:s}),(0,g.jsx)(df.Timestamp,{date:a.timeCreated,textColor:"dimmest",textVariant:"small",live:!0})]})]}),(0,g.jsx)(a8.Text,{children:a.feedbackText})]})}var bS=function(){bw({variables:{replId:(0,a2.default)()}})};function bI(){var e,n=bw({variables:{replId:(0,a2.default)()}}).data,t=(null==n||null==(e=n.getRepl)?void 0:e.__typename)==="Repl"?n.getRepl.agentFeedback:null,r=(null==t?void 0:t.__typename)==="ReplAgentFeedback"?t.items:[],i=0===r.length;return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(D.View,{row:!0,gap:4,align:"center",pl:6,pr:4,children:(0,g.jsx)(D.View,{grow:!0,shrink:!0,row:!0,gap:4,align:"center",children:(0,g.jsx)(a8.Text,{children:"Inbox"})})}),(0,g.jsx)(D.View,{grow:!0,shrink:!0,children:i?(0,g.jsxs)(D.View,{align:"center",pt:64,gap:8,children:[(0,g.jsx)(pD.default,{size:24}),(0,g.jsx)(a8.Text,{color:"dimmer",children:"Inbox is empty"})]}):(0,g.jsx)(D.View,{gap:10,pt:8,children:r.map(function(e){return(0,g.jsx)(bj,{item:e},e.id)})})})]})}function bC(){var e=aI(),n=aC(),t=(0,uv.default)(n.agentFiletreeOrder),r=(0,N.useRef)(null);return(0,g.jsx)(wH,{gutter:n.gutter,side:"agent-filetree"===t?"left":"right",onPointerDown:function(n){(0,hS.measureMouseMove)(n,{start:function(){(0,op._)(document.activeElement,HTMLElement)&&(r.current=document.activeElement),e.resize.start()},move:function(n){var t=n.delta;e.resize.update(t.x)},end:function(){var n,t;e.resize.end(),null==(t=r.current)||null==(n=t.focus)||n.call(t),r.current=null}})},onDoubleClick:function(){e.closeSidebar()}})}var bk=(0,P.cvarsFrom)("index.module.css",["--width","--height","--transform","--pointer-events","--opacity","--z-index"]),bE=(0,N.memo)(function(){var e=(0,N.useRef)(null),n=aI(),t=n.view,r=(0,uv.default)(n.activeContent);bS(),(0,nQ.useStyleSet)(e,hx(t,n.getTransitionEnabled),function(e){var n;return n={},(0,E._)(n,bk.width,e.width+"px"),(0,E._)(n,bk.height,e.height+"px"),(0,E._)(n,bk.transform,"translate(".concat(e.x,"px, ").concat(e.y,"px)")),(0,E._)(n,bk.pointerEvents,e.isOpen?"all":"none"),(0,E._)(n,bk.opacity,e.opacity.toString()),(0,E._)(n,bk.zIndex,rs.zIndexLevels.filetreeDragLayer.toString()),n});var i=(0,N.useCallback)(function(){n.closeSidebar()},[n]);return(0,g.jsxs)(A.Surface,{clsx:bf.default.root,innerRef:e,children:["filetree"===r?(0,g.jsx)(bh,{onClose:i}):null,"inbox"===r?(0,g.jsx)(bI,{}):null,(0,g.jsx)(bC,{})]})}),bT=e.i(732964),bP=e.i(718632),bR=e.i(755181);function bA(e){var n,t,r,i,a,o=e.repl,s=e.currentUser,l=(0,m.useRouter)(),u=(0,ee.useQueryParam)("enterInAgentMode","boolean"),c=(0,ee.useQueryParam)("enterInExpertMode","boolean"),d=(0,ee.useQueryParam)("popupId","string"),p=(0,Z.isInBonsaiWebview)(l),f=(0,Z.doesBonsaiWebviewSupportFeature)(l,"workspace2"),h=(0,t5.useFilePaneFlag)(),x=(0,U._)((0,N.useState)(function(){var e;return(0,aP.createPaneUI)({config:(e=(0,xY.createPaneUIConfig)(),(0,r$._)((0,v._)({},e),{webview:x$,commands:gu,tutorial:xO,extension:gb,extensionStore:vl,replAuth:vp,searchReplace:xy,deployments:xJ.deploymentsUI,config:gf,integrations:xZ.integrationsUI,extensionDevtools:vt,csvPreview:xX.csvPreviewUI,agentChat:gs,agentProgress:x0.unsupportedUI,multiplayer:x0.unsupportedUI})),filePaneFlag:h})}),1)[0],y=(0,$.useHasAssistant)({isSubscribed:s.isSubscribed}),w=null;d?w=w1(!(n=nZ.default.get(n3(d)))||"string"==typeof n&&parseInt(n,10)<Date.now()?null:nZ.default.get(n8(d)),x.decode,{hasAssistant:y}):o.layoutState&&(w=w1(o.layoutState,x.decode,{hasAssistant:y}));var b=!!o.config.isAgentStack;w||(a=c?"split-with-console":b?"split-with-automations":"split-with-webview");var _=(t=(0,ee.useQueryParam)("deploymentPane","boolean"),r=(0,ee.useQueryParam)("projectPane","boolean"),(0,J.default)(function(){return t?{type:"deployments"}:r?{type:"project"}:void 0},[t,r])),j=(!!(null==(i=o.origin)?void 0:i.id)||c)&&!o.config.isInPlanningPhase,S=(u||!!o.config.isInPlanningPhase)&&!o.config.figmaUrl&&!j;return(0,g.jsx)(hr.TrackingHierarchyProvider,{hierarchy:{page:"workspace"},children:(0,g.jsxs)(en.Pid2Provider,{currentUsername:s.username,replId:o.id,children:[(0,g.jsx)(cm.SessionProvider,{children:(0,g.jsx)(rn,{initialPane:_,savedLayoutState:w,popupId:d,agentCenteredLayout:S,agentLayoutVariation:a,agentPosition:s.workspacePreferences.agentPosition,children:(0,g.jsx)(wd,{tour:null,userId:s.id,children:(0,g.jsx)(bD,{ui:x,repl:o,currentUser:s,isBonsaiWebview:p,doesBonsaiSupportWorkspace2:f},o.id)})})}),(0,g.jsx)(et.default,{})]})})}function bD(e){var n,t,r,i,a,o,s,l,u,c,d,p,f,h,m,v,x,y,w=e.repl,b=e.currentUser,_=e.isBonsaiWebview,j=e.doesBonsaiSupportWorkspace2,S=e.ui,I=(n=aw(),t=ra(ig),r=ra(im),i=(0,yI.useThrowBsod)(),a=(0,X.useFlag)({controlName:"flag-null-diagnostics",logFlagToAnalytics:!1}),s=(o=(0,U._)((0,N.useState)(!1),2))[0],l=o[1],c=(u=(0,U._)((0,N.useState)(!1),2))[0],d=u[1],p=(0,dl.useUpdatePresence)(),f=(0,dl.useGetColorForUser)(),h=(0,X.useFlag)({controlName:"flag-open-telemetry-tracing"}),m=(0,X.useFlag)({controlName:"flag-multi-lsp-connections"}),v=(0,J.default)(function(){return{onPresenceCommand:p,getColorForUser:f,onUnrecoverableError:(0,wh.default)({origin:"replEnvironmentDesktop: services/unrecoverableError",tags:{environment:"desktop"},onNonBsodUnrecoverableError:function(e){e===Q.NonBsodErrorType.NotAllowed?l(!0):e===Q.NonBsodErrorType.RequiresRefresh&&d(!0)},throwBsod:i}),openFile:n,openMultipleFiles:t,openMultipleURLs:r,enableUserEvents:a,enableMultipleLSPClientsPerFile:m,openTelemetryTracing:h,enableReplspaceSshTokenPassthrough:!0}},[a,n,t,r,i,p,f,h,m]),x=(0,wp.useCreateServices)(v),(0,J.default)(function(){return{services:x,isPleaseRefresh:c,isNotAllowed:s}},[x,c,s])),C=I.services,k=I.isPleaseRefresh,E=I.isNotAllowed,T=(0,X.useFlag)({controlName:"flag-build-score-survey"}),P=(0,J.default)(function(){return(0,cs.initKeybindings)(null==b?void 0:b.keybindings.keybindings)},[b]);if(!C)return(0,g.jsx)(L,{});var R=w.authorizations.useAdvancedChat.isAuthorized;return(0,g.jsx)(K.AiProvider,{replId:w.id,currentUser:b,hasAccessToAdvancedModel:R,orgId:null==(y=w.org)?void 0:y.id,renderEmptyState:function(){return(0,g.jsx)(L,{})},children:(0,g.jsx)(wx.ContextMenuProvider,{children:(0,g.jsxs)(cf,{services:C,ui:S,repl:w,userKeybindings:P,children:[(0,g.jsxs)(hG.default,{origin:"ErrorBoundary: ReplEnvironmentDesktop Top level",bsod:!0,children:[(0,g.jsx)(uF,{}),(0,g.jsx)(l9,{isAdmin:b.isAdmin,isSubscribed:b.isSubscribed}),(0,g.jsx)(wG.default,{repl:w}),_&&!j?(0,g.jsx)(cI,{}):null,(0,g.jsx)(aQ,{}),(0,g.jsx)(cg,{}),(0,g.jsx)(wu,{repl:w,currentUser:b}),(0,g.jsx)(cH,{}),(0,g.jsx)(cN,{}),(0,g.jsx)(bO,{repl:w}),(0,g.jsx)(sU,{}),(0,g.jsx)(sO,{}),(0,g.jsx)(wy.default,{}),(0,g.jsx)(wR,{}),(0,g.jsx)(yr,{replId:w.id}),(0,g.jsx)(wM.default,{isOpen:E}),(0,g.jsx)(wL.default,{isOpen:k}),(0,g.jsx)(bP.GitInShellConfirmModal,{}),(0,g.jsx)(bT.DefaultBucketAccessConfirmModal,{}),(0,g.jsx)(sR,{}),(0,g.jsx)(cy,{}),(0,g.jsx)(ww.DisconnectedModal,{}),(0,g.jsx)(lm,{}),(0,g.jsx)(wU.ConvertedToProjectModal,{repl:w}),T?(0,g.jsx)(wN.BuildScoreSurveyTopLevelHook,{}):null]}),(0,g.jsx)(bV,{replId:w.id})]})})})}function bV(e){var n,t=e.replId,r=(0,U._)((0,yI.useBsod)(),1)[0],i=(0,U._)((n=(0,v._)({},z,void 0),B.useMutation(H,n)),1)[0],a=(0,N.useCallback)(function(){i({variables:{input:{replId:t,state:{}}}})},[i,t]);return(0,N.useEffect)(function(){r&&a()},[r,a]),(0,g.jsx)(wf.default,{})}var bO=(0,N.memo)(function(e){var n,t,r,i,a,o,s,l,u=e.repl,c=(n=ra(nq),t=ro(ni),r=(0,Y.default)(),i=(0,cK.useIsMac)(),a=(0,cK.useIsWindows)(),o=(i||a)&&r?V.HEADER_HEIGHT:0,s=(0,N.useRef)(null),l=(0,cq.default)(function(e){var r=e.width,i=e.height;if(r&&i&&s.current){var a=s.current.getBoundingClientRect(),l=a.top,u={width:r,height:i,x:a.left,y:l-o};(0,nc.default)(u,t())||n(u)}}),(0,N.useCallback)(function(e){s.current=e,l(e)},[l])),d=rr(nk),p=rr(e1),f=rr(e2),h=rr(e4),m=(0,N.useRef)(null),v=(0,N.useCallback)(function(e){c(e),m.current=e},[c]),x=(0,Y.default)();return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(A.Surface,{innerRef:v,clsx:[bR.default.contentContainer,(0,E._)({},bR.default.desktopApp,x)],children:[d?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(hu,{repl:u}),(0,g.jsx)(bE,{}),(0,g.jsxs)("main",{id:"main-content",children:[f.map(function(e){return(0,g.jsx)(ys,{handleId:e},e)}),h.map(function(e){return(0,g.jsx)(gn,{headerId:e},e)}),p.map(function(e){return(0,g.jsx)(hW,{paneId:e},e)}),0===p.length?(0,g.jsx)(wX,{}):null]}),(0,g.jsx)(rj,{}),(0,g.jsx)(af,{}),(0,g.jsx)(u$,{}),(0,g.jsx)(hH.ContextMenu,{}),(0,g.jsx)(wQ,{})]}):null,(0,g.jsx)(wv,{})]}),d?null:(0,g.jsx)(L,{})]})}),bF=e.i(745844),bM=e.i(734419),bL=e.i(80366),bG=e.i(722313),bU=e.i(507187),bN=e.i(932495),bB=e.i(714260),bW=e.i(788124),bz=e.i(578134),bH=e.i(662792),bq=e.i(838720);e.s(["default",0,function(){var e,n,t,r,i,a,o,s=null,l=(0,m.useRouter)().query;if(!l.replUrl)throw Error("Expected replUrl to be set");if(!l.replId)throw Error("Expected replId to be set");var u=l.replId.toString(),c=(e={variables:{replId:u,environment:(0,bU.useEnvironment)(),platform:(0,bN.usePlatform)()},ssr:!!l.ssr},n=(0,v._)({},S,e),w.useQuery(I,n)),d=c.data,p=c.loading,f=c.error,h=(null==d?void 0:d.currentUser)||void 0,x=(null==d?void 0:d.getRepl)&&("Repl"===d.getRepl.__typename||"ReplRedirect"===d.getRepl.__typename||"ReplSubscriptionExpired"===d.getRepl.__typename)?d.getRepl:null,y=(null==d||null==(t=d.getRepl)?void 0:t.__typename)==="ReplOrgPermissionDeniedError"?d.getRepl:null,b=(null==d||null==(r=d.getRepl)?void 0:r.__typename)==="NotFoundError"?d.getRepl:null,_=(null==d||null==(i=d.getRepl)?void 0:i.__typename)==="UnauthorizedError"||(null==d||null==(a=d.getRepl)?void 0:a.__typename)==="UserError"?d.getRepl:null,j=(null==x?void 0:x.__typename)==="Repl"?x:null,E=null!=(o=null==j?void 0:j.description)?o:void 0,T=null==f?void 0:f.message,P=!!(h&&!h.isVerified);return s=y?(0,g.jsx)(G.ReplOrgPermissionDeniedError,{ownerUsername:y.ownerUsername,ownerImage:y.ownerImage}):P?(0,g.jsx)(D.View,{clsx:bq.default.emailVerificationWrapper,grow:!0,shrink:!0,children:(0,g.jsx)(C.default,{})}):T?(0,g.jsx)(D.View,{align:"center",justify:"center",grow:!0,shrink:!0,children:(0,g.jsx)(a8.Text,{multiline:!1,children:"Something went wrong loading the Repl. Please reload the page and try again."})}):b||_?(0,g.jsx)(bH.default,{}):p?(0,g.jsx)(L,{animation:!0}):j&&h?(0,g.jsx)(bB.default.Provider,{value:j.id,children:(0,g.jsx)(bA,{repl:j,currentUser:h},j.id)}):(0,g.jsx)(L,{animation:!0}),(0,g.jsx)(bW.default,{children:(0,g.jsxs)(bz.default,{dataCy:"workspace-page",title:"".concat((null==j?void 0:j.title)||"Loading..."),description:E,noHeader:!P||!!y,noMain:!P||!!y,noSidebar:!P||!!y,noFooter:!0,hideEmailVerify:!0,children:[j?(0,g.jsx)(bG.OEmbedHead,{replPath:j.url}):null,(0,g.jsx)(k.OpenTelemetryTracer,{}),(0,g.jsxs)(A.Surface,{clsx:bq.default.surface,children:[(0,g.jsx)(bF.HideBodyOverflow,{}),(0,g.jsx)(bM.PreventBodyOverscrollX,{}),s]}),(0,g.jsx)(bL.default,{replId:u})]})})}],453926)},545749,(e,n,t)=>{var r="/replEnvironmentDesktop";(window.__NEXT_P=window.__NEXT_P||[]).push([r,function(){return e.r(453926)}]),n.hot&&n.hot.dispose(function(){window.__NEXT_P.push([r])})}]);

//# debugId=4c8c6c02-81a3-34de-e2ed-abffe8ede2f0
//# sourceMappingURL=a46733cfd10c4718.js.map