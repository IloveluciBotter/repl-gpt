;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="4419f5f5-c751-fd98-a4ad-c712ca55139b")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,929423,e=>{"use strict";var n=e.i(297083),r=e.i(817556),t=e.i(167626),i=function(e){var i=e.dbName,a=e.version,s=e.onUpgrade;return(0,n._)(function(){return(0,r._)(this,function(e){return[2,new Promise(function(e,n){var r=indexedDB.open(i,a);r.onerror=function(){var e;return n(Error("Failed to open database: ".concat(null==(e=r.error)?void 0:e.message)))},r.onsuccess=function(){return e(r.result)},s&&(r.onupgradeneeded=function(e){var r=e.target;(0,t._)(r,IDBOpenDBRequest)&&r.result?s(r.result):n(Error("Invalid target during upgrade."))})})]})})()},a=function(e){var t=e.db,i=e.storeName,a=e.mode,s=e.operation;return(0,n._)(function(){return(0,r._)(this,function(e){return[2,new Promise(function(e,n){if(!t.objectStoreNames.contains(i))return n(Error('Object store "'.concat(i,'" does not exist in the database.')));var r=t.transaction([i],a),o=s(r.objectStore(i));o.onsuccess=function(){return e(o.result)},o.onerror=function(){var e;return n(Error("Transaction error: ".concat(null==(e=o.error)?void 0:e.message)))},r.onabort=function(){return n(Error("Transaction was aborted."))},r.onerror=function(){return n(Error("Transaction encountered an error."))}})]})})()},s=function(e){var n=e.db,r=e.storeName,t=e.data;return a({db:n,storeName:r,mode:"readwrite",operation:function(e){return e.add(t)}})},o="LandingPageAgentAttachments",u=null,l=function(){return(0,n._)(function(){return(0,r._)(this,function(e){return u?[2,u]:[2,u=i({dbName:"ReplitAgentAttachments",version:1,onUpgrade:function(e){e.objectStoreNames.contains(o)||e.createObjectStore(o,{keyPath:"id",autoIncrement:!0})}})]})})()},d=function(e){return(0,n._)(function(){return(0,r._)(this,function(n){switch(n.label){case 0:return[4,l()];case 1:return[4,s({db:n.sent(),storeName:o,data:{file:e,name:e.name,type:e.type,lastModified:e.lastModified}})];case 2:return[2,n.sent()]}})})()},c=function(){return(0,n._)(function(){return(0,r._)(this,function(e){switch(e.label){case 0:return[4,l()];case 1:var n;return[2,a({db:(n={db:e.sent(),storeName:o}).db,storeName:n.storeName,mode:"readonly",operation:function(e){return e.getAll()}})]}})})()},g=function(){return(0,n._)(function(){return(0,r._)(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,(0,n._)(function(){return(0,r._)(this,function(e){switch(e.label){case 0:return[4,l()];case 1:var n;return[2,a({db:(n={db:e.sent(),storeName:o}).db,storeName:n.storeName,mode:"readwrite",operation:function(e){return e.clear()}})]}})})()];case 1:return e.sent(),[3,3];case 2:return e.sent(),[2];case 3:return[2]}})})()};e.s(["addFile",()=>d,"clearAllIndexedDbAttachments",()=>g,"getAllFiles",()=>c],929423)},364674,e=>{"use strict";var n=e.i(297083),r=e.i(878420),t=e.i(817556),i=e.i(435106),a=e.i(910951),s=e.i(576106),o=e.i(188507);e.i(877212);var u=e.i(600637),l=e.i(267710),d=e.i(805763),c=e.i(63846),g=e.i(709485),p=e.i(441329),m=e.i(858248),h=e.i(509908);function f(e){var f=e.currentUserUsername,y=e.currentUserEmail,A=e.currentUserTimeCreated,v=e.updatePromptConnectionStatus,_=(0,p.useIsInBonsaiWebview)();return function(e){return(0,n._)(function(e){var p,x,B,U,E,I,S,T,b,R,C,w,P,j,N,O,D,M,k,q,F,L,G,W,V;return(0,t._)(this,function(z){switch(z.label){case 0:return p=e.prompt,x=e.uploadedFiles,B=e.requestedStackBlueprint,U=e.agentStackTriggerType,E=e.replId,I=e.currentUserId,S=e.orgId,T=e.customStackReplId,b=e.themeConfig,R=e.initialBuildMode,C=e.agentChatMode,w=e.agentStackPlatformType,P=e.agentInitialBuildTier,j=e.autonomyLevel,N=e.webSearchEnabled,O=e.imageGenerationEnabled,D=e.enableAutomatedTesting,M=e.source,k=(0,i.createClientId)({currentUserId:I}),(q=new i.ChatConnection({clientId:k,serverId:u.AI_CHAT_SERVER_ID,connectImmediately:!0,getEndpoint:function(){return(0,n._)(function(){var e,n;return(0,t._)(this,function(r){switch(r.label){case 0:return[4,(0,l.auth)(E,k,S)];case 1:return e=r.sent(),(n=new URL((0,c.getAiEndpoint)())).searchParams.set("auth_token",e),[2,n]}})})()},onProtocolError:function(e){throw Error("Failed to send agent prompt. Protocol error: ".concat(e.message))},onRetriesExceeded:function(){throw Error("Unable to connect. Please try again later.")}})).status.subscribe(function(e){v(e)}),F=(0,s.createSessionRequest)({sessionType:o.SessionType.AGENT_SESSION,replId:E}),[4,q.service.createSession.rpc(F)];case 1:if(!(L=z.sent()).ok)throw Error("Failed to send agent prompt. Session creation failed.");return G=L.payload.sessionId,W=L.payload.sessionCreationEventId,V=(0,a.createEventRequest)({session:G,parent:W,model:o.ModelType.ADVANCED,sender:{id:I,membership:o.MembershipType.CORE,timeCreated:new Date(A)},addToChild:!1,data:{kind:"message",message:p,uploadedFiles:x,requestedStackBlueprint:B,agentStackTriggerType:U,intent:o.MessageAction.AGENT,customStackReplId:T,themeConfig:b,agentConfig:{webSearchEnabled:null==N||N,enableAutomatedTesting:null!=D&&D,imageGenerationEnabled:null==O||O,initialBuildMode:R,agentMode:C,agentInitialBuildTier:P,autonomyLevel:j}}}),q.service.createEvent.rpc(V.request),(0,m.track)(g.events.START_WITH_AI_USED,(0,r._)({action:"created_agent_session",prompt:p,attachments:x,repl_id:E,username:f,email:y,is_mobile:_,has_agent:!0,session_id:G,langsmith_url:(0,d.generateAiSessionLangSmithUrl)(G,o.SessionType.AGENT_SESSION)},w&&{agentStackPlatformType:w},M&&{source:M})),(0,h.trackAgentAnalyticsEvent)({action:"created_new_session",sessionId:G}),[2]}})}).apply(this,arguments)}}e.s(["useSendAgentPrompt",()=>f])},2e3,e=>{"use strict";var n=e.i(297083),r=e.i(167626),t=e.i(878420),i=e.i(64386),a=e.i(886513),s=e.i(530658),o=e.i(817556),u=e.i(931849),l=e.i(389959),d=e.i(569384),c=e.i(973245),g=e.i(951262),p=e.i(304277);e.i(566901);var m=e.i(279042),h=e.i(655366);function f(){var e=(0,d._)(["\n  mutation CreateAgentReplCreateRepl($input: CreateReplInput!) {\n    createRepl(input: $input, isTitleAutoGenerated: false) {\n      __typename\n      ... on Repl {\n        id\n        title\n        ...ReplLinkRepl\n        ...CrosisContextRepl\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n  ","\n"]);return f=function(){return e},e}function y(){var e=(0,d._)(["\n  query CreateAgentReplCurrentUser {\n    currentUser {\n      id\n      username\n      ...CrosisContextCurrentUser\n      replCount {\n        ... on ReplCount {\n          count\n        }\n      }\n    }\n  }\n  ","\n"]);return y=function(){return e},e}var A={},v=(0,c.gql)(f(),m.ReplLinkReplFragmentDoc,h.CrosisContextReplFragmentDoc),_=(0,c.gql)(y(),h.CrosisContextCurrentUserFragmentDoc),x=e.i(368964),B=e.i(188507),U=e.i(377772),E=e.i(906368);function I(){var e=(0,d._)(["\n  mutation GenerateAgentReplIcon($prompt: String!, $replId: String!) {\n    generateReplIcon(input: { prompt: $prompt, replId: $replId }) {\n      ... on GenerateReplIconResult {\n        repl {\n          id\n          iconUrl\n        }\n      }\n    }\n  }\n"]);return I=function(){return e},e}var S={},T=(0,c.gql)(I()),b=e.i(364674),R=e.i(993796),C=e.i(650587),w=e.i(796674),P=e.i(222342),j=e.i(929423),N=e.i(441329),O=e.i(221586),D=e.i(956111),M=e.i(858248),k=e.i(709485),q=e.i(1324),F=e.i(792e3),L=e.i(170784),G=e.i(122965),W=e.i(534518),V=e.i(399978),z=e.i(445059),H=e.i(170710),Q=e.i(185591);function $(e){var d,c,m,h,f,y,I,$,Y,K=e.currentUser,X=(0,s._)((0,l.useState)("idle"),2),J=X[0],Z=X[1],ee=(0,D.useQueryParam)("folderId","string"),en=(0,N.useIsInBonsaiWebview)(),er=(0,P.default)().showError,et=(0,s._)((y=(0,t._)({},A,void 0),g.useMutation(v,y)),1)[0],ei=(m=(c=(d=(0,t._)({},A,void 0),p.useQuery(_,d))).data,h=c.error,f=c.loading,h?{loading:!1,currentUser:null,errorCode:500}:(null==m?void 0:m.currentUser)?{loading:!1,currentUser:m.currentUser,errorCode:null}:f?{loading:!0,currentUser:null,errorCode:null}:{loading:!1,currentUser:null,errorCode:403}).currentUser,ea=(0,G.useFlaggedRetrier)(),es=(0,u.useRouter)(),eo=(0,q.default)(),eu=(0,R.useFlag)({controlName:"flag-killswitch-agent"}),el=(0,H.useWorkspaceLoadingState)(),ed=function(e){Z("idle"),er(e.message),(0,U.sendErrorToSentry)(e),null==el||el.remove()},ec=(0,s._)((0,l.useState)("disconnected"),2),eg=ec[0],ep=ec[1],em=(0,b.useSendAgentPrompt)({currentUserUsername:K.username,currentUserEmail:K.email,currentUserTimeCreated:K.timeCreated,updatePromptConnectionStatus:function(e){ep(e)}}),eh=(Y=(0,s._)((I={onError:function(e){E.captureException(e)}},$=(0,t._)({},S,I),g.useMutation(T,$)),1)[0],function(e){var n=e.prompt,r=e.attachments,t=e.replId;Y({variables:{prompt:n+(r.length>0?"\n\nWith attachments: ".concat(r.map(function(e){return e.path}).join(", ")):""),replId:t}})}),ef=function(e){switch(e){case x.AgentStackPlatformType.Slack:return B.AgentStackTriggerType.SLACK_MESSAGE;case x.AgentStackPlatformType.Telegram:return B.AgentStackTriggerType.TELEGRAM_MESSAGE;case x.AgentStackPlatformType.TimeBased:return B.AgentStackTriggerType.TIME_BASED;case x.AgentStackPlatformType.ConnectorTrigger:return B.AgentStackTriggerType.CONNECTOR_TRIGGER;default:return}},ey="flag-electron-orbital-dance-party",eA=(0,R.useFlag)({controlName:ey}),ev=(0,C.useIsMobile)(),e_=(0,w.useManagerWhoFlag)();return{createAgentRepl:function(e){return(0,n._)(function(){var s,u,l,d,c,g,p,m,h,f,y,A,v,_,U,E,I,S,T,b,R,C,w,P,N,D,q,G,H,$,Y;return(0,o._)(this,function(X){switch(X.label){case 0:if(s=e.prompt,u=e.attachments,l=e.requestedStackBlueprint,d=e.isPrivate,c=e.orgId,g=e.customStackReplId,p=e.isExpertMode,m=e.themeConfig,h=e.initialBuildMode,f=e.appThemeId,y=e.agentStackPlatformType,A=e.agentInitialBuildTier,v=e.autonomyLevel,_=e.webSearchEnabled,U=e.imageGenerationEnabled,E=e.enableAutomatedTesting,I=e.source,S=(0,a._)(e,["prompt","attachments","requestedStackBlueprint","isPrivate","orgId","customStackReplId","isExpertMode","themeConfig","initialBuildMode","appThemeId","agentStackPlatformType","agentInitialBuildTier","autonomyLevel","webSearchEnabled","imageGenerationEnabled","enableAutomatedTesting","source"]),eu)return er("This feature is currently unavailable."),Z("idle"),[2];return(0,O.clearAiPromptLocalStorage)(),[4,(0,j.clearAllIndexedDbAttachments)()];case 1:return X.sent(),Z("creating_repl"),b=null!=(T=S.isInPlanningPhase)?T:!g&&!p&&!h,R=u&&u.length>0,(C=b&&!ev&&!R)&&(eA&&(null==el||el.start({text:s,attachments:u})),(0,M.track)(k.events.EXPERIMENT_VARIANT_ASSIGNED,{experimentName:ey,variant:eA})),w=l===B.StackBlueprint.STACK_BLUEPRINT_AGENT,P=y&&"string"==typeof y&&y.startsWith("connector-")?x.AgentStackPlatformType.ConnectorTrigger:y,[4,et({variables:{input:{aiPromptText:s,aiPromptAttachmentPaths:u.map(function(e){return e.path}),folderId:ee,isPrivate:d,orgId:c,originId:g,detachFromProject:!!g,isInPlanningPhase:b,isExpertMode:p,isAgentStack:w,agentStackPlatformType:P,isWebDesignMockup:h===B.AgentInitialBuildMode.AGENT_INITIAL_BUILD_MODE_DESIGN}}})];case 2:if((N=X.sent()).errors)return ed(Error(N.errors.map(function(e){return e.message}).join(", "))),[2];if(!N.data)return ed(Error("Expected data from createRepl graphql mutation")),[2];if("Repl"!==N.data.createRepl.__typename)return ed(Error(N.data.createRepl.message)),[2];if(D=N.data.createRepl,eh({prompt:s,attachments:u,replId:D.id}),eA&&C&&(null==el||el.update(D)),!R)return[3,4];return q=(0,L.createConnectContext)({repl:D,currentUser:ei}),(G=(0,F.default)({onUnrecoverableError:function(e){Z("idle"),er(e.message)}})).connect({context:q,getMinimumRetryDelayMs:ea}),Z("configuring_repl"),[4,function(e){return(0,n._)(function(e){var n,r,t,i,a;return(0,o._)(this,function(s){switch(s.label){case 0:if(n=e.hasAttachments,r=e.container,t=e.attachments,i=e.handleError,!n)return[2];return a=(0,W.default)({container:r}),[4,(0,V.uploadFiles)({parentPath:z.ATTACHED_ASSETS_PATH,files:t.map(function(e){return e.file}),fs:a,onError:function(e){i(Error("Error uploading ".concat(e.path,": ").concat(e.error)))}})];case 1:return s.sent(),[2]}})}).apply(this,arguments)}({hasAttachments:R,attachments:u,container:G,handleError:ed})];case 3:X.sent(),X.label=4;case 4:return X.trys.push([4,6,,7]),[4,em({prompt:s,uploadedFiles:u.map(function(e){return{path:e.path,mimeType:e.file.type}}),requestedStackBlueprint:l,agentStackTriggerType:ef(P),replId:D.id,currentUserId:K.id,orgId:c,customStackReplId:g,themeConfig:m,initialBuildMode:h,agentChatMode:b?B.AgentMode.AGENT_MODE_INITIAL_PLANNING:B.AgentMode.AGENT_MODE_GENERAL,agentStackPlatformType:P,agentInitialBuildTier:A,autonomyLevel:v,webSearchEnabled:_,imageGenerationEnabled:U,enableAutomatedTesting:E,source:I})];case 5:return X.sent(),[3,7];case 6:return H=X.sent(),ed((0,r._)(H,Error)?H:Error(String(H))),[2];case 7:if(Z("opening_repl"),$={enterInAgentMode:e_?b:!h,enterInExpertMode:p,appThemeId:f},Y=(0,Q.replLinkProps)(D,$),!en)return[3,8];return window.location.href=(0,Q.replLinkFullUrl)(D,$),[3,10];case 8:return[4,es.push((0,i._)((0,t._)({},Y.href),{pathname:eo}),Y.as)];case 9:X.sent(),X.label=10;case 10:return Z("idle"),[2]}})})()},status:J,agentPromptRiverConnectionStatus:eg}}e.s(["useCreateAgentRepl",()=>$],2e3)},813190,e=>{"use strict";var n=e.i(878420),r=e.i(569384),t=e.i(973245),i=e.i(304277);e.i(566901);var a=e.i(850176),s=e.i(696683),o=e.i(23293);function u(){var e=(0,r._)(["\n  fragment StartWithAiOrgMetadata on Org {\n    id\n    name\n  }\n"]);return u=function(){return e},e}function l(){var e=(0,r._)(["\n  fragment StartWithAiUsageBudget on UsageBasedBillingBudget {\n    id\n    hasReachedBudget\n  }\n"]);return l=function(){return e},e}function d(){var e=(0,r._)(["\n  fragment StartWithAiOrgUsageLimitAuthorization on OrgAuthorizations {\n    editUsageLimit {\n      isAuthorized\n      message\n    }\n  }\n"]);return d=function(){return e},e}function c(){var e=(0,r._)(["\n  query StartWithAi {\n    currentUser {\n      id\n      username\n      firstName\n      email\n      isVerified\n      ...AiProviderCurrentUser\n      ...ReplOwnerCurrentUser\n    }\n  }\n  ","\n  ","\n"]);return c=function(){return e},e}function g(){var e=(0,r._)(["\n  query StartWithAiUsageLimits($orgId: String) {\n    currentUser {\n      id\n      usageBasedBillingBudget {\n        __typename\n        ... on UsageBasedBillingBudget {\n          ...StartWithAiUsageBudget\n        }\n        ... on Error {\n          message\n        }\n      }\n      usageBasedBillingAlerts {\n        ...EditUsageBasedBillingAlertsFormInitialConfig\n      }\n      org(orgId: $orgId) {\n        __typename\n        ... on Org {\n          ...StartWithAiOrgMetadata\n          authorizations {\n            ...StartWithAiOrgUsageLimitAuthorization\n          }\n          groups(input: { types: [system_viewers] }) {\n            ... on OrgGroupConnection {\n              items {\n                id\n                type\n                isMember\n              }\n            }\n          }\n          usageBasedBillingBudget {\n            __typename\n            ... on UsageBasedBillingBudget {\n              ...StartWithAiUsageBudget\n            }\n            ... on Error {\n              message\n            }\n          }\n          usageBasedBillingAlerts {\n            ...EditUsageBasedBillingAlertsFormInitialConfig\n          }\n        }\n        ... on Error {\n          message\n        }\n      }\n    }\n  }\n  ","\n  ","\n  ","\n  ","\n"]);return g=function(){return e},e}var p={},m=(0,t.gql)(u()),h=(0,t.gql)(l()),f=(0,t.gql)(d()),y=(0,t.gql)(c(),a.AiProviderCurrentUserFragmentDoc,o.ReplOwnerCurrentUserFragmentDoc);function A(e){var r=(0,n._)({},p,e);return i.useQuery(y,r)}var v=(0,t.gql)(g(),h,s.EditUsageBasedBillingAlertsFormInitialConfigFragmentDoc,m,f);function _(e){var r=(0,n._)({},p,e);return i.useQuery(v,r)}e.s(["useStartWithAiQuery",()=>A,"useStartWithAiUsageLimitsQuery",()=>_])},183662,516308,508536,e=>{"use strict";var n=e.i(530658),r=e.i(276385),t=e.i(389959),i=e.i(414779),a=e.i(541508),s=e.i(446530),o=e.i(613355),u=e.i(140487),l=e.i(396776),d=e.i(960178),c=e.i(751273),g=e.i(625484),p=e.i(940745),m=e.i(530310),h=function(e){var n=e.owner,t=e.currentUserId,i="Org"===n.__typename;return"Org"===n.__typename&&"OrgGroupConnection"===n.groups.__typename&&void 0!==n.groups.items.find(function(e){return"system_viewers"===e.type&&e.isMember})?(0,r.jsx)(y,{orgId:i?n.id:"",orgName:n.name,currentUserId:t}):(0,r.jsx)(f,{})},f=function(){return(0,r.jsx)(g.View,{children:(0,r.jsx)(l.StatusBanner,{colorway:"warning",text:"You do not have permission to create an app"})})},y=function(e){var s,o=e.orgId,h=e.orgName,f=e.currentUserId,y=(0,n._)((0,t.useState)(!1),2),v=y[0],_=y[1],x=(0,i.useOrgViewerUpgradeRequestQuery)({variables:{orgId:o,upgradeRequestInput:{userId:f,status:"PENDING"}}}),B=x.data,U=x.loading,E=x.error,I=(null==B||null==(s=B.currentUser)?void 0:s.org.__typename)==="Org"&&null!==B.currentUser.org.upgradeRequest;return U?(0,r.jsx)(g.View,{css:A.loadingAndErrorWrapper,children:(0,r.jsx)(p.default,{})}):E?(0,r.jsx)(g.View,{css:A.loadingAndErrorWrapper,children:(0,r.jsx)(g.View,{children:(0,r.jsx)(l.StatusBanner,{colorway:"red",text:"Something went wrong."})})}):(0,r.jsxs)(g.View,{css:A.overlayContainer,gap:16,justify:"center",align:"center",children:[(0,r.jsx)(m.default,{size:24}),(0,r.jsx)(d.Text,{css:A.overlayText,children:"As a viewer you can access apps but you canâ€™t create them. To create apps, you need to request an upgrade to a full seat from your team admin."}),(0,r.jsx)(c.Tooltip,{tooltip:"You already have a pending upgrade request. Please wait for your admin to respond.",isDisabled:!I,children:(0,r.jsx)(u.Button,{text:"Request upgrade from admin",isDisabled:I,variant:"default",colorway:"primary",onClick:function(){return _(!0)}})}),(0,r.jsx)(a.default,{isOpen:v,orgId:o,orgName:h,onClose:function(){return _(!1)},onSuccess:function(){return _(!1)}})]})},A=(0,s.cssRecord)({loadingAndErrorWrapper:[o.rcss.display.flex,o.rcss.flex.growAndShrink(1),o.rcss.center],overlayContainer:[o.rcss.maxWidth("100%")],overlayText:[o.rcss.textAlign.center,o.rcss.maxWidth(600),o.rcss.colWithGap(8)]});e.s(["AgentInputNoCreationPermission",()=>h],183662);var v=e.i(417751),_=e.i(310158),x=e.i(760129),B=e.i(878420),U=e.i(569384),E=e.i(973245),I=e.i(304277);function S(){var e=(0,U._)(["\n  query AgentInputReachedHardLimit($orgId: String) {\n    currentUser {\n      id\n      usageInterval {\n        ... on UsageInterval {\n          endDate\n        }\n        ... on Error {\n          message\n        }\n      }\n      org(orgId: $orgId) {\n        ... on Org {\n          id\n          usageInterval {\n            ... on UsageInterval {\n              endDate\n            }\n            ... on Error {\n              message\n            }\n          }\n        }\n      }\n    }\n  }\n"]);return S=function(){return e},e}e.i(566901);var T={},b=(0,E.gql)(S()),R=e.i(952030),C=function(e){var n,t,i,a,s,o,d=e.onIncreaseBudget,c=e.canEditUsageLimit,m=e.orgId,h=void 0!==m,f=h&&!c,y=(n={variables:{orgId:m}},t=(0,B._)({},T,n),I.useQuery(b,t)),A=y.data,v=y.loading,_=y.error;return(i=h?(null==A||null==(a=A.currentUser)?void 0:a.org.__typename)==="Org"&&"UsageInterval"===A.currentUser.org.usageInterval.__typename?A.currentUser.org.usageInterval.endDate:"":(null==A||null==(o=A.currentUser)||null==(s=o.usageInterval)?void 0:s.__typename)==="UsageInterval"?A.currentUser.usageInterval.endDate:"",v)?(0,r.jsx)(g.View,{css:j.loadingAndErrorWrapper,children:(0,r.jsx)(p.default,{})}):_?(0,r.jsx)(g.View,{css:j.loadingAndErrorWrapper,children:(0,r.jsx)(g.View,{children:(0,r.jsx)(l.StatusBanner,{colorway:"red",text:"Something went wrong."})})}):(0,r.jsxs)(g.View,{css:j.overlayContainer,gap:16,align:"center",justify:"center",children:[(0,r.jsxs)(g.View,{css:j.overlayText,children:[(0,r.jsx)(w,{isOrg:h}),(0,r.jsx)(P,{isOrg:h,isOrgMemberWithoutEditPermission:f,endOfBillingPeriod:i})]}),f?null:(0,r.jsx)(u.Button,{text:"Increase usage budget",onClick:d,iconLeft:(0,r.jsx)(R.default,{}),colorway:"primary"})]})},w=function(e){var n=e.isOrg;return(0,r.jsx)(d.Text,{css:j.overlayTitle,variant:"subheadDefault",children:n?"Your team has hit its monthly usage budget.":"You've hit your monthly usage budget."})},P=function(e){var n=e.isOrg,t=e.isOrgMemberWithoutEditPermission,i=e.endOfBillingPeriod,a=(0,x.parseISO)(i),s=(0,_.isValid)(a)?" on ".concat((0,v.format)(a,"MMM do, hh:mm aaa")):"";return n?t?(0,r.jsxs)(d.Text,{variant:"small",children:["To continue using the Agent now, please contact your team admin to request an increase in the usage budget. Otherwise, your usage will reset",s," when the next billing period begins."]}):(0,r.jsxs)(d.Text,{variant:"small",children:["To continue using the Agent now, increase your budget. Otherwise, your team's usage will reset",s," when the next billing period begins."]}):(0,r.jsxs)(d.Text,{children:["To continue using the Agent now, increase your budget. Otherwise, your usage will reset",s," when the next billing period begins."]})},j=(0,s.cssRecord)({overlayContainer:[o.rcss.maxWidth("100%")],overlayText:[o.rcss.textAlign.center,o.rcss.maxWidth(800),o.rcss.colWithGap(8)],overlayTitle:[o.rcss.fontWeight.bold],loadingAndErrorWrapper:[o.rcss.display.flex,o.rcss.flex.growAndShrink(1),o.rcss.center,o.rcss.minHeight(200)]});e.s(["AgentInputReachedHardLimit",()=>C],516308);var N=e.i(297083),O=e.i(817556),D=e.i(368964),M=e.i(765219),k=e.i(78433),q=e.i(91720),F=e.i(739521),L=e.i(929872),G=e.i(774792),W=e.i(821488),V=(0,s.cssRecord)({ubbBannedContainer:[o.rcss.textAlign.center],buttonContainer:[{"@media (max-width: 600px)":{flexDirection:"column"}}]});function z(e){var i,a,s=e.context,o=(0,n._)((0,t.useState)(!1),2),l=o[0],c=o[1],p="org"===s.type&&(null==(i=s.orgDealContext)?void 0:i.dealType)!==D.OrgDealType.Trial&&(null==(a=s.orgDealContext)?void 0:a.dealType)!==D.OrgDealType.EnterpriseTrial&&(null==s?void 0:s.canEditPaymentMethod)||"user"===s.type,m=(0,k.getUbbSuspensionDescription)("org"===s.type?{type:"org",isAdmin:s.isAdmin,isSuspended:s.isSuspended,orgDealContext:s.orgDealContext}:{type:"user",isSuspended:s.isSuspended}),h=m.headingText,f=m.subheadingText;return(0,r.jsxs)(g.View,{gap:12,align:"center",css:V.ubbBannedContainer,children:[(0,r.jsx)(d.Text,{variant:"subheadDefault",children:h}),(0,r.jsx)(d.Text,{children:f}),p?(0,r.jsx)(L.Surface,{elevated:!0,children:(0,r.jsxs)(g.View,{row:!0,css:V.buttonContainer,gap:12,children:[(0,r.jsx)(g.View,{gap:8,children:(0,r.jsx)(q.ButtonLink,{iconLeft:(0,r.jsx)(W.default,{}),text:"View and pay invoices",href:"org"===s.type?"/orb-customer-portal/org/".concat(s.orgId):"/orb-customer-portal",target:"_blank"})}),(0,r.jsx)(g.View,{gap:8,children:(0,r.jsx)(u.Button,{iconLeft:(0,r.jsx)(G.default,{}),text:"Update payment method",colorway:"primary",onClick:function(){return c(!0)}})})]})}):null,(0,r.jsx)(F.Modal,{isOpen:l,onRequestClose:function(){return c(!1)},children:(0,r.jsx)(M.PaymentMethodForm,{onDone:function(){c(!1)},onBack:function(){return(0,N._)(function(){return(0,O._)(this,function(e){return[2,c(!1)]})})()}})})]})}e.s(["default",()=>z],508536)},527587,175195,882029,135958,849165,e=>{"use strict";var n,r=e.i(530658),t=e.i(276385),i=e.i(931849),a=e.i(389959),s=e.i(368964),o=e.i(629536),u=e.i(569910),l=e.i(596139),d=e.i(183662),c=e.i(516308),g=e.i(508536),p=e.i(813190),m=e.i(968783);function h(){var e,n,r,t,i,a,s,o,u,l,d=(0,m.useCurrentUserStoredOrgContext)().orgId,c=void 0!==d,g=(0,p.useStartWithAiUsageLimitsQuery)({variables:{orgId:d},context:{noBatch:!0},ssr:!1}),h=g.data,f=g.loading,y=g.error;if(f)return{status:"loading"};var A=!0;c?(e=null!=h&&!!h.currentUser&&"Org"===h.currentUser.org.__typename&&(null==(t=h.currentUser.org.usageBasedBillingBudget)?void 0:t.__typename)==="UsageBasedBillingBudget"&&h.currentUser.org.usageBasedBillingBudget.hasReachedBudget,A=null!=h&&!!h.currentUser&&"Org"===h.currentUser.org.__typename&&(null==(i=h.currentUser.org.authorizations)?void 0:i.__typename)==="OrgAuthorizations"&&h.currentUser.org.authorizations.editUsageLimit.isAuthorized,n=(null==h||null==(a=h.currentUser)?void 0:a.org.__typename)==="Org"?h.currentUser.org:void 0,r=(null==h||null==(s=h.currentUser)?void 0:s.org.__typename)==="Org"&&(null==(o=h.currentUser.org.usageBasedBillingAlerts)?void 0:o.__typename)==="UsageBasedBillingAlertsConfig"?h.currentUser.org.usageBasedBillingAlerts:void 0):(e=null!=h&&!!h.currentUser&&(null==(u=h.currentUser.usageBasedBillingBudget)?void 0:u.__typename)==="UsageBasedBillingBudget"&&h.currentUser.usageBasedBillingBudget.hasReachedBudget,r=(null==h||null==(l=h.currentUser)?void 0:l.usageBasedBillingAlerts.__typename)==="UsageBasedBillingAlertsConfig"?h.currentUser.usageBasedBillingAlerts:void 0);var v=y?"Failed to load usage data":void 0;return v?{status:"error",error:v}:{status:"success",hasReachedBudget:e,canEditUsageLimit:A,org:n,usageBasedBillingAlerts:r}}function f(e){return"CurrentUser"===e.__typename?"OrgAuthorizations"===e.personalOrgAuthorizations.__typename?e.personalOrgAuthorizations:void 0:"Org"===e.__typename?e.authorizations:void 0}e.s(["getAgentAuthorizationsForOwner",()=>f,"useBillingBudgetStatus",()=>h],175195);var y=e.i(173532),A=e.i(993796),v=e.i(878420),_=e.i(569384),x=e.i(973245),B=e.i(304277);function U(){var e=(0,_._)(["\n  query IsUBBBanned($orgId: String) {\n    currentUser {\n      id\n      isUBBBanned\n      org(orgId: $orgId) {\n        ... on Org {\n          id\n          isUBBBanned\n        }\n      }\n    }\n  }\n"]);return U=function(){return e},e}e.i(566901);var E={},I=(0,x.gql)(U());function S(e){var n,r,t,i,a,s,o=(a={variables:{orgId:e.orgId}},s=(0,v._)({},E,a),B.useQuery(I,s)),u=o.data,l=o.loading,d=o.refetch;return{loading:l,isUBBBanned:(null==u||null==(n=u.currentUser)?void 0:n.org.__typename)==="Org"?null==u||null==(t=u.currentUser)||null==(r=t.org)?void 0:r.isUBBBanned:null==u||null==(i=u.currentUser)?void 0:i.isUBBBanned,refetchBanStatus:d}}e.s(["useIsUBBBanned",()=>S],882029);var T=e.i(573605),b=((n={}).AgentKillswitch="Agent killswitch",n.ErrorDeterminingBudget="Error determining budget",n.BudgetExceeded="Budget exceeded",n.EmailVerificationRequired="Email verification required",n.FreeAgentUsageQuotaExceeded="Free Agent usage quota exceeded",n.FreeReplLimitExceeded="Free Repl limit exceeded",n.FreemiumTemporarilyUnavailable="Freemium temporarily unavailable",n.NoReplCreationPermissions="No Repl creation permissions",n.UserUBBBanned="User is UBB Banned",n.RequiresPaymentMethod="Requires payment method",n.PaymentDelinquent="Failed payment. Update payment method to continue using Agent.",n);function R(e,n){var r=(0,T.useGetAgentFreeUsage)(),t=r.agentUsage,i=r.agentUsageV2,a=r.loading,o="Org"===e.__typename?e.id:void 0,u=f(e),l=S({orgId:o}),d=l.loading,c=l.isUBBBanned,g=(0,y.useReplLimit)(),p=(0,A.useFlag)({controlName:"flag-killswitch-agent"}),m=(0,A.useFlag)({controlName:"flag-freemium-ai-load-shedder"}),h="CurrentUser"===e.__typename&&!e.isSubscribed,v="Org"===e.__typename&&!e.authorizations.createPrivateRepl.isAuthorized&&!e.authorizations.createPublicRepl.isAuthorized;if(!u||a||"loading"===n.status||"loading"===g.type||d)return{loading:!0,hasAccess:!1};if(p)return{loading:!1,hasAccess:!1,accessDeniedReason:"Agent killswitch"};if(c)return{loading:!1,hasAccess:!1,accessDeniedReason:"User is UBB Banned"};if("error"===n.status)return{loading:!1,hasAccess:!1,accessDeniedReason:"Error determining budget"};if(!u.paidAgent.isAuthorized&&u.paidAgent.code===s.OrgAuthorizationCode.InsufficientBudget)return{loading:!1,hasAccess:!1,accessDeniedReason:"Budget exceeded"};if(!u.paidAgent.isAuthorized&&!u.freeAgent.isAuthorized&&v)return{loading:!1,hasAccess:!1,accessDeniedReason:"No Repl creation permissions"};if(!u.freeAgent.isAuthorized&&u.freeAgent.code===s.OrgAuthorizationCode.RequiresEmailVerification)return{loading:!1,hasAccess:!1,accessDeniedReason:"Email verification required"};var _=i?i.isUnderQuota:null==t?void 0:t.isUnderQuota;return h&&!_?{loading:!1,hasAccess:!1,accessDeniedReason:"Free Agent usage quota exceeded"}:"data"===g.type&&g.shouldBlockReplForm?{loading:!1,hasAccess:!1,accessDeniedReason:"Free Repl limit exceeded"}:m&&h?{loading:!1,hasAccess:!1,accessDeniedReason:"Freemium temporarily unavailable"}:u.paidAgent.code===s.OrgAuthorizationCode.RequiresPaymentMethod?{loading:!1,hasAccess:!1,accessDeniedReason:"Requires payment method"}:u.paidAgent.code===s.OrgAuthorizationCode.PaymentDelinquent?{loading:!1,hasAccess:!1,accessDeniedReason:"Failed payment. Update payment method to continue using Agent."}:{loading:!1,hasAccess:!0}}e.s(["AgentAccessDeniedReason",()=>b,"useAgentReplCreationAccess",()=>R],135958);var C=e.i(82464),w=e.i(418725),P=e.i(201411),j=e.i(739521),N=e.i(396776),O=e.i(960178),D=e.i(625484),M=e.i(871318),k=e.i(917204);function q(e){var n=e.agentAccessDeniedReason,p=e.owner,h=e.usageInfo,f=e.currentUserId,y=(0,r._)((0,a.useState)(!1),2),A=y[0],v=y[1],_=(0,m.useCurrentUserStoredOrgContext)(),x=_.orgRole,B=_.orgDealContext,U=(0,i.useRouter)();return n===b.BudgetExceeded?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.AgentInputReachedHardLimit,{orgId:"Org"===p.__typename?p.id:void 0,canEditUsageLimit:"success"===h.status&&h.canEditUsageLimit,onIncreaseBudget:function(){return v(!0)}}),(0,t.jsx)(j.Modal,{isOpen:A,onRequestClose:function(){return v(!1)},children:(0,t.jsx)(P.EditUsageBasedBillingAlertsForm,{org:"success"===h.status?h.org:void 0,initialSettings:"success"===h.status?h.usageBasedBillingAlerts:void 0,onDone:function(){return v(!1)}})})]}):n===b.FreeAgentUsageQuotaExceeded?(0,t.jsxs)(D.View,{gap:8,align:"center",children:[(0,t.jsxs)(O.Text,{color:"dimmer",children:["You've reached your ",l.freePlanName," usage limit"]}),(0,t.jsx)(w.default,{context:"agent_freemium_quota",colorway:"primary",variant:"outlined",text:"Upgrade to ".concat(l.corePlanName," to continue using ").concat(o.AGENT_NAME),modalHeadingText:"Upgrade to ".concat(l.corePlanName," to continue using ").concat(o.AGENT_NAME),modalSubHeadingText:"You've reached your ".concat(l.freePlanName," usage limit")})]}):n===b.ErrorDeterminingBudget?(0,t.jsx)(D.View,{children:(0,t.jsx)(D.View,{children:(0,t.jsx)(N.StatusBanner,{colorway:"red",text:"Error determining remaining budget. Please try again later."})})}):n===b.AgentKillswitch?(0,t.jsx)(D.View,{children:(0,t.jsx)(N.StatusBanner,{colorway:"red",text:"This feature is currently unavailable. Please try again later."})}):n===b.PaymentDelinquent?(0,t.jsx)(g.default,{context:"Org"===p.__typename?{type:"org",orgId:p.id,isAdmin:x===s.SystemOrgGroupType.SystemAdmins,canEditPaymentMethod:x===s.SystemOrgGroupType.SystemAdmins,isSuspended:!1,orgDealContext:B}:{type:"user",isSuspended:!1}}):n===b.FreeReplLimitExceeded?(0,t.jsxs)(D.View,{gap:12,align:"center",children:[(0,t.jsx)(k.default,{size:32}),(0,t.jsx)(O.Text,{variant:"subheadDefault",children:"You've hit your limit of free Apps"}),(0,t.jsx)(w.default,{context:"repl_limit_upsell",colorway:"primary",variant:"default",text:"Upgrade to ".concat(l.corePlanName," for unlimited Apps"),modalHeadingText:"Upgrade to ".concat(l.corePlanName," for unlimited Apps"),modalSubHeadingText:"You've hit your limit for Apps"})]}):n===b.EmailVerificationRequired?(0,t.jsx)(C.default,{onEmailVerified:function(){U.reload()}}):n===b.FreemiumTemporarilyUnavailable?(0,t.jsxs)(D.View,{gap:12,align:"center",children:[(0,t.jsxs)(O.Text,{variant:"subheadDefault",children:[o.AGENT_NAME," is currently experiencing high demand and is temporarily unavailable for ",l.freePlanName," plan users."]}),(0,t.jsxs)(O.Text,{children:["Please try again later, or upgrade to ",l.corePlanName," for immediate access."]}),(0,t.jsx)(w.default,{context:"agent_freemium_quota",colorway:"primary",variant:"default",text:"Upgrade to ".concat(l.corePlanName," to continue using ").concat(o.AGENT_NAME),modalHeadingText:"Upgrade to ".concat(l.corePlanName," to continue using ").concat(o.AGENT_NAME),modalSubHeadingText:"".concat(o.AGENT_NAME," is currently experiencing high demand and is temporarily unavailable for ").concat(l.freePlanName," plan users.")})]}):n===b.NoReplCreationPermissions?(0,t.jsx)(d.AgentInputNoCreationPermission,{owner:p,currentUserId:f}):n===b.UserUBBBanned?(0,t.jsx)(g.default,{context:"Org"===p.__typename?{type:"org",orgId:p.id,isAdmin:x===s.SystemOrgGroupType.SystemAdmins,canEditPaymentMethod:p.authorizations.editPaymentMethod.isAuthorized,isSuspended:!0,orgDealContext:B}:{type:"user",isSuspended:!0}}):n===b.RequiresPaymentMethod?(0,t.jsx)(M.default,{owner:"Org"===p.__typename?{type:"org",slug:p.slug}:void 0}):void(0,u.default)(n)}e.s(["AgentEntryPointOverlay",()=>q],527587);var F=e.i(297083),L=e.i(817556);e.i(877212);var G=e.i(924908);e.i(908320);var W=e.i(342469);function V(){var e=(0,G.useYapper)(),n=(0,a.useMemo)(function(){return new W.Classifier({classifyFn:function(n,r){return(0,F._)(function(){return(0,L._)(this,function(t){return[2,e.classifyInitialUserPrompt(n,r)]})})()},uploadFile:function(n){return(0,F._)(function(){return(0,L._)(this,function(r){return[2,e.uploadStackSelectionFile({fileName:n.path.split("/").pop()||n.path,mimeType:n.mimeType,file:n.file})]})})()}})},[e]);return(0,a.useEffect)(function(){return function(){n.destroy()}},[n]),n}e.s(["useClassifier",()=>V],849165)}]);

//# debugId=4419f5f5-c751-fd98-a4ad-c712ca55139b
//# sourceMappingURL=462ce1e5895060d2.js.map